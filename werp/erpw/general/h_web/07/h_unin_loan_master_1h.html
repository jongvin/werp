<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************  -->
<!-- 1. 프로그램 id   : h_unin_loan_master_1h.html                   -->
<!-- 2. 유형(시나리오): shared window 조회및 입력                    -->
<!-- 3. 기 능 정 의   : 조합대여금관리(분양)                         -->
<!-- 4. 변 경 이 력   : 김 동우 작성                                 -->
<!-- 5. 관련프로그램  :                                              -->
<!-- 6. 특 기 사 항   :                                              -->
<!-- *************************************************************   -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
var gs_home = top.frames['security'].gs_home.value

var is_ds_1_addr = gs_home + '/general/h_web/07/h_unin_loan_master_1q.jsp'

var is_ds_2_addr = gs_home + '/general/h_web/07/h_unin_loan_master_2q.jsp?arg_dept_code='
var is_tr_2_addr = gs_home + '/general/h_web/07/h_unin_loan_master_2tr.jsp'

var is_ds_3_addr = gs_home + '/general/h_web/07/h_unin_loan_master_3q.jsp?arg_dept_code='
var is_tr_3_addr = gs_home + '/general/h_web/07/h_unin_loan_master_3tr.jsp'

var il_screen = 1
var tr_fail=1                 // update정상:1  비정상:0

//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{	
	if ( il_screen == 2 ) {
		div_btnquery_onclick()
		return
	}
	if ( il_screen == 3 ) {
		div_btnquery_onclick1()
		return
	}
   ds_1.DataID = is_ds_1_addr 
   ds_1.SyncLoad=true
   ds_1.Reset()

   if (ds_1.countrow == 0 ){
	   ds_2.cleardata()
	   ds_3.cleardata()
	}
   
}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
   var ls_dept_code,ls_sell_code,ls_union_code
   
   ls_dept_code  = ds_1.NameValue(ds_1.RowPosition,'dept_code')
   ls_sell_code  = ds_1.NameValue(ds_1.RowPosition,'sell_code')
   ls_union_code = ds_1.NameValue(ds_1.RowPosition,'union_code')
   
   ds_2.DataID = is_ds_2_addr + ls_dept_code  + "&arg_sell_code=" + ls_sell_code +
                 "&arg_union_code=" + ls_union_code 
   ds_2.SyncLoad=true
	ds_2.Reset()
	if (ds_2.countrow == 0 ){
	   ds_3.cleardata()
	}
   
   
}
//------------------------------------------------------------------------
function div_btnquery_onclick1()                     // 최하위 조회  
//------------------------------------------------------------------------
{
   var ls_dept_code,ls_sell_code,ls_union_code,ls_degree
   
   if (ds_2.CountRow < 1 ){
      ds_3.ClearData()
      return
   }
   ls_dept_code  = ds_2.NameValue(ds_2.RowPosition,'dept_code')
   ls_sell_code  = ds_2.NameValue(ds_2.RowPosition,'sell_code')
   ls_union_code = ds_2.NameValue(ds_2.RowPosition,'union_code')
   ls_degree     = ds_2.NameValue(ds_2.RowPosition,'pay_degree')
   
   ds_3.DataID = is_ds_3_addr + ls_dept_code  + "&arg_sell_code=" + ls_sell_code +
                 "&arg_union_code=" + ls_union_code + "&arg_pay_degree=" + ls_degree
                 
   ds_3.SyncLoad=true
	ds_3.Reset()
   
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
   if ( il_screen == 2 ) {
      gd_2.Focus();
      gd_2.SetColumn("pay_degree");
   }
   else {
      gd_3.Focus();
      gd_3.SetColumn("degree_seq");
   }
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
   var ll_seq
   
   if ( il_screen == 2 ) {
      ds_2.NameValue(ds_2.RowPosition,'dept_code')  = ds_1.NameValue(ds_1.RowPosition,'dept_code')
      ds_2.NameValue(ds_2.RowPosition,'sell_code')  = ds_1.NameValue(ds_1.RowPosition,'sell_code')
      ds_2.NameValue(ds_2.RowPosition,'union_code') = ds_1.NameValue(ds_1.RowPosition,'union_code')
      ll_seq = ds_2.Max(4,0,0)
      ds_2.NameValue(ds_2.RowPosition,'pay_degree') = ll_seq + 1
   }
   else {
      ds_3.NameValue(ds_3.RowPosition,'dept_code')  = ds_2.NameValue(ds_2.RowPosition,'dept_code')
      ds_3.NameValue(ds_3.RowPosition,'sell_code')  = ds_2.NameValue(ds_2.RowPosition,'sell_code')
      ds_3.NameValue(ds_3.RowPosition,'union_code') = ds_2.NameValue(ds_2.RowPosition,'union_code')
      ds_3.NameValue(ds_3.RowPosition,'pay_degree') = ds_2.NameValue(ds_2.RowPosition,'pay_degree')
      ll_seq = ds_3.Max(5,0,0)
      ds_3.NameValue(ds_3.RowPosition,'degree_seq') = ll_seq + 1
   }

   Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
   if ( il_screen == 1 ) return

   if ( il_screen == 2 ) {
      ds_2.AddRow()
   }
   else {
      if (ds_2.CountRow < 1 ) {
         return
      }
      ds_3.AddRow()
   }

   init_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
   if ( il_screen == 1 ) return

   if (il_screen == 2 ) {
      if (ds_2.CountRow < 1 ) {
         ds_2.AddRow()
      }
      else {
         ds_2.InsertRow(ds_1.RowPosition)
      }
   }
   else {
      if (ds_2.CountRow < 1 ) {
         return
      }
      if (ds_3.CountRow < 1 ) {
         ds_3.AddRow()
      }
      else {
         ds_3.InsertRow(ds_2.RowPosition)
      }
   }  
   init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
   if ( il_screen == 1 ) return
   
   if ( il_screen == 2 ) {
   	if (ds_3.CountRow > 0) {
   		alert('하위자료가 존재하므로 삭제할 수 없습니다...')
   		return
   	}
   	if (ds_3.IsUpdated) {
   		tr_3.Post()
   	}
      ds_2.DeleteRow(ds_2.RowPosition)  
   }  
   else {
      ds_3.DeleteRow(ds_3.RowPosition)
   }  
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
   var ls_chk=0,ls_spec_chk=0
	var ll_dup

	if (ds_2.IsUpdated){
		ll_dup = f_dup_chk("ds_2","pay_degree")
		if (ll_dup > 0) {
			alert("차수가 중복되었습니다: 차수를 수정하십시요 ")
			ds_2.RowPosition = ll_dup
			gd_2.SetColumn("pay_degree")
			return
		}
	}           
	if (ds_3.IsUpdated){
		ll_dup = f_dup_chk("ds_3","degree_seq")
		if (ll_dup > 0) {
			alert("회수가 중복되었습니다: 회수를 수정하십시요 ")
			ds_3.RowPosition = ll_dup
			gd_3.SetColumn("degree_seq")
			return
		}
	}           

   if (ds_2.IsUpdated || ds_3.IsUpdated ){
      if  (confirm("변경되었습니다 저장하시겠습니까?")){
         if (ds_2.IsUpdated ) {
            tr_2.Post()
         }
         if (ds_3.IsUpdated ) {
            tr_3.Post()
         }
      }
   }
   
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
   ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
   if (ds_1.IsUpdated) {
        if  (confirm("변경되었습니다 저장하시겠습니까?")) 
           {  //저장 routine
           }   
 
      }     
   top.frames['main_ct'].location.href(ls_arg)
   top.frames['main_title'].div_r.style.visibility="hidden"             
   top.frames['main_title'].div_u.style.visibility="hidden"             

   // top.frames['main_ct'].window.close()     
}
//----------------------------------------------------------------
function excel_down()                      //엑셀자료 내리기(공종별) 
//----------------------------------------------------------------
{
 var temp_1
 temp_1 = is_dept_name + '   [' + em_select_yymm.text + ']'
 gd_1.RunExcelSheet(temp_1)
   
}
//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{	
	if (focus == il_screen) {
		return
	}	
	il_screen = focus
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
   tr_2.Action = is_tr_2_addr 
   tr_3.Action = is_tr_3_addr 

   ll_cnt = f_select_q("select code select_1, code_name select_2  from h_code_common  where code_div = '10' order by code ")       //조합구분 

   btnquery_onclick()
}
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
   if  (row < 1) return;
   if (ds_2.IsUpdated || ds_3.IsUpdated ){
   	btnsave_onclick()
   }
   div_btnquery_onclick()  
</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_2>
   if  (row < 1) return;
   if (ds_3.IsUpdated ){
      if  (confirm("변경되었습니다 저장하시겠습니까?")){
         if (ds_3.IsUpdated ) {
            tr_3.Post()
         }
      }
   }
   div_btnquery_onclick1()  
</SCRIPT>

</HEAD>

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
   alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
   alert("Error Code : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
   alert("Error Code : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
   alert("Error Code : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
     tr_fail=0
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
   alert("Error Code : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_3.ErrorMsg + "\n");
</SCRIPT>

<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<comment id="__NSID__"><OBJECT id=ds_1 
   classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
   <param name=SyncLoad value=true>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
   classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
   <param name=SyncLoad value=true>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
   classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
   <param name=SyncLoad value=true>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select1
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
   <PARAM NAME="DataID" VALUE="">
</OBJECT></comment> <script> __ws__(__NSID__);</script>   
<comment id="__NSID__"><OBJECT id=tr_2 
      classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
      <PARAM NAME="Action" VALUE="">
   <PARAM NAME="KeyName" VALUE="toinb_dataid4">
   <PARAM NAME="KeyValue" VALUE="JSP(I:h_unin_loan_master_2tr=ds_2)">
   <PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>   
<comment id="__NSID__"><OBJECT id=tr_3 
      classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
      <PARAM NAME="Action" VALUE="">
   <PARAM NAME="KeyName" VALUE="toinb_dataid4">
   <PARAM NAME="KeyValue" VALUE="JSP(I:h_unin_loan_master_3tr=ds_3)">
   <PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>   

   
<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
      style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 1010px; POSITION: absolute; TOP: 30px; HEIGHT: 358px" 
      classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
   <PARAM NAME="MultiRowSelect" VALUE="0">
   <PARAM NAME="DataID" VALUE="ds_1">
   <PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
   <PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="Editable" VALUE="0">
   <PARAM NAME="ColSizing" VALUE="-1">
   <PARAM NAME="Format" VALUE="
     <FC> Name='현장코드' ID=dept_code Align=Center HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=60  suppress=1 </C>
     <FC> Name='현장명'   ID=long_name  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=150  suppress=2  </C>
     <FC> Name='분양구분' ID=code_name Align=Center HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70   suppress=3 </C>
     <FC> Name='조합코드' ID=union_code Align=Center HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=60  </C>
     <FC> Name='조합명'   ID=union_name HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=120  </C>
     <C> Name='조합구분'   ID=union_div_code Align=Center EditStyle=Lookup Data='ds_select:select_1:select_2' HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70  </C>
     <C> Name='전화번호'   ID=phone HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=90  </C>
     <C> Name='조합원수'   ID=union_members HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=60  </C>
     <C> Name='주소'   ID=addr HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=330  </C>
     ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
      style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 504px; POSITION: absolute; TOP: 390px; HEIGHT: 260px" 
      classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
   <PARAM NAME="MultiRowSelect" VALUE="-1">
   <PARAM NAME="DataID" VALUE="ds_2">
   <PARAM NAME="AutoInsert" VALUE="-1">
   <param name="BorderStyle"         value=4>
   <PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="Editable" VALUE="-1">
   <PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
   <PARAM NAME="Format" VALUE="
     <FC> Name='차수'     ID=pay_degree Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=40 </C>
     <FC> Name='지급일자' ID=pay_date  Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70 </C>
     <C> Name='지급금액'  ID=pay_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90 
         SumText=@sum </C>
     <C> Name='대여항목' ID=pay_item  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=200 </C>
     <C> Name='비고'      ID=remark  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=300 </C>
     ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=gd_3 onfocus="get_focus(3)"
      style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 508px; WIDTH: 504px; POSITION: absolute; TOP: 390px; HEIGHT: 260px" 
      classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
   <PARAM NAME="MultiRowSelect" VALUE="-1">
   <PARAM NAME="DataID" VALUE="ds_3">
   <PARAM NAME="AutoInsert" VALUE="-1">
   <param name="BorderStyle"         value=4>
   <PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="Editable" VALUE="-1">
   <PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
   <PARAM NAME="Format" VALUE="
     <C> Name='회수' ID=degree_seq Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=40 </C>
     <C> Name='상환일자' ID=refund_date Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70 </C>
     <C> Name='상환금액' ID=refund_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90 
         SumText=@sum </C>
     <C> Name='비고' ID=remark BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=260 </C>
     ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=bd_data 
      style="Z-INDEX: 108; LEFT: 124px; WIDTH: 22px; POSITION: absolute; TOP: -37px; HEIGHT: 18px" 
      classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
   <PARAM NAME="DataID" VALUE="ds_1">
   <PARAM NAME="BindInfo" VALUE="
      <C>Col=union_code     Ctrl=tx_union_code    Param=value Enable=enable</C>
      <C>Col=union_name     Ctrl=tx_union_name    Param=value Enable=enable</C>
      <C>Col=zip_code       Ctrl=tx_zip_code      Param=value Enable=enable</C>
      <C>Col=addr1          Ctrl=tx_addr1         Param=value Enable=enable</C>
      <C>Col=addr2          Ctrl=tx_addr2         Param=value Enable=enable</C>
      <C>Col=phone          Ctrl=tx_phone         Param=value Enable=enable</C>
      <C>Col=fax            Ctrl=tx_fax           Param=value Enable=enable</C>
      <C>Col=union_members  Ctrl=em_union_members Param=text  Enable=enable</C>
      <C>Col=remark         Ctrl=tx_remark        Param=value Enable=enable</C>
   " >
   
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</BODY></HTML>



















