<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : h_unin_member_paymaster_1h.html 					-->
<!-- 2. 유형(시나리오): shared window 조회및 입력							-->
<!-- 3. 기 능 정 의   : 조합원대여금관리(분양)  	  						-->
<!-- 4. 변 경 이 력   : 김 동우 작성											-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :																-->
<!-- *************************************************************	-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
var gs_home = top.frames['security'].gs_home.value
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_sell_code = top.frames['security'].gs_sell_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var is_sell_name = top.frames['security'].gs_sell_name.value

var is_ds_1_addr = gs_home + '/general/h_web/07/h_unin_member_paymaster_1q.jsp?arg_dept_code='
var is_ds_2_addr = gs_home + '/general/h_web/07/h_unin_member_paymaster_2q.jsp?arg_dept_code='
var is_tr_2_addr = gs_home + '/general/h_web/07/h_unin_member_paymaster_2tr.jsp'                                 

var is_ds_3_addr = new Array(3)
is_ds_3_addr[1] = "h_unin_member_paymaster_3q.jsp?arg_dept_code=" 
is_ds_3_addr[2] = "h_unin_member_paymaster_4q.jsp?arg_dept_code=" 

var is_tr_3_addr = new Array(3)
is_tr_3_addr[1] = gs_home +  '/general/h_web/07/h_unin_member_paymaster_3tr.jsp'                                 
is_tr_3_addr[2] = gs_home +  '/general/h_web/07/h_unin_member_paymaster_4tr.jsp'                                 

var is_ds_4_addr = gs_home + '/general/h_web/07/h_unin_member_paymaster_5q.jsp?arg_dept_code='
var is_tr_4_addr = gs_home + '/general/h_web/07/h_unin_member_paymaster_5tr.jsp'                                 

var is_tab_addr_tr_keyvalue =  new Array(3)
is_tab_addr_tr_keyvalue[1] = 'JSP(I:h_unin_member_paymaster_3tr=ds_3)'         
is_tab_addr_tr_keyvalue[2] = 'JSP(I:h_unin_member_paymaster_4tr=ds_3)'         

var is_work_date 
var il_screen = 1,il_tagpage=1
var il_amt = 0, il_delay_days = 0, il_delay_amt = 0

var tr_fail=1                 // update정상:1  비정상:0
var ib_once = true

//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{	
	switch(il_screen) {
		case 1:
			ds_1.DataID = is_ds_1_addr + is_dept_code + "&arg_sell_code=" + is_sell_code 
			ds_1.SyncLoad=true
			ds_1.Reset()
			if (ds_1.CountRow < 1 ){
				ds_2.ClearData()
				ds_3.ClearData()
				ds_4.ClearData()
				return
			}
		//div_btnquery_onclick()
			break;
		case 2:
			div_btnquery_onclick()
			break;
		case 3:
			div_btnquery_onclick1()
			break;
		case 4:
			div_btnquery_onclick1()
			break;
			return
		case 5:
			div_btnquery_onclick2()
			break;
	}
}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{	
	var ls_union_code,ls_union_id,ls_union_seq
	
	if (ds_1.rowcount <  1){return};
	ls_union_code = ds_1.NameValue(ds_1.RowPosition,'union_code')
	ls_union_id   = ds_1.NameValue(ds_1.RowPosition,'union_id')
	ls_union_seq  = ds_1.NameValue(ds_1.RowPosition,'union_seq')
	
	ds_2.DataID = is_ds_2_addr + is_dept_code  + "&arg_sell_code=" + is_sell_code +
	              "&arg_union_code=" + ls_union_code + "&arg_union_id=" + ls_union_id +
	              "&arg_union_seq=" + ls_union_seq
	ds_2.SyncLoad=true
	ds_2.Reset()
	if (ds_2.CountRow < 1 ){
		ds_3.ClearData()
		ds_4.ClearData()
		return
	}
	
	//div_btnquery_onclick1()
}
//------------------------------------------------------------------------
function div_btnquery_onclick1()               // 대여금상환/이자상환 약정  
//------------------------------------------------------------------------
{  
	var ls_union_code,ls_union_id,ls_union_seq,ls_pay_degree
	
   if (ds_2.rowcount <  1){return};
	ls_union_code = ds_2.NameValue(ds_2.RowPosition,'union_code')
	ls_union_id   = ds_2.NameValue(ds_2.RowPosition,'union_id')
	ls_union_seq  = ds_2.NameValue(ds_2.RowPosition,'union_seq')
	ls_pay_degree = ds_2.NameValue(ds_2.RowPosition,'pay_degree')
	
	ds_3.DataID = is_ds_3_addr[il_tagpage] + is_dept_code  + "&arg_sell_code=" + is_sell_code +
	              "&arg_union_code=" + ls_union_code + "&arg_union_id=" + ls_union_id +
	              "&arg_union_seq=" + ls_union_seq + "&arg_pay_degree=" + ls_pay_degree
	ds_3.SyncLoad=true
	ds_3.Reset()
	if ( ds_3.CountRow < 1) {
		ds_4.ClearData()
		return
	}
	//if ( il_tagpage == 2 ) {
		//div_btnquery_onclick2()
	//}
}
//------------------------------------------------------------------------
function div_btnquery_onclick2()                     // 이자상환  
//------------------------------------------------------------------------
{
	var ls_union_code,ls_union_id,ls_union_seq,ls_pay_degree,ls_degree_code

   if (ds_3.rowcount <  1){return};
	ls_union_code  = ds_3.NameValue(ds_3.RowPosition,'union_code')
	ls_union_id    = ds_3.NameValue(ds_3.RowPosition,'union_id')
	ls_union_seq   = ds_3.NameValue(ds_3.RowPosition,'union_seq')
	ls_pay_degree  = ds_3.NameValue(ds_3.RowPosition,'pay_degree')
	ls_degree_code = ds_3.NameValue(ds_3.RowPosition,'degree_code')
	
	ds_4.DataID = is_ds_4_addr + is_dept_code  + "&arg_sell_code=" + is_sell_code +
	              "&arg_union_code=" + ls_union_code + "&arg_union_id=" + ls_union_id +
	              "&arg_union_seq=" + ls_union_seq + "&arg_pay_degree=" + ls_pay_degree +
	              "&arg_degree_code=" + ls_degree_code
	ds_4.SyncLoad=true
	ds_4.Reset()
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	if ( tb_1.ActiveIndex == 1 ) {
//		tab_page_1.Focus();
//		tab_page_1.SetColumn("phone");
	}
}
//-----------------------------------------------------------------------
function amt_com()   // 이자 납입예정금액 계산
//-----------------------------------------------------------------------
{
	il_amt        = 0
	il_delay_days = 0
	il_delay_amt  = 0
	
	ll_remain = ds_3.NameValue(ds_3.RowPosition,'agree_amt') - ds_4.Sum(10,0,0) + ds_4.NameValue(ds_4.RowPosition,'r_amt')

	il_amt = ll_remain
	
	return

// @@@@@@@@@@@@@@@@@@@  이하 부분은 사용 안함	@@@@@@@@@@@@@@@@@@@@@@@




	
	if (ds_3.NameValue(ds_3.RowPosition,'agree_date') >= ds_4.NameValue(ds_4.RowPosition,'receipt_date'))  {
		il_amt = ll_remain
		il_delay_days = 0
		il_delay_amt  = 0
		ds_4.NameValue(ds_4.RowPosition,'r_amt')    = il_amt 
		return
	}

	// 약정일자, 약정이자
	ls_start_date = ds_3.NameValue(ds_3.RowPosition,'agree_date')
	ll_agree_amt  = ds_3.NameValue(ds_3.RowPosition,'agree_amt') 

	// 납입일자
   ls_end_date = ds_4.NameValue(ds_4.RowPosition,'receipt_date')

	// 일수 계산
   ll_cnt = f_select_q("SELECT to_date('" + ls_end_date + "' , 'yyyy.mm.dd') - to_date('" + ls_start_date + "', 'yyyy.mm.dd') select_1 FROM  DUAL ")
	il_delay_days = parseInt(ds_select.NameValue(1,'select_1'))
	
	// 입금액계산
	ll_amt  = ds_2.NameValue(ds_2.RowPosition,'pay_amt')
	ll_rate = ds_2.NameValue(ds_2.RowPosition,'interest_rate') / 100

	il_delay_amt = parseInt(ll_amt * ll_rate / 365 * il_delay_days / 100) * 100

	il_amt = ll_agree_amt + il_delay_amt
	
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	var ll_seq
	
	if ( il_screen == 2 ) {
		ds_2.NameValue(ds_2.RowPosition,'dept_code')  = is_dept_code
		ds_2.NameValue(ds_2.RowPosition,'sell_code')  = is_sell_code
		ds_2.NameValue(ds_2.RowPosition,'union_code') = ds_1.NameValue(ds_1.RowPosition,'union_code')
		ds_2.NameValue(ds_2.RowPosition,'union_id')   = ds_1.NameValue(ds_1.RowPosition,'union_id')
		ds_2.NameValue(ds_2.RowPosition,'union_seq')  = ds_1.NameValue(ds_1.RowPosition,'union_seq')
		ll_seq = ds_2.Max(6,0,0)
		ds_2.NameValue(ds_2.RowPosition,'pay_degree')     = ll_seq + 1
		ds_2.NameValue(ds_2.RowPosition,'int_div')        = 'Y'   // Y:유이자,  N:무이자
		ds_2.NameValue(ds_2.RowPosition,'f_pay_yn')       = 'N'
		ds_2.NameValue(ds_2.RowPosition,'month_interest') = 0
		ds_2.NameValue(ds_2.RowPosition,'payer_tag')      = '1'   //1:고객납부, 2:회사대납, 3:회사채
		ds_2.NameValue(ds_2.RowPosition,'interest_rate')  = 0
		ds_2.NameValue(ds_2.RowPosition,'interest_day')   = 1
	}
	if (il_screen == 3 || il_screen == 4) {
		ds_3.NameValue(ds_3.RowPosition,'dept_code')  = is_dept_code
		ds_3.NameValue(ds_3.RowPosition,'sell_code')  = is_sell_code
		ds_3.NameValue(ds_3.RowPosition,'union_code') = ds_2.NameValue(ds_2.RowPosition,'union_code')
		ds_3.NameValue(ds_3.RowPosition,'union_id')   = ds_2.NameValue(ds_2.RowPosition,'union_id')
		ds_3.NameValue(ds_3.RowPosition,'union_seq')  = ds_2.NameValue(ds_2.RowPosition,'union_seq')
		ds_3.NameValue(ds_3.RowPosition,'pay_degree') = ds_2.NameValue(ds_2.RowPosition,'pay_degree')

		if (il_tagpage == 1) {
			if (ds_3.CountRow == 1) {
				ll_seq = 0
			}
			else  {
				ll_seq = ds_3.NameValue(2,'degree_seq')
			}
			
			ds_3.NameValue(ds_3.RowPosition,'degree_seq') = ll_seq + 1
			
		}
		else {
			if (ds_3.CountRow == 1) {
				ll_seq = 0
				ls_start_date = ds_2.NameValue(ds_2.RowPosition,'pay_date')
			}
			else  {
				ll_seq = ds_3.NameValue(2,'degree_code')
				ls_start_date = ds_3.NameValue(ds_3.RowPosition  + 1,'agree_date')
			}

			ds_3.NameValue(ds_3.RowPosition,'degree_code') = parseInt(ll_seq) + 1
			ds_3.NameValue(ds_3.RowPosition,'f_pay_yn') = 'N'

			// 약정일자 계산
			ll_yy = parseInt(ls_start_date.substr(0, 4))
			if (ls_start_date.substr(5, 1) == "0")
			 	ll_mm = parseInt(ls_start_date.substr(6, 1))
			else
			 	ll_mm = parseInt(ls_start_date.substr(5, 2))
			if (ll_mm > 11)  {
				ll_mm = 1
				ll_yy = ll_yy + 1
			}
			else  {
				ll_mm = ll_mm + 1
			}
			ll_dd = ds_2.NameValue(ds_2.RowPosition,'interest_day')  

			ls_end_date = ""  
			ls_end_date = ls_end_date + ll_yy + "."
	
			if (ll_mm < 10) 
				ls_end_date = ls_end_date + "0" + ll_mm + "."
			else
				ls_end_date = ls_end_date + ll_mm + "."
			if (ll_dd < 10) 
				ls_end_date = ls_end_date + "0" + ll_dd
			else
				ls_end_date = ls_end_date + ll_dd
				
			// 상환예정일을 초과 할 수 없다.
			if (ls_end_date >= ds_2.NameValue(ds_2.RowPosition,'repay_date'))
				ls_end_date = ds_2.NameValue(ds_2.RowPosition,'repay_date')
				
			ds_3.NameValue(ds_3.RowPosition,'agree_date') = ls_end_date

			// 일수 계산
		   ll_cnt = f_select_q("SELECT to_date('" + ls_end_date + "' , 'yyyy.mm.dd') - to_date('" + ls_start_date + "', 'yyyy.mm.dd') select_1 FROM  DUAL ")
			ll_day = parseInt(ds_select.NameValue(1,'select_1'))
			
			// 약정금액 계산
			ll_amt  = ds_2.NameValue(ds_2.RowPosition,'pay_amt')
			ll_rate = ds_2.NameValue(ds_2.RowPosition,'interest_rate') / 100

			amt = parseInt(ll_amt * ll_rate / 365 * ll_day / 100) * 100

			ds_3.NameValue(ds_3.RowPosition,'agree_amt') = amt
		}
	}
	if (il_screen == 5) {
		ds_4.NameValue(ds_4.RowPosition,'dept_code')  = is_dept_code
		ds_4.NameValue(ds_4.RowPosition,'sell_code')  = is_sell_code
		ds_4.NameValue(ds_4.RowPosition,'union_code') = ds_3.NameValue(ds_3.RowPosition,'union_code')
		ds_4.NameValue(ds_4.RowPosition,'union_id')   = ds_3.NameValue(ds_3.RowPosition,'union_id')
		ds_4.NameValue(ds_4.RowPosition,'union_seq')  = ds_3.NameValue(ds_3.RowPosition,'union_seq')
		ds_4.NameValue(ds_4.RowPosition,'pay_degree') = ds_3.NameValue(ds_3.RowPosition,'pay_degree')
		ds_4.NameValue(ds_4.RowPosition,'degree_code')= ds_3.NameValue(ds_3.RowPosition,'degree_code')
		ds_4.NameValue(ds_4.RowPosition,'receipt_date') = is_work_date
		ds_4.NameValue(ds_4.RowPosition,'delay_days')   = 0
		ds_4.NameValue(ds_4.RowPosition,'delay_amt')    = 0
		ds_4.NameValue(ds_4.RowPosition,'discount_days')  = 0
		ds_4.NameValue(ds_4.RowPosition,'discount_amt')   = 0

		if (ds_4.CountRow == 1) {
			ll_seq = 0
		}
		else  {
			ll_seq = ds_4.Max(8,0,0)
		}

		ds_4.NameValue(ds_4.RowPosition,'degree_seq') = ll_seq + 1
	}

	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
 	if (il_screen == 1) return
 	
	if ( il_screen == 2 ) {
		ds_2.InsertRow(1)
	}
	if ( il_screen == 3) {
		ds_3.InsertRow(1)
	}
	if ( il_screen == 4) {
		if (ds_2.NameValue(ds_2.RowPosition,'int_div') == 'N') {
			alert("무이자는 이자상환 입력을 할 수 없습니다")
			return
		}
		ds_3.InsertRow(1)
	}
	if ( il_screen == 5 ) {
		ds_4.InsertRow(1)
	}
	init_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	btnadd_onclick()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	
	if ( il_screen == 1 ) {
		return
	}
	if (il_screen == 2 ) {
		if (ds_3.CountRow > 0) {
			alert('하위의 자료가 존재 하므로 삭제할 수 없습니다...')
			return
		}
		ds_2.DeleteRow(ds_2.RowPosition)  
	}	
	if (il_screen == 3 || il_screen == 4 ) {
	     if (gd_4.MultiRowSelect){               // multi row select 일 경우
	         for (i=ds_3.CountRow ;i >0 ;i--){
	           if (ds_3.RowMark(i) == 1)
	                  ds_3.DeleteRow(i)
	         } 
		      if  (ds_3.RowPosition != 0)     
		       	ds_3.MarkRows(ds_3.RowPosition,ds_3.RowPosition)  //삭제작업완료후 MARK
	      }    
	}

	if (il_screen == 5 ) {
		// 납입총액을 계산하기 위하여 삭제전에 0으로 수정
		ds_4.NameValue(ds_4.RowPosition,"r_amt") = 0  
		ds_4.DeleteRow(ds_4.RowPosition)  
	}	
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	var ls_chk=0,ls_spec_chk=0

	if (ds_2.IsUpdated){
		 var ll_dup
		 ll_dup = f_dup_chk("ds_2","pay_degree")
		 if (ll_dup > 0) {
		     alert("지급차수가 중복되었습니다: 지급차수를 수정하십시요 ")
		     ds_2.RowPosition = ll_dup
		     gd_2.SetColumn("pay_degree")
		     return
		 }
  		for (i=ds_2.CountRow ;i >0 ;i--){
  			if (ds_2.NameValue(i,"pay_date") == '') {
				alert("지급일자를 입력하세요.")
				return
  			}  
  			if (ds_2.NameValue(i,"int_div") == 'Y' && ds_2.NameValue(i,"interest_rate") == 0) {
				alert("유이자는 이자율을 입력해야 됩니다.")
				return
  			}
  			if (ds_2.NameValue(i,"int_div") == 'N' && ds_2.NameValue(i,"interest_rate") != 0) {
				alert("무이자에 이자율이 입력되었습니다.")
				return
  			}  
  			if (ds_2.NameValue(i,"repay_date") == '') {
				alert("상환예정일을 입력하세요.")
				return
  			}  
  			if (ds_2.NameValue(i,"repay_date") <= ds_2.NameValue(i,"pay_date")) {
				alert("상환예정일이 지급일자 보다 커야 됩니다.")
				return
  			}  
  			if (ds_2.NameValue(i,"int_div") == 'N' && ds_2.NameValue(i,"payer_tag") == '1') {
				alert("무이자에 이자납부가 고객으로 입력되었습니다.")
				return
  			}  
  			if (ds_2.NameValue(i,"int_div") == 'N') {
  				ls_union_code = ds_2.NameValue(i,'union_code')
  				ls_union_id   = ds_2.NameValue(i,'union_id')
  				ls_union_seq  = ds_2.NameValue(i,'union_seq')
  				ls_pay_degree = ds_2.NameValue(i,'pay_degree')

			   ll_cnt = f_select_q("select count(*) select_1 from h_unin_intr_agree where dept_code = '" + is_dept_code + "' and sell_code = '" + is_sell_code + "' " +
								" and union_code = '" + ls_union_code + "' and union_id = '" + ls_union_id + "' and union_seq = '" + ls_union_seq + "' " + 
								" and pay_degree = '" + ls_pay_degree + "' "  )
				if (ll_cnt > 0) {
					if (parseInt(ds_select.NameValue(1,'select_1')) > 0)  {
						alert("이자상환 약정사항이 있으므로 무이자로 변경 할 수 없습니다.")
						return
					}
				}
  			}
  			
  		}
	} 	       
	if (ds_3.IsUpdated){
		 var ll_dup
		 if (il_tagpage == 1) {
			 ll_dup = f_dup_chk("ds_3","degree_seq")
			 if (ll_dup > 0) {
			     alert("회수가 중복되었습니다: 회수를 수정하십시요 ")
			     ds_3.RowPosition = ll_dup
			     gd_3.SetColumn("degree_seq")
			     return
			 }
		 }
		 if (il_tagpage == 2) {
			 ll_dup = f_dup_chk("ds_3","degree_code")
			 if (ll_dup > 0) {
			     alert("약정차수가  중복되었습니다: 약정차수를 수정하십시요 ")
			     ds_3.RowPosition = ll_dup
			     gd_4.SetColumn("degree_code")
			     return
			 }
	  		for (i=ds_3.CountRow ;i >0 ;i--){
				if (ds_3.NameValue(i,"agree_date") == "")  {
					alert("약정일자를 입력하세요")
					return
				}
	  		}
		 }
	} 	       
	if (ds_4.IsUpdated){
		 var ll_dup
		 ll_dup = f_dup_chk("ds_4","degree_seq")
		 if (ll_dup > 0) {
		     alert("회수가 중복되었습니다: 회수를 수정하십시요 ")
		     ds_4.RowPosition = ll_dup
		     gd_5.SetColumn("degree_seq")
		     return
		 }
	} 	       

	if (ds_2.IsUpdated || ds_3.IsUpdated || ds_4.IsUpdated ){
		if  (confirm("변경되었습니다 저장하시겠습니까?")){
			if (ds_2.IsUpdated ) {
       		tr_2.Post()
       	}
			if (ds_3.IsUpdated ) {
			 	tr_3.Action   = is_tr_3_addr[il_tagpage]
			 	tr_3.KeyValue = is_tab_addr_tr_keyvalue[il_tagpage]

     			tr_3.Post()
			}
			if (ds_4.IsUpdated ) {
				tr_4.Post()
			}
		}
	}
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function interest_agree_comp()                   // 이자상환 약정 생성
//---------------------------------------------------------------------------- 
{

	if (tb_1.ActiveIndex != 2) {
		alert("이자상환 화면에서 이자상환 약정을 처리하세요")
		return
	}

	if (il_screen == 3) 
		il_screen = 4
		
	if (il_screen != 4) {
		alert("이자상환 약정사항 화면을 클릭 한 후 처리하세요")
		alert(il_screen)
		return
	}

	btnsave_onclick()   /// 수정 자료는 저장후 처리한다.
	
	for (i=ds_3.CountRow ;i >0 ;i--){

		// 이자 입금이 없는 약정은 삭제한다.
		ls_union_code = ds_3.NameValue(i,"union_code")
		ls_union_id   = ds_3.NameValue(i,"union_id")
		ls_union_seq  = ds_3.NameValue(i,"union_seq")
		ls_pay_degree = ds_3.NameValue(i,"pay_degree")
		
	   ll_cnt = f_select_q("select count(*) select_1 from h_unin_intr_agree where dept_code = '" + is_dept_code + "' and sell_code = '" + is_sell_code + "' " +
						" and union_code = '" + ls_union_code + "' and union_id = '" + ls_union_id + "' and union_seq = '" + ls_union_seq + "' " + 
						" and pay_degree = '" + ls_pay_degree + "' "  )
		if (ll_cnt > 0) {
			continue
		}

		ds_3.DeleteRow(i)  
		
	}

	// 약정차수를 만들어준다.
	while (1)  {
		if (ds_3.NameValue(1,'agree_date') >= ds_2.NameValue(ds_2.RowPosition,'repay_date'))  {
			alert("처리 완료")
			break
		}
		
		btnadd_onclick()   // 이자 상환 약정을 만들어준다.
		
	}

	btnsave_onclick() 
	
}
//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기(분양) 
//---------------------------------------------------------------------------
{
	result = f_hdept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	is_sell_code = top.frames['security'].gs_sell_code.value
	is_sell_name = top.frames['security'].gs_sell_name.value

	dept_name.value = is_dept_name
	sell_name.value = is_sell_name

	btnquery_onclick()
}   
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	        {  //저장 routine
	        }   
 
	   }     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

	// top.frames['main_ct'].window.close()     
}
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//----------------------------------------------------------------
function excel_down()                      //엑셀자료 내리기(공종별) 
//----------------------------------------------------------------
{
 var temp_1
 temp_1 = is_dept_name + '   [' + em_select_yymm.text + ']'
 gd_1.RunExcelSheet(temp_1)
   
}

//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{	
	if (focus == il_screen) {
		return
	}	
	il_screen = focus
}

//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
	top.frames['main_title'].mouse_over()
   tr_2.Action = is_tr_2_addr 
   tr_4.Action = is_tr_4_addr 

	dept_name.value = is_dept_name
	sell_name.value = is_sell_name

	is_work_date = f_sysdate()

	btnquery_onclick()
	tb_1.ActiveIndex = 1
	il_screen = 1
}
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
	if  (row < 1) return;

	if ( ds_2.IsUpdated || ds_3.IsUpdated || ds_4.IsUpdated)
		btnsave_onclick()
	div_btnquery_onclick()  
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_2>
	if  (row < 1) return;
	
	if (ds_3.IsUpdated || ds_4.IsUpdated)
		btnsave_onclick()
	
	div_btnquery_onclick1()  
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_3>
	if  (row < 1) return;
	if (ds_4.IsUpdated)
		btnsave_onclick()

	if (il_tagpage == 2){
		div_btnquery_onclick2()  
	}
</SCRIPT>
<SCRIPT language=JavaScript event=OnSelChanged(index) for=tb_1>
	il_tagpage =  index
	il_screen = 3
	if (ib_once == false){
      div_btnquery_onclick1()
	}
	else{
	    ib_once = false
   };
</SCRIPT>


<SCRIPT language=JavaScript event=CanSelChange(nIndex) for=tb_1>
  btnsave_onclick()
  if (tr_fail == 0) {
     tr_fail=1 
     return false
   }  
  ol_nindex = nIndex
  il_nindex = nIndex

</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnColumnChanged(row,colid)>
	var ld_amt
	if (colid == "refund_amt" ) {
		ds_2.NameValue(ds_2.RowPosition,"tot_amt") = ds_3.Sum(9,0,0)
		ld_amt = ds_2.NameValue(ds_2.RowPosition,'pay_amt')
		if (ld_amt <= ds_3.sum(9,0,0)) {
			ds_2.NameValue(ds_2.RowPosition,'f_pay_yn') = 'Y'
		}
		else {
			ds_2.NameValue(ds_2.RowPosition,'f_pay_yn') = 'N'
		}
	}   
</SCRIPT>
<SCRIPT language=JavaScript for=ds_4 event=OnColumnChanged(row,colid)>
	var ld_amt
	if (colid == "receipt_date" ) {
		amt_com()   // 납입예정금액 계산
		ds_4.NameValue(ds_4.RowPosition,'r_amt') = il_amt
	}
		
	if (colid == "r_amt" ) {
		ds_3.NameValue(ds_3.RowPosition,"tot_amt") = ds_4.Sum(10,0,0)
		if (ds_3.NameValue(ds_3.RowPosition,"agree_amt") <= ds_4.sum(10,0,0)) {
			ds_3.NameValue(ds_3.RowPosition,'f_pay_yn') = 'Y'
		}
		else {
			ds_3.NameValue(ds_3.RowPosition,'f_pay_yn') = 'N'
		}
	}   
</SCRIPT>

</HEAD>

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
	alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
	alert("Error Code : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
	alert("Error Code : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_4 event=OnLoadError()>
	alert("Error Code : " + ds_4.ErrorCode + "\n" + "Error Message : " + ds_4.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
	alert("Error Code : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
	  tr_fail=0
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
	alert("Error Code : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_4 event=OnFail()>
	alert("Error Code : " + tr_4.ErrorCode + "\n" + "Error Message : " + tr_4.ErrorMsg + "\n");
</SCRIPT>

<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>
<comment id="__NSID__"><OBJECT id=ds_1 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	<param name=SyncLoad	value=true>
	 <param name=SortExpr       value="+union_id+union_seq">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	<param name=SyncLoad	value=true>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	<param name=SyncLoad	value=true>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_4 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	<param name=SyncLoad	value=true>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT></comment> <script> __ws__(__NSID__);</script>	
<comment id="__NSID__"><OBJECT id=ds_update
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_2 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:h_unin_member_paymaster_2tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	
<comment id="__NSID__"><OBJECT id=tr_3 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:h_unin_member_paymaster_3tr=ds_3)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	
<comment id="__NSID__"><OBJECT id=tr_4 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:h_unin_member_paymaster_5tr=ds_4)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	

<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 2px; WIDTH: 430px; POSITION: absolute; TOP: 1px; HEIGHT: 25px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td WIDTH='10%'  BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="right">현장명</div></td>
             <td WIDTH='50%'>
						<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" size=25 onkeyDown="keyDown()" style=" FONT-SIZE: 12px">
						<input type="button_query" value=" 검색" 
					        style="color:#2E4A4A; font-size:13px;  CURSOR: hand; width=40px;
					        background-color:#E9F5F5; border:1 #A1A9A9 solid; height:20px"   
					        onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
					        onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
					        "  onclick=dept_code_find()>
             <td WIDTH='13%'   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
                 <div align="right">분양구분</div></td>
             <td WIDTH='27%'>
						<INPUT id=sell_name SIZE=15  style=" FONT-SIZE: 12px" READONLY DISABLED></td>
      </table>
</DIV>      
<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 435px; WIDTH: 320px; POSITION: absolute; TOP: 1px; HEIGHT: 25px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td WIDTH='10%'  BGCOLOR="WHITE" style="COLOR: BLACK"> 
                 <div align="CENTER">차수==>1:은행 유이자, 2:은행 무이자, 3:고객 유이자</div></td>
         </tr>
      </table>
</DIV>      

<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 800px; WIDTH:50px; POSITION: absolute; TOP: 5px; HEIGHT: 25px;FONT-SIZE: 12px" >
	<input type="button_query" value=" 이자상환약정" 
        style="color:#2E4A4A; font-size:13px;  CURSOR: hand; width=90px;
        background-color:#E9F5F5; border:1 #A1A9A9 solid; height:20px"   
        onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
        onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
        "  onclick=interest_agree_comp()>
</DIV>      
	
<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
    	style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 410px; POSITION: absolute; TOP: 30px; HEIGHT: 100%" 
    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="0">
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="0">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="Format" VALUE="
	  <C> Name='조합명' ID=union_name HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=80  suppress=1 </C>
	  <C> Name='조합원ID' ID=union_id Align=Center HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=56  suppress=2 </C>
	  <C> Name='고객번호' ID=t_cust_code Align=Center HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=90  </C>
	  <C> Name='고객명' ID=cust_name Align=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70  </C>
	  <C> Name='계약일자' ID=contract_date  Align=Center HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=75  </C>
	  ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
    	style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 415px; WIDTH: 598px; POSITION: absolute; TOP: 30px; HEIGHT: 250px" 
    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="0">
	<PARAM NAME="DataID" VALUE="ds_2">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
   <param name="ViewSummary"    value=1>
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="Format" VALUE="
	  <FC> Name='차수' ID=pay_degree Align=Center HeadAlign=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=30 </C>
	  <FC> Name='지급일자' ID=pay_date Align=Center HeadAlign=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=70 </C>
	  <FC> Name='지급액' ID=pay_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90 
	  		SumText=@sum </C>
	  <C> Name='구분' ID=int_div Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=45
	  		EditStyle=Combo Data='Y:유이자,N:무이자'</C>
	  <C> Name='이자납부' ID=payer_tag Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60
	  		EditStyle=Combo Data='1:고객,2:회사대납,3:회사채'</C>
	  <C> Name='이율' ID=interest_rate Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=50 </C>
	  <C> Name='상환예정일' ID=repay_date Align=Center HeadAlign=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=70 </C>
	  <C> Name='이자납부일' ID=interest_day Align=Center HeadAlign=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=65  </C>
	  <C> Name='입금합계' ID=tot_amt Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90 
	  		SumText=@sum </C>
	  <C> Name='입금완료' ID=f_pay_yn Edit=None Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=55
	  		EditStyle=Combo Data='Y:완납,N:미납 '</C>
	  <C> Name='은행명' ID=bank_name Align=Center HeadAlign=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=150 </C>
	  ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tb_1 
    style="FONT-SIZE: 12px; Z-INDEX: 200; LEFT: 415px; WIDTH: 598px; POSITION: absolute; TOP: 290px; HEIGHT: 20px" 
    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
  <param name="BackColor"  value="#BBE0F4">
  <param name="TextColor"  value="BLACK">
  <PARAM NAME="Format" VALUE="
    <T>divid=tab_page_1 title=대여금상환</T>
    <T>divid=tab_page_2 title=이자상환</T>
    ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<DIV id=tab_page_1
      style="LEFT: 415px; WIDTH: 598px; POSITION: absolute; TOP: 310px; HEIGHT: 50%; BACKGROUND-COLOR: #FFFFFF">
<comment id="__NSID__"><OBJECT id=gd_3 onfocus="get_focus(3)"
    	style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 0px; WIDTH: 598px; POSITION: absolute; TOP: 0px; HEIGHT: 100%" 
    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="DataID" VALUE="ds_3">
	<PARAM NAME="AutoInsert" VALUE="-1">
	<param name="BorderStyle"         value=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
	<PARAM NAME="Format" VALUE="
	  <C> Name='회수'     ID=degree_seq Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=60 </C>
	  <C> Name='상환일자' ID=return_date Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=90 </C>
	  <C> Name='상환금액' ID=refund_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90 
	  		SumText=@sum </C>
	  <C> Name='' ID=comp_space BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=310 </C>
	  ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</DIV>
<DIV id=tab_page_2
      style="LEFT: 415px; WIDTH: 598px; POSITION: absolute; TOP: 310px; HEIGHT: 50%; BACKGROUND-COLOR: #FFFFFF">
<comment id="__NSID__"><OBJECT id=gd_4 onfocus="get_focus(4)"
    	style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 0px; WIDTH: 598px; POSITION: absolute; TOP: 0px; HEIGHT: 170px" 
    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="DataID" VALUE="ds_3">
	<PARAM NAME="AutoInsert" VALUE="-1">
	<param name="BorderStyle"         value=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
	<PARAM NAME="Format" VALUE="
	  <C> Name='약정차수' ID=degree_code Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70 </C>
	  <C> Name='약정일자' ID=agree_date Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=100 </C>
	  <C> Name='약정금액' ID=agree_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=100 
	  		SumText=@sum </C>
	  <C> Name='입금합계' ID=tot_amt Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=100 
	  		SumText=@sum </C>
	  <C> Name='입금완료' ID=f_pay_yn Edit=None Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90
	  		EditStyle=Combo Data='Y:완납,N:미납 '</C>
	  <C> Name='비고' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=90 </C>
	  ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=gd_5 onfocus="get_focus(5)"
    	style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 0px; WIDTH: 598px; POSITION: absolute; TOP: 172px; HEIGHT: 45%" 
    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="DataID" VALUE="ds_4">
	<PARAM NAME="AutoInsert" VALUE="-1">
	<param name="BorderStyle"         value=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
	<PARAM NAME="Format" VALUE="
	  <C> Name='회수' ID=degree_seq Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=60 </C>
	  <C> Name='납입일자' ID=receipt_date Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=100 </C>
	  <C> Name='납입금액' ID=r_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=120
	  		SumText=@sum </C>
	  <C> Name='비고' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=270 </C>
	  ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</DIV>

</OBJECT>
</BODY></HTML>



















