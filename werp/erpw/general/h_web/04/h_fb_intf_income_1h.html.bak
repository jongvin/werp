<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : h_batch_loan_interest_1h.html							-->
<!-- 2. 유형(시나리오): window 조회및 입력									-->
<!-- 3. 기 능 정 의   : 대출이자 대납내역 일괄처리		  	  							-->
<!-- 4. 변 경 이 력   : 임종빈 작성											-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :																-->
<!-- *************************************************************	-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 

<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_sell_code = top.frames['security'].gs_sell_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var is_sell_name = top.frames['security'].gs_sell_name.value

var is_ds_1_addr = gs_home + '/general/h_web/04/h_fb_intf_income_n_1q.jsp'
var is_ds_2_addr = gs_home + '/general/h_web/04/h_fb_intf_income_y_1q.jsp?arg_from='
var is_tr_1_addr = gs_home +    '/general/h_web/04/h_fb_intf_income_1tr.jsp'
var is_work_date
var is_from_date = ""
var is_to_date   = ""
var is_sort = ""
var is_yn = ''
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	if ( f_check_date(em_from_date.text) == false ) {
  		alert("기간을 정확히 입력해 주십시오.")
  		return
   }
   if ( f_check_date(em_to_date.text) == false ) {
  		alert("기간을 정확히 입력해 주십시오.")
  		return
   }
	select_from()
	select_to()

   if( is_yn =='N') {
		ds_1.DataID = is_ds_1_addr 
	}
	else if( is_yn == 'Y'){
	   ds_1.DataID = is_ds_2_addr + is_from_date + '&arg_to=' + is_to_date 
	}
	
   ds_1.SyncLoad=true
	ds_1.Reset()
	

}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("dong");
} 
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
	ds_1.NameValue(ds_1.RowPosition,"sell_code") = is_sell_code
	ds_1.namevalue(ds_1.RowPosition, 'receipt_date') =is_work_date
	
	ds_1.namevalue(ds_1.RowPosition, 'process') = 'N'
	//Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
   
    ds_1.AddRow()
	 init_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
    ds_1.InsertRow(ds_1.RowPosition)
	 init_move()
}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
   
  if  (gd_1.MultiRowSelect){               // multi row select 일 경우
     for (i=ds_1.CountRow ;i >0 ;i--)
     {
        if (ds_1.RowMark(i) == 1)
               ds_1.DeleteRow(i)
      }  
   if  (ds_1.RowPosition != 0)          
       ds_1.MarkRows(ds_1.RowPosition,ds_1.RowPosition)  //삭제작업완료후 MARK
    }
  else
     ds_1.DeleteRow(ds_1.RowPosition)  
 }

//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
var ls_temp
	if (ds_1.IsUpdated){
	   if  (confirm("변경되었습니다 저장하시겠습니까?")){
		    tr_1.Post()
	   }
   } 
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	   if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	       {  //저장 routine
	       }   
 
}     
top.frames['main_ct'].location.href(ls_arg)
top.frames['main_title'].div_r.style.visibility="hidden"             
top.frames['main_title'].div_u.style.visibility="hidden"             

// top.frames['main_ct'].window.close()     
}

//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기(분양) 
//---------------------------------------------------------------------------
{
	//result = f_hdept_code_find(dept_name.value)
	//if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	is_sell_code = top.frames['security'].gs_sell_code.value
	is_sell_name = top.frames['security'].gs_sell_name.value

	//dept_name.value = is_dept_name
	//sell_name.value = is_sell_name

	btnquery_onclick()
}   
//-------------------------------------------------------------------------------
function select_from()                  //시작일 선택 
//-------------------------------------------------------------------------------
{
   is_from_date = em_from_date.text.substr(0,4) + "." + em_from_date.text.substr(4,2)  + "." +  em_from_date.text.substr(6,2)
}
//-------------------------------------------------------------------------------
function select_to()                  //종료일 선택 
//--------------------------------------------------------------------------------
{
   is_to_date = em_to_date.text.substr(0,4) + "." + em_to_date.text.substr(4,2)  + "." +  em_to_date.text.substr(6,2)
} 
//---------------------------------------------------------------------------
function apply_income(as_work_tag) 
//---------------------------------------------------------------------------
{	 result = window.showModalDialog("h_fb_intf_income_apply_pop_1h.html", '' ,"dialogWidth:400px;dialogHeight:200px;status=no");

	if (result == 'CANCEL') {
		return;
	}

	if (result =='SMS'){
	   ls_sms_yn = 'Y';
   }
   else {
      ls_sms_yn = 'N';
	}

	var once= true
	var work_seq

	//btnsave_onclick()

	for (i=1  ;i <ds_1.CountRow+1 ;i++){
		if ( ds_1.namevalue( i, 'chk') == 'T'){
		   if (once) {
			   once= false
			   ll_cnt = f_select2_q(" select h_fb_intf_income_work_seq.nextval select_1  from dual ")       //계좌번호	
				if (  ll_cnt  != 1 ) {
				   alert('작업번호 가져오기실패')
					return;
			   }
				work_seq = ds_select2.namevalue(1, 'select_1')
				
			}
			ds_1.namevalue( i, 'work_seq') = work_seq;


		   /*ls_fb_seq = ds_1.namevalue(i, 'fb_seq')
			ds_spcall.DataID = 'h_fb_intf_income_procedure.jsp?arg_fb_seq=' + ls_fb_seq
			//alert(ds_spcall.DataID)
			ds_spcall.SyncLoad = true
			ds_spcall.reset()*/
			
		}
	}
   tr_1.Post()
	
	ds_spcall.DataID = 'h_fb_intf_batch_procedure.jsp?arg_work_seq=' + work_seq+
																																  '&arg_work_tag=' +as_work_tag+
																																  '&arg_sms_yn='   +ls_sms_yn
	
   
	 
	//alert(ds_spcall.DataID)
	ds_spcall.SyncLoad = true
	ds_spcall.reset()

	
	btnquery_onclick()		
	
}
//---------------------------------------------------------------------------
function rd_select(value)                      // 처리구분
//---------------------------------------------------------------------------
{	if( value=='1') {
		is_yn = 'N'
		hdept_page_1.style.visibility = 'hidden'
		gd_1.ColumnProp('error_code','Show')=true
		gd_1.ColumnProp('error_msg','Show')=true
		
	}
	else if( value == '2'){
	   is_yn = 'Y'
		hdept_page_1.style.visibility = 'visible'
		gd_1.ColumnProp('error_code','Show')=false
		gd_1.ColumnProp('error_msg','Show')=false
		
	}
   
   btnquery_onclick()	
}
//----------
function sel_all()
//-----------
{ var i
   gd_1.ReDraw = false
	for (i=1  ;i <ds_1.CountRow+1 ;i++){
		if ( !(ds_1.namevalue(i,'apply_ok') == 'Y')){
			ds_1.namevalue(i, 'chk') = 'T'
		}
	}
	gd_1.ReDraw = true
}
//----------
function sel_none()
//-----------
{ var i
   gd_1.ReDraw = false
	for (i=1  ;i <ds_1.CountRow+1 ;i++){
		
			ds_1.namevalue(i, 'chk') = 'F'
		
	}
	gd_1.ReDraw = true
}
//---------------------------------------------------------------------------
function dept_code_find_popup()                       //현장 찾기(분양) 
//---------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	var gs_home1 = top.frames['security'].gs_home.value
	var is_dept_search_addr = gs_home1 + '/general/h_web/00/h_code_house_find_1h.html'

	result = window.showModalDialog(is_dept_search_addr,gs_home1 + "@" + ds_1.Namevalue(ds_1.Rowposition, 'long_name'),"dialogWidth:500px;dialogHeight:500px");
	ib_check = false
	if(result == "") {
		ds_1.Namevalue(ds_1.Rowposition, 'long_name') = is_dept_name
	   ds_1.Namevalue(ds_1.Rowposition, 'dept_code') = is_dept_code
	   ib_check = true
		return
	}
	array = result.split("@");
	
	ds_1.Namevalue(ds_1.Rowposition, 'dept_code') = array[0]
	ds_1.Namevalue(ds_1.Rowposition, 'long_name') = array[1]
	ds_1.Namevalue(ds_1.Rowposition, 'sell_code') = array[2]
	ds_1.Namevalue(ds_1.Rowposition, 'sell_name') = array[3]
	ds_1.NameValue(ds_1.RowPosition, 'dongho')     = ""
	ds_1.NameValue(ds_1.RowPosition, 'seq')        = ""
	is_dept_code = array[0]
	is_dept_name = array[1]
	ib_check = true
}
//-----------------------------------------------------------------------
function cont_dongho_find()               // 계약동호찾기
//-----------------------------------------------------------------------
{
	var result,arg;
	var array = new Array();
	
	ls_dept_code = ds_1.Namevalue(ds_1.Rowposition, 'dept_code')
	ls_sell_code  =  ds_1.Namevalue(ds_1.Rowposition, 'sell_code')

	if ( ! ls_dept_code.length > 0 || ! ls_sell_code.length > 0) {
	   alert('먼저 현장을 선택하세요');
		return;
   }

	arg = gs_home + '@' + ls_dept_code + '@' + ls_sell_code 
	result = window.showModalDialog(gs_home + "/general/h_web/03/h_contract_find_1h.html", arg,"dialogWidth:685px;dialogHeight:500px");
	
	if (result == "") {
	   return;
   }
	array = result.split("@");

	ds_1.NameValue(ds_1.RowPosition,"dongho") = array[0]
	ds_1.NameValue(ds_1.RowPosition,'seq') = array[1]
	ds_1.NameValue(ds_1.RowPosition,'cust_name') = array[2]
}

//-----------------------------------------------------------------------
function cust_name_find()               // 계약동호찾기
//-----------------------------------------------------------------------
{
	var result,arg;
	var array = new Array();
	
	//ls_dept_code = ds_1.Namevalue(ds_1.Rowposition, 'dept_code')
	//ls_sell_code  =  ds_1.Namevalue(ds_1.Rowposition, 'sell_code')
	ls_cust_name = ds_1.Namevalue(ds_1.Rowposition, 'fb_account_name')
	ls_work_date = ds_1.Namevalue(ds_1.Rowposition, 'fb_recv_date')

	/*if ( ! ls_dept_code.length > 0 || ! ls_sell_code.length > 0) {
	   alert('먼저 현장을 선택하세요');
		return;
   }	*/

	arg = gs_home + '@' + ls_cust_name + '@' + ls_work_date 
	result = window.showModalDialog(gs_home + "/general/h_web/04/h_fb_intf_cust_find_1h.html", arg,"dialogWidth:685px;dialogHeight:500px");
	
	if (result == "") {
	   return;
   }
	array = result.split("@");
	ds_1.Namevalue(ds_1.Rowposition, 'dept_code') = array[0]
	ds_1.Namevalue(ds_1.Rowposition, 'long_name') = array[1]
	ds_1.Namevalue(ds_1.Rowposition, 'sell_code') = array[2]
	ds_1.Namevalue(ds_1.Rowposition, 'sell_name') = array[3]
	ds_1.NameValue(ds_1.RowPosition,"dongho") = array[4]
	ds_1.NameValue(ds_1.RowPosition,'seq') = array[5]
	ds_1.NameValue(ds_1.RowPosition,'cust_name') = array[6]
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
	tr_1.Action = is_tr_1_addr

	is_work_date = f_sysdate()

	is_from_date = is_work_date
   is_to_date      = is_work_date
	
	em_from_date.text = is_from_date
	em_to_date.text      = is_from_date
	
	//dept_name.value = is_dept_name
	//sell_name.value = is_sell_name
	
	rd_select('1')
	//btnquery_onclick()
	
}
</SCRIPT>
  
</script>
 <script language=JavaScript for=ds_1 event=onFilter(row)>
   
	if (is_yn == 'Y') {
	   if (ds_1.namevalue(row, 'apply_ok') == 'Y') 
		   return true;
	    else 
		   return false;
   }
   else if(is_yn =='N'){
	   if (!(ds_1.namevalue(row, 'apply_ok') == 'Y') )
		   return true;
	    else 
		   return false;
   }
	

</script>

<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>
	
	if (ds_1.NameValue(row,'prgss_status') == 'N') {
		if (colid == 'cancel_yn') {
			if (ds_1.NameValue(row,'cancel_yn') == '0') {
				ds_1.NameValue(row,'process_yn') = 'T'
			}
			else {
				ds_1.NameValue(row,'process_yn') = 'F'
			}
		}			
	}
	else {
		if (colid == 'cancel_yn') {
			if (ds_1.NameValue(row,'cancel_yn') != ds_1.OrgNameValue(row,'cancel_yn')) {
				alert('이미처리된자료는 수정할 수 없습니다...')
				ds_1.NameValue(row,'cancel_yn') = ds_1.OrgNameValue(row,'cancel_yn')
			}
		}
	}
</script>
<script language=JavaScript for=Button_file event=OnClick()>
	
	tx_temp.Src = Button_file.value           
	tx_temp.reset()
	
	//ds_1.DataID = is_ds_1_addr
	//ds_1.SyncLoad=true
	//ds_1.reset()
	ds_1.ImportData(tx_temp.Text)
	//ds_1.ResetStatus()
	
	import_rtn()
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_1.RowPosition == ds_1.CountRow)  
        btnadd_onclick()
    else     
        ds_1.RowPosition++
}
</SCRIPT>

<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>
  if (colid != 'process'){
	ds_1.namevalue(ds_1.rowposition, 'process') = 'N';
  }
</SCRIPT>
<script language=JavaScript for=gd_1 event=onClick(row,colid)>
   if (row == 0) {
  		if (is_sort == "+" + colid)
   	  ds_1.SortExpr = "-" + colid;
  	   else
   	  ds_1.SortExpr = "+" + colid;
   	  
  	  is_sort = ds_1.SortExpr;
  	  ds_1.Sort();
  }
  else if (colid == 'chk'){
              
              if (ds_1.namevalue(row, 'chk') == 'T'){
					  ds_1.namevalue(row, 'chk') = 'F'
				  }
				  else{ 
				     if ( !(ds_1.namevalue(row,'apply_ok') == 'Y')){
				         ds_1.namevalue(row, 'chk') = 'T'
					   }
						else{
							alert('이미처리된 자료입니다')
						}
				  }
	}
</script>
<SCRIPT language="javascript" for=gd_1 event=OnPopup(row,colid,data)>
 if (colid == "long_name") {
    cust_name_find()
 }
 if (colid == "dongho") { 
    //cont_dongho_find()
	 cust_name_find()
 }
 
</SCRIPT>
<script language=JavaScript for=gd_1 event=OnColumnPosChanged(row,colid)>
  if ( colid == 'deposit_no') {
      ls_dept_code = ds_1.namevalue(row, 'dept_code')
      ls_sell_code = ds_1.namevalue(row, 'sell_code')
		ll_cnt = f_select1_q("select print_deposit_no select_1, print_deposit_no select_2  from h_code_deposit  where dept_code = '" + ls_dept_code + "' and sell_code = '" + ls_sell_code + "' order by print_deposit_no ")       //계좌번호	
  }
</script>


</HEAD>
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("Error Code : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code(ds_spcall) : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
</SCRIPT>

<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT>
<Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT>
<Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT>
<OBJECT id=ds_1 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	 <param name=UseFilter       value=true>
</OBJECT>
<OBJECT id=ds_2 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT>	
<OBJECT id=tr_1 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   <PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:h_fb_intf_income_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1">
</OBJECT>	
<div name=rd_div style="LEFT: 10px; POSITION: absolute; TOP: 7px;  height:17px"   >
<input type="radio" value="1" name="rd_prog" onclick=rd_select(value) checked>미처리
<input type="radio" value="2" name="rd_prog" onclick=rd_select(value) >처리(일자별)
</div>
<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 200px; WIDTH: 350px; POSITION: absolute; TOP: 1px; HEIGHT: 20px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <!-- <tr BGCOLOR="white" > 
			    <td WIDTH='6%'  BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="right">현장명</div></td>
             <td WIDTH='21%'>
						<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" size=25 onkeyDown="keyDown()" style=" FONT-SIZE: 12px">
						<input id=find_btn type="button_query" value=" 검색" 
					        style="color:#2E4A4A; font-size:13px;  CURSOR: hand; width=40px;
					        background-color:#E9F5F5; border:1 #A1A9A9 solid; height:20px"   
					        onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
					        onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
					        "  onclick=dept_code_find()>
             <td WIDTH='6%'   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
                 <div align="right">분양구분</div></td>
             <td WIDTH='5%'>
						<INPUT id=sell_name SIZE=15  style=" FONT-SIZE: 12px" READONLY DISABLED></td> -->
				 <td WIDTH='5%'   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
                 <div align="right">기간</div></td>
             <td WIDTH='25%'>
             	  <OBJECT id=em_from_date 
                       style="WIDTH: 100px";
				           classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=Format value="####-##-##"> 
                       <param name=Alignment      value=1>
                       <param name=SelectAll       value=true>
	                    <param name=Numeric        value=false>
	            </OBJECT>
	            <img src="../../../image/icon/calender_on.gif"  id=img_fr OnClick="var result = gn_Cal_Yyyymmdd(); 
								if(!is_null(result)){ em_from_date.text = result.substr(0,8);} ; select_from()">
	            <object id=em_middle classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F
	                    width=7px>
							  <param name=Text    value="~">
							  <param name=Numeric value=false>
							  <param name=Border  value=false>
               </object>
					<OBJECT id=em_to_date
                       style="WIDTH: 100px"
				           classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=Format value="####-##-##"> 
                       <param name=Alignment      value=1>
                       <param name=SelectAll       value=true>
	                    <param name=Numeric        value=false>
	            </OBJECT>
	            <img src="../../../image/icon/calender_on.gif"  id=img_to OnClick="var result = gn_Cal_Yyyymmdd(); 
								if(!is_null(result)){ em_to_date.text = result.substr(0,8);} ; select_to()">
				 </td>
         </tr>                 
      </table>
</DIV> 
<DIV id=btn_sel  style="Z-INDEX: 107; LEFT:550px; WIDTH: 300px; POSITION: absolute; TOP: 5px; HEIGHT: 20px">
	<input  id=sel_all  type=button  value='전체선택' onclick=sel_all() >
	<input  id=sel_none  type=button  value='전체해제' onclick=sel_none() >									  
</DIV>
<DIV id=gd_2_button 
style="Z-INDEX: 107; LEFT:800px; WIDTH: 180px; POSITION: absolute; TOP: 5px; HEIGHT: 20px">
	<input  id=apply  type=button  value='계약자 연결' onclick=apply_income("MAP")
        style="Z-INDEX: 110; LEFT: 0px;  WIDTH: 80px;">
   <input  id=send  type=button  value='입금 처리' onclick=apply_income("APP")
        style="Z-INDEX: 110;  WIDTH: 80px;">
	        
</DIV>


<OBJECT id=gd_1 
    style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 1010px; POSITION: absolute; TOP: 34px; HEIGHT: 100%" 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BorderStyle"  VALUE="4">
	<PARAM NAME="Editable" VALUE="true">
	<PARAM NAME="ColSizing" VALUE="true">  
	<PARAM NAME="Format" VALUE="
	  <FC> Name='전송순번'     ID=fb_seq Align=Center Edit=None  HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=60 color=@ucolor</FC>
	   <FC> Name='선택'     ID=chk Align=Center EditStyle=CheckBox edit=none HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=30 color=@ucolor</FC>
	  <G> Name='FBS  전송 내역' HeadBgColor=#FFFF99  HeadColor=BLACK
	  <C> Name='전송일자'     ID=transfer_date  Align=left  HeadAlign=Center  HeadAlign=Center HeadBgColor=#BBE0F4  
	  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}	  HeadColor=BLACK   Width=70 suppress=1 
	  subsumtext='총계' </C>
	  <C> Name='구분'     ID=fb_gubun_cd  edit=none EditStyle=Combo Data='1:CMS,2:가상계좌,3:일반입금' HeadAlign=Center  align=center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=60 color=@ucolor</C>
     <C> Name='가상계좌/CMS' id=intf_code Align=Center   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  width=103 HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK color=@ucolor</C>
	  <C> Name='입금일자'     ID=fb_recv_date Edit=None HeadAlign=Center  Mask='XXXX.XX.XX'  align=CENTER BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70 color=@ucolor</C>
	  <C> Name='입금자'  id=fb_account_name    width=90 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='입금액'  id=fb_recv_amt  Edit=None  width=80 align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumText=@sum </C> </G>
	  <G> Name='분양수입금 처리내역' HeadBgColor=#99CCFF  HeadColor=BLACK
	  <C> Name='분양처리일'  id=apply_date  Edit=None  width=70 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='처리'  id=apply_ok  width=30 align=center EditStyle=Combo Data='Y:Y,N:N' BgColor={decode(apply_ok,'N','#FFFF99','Y','#99CCFF')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='SMS'  id=ex_col1  width=30 align=center EditStyle=Combo Data='Y:Y,N:N' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='현장'  id=long_name  width=90 align=left  EditStyle=Popup BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='분양구분'  id=sell_name Edit=None width=60 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
	  <C> Name='동호'  id=dongho  width=60 align=center Mask='XXXX-XXXX'  EditStyle=Popup  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='순번'  id=seq Edit=None width=26 align=center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='계약자'  id=cust_name Edit=None width=60 align=center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='계좌'  id=deposit_no  width=105 align=center EditStyle=Lookup Data='ds_select1:select_1:select_2'    BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
	  <C> Name='가상계좌'  id=v_account_no Edit=None width=85 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='error_code'  id=error_code  Edit=None  width=70 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='error_msg'  id=error_msg Edit=None width=500 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> </G>
	  ">
</OBJECT>
<!--  <FC> Name='전송순번'     ID=fb_seq Align=Center Edit=None  HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=65 color=@ucolor</FC>
	   <FC> Name='선택'     ID=chk Align=Center EditStyle=CheckBox edit=none HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=30 color=@ucolor</FC>
	  <G> Name='FBS  전송 내역' HeadBgColor=#FFFF99  HeadColor=BLACK
	  <C> Name='전송일자'     ID=transfer_date  Align=Center  HeadAlign=Center  HeadAlign=Center HeadBgColor=#BBE0F4  
	  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}	  HeadColor=BLACK   Width=120 suppress=1 </C>
	  <C> Name='구분'     ID=fb_gubun_cd  edit=none EditStyle=Combo Data='1:CMS,2:가상계좌' HeadAlign=Center  align=center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=60 color=@ucolor</C>
     <C> Name='가상계좌/CMS' id=intf_code Align=Center   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  width=100 HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK color=@ucolor</C>
	  <C> Name='입금일자'     ID=fb_recv_date Edit=None HeadAlign=Center  Mask='XXXX.XX.XX'  align=CENTER BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70 color=@ucolor</C>
	  <C> Name='입금시간'  id=fb_recv_time   Mask='XX:XX:XX' width=55 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='입금액'  id=fb_recv_amt  Edit=None  width=80 align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> </G>
	  <G> Name='분양수입금 처리내역' HeadBgColor=#99CCFF  HeadColor=BLACK
	  <C> Name='분양처리일자'  id=apply_date  Edit=None  width=120 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='처리'  id=apply_ok  width=30 align=center EditStyle=Combo Data='Y:Y,N:N' BgColor={decode(apply_ok,'N','#FFFF99','Y','#99CCFF')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='SMS'  id=ex_col1  width=30 align=center EditStyle=Combo Data='Y:Y,N:N' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='현장'  id=long_name Edit=None width=90 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='분양구분'  id=sell_name Edit=None width=60 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
	  <C> Name='동호'  id=dongho Edit=None width=60 align=center Mask='XXXX-XXXX' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='순번'  id=seq Edit=None width=40 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='모계좌'  id=deposit_no Edit=None width=85 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
	  <C> Name='가상계좌'  id=v_account_no Edit=None width=85 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='error_code'  id=error_code  Edit=None  width=70 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> 
	  <C> Name='error_msg'  id=error_msg Edit=None width=500 align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK</C> </G> -->
</BODY></HTML>
 