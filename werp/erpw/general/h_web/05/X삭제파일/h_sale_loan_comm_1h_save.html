<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : h_sale_loan_comm_1h.html								-->
<!-- 2. 유형(시나리오): 조회및 입력													-->
<!-- 3. 기 능 정 의   : 국민기금/대출금관리                 	      	-->
<!-- 4. 변 경 이 력   : 정호준 작성													-->
<!-- 5. 관련프로그램  :																	-->
<!-- 6. 특 기 사 항   : 국민기금/대출금관리										-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 

<SCRIPT language=JavaScript>
var gs_home = top.frames['security'].gs_home.value
var is_ds_1_addr = new Array(3)

is_ds_1_addr[1] = 'h_sale_loan_comm_1q.jsp?as_dept_code='
is_ds_1_addr[2] = 'h_sale_loan_comm_2q.jsp?as_dept_code='

var is_dept_code = ""
var is_dept_name = ""
var is_sell_code = ""
var is_sell_name = ""

var tr_fail    = 1                 // update정상:1  비정상:0
var il_index   = 1                 // 현재 tab_page
var il_sqlcode = 1                 // f_select 를 사용한 쿼리의 Valid Check 정상 1 비정상 0

//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
 tab_changed()
}
//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기(분양) 
//---------------------------------------------------------------------------
{
	result = f_hdept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	is_sell_code = top.frames['security'].gs_sell_code.value
	is_sell_name = top.frames['security'].gs_sell_name.value

	dept_name.value = is_dept_name
	sell_name.value = is_sell_name

	btnquery_onclick()
}
//---------------------------------------------------------------------
function tab_changed()
//---------------------------------------------------------------------
{
	ds_1.DataId = is_ds_1_addr[il_index] + is_dept_code + "&as_sell_code=" + is_sell_code
	ds_1.SyncLoad = true
	ds_1.reset()
}
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		cust_find();
	} 
}
//------------------------------------------------------------------------
function dongho_keyDown()                       //  입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{  
	if (window.event.keyCode != 13) return 
   dongho_find()
}
//------------------------------------------------------------------------
function dongho_find()                       //동호찾기
//------------------------------------------------------------------------
{
	ds_1.RowPosition = ds_1.ValueRow(3, dongho.value)
}
//------------------------------------------------------------------------
function cust_keyDown()                       //  입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{  
	if (window.event.keyCode != 13) return 
   cust_select()
}
//------------------------------------------------------------------------
function cust_select()                       //고객찾기
//------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	var row,ll_cnt=0,i,ls_chk

	if(cust.value.substr(0,1) > 0 && cust.value.substr(0,1) < 9) {
		ls_chk = '1'
	}
	else {
		ls_chk = '2'
	}
  
	for (i=1; i<=ds_1.CountRow; i++) {
		if (ls_chk == '1') {
			if (ds_1.NameValue(i,'chk_cust_code') == cust.value) {
				ll_cnt ++
				if (ll_cnt == 1){
					row = i
				}
			} 
		}
		else {
			if (ds_1.NameValue(i,'cust_name') == cust.value) {
				ll_cnt ++
				if (ll_cnt == 1){
					row = i
				}
			} 
		}
	}
	if (ll_cnt > 1 || ll_cnt == 0) {
		if (ls_chk == '1') {
			result = window.showModalDialog(gs_home + "/general/h_web/00//h_code_cust_find_1h.html", "1"+ "@" + cust.value,"dialogWidth:685px;dialogHeight:700px");
			if (result == "") {
			   return;
		   }
		}
		else {
			result = window.showModalDialog(gs_home + "/general/h_web/00//h_code_cust_find_1h.html", "2"+ "@" + cust.value,"dialogWidth:685px;dialogHeight:700px");
			if (result == "") {
			   return;
		   }
		}
		array = result.split("@");
		row = ds_1.NameValueRow("chk_cust_code",array[0])
	}
	if (row > 0) ds_1.RowPosition = row
}
//------------------------------------------------------------------------
function fund_loan(button_number)                       //상단버튼처리
//------------------------------------------------------------------------
{
	if ( ds_1.CountRow <= 0 ) {
		alert("먼저 자료를 조회해 주십시오.")
		return
	}

	// 평형 일괄 선택
	if ( button_number == 1 ) {
		pyong_select()
		return
	}
	
	if ( button_number <= 4 ) {
		if ( il_index == 2 ) {
			alert("국민기금 화면에서만 동작합니다.")
			return
		}
	}
	else {
		if ( il_index == 1 ) {
			alert("보증서대출 화면에서만 동작합니다.")
			return
		}
	}

	var i = 0, j = 0
	for ( i=1; i<=ds_1.CountRow; i++ ) {
		if ( ds_1.NameValue(i, "chk") == 'T' ) {
			j++
		}
	}
	if ( j <= 0 && button_number != 1) {
		alert("처리할 자료가 없습니다.")
		return
	}
	
	tr_fail == 1
	
	switch(button_number) {
//		case 1 : pyong_select(); break
		case 2 : fund_update(); break
		case 3 : fund_set(); break
		case 4 : fund_delete(); break
		case 5 : loan_update(); break
		case 6 : loan_set(); break
		case 7 : loan_delete(); break
	}
}
//---------------------------------------------------------------------
function pyong_select()                     //평형 찾기 
//---------------------------------------------------------------------
{
	var result,ls_arg;
	var array = new Array();
	
	ls_arg = gs_home + '@' + is_dept_code + '@' + is_sell_code + '@'
	
	ls_pyong = window.showModalDialog(gs_home + "/general/h_web/00/h_pyong_find_only_1h.html", ls_arg,"dialogWidth:440px;dialogHeight:500px");

	if (result == "") {
	   return;
   }

// 해당 평형 자료를 체크표시한다.
	for (i=ds_1.CountRow ;i >0 ;i--)
	{
		if (ds_1.Namevalue(i, "pyong") == ls_pyong)   {
			ds_1.Namevalue(i, "chk") = 'T'
		}
	}   
}
//---------------------------------------------------------------------------
function fund_update()                      // 국민기금등록
//---------------------------------------------------------------------------
{
	var result, ls_date, ls_amt
	var array = new Array()

	result = window.showModalDialog("h_fund_update_1h.html", '',"dialogWidth:290px;dialogHeight:190px;center:1;resizable=0;status=0;scroll=0")
	if(result == "") return
	array = result.split("@")
	ls_date = array[0]
	ls_amt  = array[1]
	var i = 0
	for ( i = 1; i <= ds_1.CountRow; i++ ) {
	   if ( ds_1.Namevalue(i, "chk") != 'T' ) continue ;
	   if ( ds_1.Namevalue(i, "master_dongho") == "" ) continue ;
	   if ( ds_1.Namevalue(i, "master_seq") == "" ) continue ;
		var arg_sql   = ""
		var ls_dongho = ""
		var ls_seq    = ""
		ls_dongho  = ds_1.NameValue(i, "master_dongho")
		ls_seq     = ds_1.NameValue(i, "master_seq")
		arg_sql    = "  Delete From h_sale_fund " + 
	                "  WHERE ( dept_code = '" + is_dept_code + "' AND " +
					    "          sell_code = '" + is_sell_code + "' AND " +
					    "          dongho    = '" + ls_dongho    + "' AND"  +
					    "          seq       = "  + ls_seq       + 
					    " ) "  + "@" +
		             "  Insert Into h_sale_fund " +
		             "  ( dept_code, sell_code, dongho, seq, request_date, request_r_amt, process_yn ) " +
		             "  VALues ( '" + is_dept_code + "', '" + is_sell_code + "', '" + ls_dongho + "', " + ls_seq + ", '" + ls_date + "', " + ls_amt + ", '" + 'N' + "' ) " + "@" +
		             "  Update h_sale_master " + 
	   				 "  Set   fund_amt  = " + ls_amt + " " + 
	 					 "  Where dept_code = '" + is_dept_code + "' AND " +
	   				 "        sell_code = '" + is_sell_code + "' AND " +
						 "        dongho    = '" + ls_dongho    + "' AND"  +
						 "        seq       = "  + ls_seq 
		f_update_sql_multy(arg_sql)	             
	}
	if ( tr_fail == 1 ) tab_changed();
}
//---------------------------------------------------------------------------
function fund_set()                      // 대환일자등록
//---------------------------------------------------------------------------
{
	var result, ls_date
	var array = new Array()
	result = window.showModalDialog("h_fund_set_1h.html", '',"dialogWidth:290px;dialogHeight:190px;center:1;resizable=0;status=0;scroll=0")
	if(result == "") return
	ls_date = result
	var i = 0
	for ( i = 1; i <= ds_1.CountRow; i++ ) {
		if ( ds_1.NameValue(i, "chk") != 'T' ) continue ;
	   if ( ds_1.NameValue(i, "master_dongho") == "" ) continue ;
	   if ( ds_1.NameValue(i, "master_seq") == "" ) continue ;
	   if ( ds_1.NameValue(i, "request_date") == "" ) continue ;
		var arg_sql          = ""
		var ls_dongho        = ""
		var ls_seq           = ""
		var ls_request_date  = ""
		var ls_request_r_amt = ""
		var ls_degree_seq    = ""
		var ls_sysdate       = ""
		var ls_empno         = ""
		ls_dongho  		  = ds_1.NameValue(i, "master_dongho")
		ls_seq     		  = ds_1.NameValue(i, "master_seq")
		ls_request_date  = ds_1.NameValue(i, "request_date")
		ls_request_r_amt = ds_1.Namevalue(i, "request_r_amt")
		// Check : 국민기금 수입금 처리 여부가 'Y' 인 세대만 처리 가능
		ll_cnt = f_select_q( "Select process_yn select_1 From h_sale_fund Where dept_code = '" + is_dept_code + "' AND sell_code = '" + is_sell_code + "' AND "
									 + "dongho = '" + ls_dongho + "' AND seq = " + ls_seq )
		if ( ( il_sqlcode = 0 ) || ( ds_select.NameValue(1, "select_1") != 'Y') ) continue ;
		// ① 해당 동호에 대한 잔금 차수가 존재 하는지 확인
		ll_cnt = f_select_q( "Select Count(*) select_1 From h_sale_income Where dept_code = '" + is_dept_code + "' AND sell_code = '" + is_sell_code + "' AND "
								    + "dongho = '" + ls_dongho + "' AND seq = " + ls_seq + " AND degree_code = '" + '50' + "'")
		if ( ( il_sqlcode = 0 ) || ( parseInt(ds_select.NameValue(1, "select_1"), 10) < 1 ) ) continue ;
		// ② 납입회수 계산 (~ 국민기금의 납입 회수 범위 : 60 ~ 69)
		ll_cnt = f_select_q( "Select max(degree_seq) select_1 From h_sale_income Where dept_code = '" + is_dept_code + "' AND sell_code = '" + is_sell_code + "' AND "
								    + "dongho = '" + ls_dongho + "' AND seq = " + ls_seq + " AND degree_code = '" + '50' + "'")
		if ( il_sqlcode = 0 ) continue ;
		ls_degree_seq = ds_select.NameValue(1, "select_1")
		if ( ls_degree_seq == "" ) ls_degree_seq = "0"
		ls_degree_seq = parseInt(ls_degree_seq, 10) + 1
		ll_cnt = f_select_q( " select sysdate select_1 from dual " )
		ls_sysdate = ds_select.NameValue(1, "select_1").substr(0, 10)
		ls_empno   = top.frames['security'].empno.value
		arg_sql    = "Update h_sale_fund " +
	   				 "Set exchange_date = '" + ls_date + "' " + 
	 					 "Where dept_code   = '" + is_dept_code + "' AND " +
	   				 "      sell_code   = '" + is_sell_code + "' AND " +
						 "      dongho      = '" + ls_dongho    + "' AND " +
		 				 "      seq         = "  + ls_seq + "@" +
		 				 "Insert Into h_sale_income " +
		 				 "Values ( '" + is_dept_code + "', '" + is_sell_code + "', '" + ls_dongho + "', '" + ls_seq + "', '" + "50" + "', '" +
		 				 					 ls_degree_seq + "', '" + ls_request_date + "', '" + "04" + "', " + "null, " +  ls_request_r_amt + ", " +
		 				 					 "0, 0, 0, 0, 0, 0, 0, '" +  ls_empno + "', '" + ls_sysdate + "', " + "null, null, null, null )"
		f_update_sql_multy(arg_sql)	             
	}
	if ( tr_fail == 1 ) tab_changed();
}
//---------------------------------------------------------------------------
function fund_delete()                      // 국민기금삭제
//---------------------------------------------------------------------------
{
	if ( confirm("선택한 국민기금을 삭제하시겠습니까?") == true ) {
		var i = 0
		for ( i = 1; i <= ds_1.CountRow; i++ ) {
			if ( ds_1.NameValue(i, "chk") != 'T' ) continue ;
		   if ( ds_1.NameValue(i, "master_dongho") == "" ) continue ;
		   if ( ds_1.NameValue(i, "master_seq") == "" ) continue ;
		   if ( ds_1.NameValue(i, "process_yn") == "Y" ) continue ;
		   var arg_sql   = ""
			var ls_dongho = ""
			var ls_seq    = ""
			ls_dongho  	  = ds_1.NameValue(i, "master_dongho")
			ls_seq     	  = ds_1.NameValue(i, "master_seq")
		   arg_sql = "Delete From h_sale_fund " +
	 					 "Where dept_code = '" + is_dept_code + "' AND " +
	   				 "      sell_code = '" + is_sell_code + "' AND " +
						 "		  dongho    = '" + ls_dongho    + "' AND " +
						 "		  seq 		= "  + ls_seq + "@"
						 "Update h_sale_master " +
	   				 "Set fund_amt = 0 "     +
	 					 "Where dept_code = '" + is_dept_code + "' AND " +
	   				 "      sell_code = '" + is_sell_code + "' AND " +
						 "		  dongho    = '" + ls_dongho    + "' AND " +
						 "		  seq 		= "  + ls_seq
			f_update_sql_multy(arg_sql)
		}
		if ( tr_fail == 1 ) tab_changed();
	}
}
//---------------------------------------------------------------------------
function loan_update()                      // 보증서대출금등록
//---------------------------------------------------------------------------
{
	var result, ls_bank, ls_date, ls_amt, ls_charger, ls_tel
	var array = new Array()
	result = window.showModalDialog("h_loan_update_1h.html", gs_home,"dialogWidth:490px;dialogHeight:290px;center:1;resizable=0;status=0;scroll=0")
	if(result == "") return
	array      = result.split("@")
	ls_bank    = array[0]
	ls_date    = array[1]
	ls_amt  	  = array[2]
	ls_charger = array[3]
	ls_tel     = array[4]
	var i = 0
	for ( i = 1; i <= ds_1.CountRow; i++ ) {
		if ( ds_1.NameValue(i, "chk") != 'T' ) continue ;
	   if ( ds_1.NameValue(i, "dongho") == "" ) continue ;
	   if ( ds_1.NameValue(i, "seq") == "" ) continue ;
	   var arg_sql   = ""
		var ls_dongho = ""
		var ls_seq    = ""
		ls_dongho  	  = ds_1.NameValue(i, "dongho")
		ls_seq     	  = ds_1.NameValue(i, "seq")
	   arg_sql = "Delete From h_sale_loan " +
	  				 "Where dept_code = '" + is_dept_code + "' AND " +
	   			 "      sell_code = '" + is_sell_code + "' AND " +
					 "		  dongho    = '" + ls_dongho    + "' AND " +
					 "		  seq 		= "  + ls_seq + "@" +
					 "Insert Into h_sale_loan " +
					 " ( dept_code, sell_code, dongho, seq, bank_head_code, loan_request_date, loan_request_amt, loan_duty_name, loan_duty_phone ) " +
					 "VALues ( '" + is_dept_code + "', '" + is_sell_code + "', '" + ls_dongho + "', " + ls_seq + ", '" + ls_bank + "', '" + ls_date + "', " + 
					 			  ls_amt + ", '" + ls_charger + "', '" + ls_tel + "' )" + "@" +
					 "Update h_sale_master " +
					 "Set guarantee_amt = " + ls_amt + " " +
	 				 "Where dept_code = '" + is_dept_code + "' AND " +
   				 "      sell_code = '" + is_sell_code + "' AND " +
					 "		  dongho    = '" + ls_dongho    + "' AND " +
					 "		  seq 		= "  + ls_seq
		f_update_sql_multy(arg_sql)
	}
	if ( tr_fail == 1 ) tab_changed();
	
}
//---------------------------------------------------------------------------
function loan_set()                      // 해소일자등록
//---------------------------------------------------------------------------
{
	var result, ls_date
	var array = new Array()
	result = window.showModalDialog("h_loan_set_1h.html", '',"dialogWidth:290px;dialogHeight:190px;center:1;resizable=0;status=0;scroll=0")
	if(result == "") return
	ls_date = result
	var i = 0
	for ( i = 1; i <= ds_1.CountRow; i++ ) {
		if ( ds_1.NameValue(i, "chk") != 'T' ) continue ;
	   if ( ds_1.NameValue(i, "dongho") == "" ) continue ;
	   if ( ds_1.NameValue(i, "seq") == "" ) continue ;
	   if ( ds_1.NameValue(i, "loan_request_date") == "" ) continue ;
	   var arg_sql   = ""
		var ls_dongho = ""
		var ls_seq    = ""
		ls_dongho  	  = ds_1.NameValue(i, "dongho")
		ls_seq     	  = ds_1.NameValue(i, "seq")
	   arg_sql = "Update h_sale_loan " +
	   			 "Set guarantee_sol_date = '" + ls_date + "' " +
	 				 "Where dept_code = '" + is_dept_code + "' AND " +
   				 "      sell_code = '" + is_sell_code + "' AND " +
					 "		  dongho    = '" + ls_dongho    + "' AND " +
					 "		  seq 		= "  + ls_seq
	  f_update_sql(arg_sql)
	}
	if ( tr_fail == 1 ) tab_changed();
}
//---------------------------------------------------------------------------
function loan_delete()                      // 보증서대출금삭제
//---------------------------------------------------------------------------
{
	if ( confirm("선택한 보증서대출금을 삭제하시겠습니까?") == true ) {
		var i = 0
		for ( i = 1; i <= ds_1.CountRow; i++ ) {
			if ( ds_1.NameValue(i, "chk") != 'T' ) continue ;
		   if ( ds_1.NameValue(i, "dongho") == "" ) continue ;
		   if ( ds_1.NameValue(i, "seq") == "" ) continue ;
		   var arg_sql   = ""
			var ls_dongho = ""
			var ls_seq    = ""
			ls_dongho  	  = ds_1.NameValue(i, "dongho")
			ls_seq     	  = ds_1.NameValue(i, "seq")
		   arg_sql = "Delete From h_sale_loan " +
	 					 "Where dept_code = '" + is_dept_code + "' AND " +
	   				 "      sell_code = '" + is_sell_code + "' AND " +
						 "		  dongho    = '" + ls_dongho    + "' AND " +
						 "		  seq 		= "  + ls_seq + "@"
						 "Update h_sale_master " +
	   				 "Set guarantee_amt = 0 "     +
	 					 "Where dept_code = '" + is_dept_code + "' AND " +
	   				 "      sell_code = '" + is_sell_code + "' AND " +
						 "		  dongho    = '" + ls_dongho    + "' AND " +
						 "		  seq 		= "  + ls_seq
			f_update_sql_multy(arg_sql)
		}
		if ( tr_fail == 1 ) tab_changed();
	}
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
  top.frames['main_title'].mouse_over()
  tb_1.ActiveIndex = 1
  il_index=1
  is_dept_code = top.frames['security'].gs_dept_code.value
  is_dept_name = top.frames['security'].gs_dept_name.value
  is_sell_code = top.frames['security'].gs_sell_code.value
  is_sell_name = top.frames['security'].gs_sell_name.value
  dept_name.value = is_dept_name
  sell_name.value = is_sell_name
  tab_changed()
}
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_1.RowPosition == ds_1.CountRow)  
        btnadd_onclick()
    else     
        ds_1.RowPosition++
}
</SCRIPT>

<SCRIPT language=JavaScript event=OnSelChanged(Index) for=tb_1>
  il_index = Index
  tab_changed()
</SCRIPT>
</HEAD>
<script language=JavaScript for=ds_select event=OnLoadError()>
        il_sqlcode = 0
</script>
<script language=JavaScript for=ds_select event=OnLoadCompleted(rowcnt)>
        il_sqlcode = 1
</script>

<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
  tr_fail = 0
</SCRIPT>
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
      alert("Error Code : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>
<script language=JavaScript for=gd_1 event=OnClick(row,colid)>
	if ( colid == 'chk' ) {
		if ( ds_1.NameValue(row, colid)  == 'T' ) {
			ds_1.NameValue(row, colid) = 'F'
		}
		else {
			if ( ds_1.NameValue(ds_1.RowPosition, "private_square") >= 85 ) {
				alert("국민기금대출을 신청할 대상이 아닙니다\n계약자가 계약한 동호의 전용면적을 확인하세요.")
			}
			else {
				ds_1.NameValue(row, colid) = 'T'
			}
		}
	}
</script>
<script language=JavaScript for=gd_2 event=OnClick(row,colid)>
	if ( colid == 'chk' ) {
		if ( ds_1.NameValue(row, colid)  == 'T' ) {
			ds_1.NameValue(row, colid) = 'F'
		}
		else {
			ds_1.NameValue(row, colid) = 'T'
		}
	}
</script>
<OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select
        style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
        classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT>        
<OBJECT id=ds_update 
        style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
        classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT>
<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 2px; WIDTH: 800px; POSITION: absolute; TOP: 1px; HEIGHT: 25px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td WIDTH='80px'  BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="right">현장명</div></td>
             <td WIDTH='240px'>
						<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" size=25 onkeyDown="keyDown()" style=" FONT-SIZE: 12px">
						<input type="button_query" value=" 검색" 
					        style="color:#2E4A4A; font-size:13px;  CURSOR: hand; width=40px;
					        background-color:#E9F5F5; border:1 #A1A9A9 solid; height:20px"   
					        onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
					        onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
					        "  onclick=dept_code_find()>
             <td WIDTH=80px   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
                 <div align="right">분양구분</div></td>
             <td WIDTH='108px'>
						<INPUT id=sell_name SIZE=15  style=" FONT-SIZE: 12px" READONLY DISABLED></td>
				 <td WIDTH='80px'   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
                 <div align="right">동호</div></td>
             <td WIDTH='108px'>
						<INPUT id=dongho SIZE=15  style=" FONT-SIZE: 12px" onkeyDown="dongho_keyDown()"></td>
				 <td WIDTH='80px'   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
                 <div align="right">고객찾기</div></td>
             <td WIDTH='108px'>
						<INPUT id=cust SIZE=15  style=" FONT-SIZE: 12px" onkeyDown="cust_keyDown()"></td>		
         </tr>                 
      </table>
</DIV>

<OBJECT id=tb_1 
    style="FONT-SIZE: 11px; Z-INDEX: 200; LEFT: 1px; WIDTH: 150px; POSITION: absolute; TOP: 30px; HEIGHT: 20px" 
    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
  <param name="BackColor"  value="#BBE0F4">
  <param name="TextColor"  value="BLACK">
  <PARAM NAME="Format" VALUE="
    <T>divid=tab_page_1 title=국민기금</T>
    <T>divid=tab_page_2 title=보증서대출</T>
    ">
 </OBJECT>
    
	 <DIV id=tab_page_1 
         style="Z-INDEX: 110; LEFT: 1px; WIDTH: 1009px; POSITION: absolute; TOP: 50px; HEIGHT: 598px;FONT-SIZE: 12px" >  
      <OBJECT id=gd_1 
         style="Z-INDEX: 100; LEFT: 1px; WIDTH: 1009px; POSITION: absolute; TOP: 1px; HEIGHT: 598px;FONT-SIZE: 12px" 
          classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
			<PARAM NAME="MultiRowSelect" VALUE="0">
		   <PARAM NAME="BorderStyle"  VALUE=4>
			<PARAM NAME="AutoInsert" VALUE="-1">
			<PARAM NAME="AllShowEdit" VALUE="-1">
			<PARAM NAME="Editable" VALUE="-1">
			<PARAM NAME="ViewSummary"    value=-1>
	      <param name="ColSelect"  value=true>
	      <PARAM NAME="DataID" VALUE="ds_1">
	      <PARAM NAME="Format" VALUE="
			     <C> Name='처리'  id=chk  width=60 EditStyle=CheckBox Data='Y:처리완료,N:미처리 ' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='평형'  id=pyong  width=87  align=center  Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='동호'  id=master_dongho  width=87  Align=Center Mask='XXXX-XXXX' Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='고객코드'  id=cust_code  width=110 Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='성명'  id=cust_name  width=150  align=center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='신청일자'  id=request_date  width=80 Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='신청금액'  id=request_r_amt  width=120 Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='대환일자'  id=exchange_date  width=80 Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='입금처리'  id=process_yn  width=60 EditStyle=Combo Data='Y:처리완료,N:미처리 ' Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
           ">
	   </OBJECT>
	 </DIV>	
   <DIV id=tab_page_2 
         style="Z-INDEX: 110; LEFT: 1px; WIDTH: 1009px; POSITION: absolute; TOP: 50px; HEIGHT: 598px;FONT-SIZE: 12px" >
      <OBJECT id=gd_2 
         style="Z-INDEX: 110; LEFT: 1px; WIDTH: 1009px; POSITION: absolute; TOP: 1px; HEIGHT: 598px;FONT-SIZE: 12px" 
          classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	      <PARAM NAME="MultiRowSelect" VALUE="0">
	      <PARAM NAME="AutoInsert" VALUE="-1">
	      <param name="ColSelect"  value=true>
         <PARAM NAME="BorderStyle"  VALUE=4>
	      <PARAM NAME="AllShowEdit" VALUE="-1">
	      <PARAM NAME="Editable" VALUE="-1">
	      <PARAM NAME="DataID" VALUE="ds_1">
	      <PARAM NAME="Format" VALUE="
				  <C> Name='처리'  id=chk  width=60 EditStyle=CheckBox Data='Y:처리완료,N:미처리 ' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='평형'  id=pyong  align=center width=87  Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='동호'  id=dongho  width=60  Align=Center Mask='XXXX-XXXX' Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='고객코드'  id=cust_code  width=90 Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>			     
				  <C> Name='성명'  id=cust_name  align=center  width=80 Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='신청일자'  id=loan_request_date  width=70 Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='신청금액'  id=loan_request_amt  width=90 Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='보증해소일자'  id=guarantee_sol_date  width=80 Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='은행명'  id=bank_head_name  width=120 Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='담당자'  id=loan_duty_name  width=100 Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='전화번호'  id=loan_duty_phone  width=120 Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
           ">
	   </OBJECT>
	 </DIV>
	 <Div id=button style="Z-INDEX: 210; LEFT: 152px; WIDTH: 1000px; POSITION: absolute; TOP: 27px; HEIGHT: 20px;FONT-SIZE: 09px" >
		<table>
			<tr>
				<td>
					<input type="button" name="pyong_select" value="평형선택" Onclick="fund_loan(1)" style="LEFT: 21px; WIDTH: 80px; POSITION: absolute">
					<input type="button" name="fund_update" value="국민기금등록" Onclick="fund_loan(2)" style="LEFT: 113px; WIDTH: 90px; POSITION: absolute">
					<input type="button" name="fund_set" value="대환일자등록" Onclick="fund_loan(3)" style="LEFT: 206px; WIDTH: 90px; POSITION: absolute">
					<input type="button" name="fund_delete" value="국민기금삭제" Onclick="fund_loan(4)" style="LEFT: 299px; WIDTH: 90px; POSITION: absolute">
					<input type="button" name="loan_update" value="보증서대출금등록" Onclick="fund_loan(5)" style="LEFT: 392px; WIDTH: 115px; POSITION: absolute">
					<input type="button" name="loan_set" value="해소일자등록" Onclick="fund_loan(6)" style="LEFT: 510px; WIDTH: 90px; POSITION: absolute">
					<input type="button" name="loan_delete" value="보증서대출금삭제" Onclick="fund_loan(7)" style="LEFT: 603px; WIDTH: 115px; POSITION: absolute">
				</td>
			</tr>
		</table>
	</Div>
</BODY></HTML>