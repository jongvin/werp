<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : h_sale_master_insert_1h.html						-->
<!-- 2. 유형(시나리오): window 조회및 입력									-->
<!-- 3. 기 능 정 의   : 공급세대 등록			  	  							-->
<!-- 4. 변 경 이 력   : 김 동우 작성											-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :																-->
<!-- *************************************************************	-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR> 
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_sell_code = top.frames['security'].gs_sell_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var is_sell_name = top.frames['security'].gs_sell_name.value

var is_ds_1_addr = gs_home + '/general/h_web/01/h_sale_master_insert_1q.jsp?arg_dept_code='
var is_tr_1_addr = gs_home + '/general/h_web/01/h_sale_master_insert_1tr.jsp'
</script>

<!-- ======================================================================= -->
<!--                      Function                          -->
<!-- ======================================================================= -->
<script language="JavaScript">
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	ds_1.DataID = is_ds_1_addr + is_dept_code + '&arg_sell_code=' + is_sell_code
	ds_1.SyncLoad=true
	ds_1.Reset()
	tot_cnt.value = ds_1.CountRow
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("dong");
} 
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
	ds_1.NameValue(ds_1.RowPosition,"sell_code") = is_sell_code
	ds_1.NameValue(ds_1.RowPosition,"seq") = 1
	ds_1.NameValue(ds_1.RowPosition,'contract_code') = '01'
	ds_1.NameValue(ds_1.RowPosition,'contract_yn') = 'N'
	ds_1.NameValue(ds_1.RowPosition,'chg_div') = '00'
	ds_1.NameValue(ds_1.RowPosition,'contract_date') = '1000.01.01'
	ds_1.NameValue(ds_1.RowPosition,'chg_date') = '2999.12.31'
	ds_1.NameValue(ds_1.RowPosition,'last_contract_date') = '1000.01.01'
	Fn_SetColumn()
	tot_cnt.value = ds_1.CountRow
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	 ds_1.AddRow()
	 init_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	 ds_1.InsertRow(ds_1.RowPosition)
	 init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	var ls_temp,ls_seq,ls_dongho,arg_cmd
	  if  (gd_1.MultiRowSelect){               // multi row select 일 경우
	     for (i=ds_1.CountRow ;i >0 ;i--)
	     {
	        if (ds_1.RowMark(i) == 1){
					ls_temp = ds_1.NameValue(i,'contract_yn')
					ls_seq  = ds_1.NameValue(i,'seq')
					if (ls_temp == 'N' && ls_seq == 1){	        				
						ls_dongho = ds_1.NameValue(i,'dongho')
						var ls_v_account_no = ds_1.namevalue(i, 'v_account_no')
						var ls_deposit_no = ds_1.namevalue(i, 'deposit_no')			
						ds_1.DeleteRow(i)
						arg_cmd = " delete from H_SALE_AGREE " +
									 "   where dept_code = '" + is_dept_code + "'" +
									 "     and sell_code = '" + is_sell_code + "'" + 
									 "     and dongho = '" + ls_dongho + "'" +
									 "     and seq = '" + ls_seq + "'" 
						f_update_sql(arg_cmd)
						arg_cmd = " delete from H_SALE_DELAY_RATE " +
									 "   where dept_code = '" + is_dept_code + "'" +
									 "     and sell_code = '" + is_sell_code + "'" + 
									 "     and dongho = '" + ls_dongho + "'" +
									 "     and seq = '" + ls_seq + "'" 
						f_update_sql(arg_cmd)
						arg_cmd = " delete from H_SALE_DISCOUNT_RATE " +
									 "   where dept_code = '" + is_dept_code + "'" +
									 "     and sell_code = '" + is_sell_code + "'" + 
									 "     and dongho = '" + ls_dongho + "'" +
									 "     and seq = '" + ls_seq + "'" 
						f_update_sql(arg_cmd)

						if ( ls_v_account_no.length > 0) {
							ds_spcall.DataID =  gs_home + '/general/h_web/03/h_del_v_account_no_procedure.jsp?arg_dept_code=' + is_dept_code + 
																																		  '&arg_sell_code=' + is_sell_code +
																																		  '&arg_dongho=' + ls_dongho + 
																																		  '&arg_seq=' + ls_seq + 
																																		  '&arg_deposit_no=' + ls_deposit_no + 
																																		  '&arg_v_account_no=' + ls_v_account_no
							
						   ds_spcall.SyncLoad = true
					 	   ds_spcall.reset()
						}
					}
	        }
	    }   
	    ds_1.MarkRows(ds_1.RowPosition,ds_1.RowPosition)  //삭제작업완료후 MARK
	   } 
	  else {
	     ds_1.DeleteRow(ds_1.RowPosition)  
	  }
	tr_1.Post()
	tot_cnt.value = ds_1.CountRow
 }
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
var ls_temp,ls_dongho,ls_pyong,ls_style,ls_class,ls_option_code,arg_cmd,ls_spec_unq_num,ll_seq

 if (ds_1.IsUpdated){
	 var ll_dup
	 ll_dup = f_dup_chk("ds_1","dongho")
	 if (ll_dup > 0) {
	     alert("동호가 중복되었습니다: 동호를 수정하십시요 ")
	     ds_1.RowPosition = ll_dup
	     return
	 }
 }
	if (ds_1.IsUpdated){
	   if  (confirm("변경되었습니다 저장하시겠습니까?")){
	     for (i=ds_1.CountRow ;i >0 ;i--){
	     		ls_temp = ds_1.NameValue(i,'dongho')
	     		if (ls_temp.length != 8){
	     			alert('동호를 반드시 입력하십시오')
	     			ds_1.RowPosition = i
	     			return
	     		}
	     		if (ds_1.RowStatus(i) == '1') {
	     			ds_1.NameValue(i,'chk_st') = 'Y'
	     		}
	     		if (ds_1.RowStatus(i) == '3') {
	     			if (ds_1.NameValue(i,'dongho') != ds_1.OrgNameValue(i,'dongho')) {
	     				alert('동호는 변경할 수없습니다...')
	     				ds_1.NameValue(i,'dongho') = ds_1.OrgNameValue(i,'dongho')
	     				ds_1.NameValue(i,'dong')   = ds_1.OrgNameValue(i,'dong')
	     				ds_1.NameValue(i,'ho')     = ds_1.OrgNameValue(i,'ho')
	     				ds_1.RowPosition = i
	     				return
	     			}
	     		}
 				if ((ds_1.NameValue(i,'chk_st') != 'Y') && (ds_1.NameValue(i,'option_code') != ds_1.OrgNameValue(i,'option_code') || ds_1.NameValue(i,'pyong') != ds_1.OrgNameValue(i,'pyong') || ds_1.NameValue(i,'style') != ds_1.OrgNameValue(i,'style') || ds_1.NameValue(i,'class') != ds_1.OrgNameValue(i,'class'))) {
 					ls_dongho = ds_1.NameValue(i,'dongho')
 					ll_seq    = ds_1.NameValue(i,'seq')
 					f_select_q("select count(*) select_1 from h_sale_income where dept_code = '" + is_dept_code + "' and sell_code = '" + is_sell_code + "' and dongho = '" + ls_dongho + "' and seq = " + ll_seq )       
 					ll_cnt = parseInt(ds_select.NameValue(ds_select.RowPosition,'select_1'),10)
 					
 					if (ll_cnt < 1) {
 						arg_cmd = " delete from h_sale_agree  " +
 							       "  WHERE ( DEPT_CODE = '" + is_dept_code + "' AND " +
 									 "        sell_code = '" + is_sell_code + "' AND " +
 									 "        dongho    = '" + ls_dongho + "' AND " +
 									 "        seq       = " + ll_seq + " )" 
 					
 						f_update_sql(arg_cmd)

 						ls_pyong       = ds_1.NameValue(i,'pyong')
 						ls_style       = ds_1.NameValue(i,'style')
 						ls_class       = ds_1.NameValue(i,'class')
 						ls_option_code = ds_1.NameValue(i,'option_code')
 						ll_cnt = f_select_q("select spec_unq_num select_1 from h_base_pyong_master where dept_code = '" + is_dept_code + "' and sell_code = '" + is_sell_code + "' and pyong = '" + ls_pyong + "' and style = '" + ls_style + "' and class = '" + ls_class + "' and option_code = '" + ls_option_code + "'" )       
 						if (ll_cnt > 0) {
 							ls_spec_unq_num = ds_select.NameValue(1,'select_1')
 							
 							arg_cmd = "  INSERT INTO h_sale_agree  " +
 						     			 "  SELECT dept_code,sell_code,'" + ls_dongho + "'," + ll_seq + " ,degree_code,agree_date,land_amt,build_amt, " +
 						     			 "         vat_amt,sell_amt,'N',0,sysdate,0,null,null,null,null,null, null, null  " + 
 						       		 "    FROM h_base_pyong_detail  " +
 						      		 "   WHERE ( DEPT_CODE = '" + is_dept_code + "' ) AND  " +
 						             "         ( SELL_CODE = '" + is_sell_code + "' ) AND  " +
 						             "         ( spec_unq_num = " + ls_spec_unq_num + " ) " 
 						
 							f_update_sql(arg_cmd)
 						}
 					}
 				}
	     }
	      tr_1.Post()
			for (i=ds_1.CountRow ;i >0 ;i--){
	     		if (ds_1.NameValue(i,'chk_st') == 'Y') {
	     			ds_1.NameValue(i,'chk_st') = 'N'
					ds_1.ResetStatus()
	     			ls_dongho = ds_1.NameValue(i,'dongho')
	     			ls_pyong  = ds_1.NameValue(i,'pyong')
	     			ls_style  = ds_1.NameValue(i,'style')
	     			ls_class  = ds_1.NameValue(i,'class')
	     			ls_option_code = ds_1.NameValue(i,'option_code')

					arg_cmd = " INSERT INTO H_SALE_AGREE " +
								 "  SELECT b.DEPT_CODE,b.SELL_CODE,'" + ls_dongho + "',1,b.DEGREE_CODE,b.AGREE_DATE,b.LAND_AMT,b.BUILD_AMT, " +
								 "         b.VAT_AMT,b.SELL_AMT,'N',0,null,0 ,null,null,null,null,null, null, null" +
								 "    FROM h_base_pyong_master a, " +
								 "         H_BASE_PYONG_DETAIL b " +
								 "   where a.dept_code = b.dept_code (!) " +
								 "     and a.sell_code = b.sell_code (!) " +
								 "     and a.spec_unq_num = b.spec_unq_num (!) " +
								 "     and a.dept_code = '" + is_dept_code + "'" +
								 "     and a.sell_code = '" + is_sell_code + "'" + 
								 "     and a.pyong = '" + ls_pyong + "'" +
								 "     and a.style = '" + ls_style + "'" +
								 "     and a.class = '" + ls_class + "'" +
								 "     and a.option_code = '" + ls_option_code + "'"
					f_update_sql(arg_cmd)

					arg_cmd = "	INSERT INTO h_sale_delay_rate " +
								 " SELECT dept_code,sell_code,'" + ls_dongho + "',1,rate_kind,mnth,s_date,e_date,rate, " +
								 "    	 cutoff_std,cutoff_unit " +
							    "   FROM h_base_delay_rate " +
							 	 "  WHERE dept_code = '" + is_dept_code + "'" +
								 " 	AND sell_code = '" + is_sell_code + "'"

					f_update_sql(arg_cmd)

					arg_cmd = "	INSERT INTO h_sale_discount_rate " +
								 " SELECT dept_code,sell_code,'" + ls_dongho + "',1,rate_kind,s_date,e_date,rate,cutoff_std,cutoff_unit " +
							    "   FROM h_base_discount_rate " +
							    "  WHERE dept_code = '" + is_dept_code + "'" +
								 "    AND sell_code = '" + is_sell_code + "'"

					f_update_sql(arg_cmd)
	     		}
	     	}
	   }
 } 
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	   if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	       {  //저장 routine
	       }   
 
}     
top.frames['main_ct'].location.href(ls_arg)
top.frames['main_title'].div_r.style.visibility="hidden"             
top.frames['main_title'].div_u.style.visibility="hidden"             

// top.frames['main_ct'].window.close()     
}
//---------------------------------------------------------------------
function pyong_find()                     //평형 찾기 
//---------------------------------------------------------------------
{
	var result,ls_arg;
	var array = new Array();
	
	ls_arg = gs_home + '@' + is_dept_code + '@' + is_sell_code + '@'
	
	result = window.showModalDialog(gs_home + "/general/h_web/00/h_pyong_find_2h.html", ls_arg,"dialogWidth:480px;dialogHeight:500px");
	
	if (result == "") {
	   return;
   }
	array = result.split("@");

	ds_1.NameValue(ds_1.RowPosition,'pyong') = array[0]
	ds_1.NameValue(ds_1.RowPosition,'style') = array[1]
	ds_1.NameValue(ds_1.RowPosition,'class') = array[2]
	ds_1.NameValue(ds_1.RowPosition,'option_code') = array[4]
}
//---------------------------------------------------------------------
function tot_insert()                     //일괄등록처리
//---------------------------------------------------------------------
{
	var result,ls_arg;
	var array = new Array();
	
	ls_arg = gs_home + '@' + is_dept_code + '@' + is_sell_code + '@'
	
	result = window.showModalDialog(gs_home + "/general/h_web/01/h_base_sellhouse_insert_1h.html", ls_arg,"dialogWidth:930px;dialogHeight:510px");

	btnquery_onclick()
}

//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기(분양) 
//---------------------------------------------------------------------------
{
	result = f_hdept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	is_sell_code = top.frames['security'].gs_sell_code.value
	is_sell_name = top.frames['security'].gs_sell_name.value

	dept_name.value = is_dept_name
	sell_name.value = is_sell_name

	ll_cnt = f_select1_q("select class select_1, class_name select_2  from h_code_class  where dept_code = " + "'" + is_dept_code + "'" + " and sell_code = " + "'" + is_sell_code + "'" + " order by class ")       //군코드
	ll_cnt = f_select2_q("select option_code select_1, option_name select_2  from h_code_option where dept_code = " + "'" + is_dept_code + "'" + " and sell_code = " + "'" + is_sell_code + "'" + " order by option_code ")       //선택사양
	ll_cnt = f_select3_q("select code select_1, code_name select_2  from h_code_common  where code_div = '04' order by code ")       //계약구분

	btnquery_onclick()
}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return
  
  

   top.frames['main_title'].mouse_over()
	tr_1.Action = is_tr_1_addr 

	dept_name.value = is_dept_name
	sell_name.value = is_sell_name
	
	ll_cnt = f_select1_q("select class select_1, class_name select_2  from h_code_class  where dept_code = " + "'" + is_dept_code + "'" + " and sell_code = " + "'" + is_sell_code + "'" + " order by class ")       //군코드
	ll_cnt = f_select2_q("select option_code select_1, option_name select_2  from h_code_option where dept_code = " + "'" + is_dept_code + "'" + " and sell_code = " + "'" + is_sell_code + "'" + " order by option_code ")       //선택사양
	ll_cnt = f_select3_q("select code select_1, code_name select_2  from h_code_common  where code_div = '04' order by code ")       //계약구분
	btnquery_onclick()
}




</SCRIPT>
<!-- ======================================================================= -->
<!--                     Event                          -->
<!-- ======================================================================= -->
<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_1.RowPosition == ds_1.CountRow)  
        btnadd_onclick()
    else     
        ds_1.RowPosition++
}
</SCRIPT>
<SCRIPT language="javascript" for=gd_1 event=OnPopup(row,colid,data)>
 if (colid == "pyong") {
 	if (ds_1.NameValue(row,'contract_yn') == 'Y') {
 		alert('계약된 자료는 수정할 수 없습니다...')
 		return
 	}
    pyong_find()
 }    
</SCRIPT>
<script language=JavaScript for=gd_1 event=CanColumnPosChange(row,colid)>
	var ll_cnt=0,ls_temp,ls_temp1
	if (colid == "dong" ) {
		ls_temp = ds_1.NameValue(row,'dong')
		if (ls_temp.length != 4 ) {
			alert('동은 반드시 4자리로 입력하십시오...')
			gd_1.Focus();
			return false;
		}
		return true
	}
	if (colid == 'ho') {
		ls_temp = ds_1.NameValue(row,'ho')
		if (ls_temp.length != 4 ) {
			alert('호수는 반드시 4자리로 입력하십시오...')
			gd_1.Focus();
			return false;
		}
		return true
	}
return true
	
</SCRIPT>
<script language=JavaScript for=gd_1 event=OnExit(row,colid,olddata)>
	var ls_temp,ls_temp1
	if (colid == "dong" || colid == 'ho') {
		ls_temp = ds_1.NameValue(row,'dong')
		ls_temp1 = ds_1.NameValue(row,'ho')
		if (ls_temp.length == 4 && ls_temp1.length == 4 ) {
			ds_1.NameValue(row,'dongho') = ls_temp + ls_temp1
		}
	}
</SCRIPT>

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code(ds_spcall) : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
</SCRIPT>
<!-- ======================================================================= -->
<!--                      Component                          -->
<!-- ======================================================================= -->
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select3
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_update
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   <PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:h_sale_master_insert_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1">
</OBJECT></comment> <script> __ws__(__NSID__);</script>	
</HEAD>
<!-- ======================================================================= -->
<!--                     Body                         -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0;"  onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<div class=main_div>
	<!--  <table class=main_table > -->
	<table width="100%" height="100%" BORDER="0"  cellpadding="0"  CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
		<TR height="20px">
			<TD class=td_green >
					<table border= "0" cellpadding="0" cellspacing="0" class=main_table>
						<tr>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td width="45px" class=font_green_bold>현장명</td>
							<td width="166">
								<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"   style="ime-mode:active"   style=" FONT-SIZE: 12px" style="ime-mode:active " size=25 onkeyDown="keyDown()"   >
							</td>
							<td width="50">
								<input id="button_query" type="button" value=" 검색" class="img_btnFind"   onclick=dept_code_find()
										onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"  >
							</td>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td WIDTH='58px'    class=font_green_bold >분양구분</td>
							 <td WIDTH='70px'>
									<INPUT id=sell_name   style=" width:100%;FONT-SIZE: 12px" READONLY ></td>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td WIDTH='58px'  align=center  class=font_green_bold >총세대수</td>
							 <td WIDTH='70px'>
									<INPUT id=tot_cnt SIZE=5  style=" FONT-SIZE: 12px;TEXT-ALIGN: right" READONLY DISABLED></td>
							<td width="*">&nbsp;</td>
							<td  width=100px>
									<input id=bt_query type="button" value="일괄등록"  class="img_btn4_1"
										onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"  onclick=tot_insert()>
							</td>
						</tr>
					</table>

			</TD>
		</TR>



		</TR>
		<TR>
			<TD>
					<comment id="__NSID__"><OBJECT id=gd_1 
					 style="WIDTH: 100%; HEIGHT: 100% ; "
					 classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
					<PARAM NAME="MultiRowSelect" VALUE="-1">
					<PARAM NAME="DataID" VALUE="ds_1">
					<PARAM NAME="AutoInsert" VALUE="-1">
					<PARAM NAME="BorderStyle"  VALUE=1>
					<PARAM NAME="AllShowEdit" VALUE="-1">
					<PARAM NAME="Editable" VALUE="-1">
					<PARAM NAME="ColSizing" VALUE="-1">
					<param name="ViewSummary"    value=1>
					<param name=SortView  value="Left">
					<PARAM NAME="Format" VALUE="
					  <C> Name='동'    ID=dong sort=true Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=60 </C>
					  <C> Name='호수'  ID=ho  sort=true  Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=60 </C>
					  <C> Name='평형' ID=pyong  sort=true EditStyle=Popup dec=2 Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center Align=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 </C>
					  <C> Name='TYPE'  sort=true  ID=style  Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=50 </C>
					  <C> Name='군'    sort=true    ID=class  Align=Center Edit=None EditStyle=Lookup Data='ds_select1:select_1:select_2' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  width=160 </C>
					  <C> Name='선택사양' sort=true ID=option_code  Align=Center EditStyle=Lookup Data='ds_select2:select_1:select_2' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  width=160 </C>
					  <C> Name='계약구분' sort=true ID=contract_code  Align=Center EditStyle=Lookup Data='ds_select3:select_1:select_2' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  width=100 </C>
					  <C> Name='계약여부' sort=true ID=contract_yn edit=none Align=Center Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center Align=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70 
							EditStyle=Combo Data='Y:계약,N:미계약' SumText='총분양가'</C>
					  <C> Name='공급금액' sort=true ID=sell_amt edit=none BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 SumText=@sum          </C> 
					  <C> Name='가상계좌' ID=v_account_no edit=none BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100           </C> 
					  ">
				</OBJECT></comment> <script> __ws__(__NSID__);</script>
			</TD>
		</TR>
	</TABLE>
</div>


</BODY></HTML>
