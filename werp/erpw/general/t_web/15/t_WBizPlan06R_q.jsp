<%@ page import="com.cj.common.*, com.cj.database.*, com.cj.util.*, com.gauce.*, com.gauce.io.*, java.sql.*" errorPage="../common/Error.jsp" contentType="text/html;charset=euc-kr"%>
<%
/**************************************************************************/
/* 1. 프 로 그 램 id : 
/* 2. 유형(시나리오) : Select Page
/* 3. 기  능  정  의 : 
/* 4. 변  경  이  력 : 김흥수 작성(2006-01-16)
/* 5. 관련  프로그램 : 
/* 6. 특  기  사  항 : 
/**************************************************************************/
 
	CITGauceInfo GauceInfo = null;
	
	CITData lrReturnData = null;
	GauceDataSet lrDataset = null;
	String	strSql = "";
	String	strAct = "";
	
	try
	{
		GauceInfo = CITCommon.initServerPage(request, response, session);
		
		CITData lrArgData = new CITData();
		
		strAct = CITCommon.toKOR(request.getParameter("ACT"));
		
		if (strAct.equals("MAIN"))
		{
			String strCLSE_ACC_ID_BF 	= CITCommon.toKOR(request.getParameter("CLSE_ACC_ID_BF"));
			String strCLSE_ACC_ID_NW 	= CITCommon.toKOR(request.getParameter("CLSE_ACC_ID_NW"));
			String strMM 							= CITCommon.toKOR(request.getParameter("MONTH"));
			String strBASE_AMT				= CITCommon.toKOR(request.getParameter("BASE_AMT"));
			String strCOMP_CODE				= CITCommon.toKOR(request.getParameter("COMP_CODE"));

strSql 	= "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		*                                                                                                                                                                                                                                                                              \n";
strSql += "	From                                                                                                                                                                                                                                                                             \n";
strSql += "	(                                                                                                                                                                                                                                                                                \n";
strSql += "	With Base_Table As                                                                                                                                                                                                                                                               \n";
strSql += "	(                                                                                                                                                                                                                                                                                \n";
strSql += "		Select                                                                                                                                                                                                                                                                         \n";
strSql += "			a.RN,                                                                                                                                                                                                                                                                        \n";
strSql += "			a.BIZ_PLAN_ITEM_NAME,                                                                                                                                                                                                                                                        \n";
strSql += "			a.MNG_CODE,                                                                                                                                                                                                                                                                  \n";
strSql += "			Sum( Case When InStr(c.GB1,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.EXEC_AMT Else Null End ) / ? EXEC_AMT_TOT_BF1,                                                                                                                              \n";
strSql += "			Sum( Case When InStr(c.GB1,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.EXEC_AMT Else Null End ) / ? EXEC_AMT_TOT1,                                                                                                                                \n";
strSql += "			Sum( Case When InStr(c.GB1,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.PLAN_AMT Else Null End ) / ? PLAN_AMT_TOT1,                                                                                                                                \n";
strSql += "			Sum( Case When InStr(c.GB1,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.EXEC_AMT Else Null End ) / ? BASE_EXEC_AMT_TOT_BF1,                                                                                              \n";
strSql += "			Sum( Case When InStr(c.GB1,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.PLAN_AMT Else Null End ) / ? BASE_PLAN_AMT_TOT1,                                                                                                 \n";
strSql += "			Sum( Case When InStr(c.GB1,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.EXEC_AMT Else Null End ) / ? BASE_EXEC_AMT_TOT1,                                                                                                 \n";
strSql += "			Sum( Case When InStr(c.GB2,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.EXEC_AMT Else Null End ) / ? EXEC_AMT_TOT_BF2,                                                                                                                             \n";
strSql += "			Sum( Case When InStr(c.GB2,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.EXEC_AMT Else Null End ) / ? EXEC_AMT_TOT2,                                                                                                                                \n";
strSql += "			Sum( Case When InStr(c.GB2,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.PLAN_AMT Else Null End ) / ? PLAN_AMT_TOT2,                                                                                                                                \n";
strSql += "			Sum( Case When InStr(c.GB2,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.EXEC_AMT Else Null End ) / ? BASE_EXEC_AMT_TOT_BF2,                                                                                              \n";
strSql += "			Sum( Case When InStr(c.GB2,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.PLAN_AMT Else Null End ) / ? BASE_PLAN_AMT_TOT2,                                                                                                 \n";
strSql += "			Sum( Case When InStr(c.GB2,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.EXEC_AMT Else Null End ) / ? BASE_EXEC_AMT_TOT2,                                                                                                 \n";
strSql += "			Sum( Case When InStr(c.GB3,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.EXEC_AMT Else Null End ) / ? EXEC_AMT_TOT_BF3,                                                                                                                             \n";
strSql += "			Sum( Case When InStr(c.GB3,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.EXEC_AMT Else Null End ) / ? EXEC_AMT_TOT3,                                                                                                                                \n";
strSql += "			Sum( Case When InStr(c.GB3,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  Then b.PLAN_AMT Else Null End ) / ? PLAN_AMT_TOT3,                                                                                                                                \n";
strSql += "			Sum( Case When InStr(c.GB3,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.EXEC_AMT Else Null End ) / ? BASE_EXEC_AMT_TOT_BF3,                                                                                              \n";
strSql += "			Sum( Case When InStr(c.GB3,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.PLAN_AMT Else Null End ) / ? BASE_PLAN_AMT_TOT3,                                                                                                 \n";
strSql += "			Sum( Case When InStr(c.GB3,b.COMP_CODE) > 0 And b.WORK_YM = ? ||?  And a.MNG_CODE = '매출액' Then b.EXEC_AMT Else Null End ) / ? BASE_EXEC_AMT_TOT3                                                                                                  \n";
strSql += "		From                                                                                                                                                                                                                                                                           \n";
strSql += "			(                                                                                                                                                                                                                                                                            \n";
strSql += "				Select                                                                                                                                                                                                                                                                     \n";
strSql += "					a.BIZ_PLAN_ITEM_NO,                                                                                                                                                                                                                                                      \n";
strSql += "					a.BIZ_PLAN_ITEM_NAME,                                                                                                                                                                                                                                                    \n";
strSql += "					a.ITEM_TAG,                                                                                                                                                                                                                                                              \n";
strSql += "					a.LEVEL_TAG,                                                                                                                                                                                                                                                             \n";
strSql += "					a.MNG_CODE,                                                                                                                                                                                                                                                              \n";
strSql += "					RowNum Rn                                                                                                                                                                                                                                                                \n";
strSql += "				From	T_PL_ITEM a                                                                                                                                                                                                                                                          \n";
strSql += "				Start With                                                                                                                                                                                                                                                                 \n";
strSql += "					a.P_NO = 0                                                                                                                                                                                                                                                               \n";
strSql += "				Connect By                                                                                                                                                                                                                                                                 \n";
strSql += "				Prior	a.BIZ_PLAN_ITEM_NO = a.P_NO                                                                                                                                                                                                                                          \n";
strSql += "				Order Siblings By                                                                                                                                                                                                                                                          \n";
strSql += "					a.ITEM_LEVEL_SEQ                                                                                                                                                                                                                                                         \n";
strSql += "			) a,                                                                                                                                                                                                                                                                         \n";
strSql += "			T_PL_COMP_PLAN_EXEC b,                                                                                                                                                                                                                                                       \n";
strSql += "			(                                                                                                                                                                                                                                                                            \n";
strSql += "				Select                                                                                                                                                                                                                                                                     \n";
strSql += "					Max(Decode(a.CODE_LIST_ID,'1',a.CODE_LIST_NAME)) GB1,                                                                                                                                                                                                                    \n";
strSql += "					Max(Decode(a.CODE_LIST_ID,'2',a.CODE_LIST_NAME)) GB2,                                                                                                                                                                                                                    \n";
strSql += "					Max(Decode(a.CODE_LIST_ID,'3',a.CODE_LIST_NAME)) GB3                                                                                                                                                                                                                     \n";
strSql += "				From	V_T_CODE_LIST a                                                                                                                                                                                                                                                      \n";
strSql += "				Where	a.CODE_GROUP_ID = '경영사업장구분'                                                                                                                                                                                                                                   \n";
strSql += "			) c                                                                                                                                                                                                                                                                          \n";
strSql += "		Where	a.BIZ_PLAN_ITEM_NO = b.BIZ_PLAN_ITEM_NO                                                                                                                                                                                                                                  \n";
strSql += "		And		b.CLSE_ACC_ID In (?,?)                                                                                                                                                                                                                       \n";
strSql += "		And		b.COMP_CODE Like ? || '%'                                                                                                                                                                                                                                       \n";
strSql += "		Group By                                                                                                                                                                                                                                                                       \n";
strSql += "			a.RN,                                                                                                                                                                                                                                                                        \n";
strSql += "			a.MNG_CODE,                                                                                                                                                                                                                                                                  \n";
strSql += "			a.BIZ_PLAN_ITEM_NAME,                                                                                                                                                                                                                                                        \n";
strSql += "			c.GB1,                                                                                                                                                                                                                                                                       \n";
strSql += "			c.GB2,                                                                                                                                                                                                                                                                       \n";
strSql += "			c.GB3                                                                                                                                                                                                                                                                        \n";
strSql += "	)                                                                                                                                                                                                                                                                                \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		1 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'매출액' NAME,                                                                                                                                                                                                                                                                 \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '매출액'                                                                                                                                                                                                                                                      \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		2 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'매출이익' NAME,                                                                                                                                                                                                                                                               \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '매출이익'                                                                                                                                                                                                                                                    \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		3 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'매출이익률' NAME,                                                                                                                                                                                                                                                             \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF1)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF1)),0) EXEC_AMT_TOT_BF1,                                                                                                                                                                                   \n";
strSql += "		100 * (Sum(a.PLAN_AMT_TOT1)) / NullIf((Sum(a.BASE_PLAN_AMT_TOT1) ),0)  PLAN_AMT_TOT1,                                                                                                                                                                                          \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT1)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT1) ),0)  EXEC_AMT_TOT1,                                                                                                                                                                                          \n";
strSql += "		100 * (100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0)) / NullIf((100 * Sum(a.BASE_EXEC_AMT_TOT1) / NullIf(Sum(a.BASE_PLAN_AMT_TOT1),0) ),0)  PRG_1,                                                                                                               \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF2)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF2) ),0)  EXEC_AMT_TOT_BF2,                                                                                                                                                                                 \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF3)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF3) ),0)  EXEC_AMT_TOT_BF3,                                                                                                                                                                                 \n";
strSql += "		100 * (Sum(a.PLAN_AMT_TOT3)) / NullIf((Sum(a.BASE_PLAN_AMT_TOT3) ),0)  PLAN_AMT_TOT3,                                                                                                                                                                                          \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT3)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT3) ),0)  EXEC_AMT_TOT3,                                                                                                                                                                                          \n";
strSql += "		100 * (100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0)) / NullIf((100 * Sum(a.BASE_EXEC_AMT_TOT3) / NullIf(Sum(a.BASE_PLAN_AMT_TOT3),0) ),0)  PRG_3,                                                                                                               \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0)) /                                                                                                                                                                     \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF3),0) ),0)  EXEC_AMT_TOT_BF_ALL,                                                                                                                       \n";
strSql += "		100 * (Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)) /                                                                                                                                                                              \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_PLAN_AMT_TOT1),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT2),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT3),0) ),0)  PLAN_AMT_TOT_ALL,                                                                                                                                   \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) /                                                                                                                                                                              \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0) ),0)  EXEC_AMT_TOT_ALL,                                                                                                                                   \n";
strSql += "		100 * (100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0)) /                                                                \n";
strSql += "					NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.BASE_PLAN_AMT_TOT1),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT2),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT3),0)),0) ),0)  PRG_ALL,               \n";
strSql += "		100 * (100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0)) / 																							 \n";	
strSql += "					NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF3),0))),0) ),0)  UP_ALL\n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '매출이익'                                                                                                                                                                                                                                                    \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		4 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'판매관리비' NAME,                                                                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '관리판매비'                                                                                                                                                                                                                                                  \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		5 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'인건비' NAME,                                                                                                                                                                                                                                                                 \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '인건비'                                                                                                                                                                                                                                                      \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		6 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'경  비' NAME,                                                                                                                                                                                                                                                                 \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '광고선전비','감가상각비','지급수수료','기타판관비')                                                                                                                                                                                                       \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		6 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'(대손상각비)' NAME,                                                                                                                                                                                                                                                           \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '대손상각비')                                                                                                                                                                                                                                              \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		7 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'영업이익' NAME,                                                                                                                                                                                                                                                               \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '영업이익')                                                                                                                                                                                                                                                \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		8 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'영업이익률' NAME,                                                                                                                                                                                                                                                             \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF1)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF1)),0) EXEC_AMT_TOT_BF1,                                                                                                                                                                                   \n";
strSql += "		100 * (Sum(a.PLAN_AMT_TOT1)) / NullIf((Sum(a.BASE_PLAN_AMT_TOT1) ),0)  PLAN_AMT_TOT1,                                                                                                                                                                                          \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT1)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT1) ),0)  EXEC_AMT_TOT1,                                                                                                                                                                                          \n";
strSql += "		100 * (100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0)) / NullIf((100 * Sum(a.BASE_EXEC_AMT_TOT1) / NullIf(Sum(a.BASE_PLAN_AMT_TOT1),0) ),0)  PRG_1,                                                                                                               \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF2)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF2) ),0)  EXEC_AMT_TOT_BF2,                                                                                                                                                                                 \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF3)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF3) ),0)  EXEC_AMT_TOT_BF3,                                                                                                                                                                                 \n";
strSql += "		100 * (Sum(a.PLAN_AMT_TOT3)) / NullIf((Sum(a.BASE_PLAN_AMT_TOT3) ),0)  PLAN_AMT_TOT3,                                                                                                                                                                                          \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT3)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT3) ),0)  EXEC_AMT_TOT3,                                                                                                                                                                                          \n";
strSql += "		100 * (100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0)) / NullIf((100 * Sum(a.BASE_EXEC_AMT_TOT3) / NullIf(Sum(a.BASE_PLAN_AMT_TOT3),0) ),0)  PRG_3,                                                                                                               \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0)) /                                                                                                                                                                     \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF3),0) ),0)  EXEC_AMT_TOT_BF_ALL,                                                                                                                       \n";
strSql += "		100 * (Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)) /                                                                                                                                                                              \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_PLAN_AMT_TOT1),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT2),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT3),0) ),0)  PLAN_AMT_TOT_ALL,                                                                                                                                   \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) /                                                                                                                                                                              \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0) ),0)  EXEC_AMT_TOT_ALL,                                                                                                                                   \n";
strSql += "		100 * (100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0)) /                                                                \n";
strSql += "					NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.BASE_PLAN_AMT_TOT1),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT2),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT3),0)),0) ),0)  PRG_ALL,               \n";
strSql += "		100 * (100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0)) /                                               \n";
strSql += "					NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF3),0))),0) ),0)  UP_ALL\n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '영업이익'                                                                                                                                                                                                                                                    \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		9 MAIN_ORDER,                                                                                                                                                                                                                                                                  \n";
strSql += "		'영업외수익' NAME,                                                                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '영업외수익')                                                                                                                                                                                                                                              \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		10 MAIN_ORDER,                                                                                                                                                                                                                                                                 \n";
strSql += "		'이자수익' NAME,                                                                                                                                                                                                                                                               \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '수입이자')                                                                                                                                                                                                                                                \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		11 MAIN_ORDER,                                                                                                                                                                                                                                                                 \n";
strSql += "		'영업외비용' NAME,                                                                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '영업외비용')                                                                                                                                                                                                                                              \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		12 MAIN_ORDER,                                                                                                                                                                                                                                                                 \n";
strSql += "		'이자비용' NAME,                                                                                                                                                                                                                                                               \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '지급이자')                                                                                                                                                                                                                                                \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		13 MAIN_ORDER,                                                                                                                                                                                                                                                                 \n";
strSql += "		'경상이익' NAME,                                                                                                                                                                                                                                                               \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF1) EXEC_AMT_TOT_BF1,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT1) PLAN_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT1) EXEC_AMT_TOT1,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0) PRG_1,                                                                                                                                                                                                             \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF2) EXEC_AMT_TOT_BF2,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.EXEC_AMT_TOT_BF3) EXEC_AMT_TOT_BF3,                                                                                                                                                                                                                                      \n";
strSql += "		Sum(a.PLAN_AMT_TOT3) PLAN_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		Sum(a.EXEC_AMT_TOT3) EXEC_AMT_TOT3,                                                                                                                                                                                                                                            \n";
strSql += "		100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0) PRG_3,                                                                                                                                                                                                             \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0) EXEC_AMT_TOT_BF_ALL,                                                                                                                                                          \n";
strSql += "		Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0) PLAN_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0) EXEC_AMT_TOT_ALL,                                                                                                                                                                      \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0) PRG_ALL,                                                                 \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0) UP_ALL                                                  \n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE In ( '경상이익')                                                                                                                                                                                                                                                \n";
strSql += "	Union All                                                                                                                                                                                                                                                                        \n";
strSql += "	Select                                                                                                                                                                                                                                                                           \n";
strSql += "		14 MAIN_ORDER,                                                                                                                                                                                                                                                                 \n";
strSql += "		'세전이익률' NAME,                                                                                                                                                                                                                                                             \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF1)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF1)),0) EXEC_AMT_TOT_BF1,                                                                                                                                                                                   \n";
strSql += "		100 * (Sum(a.PLAN_AMT_TOT1)) / NullIf((Sum(a.BASE_PLAN_AMT_TOT1) ),0)  PLAN_AMT_TOT1,                                                                                                                                                                                          \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT1)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT1) ),0)  EXEC_AMT_TOT1,                                                                                                                                                                                          \n";
strSql += "		100 * (100 * Sum(a.EXEC_AMT_TOT1) / NullIf(Sum(a.PLAN_AMT_TOT1),0)) / NullIf((100 * Sum(a.BASE_EXEC_AMT_TOT1) / NullIf(Sum(a.BASE_PLAN_AMT_TOT1),0) ),0)  PRG_1,                                                                                                               \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF2)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF2) ),0)  EXEC_AMT_TOT_BF2,                                                                                                                                                                                 \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT_BF3)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT_BF3) ),0)  EXEC_AMT_TOT_BF3,                                                                                                                                                                                 \n";
strSql += "		100 * (Sum(a.PLAN_AMT_TOT3)) / NullIf((Sum(a.BASE_PLAN_AMT_TOT3) ),0)  PLAN_AMT_TOT3,                                                                                                                                                                                          \n";
strSql += "		100 * (Sum(a.EXEC_AMT_TOT3)) / NullIf((Sum(a.BASE_EXEC_AMT_TOT3) ),0)  EXEC_AMT_TOT3,                                                                                                                                                                                          \n";
strSql += "		100 * (100 * Sum(a.EXEC_AMT_TOT3) / NullIf(Sum(a.PLAN_AMT_TOT3),0)) / NullIf((100 * Sum(a.BASE_EXEC_AMT_TOT3) / NullIf(Sum(a.BASE_PLAN_AMT_TOT3),0) ),0)  PRG_3,                                                                                                               \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0)) /                                                                                                                                                                     \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF3),0) ),0)  EXEC_AMT_TOT_BF_ALL,                                                                                                                       \n";
strSql += "		100 * (Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)) /                                                                                                                                                                              \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_PLAN_AMT_TOT1),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT2),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT3),0) ),0)  PLAN_AMT_TOT_ALL,                                                                                                                                   \n";
strSql += "		100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) /                                                                                                                                                                              \n";
strSql += "					NullIf((Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0) ),0)  EXEC_AMT_TOT_ALL,                                                                                                                                   \n";
strSql += "		100 * (100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.PLAN_AMT_TOT1),0) + Nvl(Sum(a.PLAN_AMT_TOT2),0) + Nvl(Sum(a.PLAN_AMT_TOT3),0)),0)) /                                                                \n";
strSql += "					NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0)) / NullIf((Nvl(Sum(a.BASE_PLAN_AMT_TOT1),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT2),0) + Nvl(Sum(a.BASE_PLAN_AMT_TOT3),0)),0) ),0)  PRG_ALL,               \n";
strSql += "		100 * (100 * (Nvl(Sum(a.EXEC_AMT_TOT1),0) + Nvl(Sum(a.EXEC_AMT_TOT2),0) + Nvl(Sum(a.EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.EXEC_AMT_TOT_BF3),0))),0)) /                                               \n";
strSql += "					NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT3),0)) / NullIf((100 * (Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF1),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF2),0) + Nvl(Sum(a.BASE_EXEC_AMT_TOT_BF3),0))),0) ),0)  UP_ALL\n";
strSql += "	From	Base_Table a                                                                                                                                                                                                                                                               \n";
strSql += "	Where	a.MNG_CODE = '세전이익'                                                                                                                                                                                                                                                    \n";
strSql += "	)                                                                                                                                                                                                                                                                                \n";
strSql += "	Order By                                                                                                                                                                                                                                                                         \n";
strSql += "		MAIN_ORDER                                                                                                                                                                                                                                                                     \n";

lrArgData.addColumn("1CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("1MM"							, CITData.VARCHAR2);
lrArgData.addColumn("1BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("1CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("2MM"							, CITData.VARCHAR2);
lrArgData.addColumn("2BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("2CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("3MM"							, CITData.VARCHAR2);
lrArgData.addColumn("3BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("2CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("4MM"							, CITData.VARCHAR2);
lrArgData.addColumn("4BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("3CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("5MM"							, CITData.VARCHAR2);
lrArgData.addColumn("5BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("4CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("6MM"							, CITData.VARCHAR2);
lrArgData.addColumn("6BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("3CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("7MM"							, CITData.VARCHAR2);
lrArgData.addColumn("7BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("5CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("8MM"							, CITData.VARCHAR2);
lrArgData.addColumn("8BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("6CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("9MM"							, CITData.VARCHAR2);
lrArgData.addColumn("9BASE_AMT"				, CITData.NUMBER);
lrArgData.addColumn("4CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("10MM"						, CITData.VARCHAR2);
lrArgData.addColumn("10BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("7CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("11MM"						, CITData.VARCHAR2);
lrArgData.addColumn("11BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("8CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("12MM"						, CITData.VARCHAR2);
lrArgData.addColumn("12BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("5CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("13MM"						, CITData.VARCHAR2);
lrArgData.addColumn("13BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("9CLSE_ACC_ID_NW"	, CITData.VARCHAR2);
lrArgData.addColumn("14MM"						, CITData.VARCHAR2);
lrArgData.addColumn("14BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("10CLSE_ACC_ID_NW", CITData.VARCHAR2);
lrArgData.addColumn("15MM"						, CITData.VARCHAR2);
lrArgData.addColumn("15BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("6CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("16MM"						, CITData.VARCHAR2);
lrArgData.addColumn("16BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("11CLSE_ACC_ID_NW", CITData.VARCHAR2);
lrArgData.addColumn("17MM"						, CITData.VARCHAR2);
lrArgData.addColumn("17BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("12CLSE_ACC_ID_NW", CITData.VARCHAR2);
lrArgData.addColumn("18MM "						, CITData.VARCHAR2);
lrArgData.addColumn("18BASE_AMT"			, CITData.NUMBER);
lrArgData.addColumn("13CLSE_ACC_ID_NW", CITData.VARCHAR2);
lrArgData.addColumn("7CLSE_ACC_ID_BF"	, CITData.VARCHAR2);
lrArgData.addColumn("1COMP_CODE"			, CITData.VARCHAR2);
lrArgData.addRow();
lrArgData.setValue("1CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("1MM"							, strMM);
lrArgData.setValue("1BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("1CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("2MM"							, strMM);
lrArgData.setValue("2BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("2CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("3MM"							, strMM);
lrArgData.setValue("3BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("2CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("4MM"							, strMM);
lrArgData.setValue("4BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("3CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("5MM"							, strMM);
lrArgData.setValue("5BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("4CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("6MM"							, strMM);
lrArgData.setValue("6BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("3CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("7MM"							, strMM);
lrArgData.setValue("7BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("5CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("8MM"							, strMM);
lrArgData.setValue("8BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("6CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("9MM"							, strMM);
lrArgData.setValue("9BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("4CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("10MM"							, strMM);
lrArgData.setValue("10BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("7CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("11MM"							, strMM);
lrArgData.setValue("11BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("8CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("12MM"							, strMM);
lrArgData.setValue("12BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("5CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("13MM"							, strMM);
lrArgData.setValue("13BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("9CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("14MM"							, strMM);
lrArgData.setValue("14BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("10CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("15MM"							, strMM);
lrArgData.setValue("15BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("6CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("16MM"							, strMM);
lrArgData.setValue("16BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("11CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("17MM"							, strMM);
lrArgData.setValue("17BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("12CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("18MM "						, strMM);
lrArgData.setValue("18BASE_AMT"				, strBASE_AMT);
lrArgData.setValue("13CLSE_ACC_ID_NW"	, strCLSE_ACC_ID_NW);
lrArgData.setValue("7CLSE_ACC_ID_BF"	, strCLSE_ACC_ID_BF);
lrArgData.setValue("1COMP_CODE"				, strCOMP_CODE);
			
			try
			{				
				lrReturnData = CITDatabase.selectQuery(strSql, lrArgData);
				
				lrReturnData.setScale("EXEC_AMT_TOT_BF1" 	, 4);
				lrReturnData.setScale("PLAN_AMT_TOT1"					, 4);
				lrReturnData.setScale("EXEC_AMT_TOT1"				, 4);
				lrReturnData.setScale("PRG_1"								, 4);
				lrReturnData.setScale("EXEC_AMT_TOT_BF2"		, 4);
				lrReturnData.setScale("EXEC_AMT_TOT_BF3"		, 4);
				lrReturnData.setScale("PLAN_AMT_TOT3"				, 4);
				lrReturnData.setScale("EXEC_AMT_TOT3"				, 4);
				lrReturnData.setScale("PRG_3"								, 4);
				lrReturnData.setScale("EXEC_AMT_TOT_BF_ALL"	, 4);
				lrReturnData.setScale("PLAN_AMT_TOT_ALL"		, 4);
				lrReturnData.setScale("EXEC_AMT_TOT_ALL"		, 4);
				lrReturnData.setScale("PRG_ALL"							, 4);
				
				lrDataset = CITCommon.toGauceDataSet(lrReturnData);						
				GauceInfo.response.enableFirstRow(lrDataset);			
				lrDataset.flush();
			}
			catch (Exception ex)
			{
				if (GauceInfo == null) GauceInfo = new CITGauceInfo(request, response);
				GauceInfo.response.writeException("USER", "900001","MAIN Select 오류-> "+ ex.getMessage());
			}
		}

	}
	catch (Exception ex)
	{
		if (GauceInfo == null) GauceInfo = new CITGauceInfo(request, response);
		GauceInfo.response.writeException("SYS", "100001", "페이지 초기화 오류 -> " + ex.getMessage());
	}
	finally
	{
		try
		{
			CITCommon.finalServerPage(GauceInfo);
		}
		catch (Exception ex)
		{
			if (GauceInfo == null) GauceInfo = new CITGauceInfo(request, response);
			GauceInfo.response.writeException("SYS", "100002", "페이지 종료 오류 -> " + ex.getMessage());
		}
	}
%>