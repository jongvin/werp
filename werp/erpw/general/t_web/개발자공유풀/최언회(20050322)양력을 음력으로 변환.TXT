//		 0 : 변환성공
//		-1 : 날짜범위를 벗어난 경우 (1881.01.30 ~ 2044.01.29)

boolean yuntag, exittag = false
integer yearpos, i, j
integer lunmap[163, 13], tmp[]
long totday

totday = f_datetojulian(as_soldate)
if totday < 686686 or totday > 746219 then return -1

for yearpos = 1 to 16
	choose case yearpos
		case 1
		// --------------------> 1881 ~ 1890 <------ //
			tmp[] =												 &
			  { 1, 2, 1, 2, 1, 2, 2, 3, 2, 2, 1, 2, 1, &
				 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 2, 1, 1, 2, 1, 3, 2, 1, 2, 2, 1, 2, 2, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 3, 2, 1, 1, 2, 1, 2, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2  }
		case 2
		// --------------------> 1891 ~ 1900 <------ //
			tmp[] =												 &
			  { 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 3, 2, 2, 1, 2, 2, 2, &
				 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, &
				 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 3, 2, 2, 1, 2, 1, 2, 1, 2, 1, &
				 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 2, 3, 2, 2, 1, 2  }
		case 3
		// --------------------> 1901 ~ 1910 <------ //
			tmp[] =												 &
			  { 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 3, 2, 1, 1, 2, 2, 1, 2, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 0, &
				 2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 4, 1, 2, 1, 2, 1, 2, 1, 2, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 0, &
				 1, 2, 3, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0  }
		case 4
		// --------------------> 1911 ~ 1920 <------ //
			tmp[] =												 &
			  { 2, 1, 2, 1, 1, 2, 3, 1, 2, 2, 1, 2, 2, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 2, 3, 1, 2, 1, 2, 1, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 3, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 3, 2, 2, 1, 2, 2, &
				 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 0  }
		case 5
		// --------------------> 1921 ~ 1930 <------ //
			tmp[] =												 &
			  { 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 2, 1, 3, 2, 1, 1, 2, 1, 2, 2, &
				 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 0, &
				 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 0, &
				 2, 1, 2, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 2, 3, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2, &
				 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 2, 1, 1, 2, 3, 1, 2, 1, 2, 2, 1  }
		case 6
		// --------------------> 1931 ~ 1940 <------ //
			tmp[] =												 &
				 { 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 4, 1, 2, 1, 2, 1, 1, 2, &
				 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 0, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 4, 1, 2, 1, 2, 1, 2, 2, 2, 1, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 2, 1, 1, 2, 1, 1, 4, 1, 2, 2, 1, 2, &
				 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0  }
		case 7
		// --------------------> 1941 ~ 1950 <------ //
			tmp[] =												 &
				 { 2, 2, 1, 2, 2, 1, 4, 1, 1, 2, 1, 2, 1, &
				 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 1, 2, 0, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
				 1, 1, 2, 1, 4, 1, 2, 1, 2, 2, 1, 2, 2, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 0, &
				 2, 2, 3, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 3, 2, 1, 2, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0  }
		case 8
		// --------------------> 1951 ~ 1960 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 2, 1, 4, 2, 1, 2, 1, 2, 1, 2, &
				 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 2, 1, 1, 4, 1, 1, 2, 1, 2, 1, 2, 2, 2, &
				 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 1, 1, 2, 3, 2, 1, 2, 2, &
				 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 1, 2, 2, 3, 2, 1, 2, 1, 2, 1  }
		case 9
		// --------------------> 1961 ~ 1970 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 2, 1, 3, 2, 1, 2, 1, 2, 2, 2, 1, &
				 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 0, &
				 2, 2, 2, 3, 2, 1, 1, 2, 1, 1, 2, 2, 1, &
				 2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 1, 2, 3, 2, 1, 2, 1, 2, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 0  }
		case 10
		// --------------------> 1971 ~ 1980 <------ //
			tmp[] =												 &
				 { 1, 2, 1, 1, 2, 3, 2, 1, 2, 2, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2, 1, 0, &
				 2, 2, 1, 2, 3, 1, 2, 1, 1, 2, 2, 1, 2, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 2, 3, 2, 1, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 0, &
				 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 1, 2, 1, 2, 4, 1, 2, 2, 1, 2, 1, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0  }
		case 11
		// --------------------> 1981 ~ 1990 <------ //
			tmp[] =												 &
				 { 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 3, 2, 1, 1, 2, 2, 1, 2, 2, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 3, 2, 2, &
				 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 0, &
				 2, 1, 2, 2, 1, 2, 3, 2, 2, 1, 2, 1, 2, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 2, 1, 1, 2, 3, 1, 2, 1, 2, 2, 2, 2  }
		case 12
		// --------------------> 1991 ~ 2000 <------ //
			tmp[] =												 &
				 { 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 0, &
				 1, 2, 2, 3, 2, 1, 2, 1, 1, 2, 1, 2, 1, &
				 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 2, 1, 2, 3, 2, 1, 1, 2, &
				 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 0, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 2, 1, 3, 2, 2, 1, 2, 2, 2, 1, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 0  }
		case 13
		// --------------------> 2001 ~ 2010 <------ //
			tmp[] =												 &
				 { 2, 2, 2, 1, 3, 2, 1, 1, 2, 1, 2, 1, 2, &
				 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 3, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
				 1, 1, 2, 1, 2, 1, 2, 3, 2, 2, 1, 2, 2, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 0, &
				 2, 2, 1, 1, 2, 3, 1, 2, 1, 2, 1, 2, 2, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0  }
		case 14
		// --------------------> 2011 ~ 2020 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 4, 2, 1, 2, 1, 1, 2, 1, 2, 1, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 2, 1, 2, 1, 2, 2, 3, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 2, 1, 1, 2, 1, 3, 2, 1, 2, 1, 2, 2, 2, &
				 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 1, 2, 2, 3, 2, 1, 1, 2, 1, 2, 1, 2  }
		case 15
		// --------------------> 2021 ~ 2030 <------ //
			tmp[] =												 &
				 { 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 3, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 3, 2, 1, 2, 2, 2, 1, &
				 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2, 0, &
				 1, 2, 2, 1, 2, 3, 1, 2, 1, 1, 2, 2, 1, &
				 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2, 0, &
				 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 0  }
		case 16
		// --------------------> 2031 ~ 2040 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, 1, &
				 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 3, 2, 2, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 1, 4, 1, 1, 2, 1, 2, 2, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 0, &
				 2, 2, 1, 2, 2, 3, 2, 1, 2, 1, 2, 1, 1, &
				 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0  }
	end choose
	for i = 1 to 10
		for j = 1 to 13
			lunmap[(yearpos - 1) * 10 + i, j] = tmp[(i - 1) * 13 + j]
		next
	next
next

// --------------------> 2041 ~ 2043 <------ //
tmp[] = { 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
			 1, 2, 3, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, &
			 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 0  }
for i = 1 to 3
	for j = 1 to 13
		lunmap[i + 160, j] = tmp[(i - 1) * 13 + j]
	next
next

totday -= 686685

for i = 1 to 163
	ab_yun = false
	yuntag = false
	for j = 1 to 13
		if lunmap[i, j] > 0 then
			if lunmap[i, j] > 2 then
				if totday <= lunmap[i, j] + 26 then
					ab_yun = true
					exittag = true
					exit
				end if
				yuntag = true
				totday -= lunmap[i, j] + 26
			else
				if totday <= lunmap[i, j] + 28 then
					exittag = true
					exit
				end if
				totday -= lunmap[i, j] + 28
			end if
		end if
	next
	if exittag then exit
next

if yuntag = true and ab_yun = true then
	messagebox('데이타 오류', '기술연구부로 즉시 연락하시기 바랍니다.', stopsign!)
	return -100
end if

as_lundate = string(i + 1880, '0000') + as_seperate
if yuntag = true or ab_yun = true then
	as_lundate += string(j - 1, '00')
else
	as_lundate += string(j, '00')
end if
as_lundate += as_seperate + string(totday, '00')

return 0

