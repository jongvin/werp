<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : p_attend_emp_approv_input_1h.html               -->
<!-- 2. 유형(시나리오):  조회및 입력												-->
<!-- 3. 기 능 정 의   :  근태승인자등록                       				-->
<!-- 4. 변 경 이 력   :  장희선 작성												-->
<!-- 5. 관련프로그램  :																	-->
<!-- 6. 특 기 사 항   :																	-->
<!-- *************************************************************		-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value

var is_ds_1_addr = gs_home + '/general/p_web/06/p_attend_emp_approv_input_1q.jsp'	   //조회용 &arg_bb=
var is_tr_1_addr = gs_home + '/general/p_web/06/p_attend_emp_approv_input_1tr.jsp'     //수정용 
var is_focus_enter='N'
var is_emp_no = top.frames['security'].empno.value
var is_resident_no
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	ds_1.DataID = is_ds_1_addr
	ds_1.SyncLoad=true
	ds_1.Reset()
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	if (ds_1.IsUpdated){
	 if (confirm("변경되었습니다 저장하시겠습니까?"))
	    tr_1.Post()
	}
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
     ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated){
			btnsave_onclick() 
	  }
}
//----------------------------------------------------------------
function excel_down()                      //엑셀자료 내리기 
//----------------------------------------------------------------
{
 var temp_1
 temp_1 = '개인일별근태 [' + is_work_year + ']'
 gd_1.GridToExcel(temp_1,'c:\aa.xls',0)
}
//---------------------------------------------------------------------------
function bt_emp_no()                      		// 사원찾기
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	send_arg = '' + '@' + ds_1.NameValue(ds_1.RowPosition,"approv_emp_name")
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_attend_find_1h.html",send_arg,"dialogWidth:700px;dialogHeight:500px");

	if(result == "") return;
	array = result.split("@");

 	ds_1.NameValue(ds_1.RowPosition,"approv_emp") = array[10]
 	ds_1.NameValue(ds_1.RowPosition,"approv_emp_name") = array[1]
 	ds_1.NameValue(ds_1.RowPosition,"approv_dept_name") = array[4]
 	ds_1.NameValue(ds_1.RowPosition,"approv_grade_name") = array[5]
 	
}
//---------------------------------------------------------------------------
function emp_copy()                      		// 승인자복사
//---------------------------------------------------------------------------
{
	if (ds_1.RowPosition < 1) return
	
	var i, j=0, ll_row
	
	for (i=1;i<=ds_1.CountRow;i++) {
		if (ds_1.RowMark(i) == 1){
			j = j+1
			if (j == 1) 	ll_row = i
			
			ds_1.NameValue(i,"approv_emp") 		  = ds_1.NameValue(ll_row,"approv_emp")
		 	ds_1.NameValue(i,"approv_emp_name")   = ds_1.NameValue(ll_row,"approv_emp_name")
		 	ds_1.NameValue(i,"approv_dept_name")  = ds_1.NameValue(ll_row,"approv_dept_name")
		 	ds_1.NameValue(i,"approv_grade_name") = ds_1.NameValue(ll_row,"approv_grade_name")
		}	
	}
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()

	tr_1.Action = is_tr_1_addr                   // jsp update용 

	btnquery_onclick()

}
</SCRIPT>
<SCRIPT language="javascript" for=gd_1 event=OnPopup(row,colid,data)>
	 if (colid == "approv_emp_name") {
	    bt_emp_no()
	    return
	 }    
</SCRIPT>
<script language=JavaScript for=ds_1 event=onColumnChanged(row,colid)>
	if (colid == "approv_emp_name"){
		if (ds_1.NameValue(row,colid) == ""){
			ds_1.NameValue(row,"approv_emp") = ""
			ds_1.NameValue(row,"approv_dept_name") = ""
			ds_1.NameValue(row,"approv_grade_name") = ""
		}
	}
</SCRIPT>

<script language=JavaScript for=gd_1 event=onClick(row,colid)>
	// 한번에 클릭하도록 함...		   
	if (colid == "att_exc_yn") {
		if (ds_1.NameValue(row,colid) == 'T')
	       ds_1.NameValue(row,colid) = 'F'
	   else
	       ds_1.NameValue(row,colid) = 'T'
	}
</script>
</HEAD>

<BODY style="FONT-SIZE: 12px"  onload=window_onload() oncontextmenu="return false" >

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code ds_1: " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>

<OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_attend_emp_approv_input_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>

<DIV id=gd_1_button 
style="Z-INDEX: 107; LEFT: 800px; WIDTH: 200px; POSITION: absolute; TOP: 7px; HEIGHT: 20px">
	<input id=bt_excel_copy type="button" value="&nbsp;복&nbsp;사&nbsp;" 
			style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';
			 font-size: 10pt; border:1 solid #000000; CURSOR: hand; border:1 #A1A9A9 solid; 
          onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
          onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=emp_copy()>
	<input id=bt_excel_copy type="button" value="엑셀내리기" 
			style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';
			 font-size: 10pt; border:1 solid #000000; CURSOR: hand; border:1 #A1A9A9 solid; 
          onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
          onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=excel_down()>
</DIV>

  <OBJECT id=gd_1 
      style="POSITION: absolute; LEFT: 3px; TOP: 35px; WIDTH: 1005px; HEIGHT: 99%; Z-INDEX: 102;FONT-SIZE: 12px " 
      classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
  	<PARAM NAME="MultiRowSelect" VALUE="-1">
  	<PARAM NAME="AutoInsert" VALUE="-1">
  	<PARAM NAME="AllShowEdit" VALUE="-1">
  	<PARAM NAME="Editable" VALUE="-1">
  	<PARAM NAME="ColSizing" VALUE="-1">
	<param name="ViewSummary"    value=1>
  	<param name=SortView value="Right">
  	<PARAM NAME="DataID" VALUE="ds_1">
  	<PARAM NAME="Format" VALUE="
     <G> Name='근태자' HeadBgColor=#BBE0F4  HeadColor=BLACK   >		
		  <C> Name='성명'  		id=emp_name		  			width=100	  Edit=None  sort=true  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
	         SumText='인원수'  SumColor=Black SumBgColor=Pink </C>
	     <C> Name='근태제외대상' 	id=att_exc_yn		  	EditStyle=CheckBox		width=100	  sort=true  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
	         SumText={sum(decode(att_exc_yn,'T',1,0))}  SumColor=Black SumBgColor=Pink </C>
	     <C> Name='부서'  		id=dept_name	  			width=200  	  Edit=None  sort=true  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
	         SumText={sum(decode(att_exc_yn,'T',0,1))}  SumColor=Black SumBgColor=Pink </C>
	     <C> Name='직위'  		id=grade_name 				width=100     Edit=None  sort=true  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     </G>
     <G> Name='승인자' HeadBgColor=#BBE0F4  HeadColor=BLACK   >		
		  <C> Name='성명'  		id=approv_emp_name		width=100	  sort=true  EditStyle=Popup  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
	     <C> Name='부서'  		id=approv_dept_name		width=200  	  Edit=None  sort=true  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
	     <C> Name='직위'  		id=approv_grade_name		width=100	  Edit=None  sort=true  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     </G>
     ">
  </OBJECT>
</BODY></HTML>