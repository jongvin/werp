<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : p_attend_input_shared_1h.html               	-->
<!-- 2. 유형(시나리오): 조회 및 입력											-->
<!-- 3. 기 능 정 의   : 근태등록                                   	-->
<!-- 4. 변 경 이 력   : 권미생 작성												-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :															   -->
<!-- *************************************************************	-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value
var is_work_date 
var is_work_yymm 
var is_ds_1_addr = gs_home + '/general/p_web/06/p_attend_input_shared_1q.jsp?arg_work_yymm='         
var is_tr_1_addr = gs_home + '/general/p_web/06/p_attend_input_shared_1tr.jsp'
var is_ds_seq_addr = gs_home + '/general/p_web/99/p_spec_unq_no_1q.jsp'  
var is_focus_enter='N'
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
  
  ds_1.DataID = is_ds_1_addr + is_work_yymm 
  ds_1.SyncLoad=true
  ds_1.Reset()  
  
  if (ds_1.CountRow < 1){
  		btnadd_onclick() 
  } 
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
    ds_seq.SyncLoad=true;              // spec_no_seq 구하기
    ds_seq.reset()
    ds_1.NameValue(ds_1.RowPosition,"spec_no_seq") = ds_seq.NameValue(1,"nextval")
	 ds_1.NameValue(ds_1.RowPosition, 'input_date') = is_work_date
	 ds_1.NameValue(ds_1.RowPosition, 'start_date') = is_work_yymm
	 ds_1.NameValue(ds_1.RowPosition, 'end_date')   = is_work_yymm
	 ds_1.NameValue(ds_1.RowPosition, 'attend_code')= '01'
	 cal_attend_day()
	 bt_emp_no()	 
}
//---------------------------------------------------------------------------
function bt_emp_no()                     //사번 찾기
//---------------------------------------------------------------------------
{

	var result;
	var send_arg;
	var array = new Array();
	is_comp_code = ""
	send_arg = is_comp_code + '@' + tx_emp_name.value
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_attend_find_1h.html",send_arg,"dialogWidth:700px;dialogHeight:500px");

	if(result == "") return;
	array = result.split("@");
	tx_emp_no.value     = array[0]
	tx_emp_name.value   = array[1]
	tx_dept_code.value  = array[2]
	tx_grade_code.value = array[3]	
	tx_dept_name.value  = array[4]
	tx_grade_name.value = array[5]
	ds_1.NameValue(ds_1.RowPosition,"resident_no") = array[10]
	
	em_start_date.Focus()		//focus주기
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
		ds_1.AddRow()
		init_move()
		
}
//----------------------------------------------------------------------- 
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
 		ds_1.InsertRow(ds_1.RowPosition)
 		init_move() 		
}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
  		ds_1.DeleteRow(ds_1.RowPosition)		  
}

//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
  var ls_annual_day, ls_start_year
  var ls_id = new Array();
  var ll_id_cnt = new Array();
  var ll
  var ls_start,ls_end
	 for (i=1; i <= ds_1.CountRow; i++){
	 	if (ds_1.NameValue(i,"attend_code") == ''){
	 		alert('근태코드는 필수 입력사항입니다.')
	 		ds_1.RowPosition = i
	 		return
	 	}
	 	if (ds_1.NameValue(i,"start_date") == ''){
	 		alert('근태시작일은 필수 입력사항입니다.')
	 		ds_1.RowPosition = i
	 		return
	 	}
	 	if (ds_1.NameValue(i,"end_date") == ''){
	 		alert('근태종료일은 필수 입력사항입니다.')
	 		ds_1.RowPosition = i
	 		return
	 	}	 	
	 	
		//연차일때 체크--------------------------------------------------------------------------------------
		if (ds_1.NameValue(i,'attend_code') == '01'){
		   ls_start = ds_1.NameValue(i,'start_date')  
		   ls_end = ds_1.NameValue(i,'end_date')  
			if(ls_start.substr(0,4) != ls_end.substr(0,4)){
				alert('연차는 근태시작일과 근태종료일의 년도가 같아야 합니다.')
			   ds_1.RowPosition = i
				return
			}
			// 동일 사번이 존재할경우 잔여일수를 array에서 잔여일수를 구함.(array에 사번이 없다면 f_ds_select_q
			//                로 조회한후 array에 resident_no와 잔여일수를 넣음 
			var ls_id_chk='N'
			for (ll=0;ll<ls_id.length;ll++) {
			    if (ls_id[ll] == ds_1.NameValue(i,'resident_no')) {
			        if (ll_id_cnt[ll] - ds_1.NameValue(i,"attend_day") < 0) {
			           ds_1.RowPosition = i
				        alert('사용 가능한 연차가 없습니다')
				        return
			        }
			        ll_id_cnt[ll] = ll_id_cnt[ll] - ds_1.NameValue(i,"attend_day")
			        ls_id_chk = 'Y'
			    }
			}
			//  array에 resident_no가 없을경우 f_ds_select_q로 잔여일수를 구하고 그 잔여일수를 array에 넣음 
			if (ls_id_chk == 'N') {
			   ls_start_year = ls_start.substr(0,4)	
			   ls_resident_no = ds_1.NameValue(i,'resident_no')	
			   //연차 잔여일수 구하기
			   ll_cnt = f_ds_select_q("ds_select9"," select (a.annual_day - nvl(b.attend_day,0)) select_1 	" +
										  "  from p_attend_annual  a,     											" +
                                "       (select b.resident_no, nvl(sum(b.attend_day),0)  attend_day " + 
                                "           from p_attend_input b " + 
										  "           where b.attend_code	= '01'  " +
										  "             and to_char(b.start_date,'yyyy') = '" + ls_start_year + "' 	" +
										  "             and to_char(b.start_date,'yyyy.mm') <> '" + ls_start.substr(0,7) + "' 	" +
										  "             and b.resident_no    = '" + ls_resident_no + "'   	 " + 
										  "            group by b.resident_no ) b " + 
										  "   where a.resident_no = b.resident_no (+) " + 
										  "	  and to_char(a.work_year,'yyyy') = '" + ls_start_year + "' 	" +
										  "   and a.resident_no    = '" + ls_resident_no + "'   	" )
			   if (ll_cnt < 1 ){
				   ds_1.RowPosition = i
				   alert('사용 가능한 연차가 없습니다.')
				   return
			   }
			   ls_annual_day = ds_select9.NameValue(1,"select_1")
			   ls_annual_day = parseInt(ls_annual_day,10)
			   if (ls_annual_day  < 1 ){
				   ds_1.RowPosition = i
				   alert('사용 가능한 연차가 없습니다.')
				   return
			   }
			   if (ds_1.NameValue(i,"attend_day") > ls_annual_day){	//입력한 근태일수가 연차 잔여일수보다 크면
				   ds_1.RowPosition = i
				   alert('사용 가능한 연차일수를 초과하였습니다.')
				   return
			   }
			   ll_item = ls_id.length
			   ls_id[ll_item] = ds_1.NameValue(i,'resident_no')
			   ll_id_cnt[ll_item] = ls_annual_day - ds_1.NameValue(i,"attend_day")
			}   
		}	//---------------------------------------------------------------------------------------------

   }		
  	if (ds_1.IsUpdated) {
      var ll_ret_row
      ll_ret_row = gf_gd_start_end_date('ds_1','start_date','end_date')
	   if (ll_ret_row > 0)  {
		   alert('근태종료일자가 근태시작일자보다 반드시 커야합니다')
		   ds_1.RowPosition = ll_ret_row
		   return 
      }
      
	   if (confirm("변경되었습니다 저장하시겠습니까?"))
         tr_1.Post()
  	}
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
  ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated) {
     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
        {  //저장 routine
        }   
 
   }     
}
//-------------------------------------------------------------------------------
function select_yymm()                  // 년월 선택 
//--------------------------------------------------------------------------------
{
	is_work_yymm = em_work_yymm.text.substr(0,4) + "." + em_work_yymm.text.substr(5,2)  + ".01"
   ds_1.ClearData()
   btnquery_onclick()
   
}   
//-------------------------------------------------------------------------------
function cal_attend_day()                  // 근태일수계산 
//--------------------------------------------------------------------------------
{
  		is_from = em_start_date.text
  		is_to   = em_end_date.text
  		
  		// 평일 구하기
  		ll_cnt = f_ds_select_q("ds_select3", " select count(rn.rr) select_1 " + 
  									  "   from dual, " + 
  									  "        ( select rownum rr from user_objects) rn "  +
									  "	 where rn.rr < ((to_date('" + is_to + "') ! 1) - (to_date('" + is_from + "') - 1)) " +
									  "	   and to_char((to_date('" + is_from + "') - 1) ! rn.rr, 'd') <> '7' " +
									  "	   and to_char((to_date('" + is_from + "') - 1) ! rn.rr, 'd') <> '1' ") 
		
		is_day = ds_select3.NameValue(1, "select_1")

		// 휴일 테이블중에서 토,일요일을 뺀 날짜 구하기
		ll_cnt = f_ds_select_q("ds_select4", " select count(a.holiday) select_1 " +
									  "   from 	p_attend_holiday  a		 " +
									  "  where  a.holiday between '" + is_from + "'  and '" + is_to + "'	" +
									  "    and  a.holiday_tag <> '7'	" +
									  "    and  a.holiday_tag <> '1'	" )								  													 
	   is_holiday = ds_select4.NameValue(1, "select_1")
		if (ll_cnt < 1)	is_holiday = 0	

		ds_1.NameValue(ds_1.RowPosition,"attend_day") = is_day - is_holiday
}   

//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
	if (f_reject_window()) return 
	top.frames['main_title'].mouse_over()
	
	is_work_date = f_sysdate()
	is_work_yymm = is_work_date.substr(0,7) + ".01"
	em_work_yymm.text = is_work_yymm
	
	// 연차만 등록가능
   ll_cnt = f_ds_select_q("ds_select1", " select attend_code select_1, attend_name select_2 " +
   												 "   from p_code_attend where attend_code = '01' " )
	
	is_attend_code = ds_select1.NameValue(1, "select_1")
	
	ds_seq.DataID = is_ds_seq_addr
	tr_1.Action = is_tr_1_addr

	btnquery_onclick()
}
</SCRIPT>

</HEAD>
	
<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)> // 사번컬럼값변경시 자동셋팅
  if (colid == 'emp_no') {
		
	  	ll_cnt = f_ds_select_q("ds_select", " select max(seq) select_1 from p_attend_input " +
	  													" 	where emp_no = '" + ds_1.NameValue(row,colid) + "' ")

	   if ( ds_select.NameValue(1,"select_1") == null || ds_select.NameValue(1,"select_1") == "" ){
	   	ds_1.NameValue(row,"seq") = 1
   	}
 	   else{
	   	ds_1.NameValue(row,"seq") = parseInt(ds_select.NameValue(1,"select_1"),10) + 1
	   }
  }

</script>
<script language=JavaScript for=ccom_attend_code event=onCloseUp()>  // 근태구분 변경
	is_attend_code = ccom_attend_code.CodeValue	
</SCRIPT>

<SCRIPT language=JavaScript for=em_work_yymm event=onKillFocus()>
	if (is_focus_enter == em_work_yymm.text) {   // on killfocus에서 enter를 치면 on kill focus가 발생하므로 2번 읽지않기위해서
		return
	}   
   else { 
	   is_focus_enter = em_work_yymm.text
		select_yymm()
	}
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_work_yymm event=onKeyDown(kcode,scode)>
	if (kcode == 13 ){
		is_focus_enter=em_work_yymm.text
		select_yymm()
	}
</SCRIPT>   
<SCRIPT language=JavaScript for=em_start_date event=onKillFocus()>
		if (em_end_date.text == "")
			em_end_date.text = em_start_date.text
		cal_attend_day()		
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_end_date event=onKillFocus()>
		if(em_start_date.text == ""){
			em_start_date.text = em_end_date.text
		}
		cal_attend_day()
		
</SCRIPT>  
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_select9 event=OnLoadError()>
  alert("Error Code(ds_select9) : " + ds_select9.ErrorCode + "\n" + "Error Message : " + ds_select9.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<BODY  onload=setTimeout('window_onload()',1) oncontextmenu="return false" >

<OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT>	
<Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select3
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select4
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT>
<OBJECT id=ds_select9
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT>
<OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_attend_input_shared_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<DIV id=hdept_page_1
         style="Z-INDEX: 111; LEFT: 2px; WIDTH: 165px; POSITION: absolute; TOP: 4px; HEIGHT: 27px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1" CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" >
             <td width="37%" BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="right">해당년월</div></td>
          	 <td width="63%" >
			       <OBJECT id=em_work_yymm style="WIDTH: 85px " 
					      classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
						    <PARAM NAME="Alignment" VALUE="1">
						    <PARAM NAME="IsComma" VALUE="0">
						    <PARAM NAME="MaxLength" VALUE="6">
						    <PARAM NAME="Format" VALUE="YYYY-MM">
					       <param name=ClipMode  value=false>
						    <PARAM NAME="Numeric" VALUE="0">
						    <PARAM NAME="SelectAll" VALUE="-1">
					</OBJECT>
				 	<img src="../../../image/icon/calender_on.gif"  id=img_fr OnClick="var result = gn_Cal_Yyyymmdd(); 
						if(!is_null(result)){ em_work_yymm.text = result.substr(0,8);} ; select_yymm()"
						style=" WIDTH: 20px; POSITION: absolute; TOP: 4px; HEIGHT:20px"></td>
         </tr>                 
      </table>
</DIV>      

<OBJECT id=gd_1 
    style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 465px; POSITION: absolute; TOP: 32px;
    HEIGHT: 99%" classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="0">
	<param name=SortView value="Right">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="Format" VALUE="
     <C> Name='성명'  		id=emp_name  	sort=true  width=70   suppress=1  BgColor='ffffff'  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name=''				id=resident_no	width=0    suppress=1  BgColor='ffffff'  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='부서'  		id=dept_name  	sort=true  width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='직위'  		id=grade_name 	sort=true  width=60   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='입력일시'  	id=input_date  sort=true  width=130  align=center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
	  ">
	<PARAM NAME="DataID" VALUE="ds_1"></OBJECT>
<DIV id=tab_page_1 
     style="LEFT: 470px; WIDTH: 535px; POSITION: absolute; TOP: 32px; HEIGHT: 380px; BACKGROUND-COLOR: #FFFFFF">
     <table width="100%" height="100%" border="1"  CELLSPACING="0" style="FONT-SIZE: 12px">
	      <tr BGCOLOR="white" > 
				<td width="100%" height="10%" BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=4> 
					<DIV align=center>세부내역</DIV></td>					
   	   </tr>
	     	<tr BGCOLOR="white"> 
				<td width="20%" BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
					<div align="right">사번</div></td>
				<td width="30%"> 
				  	<INPUT id=tx_emp_no size=10 >
				  	<INPUT id=bt_emp_no type=button value=" ..." onclick=bt_emp_no() ></td>						
				<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" >
					<div align="right">성명</div></td>
				<td width="30%" > 
				  	<INPUT id=tx_emp_name disabled size=10></td>
	     	</tr>	      
	     	<tr BGCOLOR="white" > 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">직위</div></td>
             <td width="80%" colspan=3> 
                  <INPUT id=tx_grade_code MAXLENGTH=100 disabled size=10 >
                  <INPUT id=tx_grade_name MAXLENGTH=100 disabled size=35 ></td>
         </tr>                 
         <tr BGCOLOR="white" > 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">부서</div></td>
             <td width="80%" colspan=3> 
		       	  <INPUT id=tx_dept_code MAXLENGTH=100 disabled size=10 >
		       	  <INPUT id=tx_dept_name MAXLENGTH=100 disabled size=35 ></td>		       	  
         </tr>                 
	     	<tr BGCOLOR="white" > 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">근태시작일</div></td>
             <td width="30%" > 
                  <OBJECT id=em_start_date 
                      style="WIDTH: 90px"
				          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
				        <param name=Format value="YYYY.MM.DD">
                    <param name=Alignment  value=1>
						  <param name=SelectAll  value=true>
                    <param name=Numeric value=false>
                    <param name=PromptChar   value=""></OBJECT></td>
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" >
					<div align="right">근태종료일</div></td>
				 <td width="30%" > 
				  	  <OBJECT id=em_end_date 
                      style="WIDTH: 90px"
				          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
				        <param name=Format value="YYYY.MM.DD">
                    <param name=Alignment  value=1>
						  <param name=SelectAll  value=true>
                    <param name=Numeric value=false>
                    <param name=PromptChar   value=""></OBJECT></td>
         </tr>                 
         <tr BGCOLOR="white"> 
				<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1 > 
					<div align="right">근태구분</div></td>
				<td width="80%"  colspan=4> 
				  	<OBJECT id=ccom_attend_code style="WIDTH: 90px; color=#CC3333"
	      	           classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	      	      <PARAM NAME="ComboDataID" VALUE="ds_select1">
	      	      <PARAM NAME="CodeCColumn" VALUE="select_1">
	      	      <PARAM NAME="DataCColumn" VALUE="select_2">
	      	      <param name=DataID     value=ds_1>
  	               <param name=CodeColumn value=attend_code>
	      	      <PARAM NAME="Enable" VALUE="-1" ></OBJECT></td>
	     	</tr>
			<tr BGCOLOR="white" > 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">일수</div></td>
             <td width="80%" colspan=3> 
                  <INPUT id=tx_attend_day   size=10  disabled ></TD>
         </tr>                 
  		   <tr BGCOLOR="white"  > 
  		   	<td width="20%" BGCOLOR="#BBE0F4" height="20%" style="COLOR: BLACK" > 
  		              <div align="right">사유</div></td>
  		      <td  BGCOLOR="#FFFFFF" style="COLOR: BLACK"  colspan=3> 
  		        <TEXTAREA id=tx_attend_reason MAXLENGTH=200  rows=6 cols=60 border="2" ></TEXTAREA></td>
  		   </tr>
      </table>
</DIV>
<object id=Bind_1 classid=CLSID:9C9AB433-EA85-11D2-A4F9-00608CEBEE49>
      <param name=DataID           value=ds_1>
      <param name=ActiveBind    value=true>
      <param name=BindInfo        value="
            <C>Col=emp_no   				Ctrl=tx_emp_no    	Param=value      Enable=Enable</C>
            <C>Col=emp_name   			Ctrl=tx_emp_name    	Param=value      Enable=Enable</C>
            <C>Col=grade_code   			Ctrl=tx_grade_code   Param=value      Enable=Enable</C>
            <C>Col=grade_name   			Ctrl=tx_grade_name   Param=value      Enable=Enable</C>
            <C>Col=dept_code				Ctrl=tx_dept_code		Param=value      Enable=Enable</C>
            <C>Col=dept_name				Ctrl=tx_dept_name		Param=value      Enable=Enable</C>
            <C>Col=start_date      		Ctrl=em_start_date          Param=text 	   Enable=Enable</C>
            <C>Col=end_date      		Ctrl=em_end_date            Param=text	      Enable=Enable</C>
            <C>Col=attend_day   			Ctrl=tx_attend_day   		 Param=value      Enable=Enable</C>
            <C>Col=attend_reason   	Ctrl=tx_attend_reason    	 Param=value      Enable=Enable</C>
      ">
</object>

</BODY></HTML>