<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : p_edu_curriculum_1h.html                   	-->
<!-- 2. 유형(시나리오): 조회 및 입력											-->
<!-- 3. 기 능 정 의   : 교육과정등록                               	-->
<!-- 4. 변 경 이 력   : 권미생 작성												-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :															   -->
<!-- *************************************************************	-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value
var is_work_date 
var is_edu_year 
var is_edu_code 
var is_sort
var il_nindex = 1 
var is_ds_1_addr = gs_home + '/general/p_web/07/p_edu_curriculum_1q.jsp'         
var is_ds_2_addr = gs_home + '/general/p_web/07/p_edu_degree_1q.jsp?arg_edu_year='         
var is_ds_3_addr = gs_home + '/general/p_web/07/p_edu_subject_1q.jsp?arg_edu_year='         
var is_tr_1_addr = gs_home + '/general/p_web/07/p_edu_curriculum_1tr.jsp'
var is_tr_2_addr = gs_home + '/general/p_web/07/p_edu_degree_1tr.jsp'
var is_tr_3_addr = gs_home + '/general/p_web/07/p_edu_subject_1tr.jsp'

var is_ds_seq_addr = gs_home + '/general/p_web/99/p_spec_unq_no_1q.jsp'  
var il_screen = 0
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
  if (il_screen == 0) {
     ds_1.DataID = is_ds_1_addr
     ds_1.SyncLoad=true
     ds_1.Reset()  
  }
  if (il_screen == 1)
     setTimeout("div_btnquery_onclick()",0.1)
     
  if (il_screen == 2)
     setTimeout("div_btnquery_onclick()",0.1)

  is_edu_code = ds_1.NameValue(ds_1.RowPosition,"edu_code")

  if (ds_1.CountRow < 1){
  	  btnadd_onclick() 
  	  ds_2.ClearData()
  	  ds_3.ClearData()  	  
  }

}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
  if	(il_nindex == 2 ){
  		ds_2.DataID = is_ds_2_addr + is_edu_year + "&arg_edu_code="  +  is_edu_code
  		ds_2.SyncLoad = true
  		ds_2.Reset()
  		
  		if (ds_2.CountRow < 1)
		  	ds_3.ClearData()
  }
}
//------------------------------------------------------------------------
function div2_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
  if	(il_nindex == 2 ){
  		ds_3.DataID = is_ds_3_addr + is_edu_year + "&arg_edu_code="  +  is_edu_code +
  						  "&arg_edu_degree="  +  is_edu_degree
  		ds_3.SyncLoad = true
  		ds_3.Reset()
  }
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	if	(il_nindex == 1 ){
		gd_1.Focus();
		gd_1.SetColumn("edu_name");
   }		
	if	(il_nindex == 2 ){
		if (il_screen == 1) {
			gd_2.Focus();
			gd_2.SetColumn("start_date");
		}
		else{
			gd_3.Focus();
			gd_3.SetColumn("subject");
		}
	}
} 
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{

	is_edu_code = ds_1.NameValue(ds_1.RowPosition,"edu_code")
	
	if	(il_nindex == 2 ){
		if (il_screen == 1){
			ds_2.NameValue(ds_2.RowPosition,"edu_year") = is_edu_year
			ds_2.NameValue(ds_2.RowPosition,"edu_code") = is_edu_code
	      ds_2.NameValue(ds_2.RowPosition,"edu_degree") = ds_2.NameMax('edu_degree',0,0) + 1 
	      is_edu_degree = ds_2.NameValue(ds_2.RowPosition,"edu_degree") 

	   }
	   else{
			ds_3.NameValue(ds_3.RowPosition,"edu_year") = ds_2.NameValue(ds_2.RowPosition,"edu_year")
			ds_3.NameValue(ds_3.RowPosition,"edu_code") = ds_2.NameValue(ds_2.RowPosition,"edu_code")
	      ds_3.NameValue(ds_3.RowPosition,"edu_degree") = ds_2.NameValue(ds_2.RowPosition,"edu_degree")  
	      ds_3.NameValue(ds_3.RowPosition,"no_seq") = ds_3.RowPosition  
	      
			ds_seq.SyncLoad=true;              // spec_no_seq 구하기
			ds_seq.reset()
			ds_3.NameValue(ds_3.RowPosition,"spec_no_seq") = ds_seq.NameValue(1,"nextval")
		}
	}
	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function inst_no_find()                       // 강사찾기 팝업
//------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();

	send_arg = is_edu_year + '@' + ds_3.NameValue(ds_3.RowPosition,"inst_no")
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_instructor_no_find_1h.html",send_arg,"dialogWidth:500px;dialogHeight:500px");
	
	if(result == "") return;
	
	array = result.split("@");
	ds_3.NameValue(ds_3.RowPosition,"inst_no") = array[0]
	ds_3.NameValue(ds_3.RowPosition,"inst_name") = array[1]
	
}	
//-----------------------------------------------------------------------
function inst_no_name()                       // 강사 사번/성명 가져오기 
//------------------------------------------------------------------------
{
	  ll_cnt = f_ds_select_q("ds_select4", "select a.inst_no select_1, b.inst_name select_2 " +
	 	                                     " 	from p_edu_instructor a, p_edu_instructor b " +
	 	                                     "	where a.inst_no = b.inst_no " + 
	 	                                     "   and a.edu_year = '" + is_edu_year + "' " +
	 	                                     "   and a.inst_no = '" + is_inst_no + "' " ) 
	 if (ll_cnt < 1 ){
	 	 inst_no_find()
	 }
	 else{
	    ds_3.NameValue(ds_3.RowPosition,'inst_no')   = ds_select4.NameValue(ds_select4.RowPosition,"select_1")
		 ds_3.NameValue(ds_3.RowPosition,'inst_name') = ds_select4.NameValue(ds_select4.RowPosition,"select_2")
	 }	
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
  if	(il_nindex == 1 || il_screen == 0){
     ds_1.AddRow()
     ccom_io_tag.codevalue = '1'
	  return
  }     
  
  if (il_screen == 2) {
     if (ds_1.IsUpdated || ds_2.IsUpdated ) {
        if (ds_1.IsUpdated) il_screen = 0
        if (ds_2.IsUpdated) il_screen = 1
        alert("저장을 먼저 하십시요")
        return
     }   
  }
  
  if	(il_nindex == 2 ){
  	  if (ds_1.CountRow < 1 ){
  			alert("교육과정이 없으므로 작성이 불가능 합니다.")
  			return
  	  }
     if (il_screen == 1)
     	  ds_2.AddRow()
     else
        ds_3.AddRow()
  }     
  init_move()
}
//----------------------------------------------------------------------- 
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
  if	(il_nindex == 1 || il_screen == 0){
     if (ds_1.CountRow < 1)
        ds_1.AddRow()
     else
        ds_1.InsertRow(ds_1.RowPosition)
        
     ccom_io_tag.codevalue = '1'
     return
  }     
  
  if (il_screen == 2) {
     if (ds_1.IsUpdated || ds_2.IsUpdated ) {
        if (ds_1.IsUpdated) il_screen = 0
        if (ds_2.IsUpdated) il_screen = 1
        alert("저장을 먼저 하십시요")
        return
     }   
  }

  if	(il_nindex == 2 ){
	  if (ds_1.CountRow < 1 ){
  			alert("교육과정이 없으므로 작성이 불가능 합니다.")
  			return
  	  }
  	  if (il_screen == 1)
     	  ds_2.InsertRow(ds_2.RowPosition)
     else
        ds_3.InsertRow(ds_3.RowPosition)
  }     
  init_move()
}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
  if  (il_screen == 1) {
    if (ds_3.IsUpdated) {
       il_screen = 2
       alert("과목 화면을 먼저 저장하십시요")
       return
    }   
  }

  var ll_cnt
  if	(il_nindex == 1 || il_screen == 0){
      ll_cnt = f_ds_select_q("ds_check"," select count(*) select_1 from p_edu_degree where edu_year = '" + is_edu_year + "' " + 
                                        " and edu_code = '" + is_edu_code + "' ")
      ll_cnt = ds_check.NameValue(1,"select_1")
      if (ll_cnt > 0) {
         alert('교육차수가 존재하므로 삭제할 수 없습니다')
         return
      }                                           
		ds_1.DeleteRow(ds_1.RowPosition)
  }     

  if	(il_nindex == 2 ){
  		if (il_screen == 1){
         if (ds_3.CountRow > 0) {
            alert('교육과목이 존재하므로 삭제할수 없습니다')
            return
         }
			ds_2.DeleteRow(ds_2.RowPosition)
		}
		else{
			if (gd_3.MultiRowSelect){               // multi row select 일 경우
			   for (i=ds_3.CountRow ;i > 0 ;i--) {
			       if (ds_3.RowMark(i) == 1)
			       	  ds_3.DeleteRow(i)
			   }   
			   ds_3.MarkRows(ds_3.RowPosition,ds_3.RowPosition)  //삭제작업완료후 MARK
			}
			else{ 
			ds_3.DeleteRow(ds_3.RowPosition)
		  	}
	  }
  }     

}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
  if	(il_nindex == 1 || il_screen == 0){
	  if (ds_1.IsUpdated){
		 var ll_dup
		 ll_dup = f_dup_chk("ds_1","edu_code")
		 if (ll_dup > 0) {
		     alert("교육과정이 중복되었습니다: 수정하십시요 ")
		     ds_1.RowPosition = ll_dup
		     return false
		 }
		 else{
	    	if (confirm("변경되었습니다 저장하시겠습니까?"))
	    		tr_1.Post()
	    }
	  }
  }

  if	(il_nindex == 2 ){
  	  if (il_screen == 1) {
		  if (ds_2.IsUpdated){
			 var ll_dup
			 ll_dup = f_dup_chk("ds_2","edu_degree")
			 if (ll_dup > 0) {
			     alert("차수가 중복되었습니다: 수정하십시요 ")
			     ds_2.RowPosition = ll_dup
			     return false
			 }
			 // 날짜포맷에 맞는지 체크
			 var ls_val
			 for (i=1 ;i<=ds_2.CountRow ;i++){
			 	if (ds_2.RowStatus(i) == 1 || ds_2.RowStatus(i) == 3){
					ls_val = ds_2.NameValue(i,'start_date')
					if (ls_val != '' && f_check_date(ls_val) == false){
				   	alert('교육시작일이 날짜 형식에 맞지 않습니다')
				   	ds_2.RowPosition = i
				   	gd_2.SetColumn('start_date')
				     	return false
				  	}
				  	ls_val = ds_2.NameValue(i,'end_date')
				  	if (ls_val != '' && f_check_date(ls_val) == false){
				   	alert('교육 종료일이 날짜 형식에 맞지 않습니다')
				   	ds_2.RowPosition = i
				   	gd_2.SetColumn('end_date')
				     	return false
				  	}		  	
				}
			 }
			 
			 
			 // 종료일자가 시작일자보다 반드시 크거나 같아야하는 로직 체크 
          var ll_ret_row
          ll_ret_row = gf_gd_start_end_date('ds_2','start_date','end_date')
			 if (ll_ret_row > 0)  {
			    alert('교육 종료일자가 교육시작일자보다 반드시 커야합니다')
			    gd_2.Focus()
			    gd_2.SetColumn('end_date')
			    ds_2.RowPosition = ll_ret_row
			    return false
			 }   
			 
		    if  (confirm("변경되었습니다 저장하시겠습니까?"))
		        tr_2.Post()
		  }
	  }
	  else{
	  		if (ds_3.IsUpdated){
				if (confirm("변경되었습니다 저장하시겠습니까?"))
				   tr_3.Post()
			}
	  }
  }
  return true
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	if	(il_nindex == 1 ){
     ds_1.Undo(ds_1.RowPosition)
   }
   if	(il_nindex == 2 ){
		if (il_screen == 1) {
			ds_2.Undo(ds_2.RowPosition)
			return
		}
		ds_3.Undo(ds_3.RowPosition)
	}
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated || ds_2.IsUpdated || ds_3.IsUpdated){
			btnsave_onclick() 
	  }
}
//---------------------------------------------------------------------
function tab_changed()
//---------------------------------------------------------------------
{
	if (il_nindex == 3){
		degree_reset()
	}  														 
   setTimeout("div_btnquery_onclick()",0.1)
}
//-------------------------------------------------------------------------------
function select_yymm()                  // 년월 선택 
//--------------------------------------------------------------------------------
{
   is_edu_year = em_select_date.text.substr(0,4) + '.01.01'
   setTimeout("div_btnquery_onclick()",0.1)
}
//-------------------------------------------------------------------------------
function cal_day()                  	// 일수계산 
//--------------------------------------------------------------------------------
{
	var ls_start, ls_end
	
  	ls_start = ds_2.NameValue(ds_2.RowPosition,"start_date")
  	ls_end   = ds_2.NameValue(ds_2.RowPosition,"end_date")
  	
  	ll_cnt = f_ds_select_q("ds_select5", " select count(rn.rr) select_1 " + 
  								  "  from dual, " + 
  								  "       ( select rownum rr from user_objects) rn "  +
								  " where rn.rr < ((to_date('" + ls_end + "') ! 1) - (to_date('" + ls_start + "') - 1)) " +
								  "   and to_char((to_date('" + ls_start + "') - 1) ! rn.rr, 'd') <> '7' " +
								  "   and to_char((to_date('" + ls_start + "') - 1) ! rn.rr, 'd') <> '1' ") 
	
	ds_2.NameValue(ds_2.RowPosition,"edu_day") = ds_select5.NameValue(1, "select_1")
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()

  is_work_date = f_sysdate()
  em_select_date.text = is_work_date.substr(0,4) 
  is_edu_year = is_work_date.substr(0,4) + '.01.01'

  is_edu_code = ds_1.NameValue(ds_1.RowPosition,"edu_code")

  ll_cnt = f_ds_select_q("ds_select","select edu_part_code select_1, edu_part_name select_2 from p_code_edu_part") // 교육분야 코드
  ll_cnt = f_ds_select_q("ds_select1","select edu_office_code select_1, edu_office_name select_2 from p_code_edu_office") // 교육기관 코드
  ll_cnt = f_ds_select_q("ds_select2","select grade_code select_1, grade_name select_2 from p_code_grade")   // 대상직위 코드
 
  tr_1.Action = is_tr_1_addr
  tr_2.Action = is_tr_2_addr
  tr_3.Action = is_tr_3_addr
  ds_seq.DataID = is_ds_seq_addr
	
  setTimeout("btnquery_onclick()",0.1)
}
//---------------------------------------------------------------------
function get_focus(focus)   // 각각의 gd에 focus를 부여함.
//---------------------------------------------------------------------
{
	il_screen = focus
}
</SCRIPT>

</HEAD>
<script language=JavaScript for=gd_1 event=OnClick(row,colid)>
  if (row == 0) {
  		if (is_sort == "+" + colid)
   	  ds_1.SortExpr = "-" + colid;
  	   else
   	  ds_1.SortExpr = "+" + colid;
   	  
  	  is_sort = ds_1.SortExpr;
  	  ds_1.Sort();
  }   
</SCRIPT>
<SCRIPT language=JavaScript event=OnSelChanged(nIndex) for=tb_1>
  il_nindex = nIndex
  tab_changed()
</SCRIPT>
<SCRIPT language=JavaScript event=CanSelChange(nIndex) for=tb_1>
{
  var ret
  il_nindex = nIndex
  ret = btnsave_onclick()
  return ret
} 
</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>

   is_edu_code = ds_1.NameValue(ds_1.RowPosition,"edu_code")

	if (row < 1) return
	if (il_nindex == 2){   // 교육차수 재조회
		setTimeout("div_btnquery_onclick()",0.1)
	}		
</script>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_2>

   is_edu_degree = ds_2.NameValue(ds_2.RowPosition,"edu_degree")

	if (row < 1) return
	if (il_nindex == 2){   // 교육차수 재조회
		setTimeout("div2_btnquery_onclick()",0.1)
	}		
</script>
<SCRIPT language="javascript" for=gd_3 event=OnPopup(row,colid,data)>
	inst_no_find()
</SCRIPT>
<script language=JavaScript for=ds_3 event=OnColumnChanged(row,colid)>
  if (colid == 'inst_no') {
  	  is_inst_no = ds_3.NameValue(row, 'inst_no')
	  inst_no_name()
	}
</script>
<SCRIPT language=JavaScript for=em_select_date event=onKillFocus()>
	select_yymm()		
</SCRIPT> 
<SCRIPT language=JavaScript for=em_select_date event=onKeyDown(kcode,scode)>
   if (kcode == 13){ 
	   select_yymm()
	}
</SCRIPT> 
<script language=JavaScript for=ds_2 event=OnColumnChanged(row,colid)>
	if (colid == 'start_date' || colid == 'end_date') {
		if(ds_2.NameValue(row,"end_date") == "")
			ds_2.NameValue(row,"end_date") = ds_2.NameValue(row,"start_date")
		if(ds_2.NameValue(row,"start_date") == "")
			ds_2.NameValue(row,"start_date") = ds_2.NameValue(row,"end_date")
		cal_day()	// 교육일수 계산
	}
</SCRIPT>  
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("Error Code : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
  alert("Error Code : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_3.ErrorMsg + "\n");
</SCRIPT>
<BODY  onload=setTimeout('window_onload()',1) oncontextmenu="return false" >

<OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_2
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_3
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT>	
<OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
</OBJECT>
<Object id=ds_check
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select3
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select4
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<Object id=ds_select5
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_edu_curriculum_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_2
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_edu_degree_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_3
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_edu_subject_1tr=ds_3)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>

<OBJECT id=gd_1 onfocus="get_focus(0)"
    style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 330px; POSITION: absolute; TOP: 10px;
    HEIGHT: 102%" classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="0">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="0">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="Format" VALUE="
     <C> Name='코드'  id=edu_code  width=40  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='교육과정'  id=edu_name  width=240  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
	  ">
	<PARAM NAME="DataID" VALUE="ds_1"></OBJECT>
<OBJECT id=tb_1 
    style="FONT-SIZE: 12px; Z-INDEX: 106; LEFT:335px; WIDTH: 600px; POSITION: absolute; TOP: 9px; HEIGHT: 20px"  
    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
  <param name="BackColor"  value="#BBE0F4">
  <param name="TextColor"  value="BLACK">
  <PARAM NAME="Format" VALUE="
    <T>divid=tab_page_1 title='교육과정'</T>
    <T>divid=tab_page_2 title='교육차수'</T>
    "></OBJECT>
<DIV id=tab_page_1 
     style="LEFT: 335px; WIDTH: 650px; POSITION: absolute; TOP: 30px; HEIGHT: 450px; BACKGROUND-COLOR: #FFFFFF">
     <table width="100%" height="100%" border="1"  CELLSPACING="0" style="FONT-SIZE: 12px">
   	   <tr BGCOLOR="white"> 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">교육과정코드</div></td>
             <td width="30%" > 
                 <INPUT id=tx_edu_code MAXLENGTH=6 size=15></td></td>
				<td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">교육과정명칭</div></td>
             <td width="30%" > 
                 <INPUT id=tx_edu_name MAXLENGTH=50 size=25></td></td>
	     	</tr>	      
   	   <tr BGCOLOR="white"> 
				<td width="20%" BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
					<div align="right">교육분야</div></td>
				<td width="30%"> 
				  	<OBJECT id=ccom_edu_part_code style="WIDTH: 187px; color=#CC3333"
	      	           classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	      	      <PARAM NAME="ComboDataID" VALUE="ds_select">
	      	      <PARAM NAME="CodeCColumn" VALUE="select_1">
	      	      <PARAM NAME="DataCColumn" VALUE="select_2">
	      	      <param name=DataID     value=ds_1>
	      	      <param name=CodeColumn value=edu_part_code>
	      	      <PARAM NAME="Enable" VALUE="-1" ></OBJECT></td>
				<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1 > 
					<div align="right">교육기관</div></td>
				<td width="30%"  colspan=4> 
				  	<OBJECT id=ccom_edu_office_code style="WIDTH: 187px; color=#CC3333"
	      	           classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	      	      <PARAM NAME="ComboDataID" VALUE="ds_select1">
	      	      <PARAM NAME="CodeCColumn" VALUE="select_1">
	      	      <PARAM NAME="DataCColumn" VALUE="select_2">
	      	      <param name=DataID     value=ds_1>
	      	      <param name=CodeColumn value=edu_office_code>
	      	      <PARAM NAME="Enable" VALUE="-1" ></OBJECT></td>	      	                    
	     	</tr>	      
	     	<tr BGCOLOR="white"> 
				<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" >
					<div align="right">사내외구분</div></td>
				<td width="30%" > 
					<OBJECT id=ccom_io_tag
						style="WIDTH: 187px; " 
						classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
						<param name=Data     value="1^사내,2^사외">
						<param name=DataID     value=ds_1>
            	   <param name=Auto       value=true>
            	   <param name=CodeColumn value=io_tag>
	          		<PARAM NAME="Enable" VALUE="-1"></OBJECT></td>
            <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">교육대상</div></td>
            <td width="30%" colspan=3> 
                  <INPUT id=tx_grade MAXLENGTH=100  size=25 ></td>
	     	</tr>
	     	<tr BGCOLOR="white" > 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">교육목적</div></td>
             <td width="80%" colspan=3> 
                  <TEXTAREA id=tx_edu_object MAXLENGTH=2000 rows=11 cols=72 border="2" ></TEXTAREA></td>
         </tr>                 
         <tr BGCOLOR="white" > 
             <td width="20%"  BGCOLOR="#BBE0F4"  style="COLOR: BLACK"  > 
                 <div align="right">교육내용</div></td>
             <td width="80%" colspan=3> 
                  <TEXTAREA id=tx_edu_remark MAXLENGTH=2000 rows=11 cols=72 border="2" ></TEXTAREA></td>
         </tr>                 
      </table>
</DIV>
<DIV id=tab_page_2 
     style="LEFT: 335px; WIDTH: 650px; POSITION: absolute; TOP: 30px; HEIGHT: 580px; BACKGROUND-COLOR: #FFFFFF">
     <table width="100%" height="5%"  BORDER="1" align="left"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" >
             <td  BGCOLOR="#BBE0F4" style="COLOR: BLACK" width="8%"> 
                 <div align="left">&nbsp교육년도</div></td>
          	 <td width="80%">
			     	  <OBJECT id=em_select_date style="WIDTH: 80px " 
					      classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
						    <PARAM NAME="Alignment" VALUE="1">
						    <PARAM NAME="IsComma" VALUE="0">
						    <PARAM NAME="MaxLength" VALUE="4">
						    <PARAM NAME="Format" VALUE="YYYY">
					       <param name=ClipMode  value=false>
						    <PARAM NAME="Numeric" VALUE="0">
						    <PARAM NAME="SelectAll" VALUE="-1">
					</OBJECT>
				 	<img src="../../../image/icon/calender_on.gif"  id=img_fr OnClick="var result = gn_Cal_Yyyymmdd(); 
						if(!is_null(result)){ em_select_date.text = result.substr(0,4);} ; select_yymm()"
						style=" WIDTH: 20px; POSITION: absolute; TOP: 4px; HEIGHT:20px"></td>
         </tr>                 
      </table>
   <OBJECT id=gd_2 onfocus="get_focus(1)"
       style="Z-INDEX: 110; LEFT: 0px; WIDTH: 650px; POSITION: absolute; TOP: 30px; HEIGHT: 379px;FONT-SIZE: 12px" 
        classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	   <PARAM NAME="MultiRowSelect" VALUE="0">
	   <PARAM NAME="AutoInsert" VALUE="-1">
      <PARAM NAME="BorderStyle"  VALUE=4>
	   <PARAM NAME="AllShowEdit" VALUE="-1">
	   <PARAM NAME="Editable" VALUE="-1">
	   <PARAM NAME="ColSizing" VALUE="-1">
      <PARAM NAME="Format" VALUE="
  	  <C> Name='차수'  id=edu_degree Edit=None width=50 align=center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='교육시작일'  id=start_date align=center width=90  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='교육종료일'  id=end_date align=center  width=90  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='교육일수'  id=edu_day  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='교육시간'  id=edu_time  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='교육인원'  id=edu_person width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
	  <C> Name='교육장소'  id=edu_place  width=170  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	    ">
	   <PARAM NAME="DataID" VALUE="ds_2"></OBJECT>
	<OBJECT id=gd_3 onfocus="get_focus(2)"
       style="Z-INDEX: 110; LEFT: 0px; WIDTH: 650px; POSITION: absolute; TOP: 410px; HEIGHT: 31%	;FONT-SIZE: 12px" 
        classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	   <PARAM NAME="MultiRowSelect" VALUE="-1">
	   <PARAM NAME="AutoInsert" VALUE="-1">
      <PARAM NAME="BorderStyle"  VALUE=4>
	   <PARAM NAME="AllShowEdit" VALUE="-1">
	   <PARAM NAME="Editable" VALUE="-1">
	   <PARAM NAME="ColSizing" VALUE="-1">
      <PARAM NAME="Format" VALUE="
  	  <C> Name='순번'  id=no_seq width=50 align=center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='교육과목'  id=subject width=300  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='강사번호'  id=inst_no EditStyle=Popup width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  	  <C> Name='강사성명'  id=inst_name Edit=none width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
	    ">
	   <PARAM NAME="DataID" VALUE="ds_3"></OBJECT>
</DIV>

<object id=Bind_1 classid=CLSID:9C9AB433-EA85-11D2-A4F9-00608CEBEE49>
      <param name=DataID           value=ds_1>
      <param name=ActiveBind    value=true>
      <param name=BindInfo        value="
            <C>Col=edu_code            	Ctrl=tx_edu_code            Param=value      Enable=Enable</C>
            <C>Col=edu_name            	Ctrl=tx_edu_name            Param=value      Enable=Enable</C>
            <C>Col=level_year   	   		Ctrl=tx_level_year   		 Param=value      Enable=Enable</C>
            <C>Col=grade		     			Ctrl=tx_grade		          Param=value      Enable=Enable</C>
            <C>Col=edu_object        	   Ctrl=tx_edu_object          Param=value      Enable=Enable</C>
            <C>Col=edu_remark      			Ctrl=tx_edu_remark          Param=Value      Enable=Enable</C>
      ">
</object>

</BODY></HTML>