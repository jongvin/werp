<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : p_order_master_1h.html                       	-->
<!-- 2. 유형(시나리오): 조회및 입력											      -->
<!-- 3. 기 능 정 의   : 인사발령등록		                              -->
<!-- 4. 변 경 이 력   : 장희선 작성												   -->
<!-- 5. 관련프로그램  :																   -->
<!-- 6. 특 기 사 항   :															      -->
<!-- *************************************************************		-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value
var is_work_date 
var is_work_year 
var is_ds_1_addr = gs_home + '/general/p_web/04/p_order_master_1q.jsp?arg_order_no='   //발령마스터
var is_tr_1_addr = gs_home + '/general/p_web/04/p_order_master_1tr.jsp'             	//발령마스터
var is_ds_2_addr = gs_home + '/general/p_web/04/p_order_empno_1q.jsp?arg_emp_no='   	//인사마스터
var is_ds_seq_addr = gs_home + '/general/p_web/99/p_spec_unq_no_1q.jsp'  					//spec_no_seq
var is_ds_3_addr = gs_home + '/general/p_web/04/p_order_add_dept_1q.jsp?arg_emp_no='   //겸직부서
var is_tr_3_addr = gs_home + '/general/p_web/04/p_order_add_dept_1tr.jsp'   				//겸직부서 
var is_ds_4_addr = gs_home + '/general/p_web/04/p_order_pers_master_1q.jsp?arg_order_no=' //발령확정
var is_tr_4_addr = gs_home + '/general/p_web/04/p_order_pers_master_1tr.jsp'   				//발령확정
var is_ds_5_addr = gs_home + '/general/p_web/04/p_order_pers_master_2q.jsp?arg_order_no=' //발령취소
var is_tr_5_addr = gs_home + '/general/p_web/04/p_order_pers_master_2tr.jsp'   				//발령취소

var is_order_comp, is_order_year, il_order_no_row	//닫기후 발령문서화면을 띄울때 이전조건으로 셋팅하기 위함
var is_order_comp_name	//발령품의서에 표기
var is_order_no
var is_emp_no
var is_master_emp_no		//인사마스터에서 화면을 띄웠을경우 갖고있는 사번
var is_service_div_code	//인사마스터에서 화면을 띄웠을경우 갖고있는 재직구분
var is_spec_no_seq
var is_order_title
var is_html
var is_init = 'Y'		// 처음 한번만 조회
var il_screen = 1
var is_paystep
var is_grade
var is_obj_tag			// 정기승호자로 등록시는 'Y', 추가하여 등록시는 'N'
var is_row_pos='N'	// 추가하면 RowPosition이 변경되었을 때 하위조회를 안함
var is_last_tag		// 최종발령일 경우 'Y', 아닌 경우 'N'
var is_confirm_tag	// 발령확정시는 '1', 발령취소시는 '2'로 셋팅
var is_save_sw='N' 	// 발령확정및 취소일경우 'Y'로 셋팅 
var is_moving_tag='N'	// 전입자료생성 성공시 'Y'로 셋팅
var is_format_1
var is_format_2
is_format_1 ="<C> Name='확정'  id=ok_tag align=center EditStyle=CheckBox width=32  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "+
     "<C> Name='순번'  id=seq Edit=None align=center  width=40  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "+
	  "<C> Name='사번'  id=emp_no  Edit=None  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  "+
     "		SumText='인원수'  SumColor=Black SumBgColor=Pink </C> " +
     "<C> Name='성명'  id=emp_name Edit=None  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  "+
     "		SumText=@count          SumColor=Black SumBgColor=Pink </C>	" +
     "<C> Name='발령종류'  id=order_code Edit=None  width=90 EditStyle=Lookup Data='ds_select1:select_1:select_2' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "+
     "<C> Name='구분'  id=confirm_tag  Edit=None EditStyle=Combo Data='1:확정,2:취소,3:' '' width=40  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "

is_format_2 ="<C> Name='순번'  id=seq Edit=None align=center  width=40  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "+
     "<C> Name='사번'  id=emp_no  Edit=None  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   "+
     "		SumText='인원수'  SumColor=Black SumBgColor=Pink </C> " +
     "<C> Name='성명'  id=emp_name Edit=None  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK "+
     "		SumText=@count          SumColor=Black SumBgColor=Pink </C>	" +
     "<C> Name='발령종류'  id=order_code Edit=None  width=90 EditStyle=Lookup Data='ds_select1:select_1:select_2' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "+
     "<C> Name='구분'  id=confirm_tag  Edit=None EditStyle=Combo Data='1:확정,2:취소,3:' '' width=40  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK SumColor=Black SumBgColor=Pink </C> "

//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	
	ds_1.DataID = is_ds_1_addr + is_order_no
	ds_1.SyncLoad=true
	ds_1.Reset()
	
	if (is_master_emp_no != ''){	//인사마스터에서 띄운 경우 해당 로우로 포커스 이동
		gd_1.Focus()
		ds_1.RowPosition = ds_1.NameValueRow('emp_no',is_master_emp_no)		
		gd_1.SetColumn('emp_name')
	}
	
	ds_seq.DataID = is_ds_seq_addr

	if (ds_1.CountRow < 1){
		ds_3.ClearData()
		if (is_last_tag == 'Y') {	//결재완료되거나 최종발령이 아닌 경우 수정 못함
			btnadd_onclick()
			return
		}
	}
}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
	if (ds_1.CountRow < 1) {
		ds_2.ClearData()	
		return
	}
	
		is_emp_no = ds_1.NameValue(ds_1.RowPosition,'emp_no')
		is_spec_no_seq = ds_1.NameValue(ds_1.RowPosition,'spec_no_seq')
	
		ds_3.DataID   = is_ds_3_addr + is_emp_no + "&arg_spec_no_seq=" + is_spec_no_seq
		ds_3.SyncLoad = true
		ds_3.Reset()	
		
		if (is_last_tag == 'N') {	//결재완료되거나 최종발령이 아닌 경우 수정 못함
			gf_protect_on('tab_page_input')
			bt_emp_no_1.disabled=1
			bt_dept_code_1.disabled=1
			bt_work_dept_code_1.disabled=1
			bt_cost_dept_code_1.disabled=1
		}
		
		if (ds_3.CountRow < 1 )
			add_dept_insert()
	
}
//---------------------------------------------------------------------
function tab_changed()
//---------------------------------------------------------------------
{
	setTimeout("div_btnquery_onclick()",0.5)
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	
	ds_seq.SyncLoad=true;              // seq no 구하기
	ds_seq.reset()
	ds_1.NameValue(ds_1.RowPosition,"spec_no_seq") = ds_seq.NameValue(1,"nextval")
	ds_1.NameValue(ds_1.RowPosition,"seq") = ds_1.NameMax("seq",0,0) + 1
	ds_1.NameValue(ds_1.RowPosition,"ok_tag") = 'F' 
	ds_1.NameValue(ds_1.RowPosition,"order_no")		 = is_order_no
   ds_1.NameValue(ds_1.RowPosition,"input_date") 	 = is_work_date	 
   em_apply_order_date.text	= is_work_date
	ds_1.NameValue(ds_1.RowPosition,"confirm_tag") = 3
	
}  
//-----------------------------------------------------------------------
function div_init_move()               // 하위초기값세팅
//-----------------------------------------------------------------------
{
   ds_3.NameValue(ds_3.RowPosition,"emp_no") = ds_1.NameValue(ds_1.RowPosition, "emp_no")
   ds_3.NameValue(ds_3.RowPosition,"spec_no_seq") = ds_1.NameValue(ds_1.RowPosition, "spec_no_seq")
   ds_3.NameValue(ds_3.RowPosition, "seq") = ds_3.NameMax("seq",0,0) + 1
   ds_3.NameValue(ds_3.RowPosition, "cancel_tag") = 'F'
   
	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   					// 커서위치 세팅
//-----------------------------------------------------------------------
{
	if (il_screen > 1){
		gd_2.Focus()
		gd_2.SetColumn("add_dept_code")
	}   	
} 
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	if (il_screen > 1){
		div_btnadd_onclick()
	}   
	else{	
		ds_1.AddRow()
		bt_emp_no()			//사번찾기	
//		add_dept_insert()	
	}
}
//-----------------------------------------------------------------------
function div_btnadd_onclick()                       // 하위추가 
//------------------------------------------------------------------------
{
	 if (ds_1.NameValue(ds_1.RowPosition,"confirm_tag") == '1'){
	 	alert('확정된 발령이므로 수정할 수 없습니다.')
	 	return
	 }
	 
	 ds_3.AddRow()
	 div_init_move()	 
}

//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	if (il_screen > 1){
		div_btninsert_onclick()
	}   
	else{	
 		if (ds_1.RowPosition == 0){     //한건도 없을경우는  0 
 		  btnadd_onclick()
 		  return
 		}  
 		ds_1.InsertRow(ds_1.RowPosition)
 		bt_emp_no()	//사번찾기
	}	
}
//-----------------------------------------------------------------------
function div_btninsert_onclick()                    // 하위삽입
//-----------------------------------------------------------------------
{
	if (ds_1.NameValue(ds_1.RowPosition,"confirm_tag") == '1'){
	 	alert('확정된 발령이므로 수정할 수 없습니다.')
	 	return
	}
	 
 	if (ds_3.RowPosition == 0){     //한건도 없을경우는  0 
 	  btnadd_onclick()
 	  return
 	}  
 	ds_3.InsertRow(ds_3.RowPosition)
 	div_init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	if (il_screen > 1){
		div_btndelete_onclick()
	}   
	else{
		if (ds_1.NameValue(ds_1.RowPosition,"confirm_tag") == '1') {
			alert('확정된 발령입니다:삭제하시려면 발령을 취소하십시오.')
			return
		}
		
		if (ds_3.CountRow > 0) {
			alert('겸직부서를 먼저 삭제하십시오.')
			return
		}
		
		if  (gd_1.MultiRowSelect){               // multi row select 일 경우
		   for (i=ds_1.CountRow ;i >0 ;i--)
		   {
		      if (ds_1.RowMark(i) == 1)
		             ds_1.DeleteRow(i)
		  }   
		  ds_1.MarkRows(ds_1.RowPosition,ds_1.RowPosition)  //삭제작업완료후 MARK
		 } 
		else
		   ds_1.DeleteRow(ds_1.RowPosition)  
 	}
}
//------------------------------------------------------------------------
function div_btndelete_onclick()                    // 하위삭제 
//------------------------------------------------------------------------
{
	if (ds_1.NameValue(ds_1.RowPosition,"confirm_tag") == '1') {
		alert('확정된 발령이므로 삭제할 수 없습니다.')
		return
	}
	
	if  (gd_2.MultiRowSelect){               // multi row select 일 경우
	   for (i=ds_3.CountRow ;i >0 ;i--)
	   {
	      if (ds_3.RowMark(i) == 1)
	             ds_3.DeleteRow(i)
	  }   
	  ds_3.MarkRows(ds_3.RowPosition,ds_3.RowPosition)  //삭제작업완료후 MARK
	 } 
	else
	   ds_3.DeleteRow(ds_3.RowPosition)  
 
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	
   if (ds_1.IsUpdated){
     if  (is_save_sw == 'Y') {}
  	  else
  	   	if (confirm("변경되었습니다 저장하시겠습니까?")) {}
 			else return false
 		
	 		// 현재 조직의 차수를 구하기
	 		ll_cnt = f_ds_select_q("ds_select10","select max(degree) select_1 from z_code_dept_degree")
			if (ll_cnt < 1){
				alert('조직정보가 한건도 없습니다.')
				return false
			}
			
	 		var i
	 		for (i=1;i<=ds_1.CountRow;i++) {
	 		   if (ds_1.RowStatus(i) == 1 || ds_1.RowStatus(i) == 3){
		 		   ls_val = ds_1.NameValue(i,'apply_order_date')
					if (ls_val != '' && f_check_date(ls_val) == false){
				   	alert('적용발령일이 날짜 형식에 맞지 않습니다')
				   	ds_1.RowPosition = i
				   	gd_1.SetColumn('apply_order_date')
				     	return false
				  	}
				}
				
	 		   if (ds_1.NameValue(i, "order_code") == "" || ds_1.NameValue(i, "order_code") == null){
		 			alert('발령코드는 필수 입력사항입니다.')
		 			ds_1.RowPosition = i
		 			ccom_order_code.Focus()
		 			return
	 			}
	 			
	 			if (ds_1.NameValue(i, "comp_code") == "" || ds_1.NameValue(i, "comp_code") == null){
		 			alert('사업체코드는 필수 입력사항입니다.')
		 			ds_1.RowPosition = i
		 			ccom_comp_code.Focus()
		 			return
	 			}
	 			
	 			if (ds_1.NameValue(i, "dept_code") == "" || ds_1.NameValue(i, "dept_code") == null){
		 			alert('부서코드는 필수 입력사항입니다.')
		 			ds_1.RowPosition = i
		 			return
	 			}
	 			
	 			if (ds_1.NameValue(i, "grade_code") == "" || ds_1.NameValue(i, "grade_code") == null){
		 			alert('직위코드는 필수 입력사항입니다.')
		 			ds_1.RowPosition = i
		 			ccom_grade_code.Focus()
		 			return
	 			}
	 			
	 			if (ds_1.NameValue(i, "jobgroup_code") == "" || ds_1.NameValue(i, "jobgroup_code") == null){
		 			alert('직군코드는 필수 입력사항입니다.')
		 			ds_1.RowPosition = i
		 			ccom_jobgroup_code.Focus()
		 			return
	 			}
	// 			if (ds_1.NameValue(i, "paystep") == "0"){
	//	 			alert('호봉은 필수 입력사항입니다.')
	//	 			ds_1.RowPosition = i
	//	 			return
	// 			}
    			
	 			if (ds_1.NameValue(i, "jobkind_code") == "" || ds_1.NameValue(i, "jobkind_code") == null){
		 			alert('직종코드는 필수 입력사항입니다.')
		 			ds_1.RowPosition = i
		 			ccom_jobkind_code.Focus()
		 			return
	 			}
	 			
	// 			if (ds_1.NameValue(i, "title_code") == "" || ds_1.NameValue(i, "title_code") == null){
	//	 			alert('직책코드는 필수 입력사항입니다.')
	//	 			ds_1.RowPosition = i
	//	 			ccom_title_code.Focus()
	//	 			return
	// 			}
				
				// 확정되지 않은 발령만 체크
				if (ds_1.NameValue(i,"confirm_tag") != '1'){
		 			ll_cnt = f_ds_select_q("ds_last_order"," select count(*) select_1 from p_order_master " +
		 										  " where confirm_tag = '1' " +
		 										  "   and emp_no = '" + is_emp_no + "' " +
		 										  "   and apply_order_date > '" + ds_1.NameValue(i, "apply_order_date") + "' " )
		 			
		 			if (ds_last_order.NameValue(1, "select_1") > 0){
			 			alert('적용발령일자 이후의 발령이 존재합니다.')
			 			ds_1.RowPosition = i
			 			em_apply_order_date.Focus()
			 			return
		 			}
	 			}
	 			
 			   if (ds_1.NameValue(i, "ok_tag") == 'T') {	
	 		   	ds_1.NameValue(i,"confirm_tag") = is_confirm_tag		// 확정인지 취소인지 저장
	 		   	ds_1.NameValue(i,"degree") = ds_select10.NameValue(1,"select_1") // 현재 조직의 차수 저장
	 		   	
	    		}	
			}		// for close
		tr_1.Post()
 	}
 
	if (ds_3.IsUpdated){
  	  if  (is_save_sw == 'Y') {}
  	  else
  	   	if (confirm("겸직부서가 변경되었습니다 저장하시겠습니까?")) {}
 			else return false
 		for (i=1;i<=ds_3.CountRow;i++) {
 		   if (ds_3.NameValue(i, "start_date") == "" || ds_3.NameValue(i, "start_date") == null){
	 			alert('겸직시작일은 필수 입력사항입니다.')
	 			gd_2.Focus()
	 			gd_2.SetColumn("start_date")
	 			return
	 		}
	 		
	 		if (ds_3.RowStatus(i) == 1 || ds_3.RowStatus(i) == 3){
	 			ls_val = ds_3.NameValue(i,'start_date')
		 		if (ls_val != '' && f_check_date(ls_val) == false){
			   	alert('겸직시작일이 날짜 형식에 맞지 않습니다')
			   	ds_3.RowPosition = i
			   	gd_2.SetColumn('start_date')
			     	return false
			  	}
			  	ls_val = ds_3.NameValue(i,'end_date')
		 		if (ls_val != '' && f_check_date(ls_val) == false){
			   	alert('겸직종료일이 날짜 형식에 맞지 않습니다')
			   	ds_3.RowPosition = i
			   	gd_2.SetColumn('end_date')
			     	return false
			  	}
			}
	 	}
   	tr_3.Post()   		
	} 
	return true
}
//-------------------------------------------------------------------------------
function all_confirm()                  //전체선택
//--------------------------------------------------------------------------------
{
	var i
	for (i=1;i<=ds_1.CountRow;i++) {
		 ds_1.NameValue(i, "ok_tag") = 'T'    
	}
}
//-------------------------------------------------------------------------------
function all_cancel()                  //전체취소
//--------------------------------------------------------------------------------
{
	var i
	for (i=1;i<=ds_1.CountRow;i++) {
	   if (ds_1.NameValue(i, "ok_tag") == 'T') 
		   ds_1.NameValue(i, "ok_tag") = 'F' 		    
	}	   
}
//-------------------------------------------------------------------------------
function order_confirm()                  //발령확정
//--------------------------------------------------------------------------------
{ 
   if (select_check() == 0) return 
   
	if (confirm("발령자료를 확정 하시겠습니까?")) {}
   else return
   
	is_confirm_tag = '1'		// 확정
	
	if (ds_1.IsUpdated || ds_3.IsUpdated){
	   is_save_sw = 'Y'
		if (btnsave_onclick()) {
	      is_save_sw = 'N'
		}
		else { 
	      is_save_sw = 'N'
	      return
	   }
	}
	
	ds_4.DataID   = is_ds_4_addr + is_order_no + "&arg_confirm_tag=" + is_confirm_tag
	ds_4.SyncLoad = true
	ds_4.Reset()	
	
	for (i=1;i<=ds_4.CountRow;i++) {
		ds_4.UserStatus(i) = 1 
   }
   tr_4.Post()
   
   //관계사전출 발령이 있으면 관계사전입 발령 자동생성
   if ( ds_1.NameValueRow('order_code', '12') > 0){
   	//alert("관계사전출 발령에 대해서 전입발령을 자동으로 생성합니다.\n\n생성하신 이후에는 신규사번이 발생합니다...")
   	if(confirm("관계사전출 발령에 대해서 전입발령을 자동으로 생성 하시겠습니까?\n\n생성하신 이후에는 신규사번이 발생합니다.")){
   		sp_call()
   	}
	}
	
	setTimeout("btnquery_onclick()",0.5)
}
//-------------------------------------------------------------------------------
function sp_call()                  //Stored Procedure Call
//--------------------------------------------------------------------------------
{	
	<!-- ***************************************	-->
   <!-- 관계사전출시 관계사전입자료 생성			-->
	<!-- p_pers_last_empno에 신규사번 insert 		-->
	<!-- p_pers_master에 신규사번 insert 			-->
	<!-- p_order_master에 관계사전입자료 insert 	-->
	<!-- ***************************************	-->
	
	ds_spcall.DataID = 'sp_p_order_moving.jsp?arg_order_no=' + is_order_no
	ds_spcall.SyncLoad = true
	ds_spcall.reset()
	
	if (is_moving_tag == 'Y')
		alert('정상적으로 전입자료가 생성되었습니다...')
}
//-------------------------------------------------------------------------------
function order_cancel()                  //발령취소
//--------------------------------------------------------------------------------
{
   //if (select_check() == 0) return 
	
	if (confirm("선택하신 발령자료를 취소 하시겠습니까?")) {}
   else return
   
	// 확정인 것만 선택되어야 발령취소를 함
	for (i=1;i<=ds_1.CountRow;i++) {
      if (ds_1.RowMark(i) == 1){
      	if ( ds_1.NameValue(i,'confirm_tag') == '2' || ds_1.NameValueRow(i,'confirm_tag') == '3' ){
				alert('확정된 발령만 선택하시기 바랍니다!')
				return
			}
   		
   		// 취소대상(선택된) 로우가 있으면... 저장...
   	   ds_1.NameValue(i,"confirm_tag") = '2'		// 취소tag 저장
      }
  	}
  	tr_1.Post()		// 취소tag 저장
	
	ds_5.DataID   = is_ds_5_addr + is_order_no + "&arg_confirm_tag=" + is_confirm_tag
	ds_5.SyncLoad = true
	ds_5.Reset()	
	
	var i	
		for (i=1;i<=ds_5.CountRow;i++) {
			 ds_5.UserStatus(i) = 1 
      }
      tr_5.Post()		
	setTimeout("btnquery_onclick()",0.5)
}
//-------------------------------------------------------------------------------
function select_check()                  //선택 건수 체크 
//--------------------------------------------------------------------------------
{ 
   var i	,j
   j=0
   for (i=1; i<= ds_1.CountRow; i++) {
       if (ds_1.NameValue(i, "ok_tag") == 'T') 
          j++
   }
   if (j == 0) 
     alert('선택한 자료가 없습니다')
   return j
}   

//-------------------------------------------------------------------------------
function order_objlist()                  //정기승호자
//--------------------------------------------------------------------------------
{

	var result;
	var send_arg;
	var array = new Array();
	send_arg = ""
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_objlist_find_1h.html",send_arg,"dialogWidth:350px;dialogHeight:400px");
	
	if(result == "") return;
	array = result.split("@");
	ls_work_year = array[0]
	
	gd_1.ReDraw = false
	
	ll_cnt = f_ds_select_q("ds_select9","select emp_no select_1, up_paystep select_2, up_level select_3 " + 
								  "  from p_order_obj_list where work_year = '" + ls_work_year + "' ")		//정기승호자
	
	if (ll_cnt < 1) return
	
	is_obj_tag = 'Y'		// 사원정보 셋팅시 직위와 호봉은 셋팅 정기승호 데이터로 셋팅함
	is_row_pos = 'Y'	   // 추가하면 RowPosition이 변경되었을 때 하위조회를 안함
		
	for (i=1;i<=ds_select9.CountRow;i++) {		
		is_emp_no = ds_select9.NameValue(i,"select_1")
		is_paystep = ds_select9.NameValue(i,"select_2")
		is_grade = ds_select9.NameValue(i,"select_3")
		tx_emp_no.value = is_emp_no
		ccom_order_code.codevalue = '21'
		set_emp_info()
		init_move()
		if (i != ds_select9.CountRow)
			ds_1.AddRow()					
	}
	
	gd_1.ReDraw = true
}
//---------------------------------------------------------------------------
function bt_emp_no()                     //사번 찾기
//---------------------------------------------------------------------------
{

	var result;
	var send_arg;
	var array = new Array();
	send_arg = is_order_comp + '@' + tx_emp_no.value
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_empno_order_find_1h.html",send_arg,"dialogWidth:580px;dialogHeight:500px");

	if(result == "") return;
	array = result.split("@");
	is_emp_no  = array[0]
	
	tx_emp_no.value = is_emp_no
	is_obj_tag = 'N'
	is_row_pos = 'N'
	
	init_move()
	set_emp_info()
}
//---------------------------------------------------------------------------
function set_emp_info()                       //사원정보 셋팅
//---------------------------------------------------------------------------
{

	ds_2.DataID = is_ds_2_addr + is_emp_no
	ds_2.SyncLoad=true
	ds_2.Reset()
	
	if (is_obj_tag == 'N') {
		is_grade = ds_2.NameValue(ds_2.RowPosition,"grade_code")
		is_paystep = ds_2.NameValue(ds_2.RowPosition,"paystep")
	}
	
	if (ds_2.CountRow > 0) {
		tx_emp_name.value				= ds_2.NameValue(ds_2.RowPosition,"emp_name")
		ccom_comp_code.codevalue  	= ds_2.NameValue(ds_2.RowPosition,"comp_code")
		tx_dept_code.value  			= ds_2.NameValue(ds_2.RowPosition,"dept_code")
		tx_dept_name.value  			= ds_2.NameValue(ds_2.RowPosition,"dept_name")
		tx_cost_dept_code.value  	= ds_2.NameValue(ds_2.RowPosition,"cost_dept_code")
		tx_cost_dept_name.value  	= ds_2.NameValue(ds_2.RowPosition,"cost_dept_name")
		tx_work_dept_code.value  	= ds_2.NameValue(ds_2.RowPosition,"work_dept_code")
		tx_work_dept_name.value  	= ds_2.NameValue(ds_2.RowPosition,"work_dept_name")
		ccom_grade_code.codevalue  = is_grade
		em_paystep.text				= is_paystep
		ccom_jobgroup_code.codevalue = ds_2.NameValue(ds_2.RowPosition,"jobgroup_code")
		ccom_jobkind_code.codevalue = ds_2.NameValue(ds_2.RowPosition,"jobkind_code")
		ccom_title_code.codevalue  = ds_2.NameValue(ds_2.RowPosition,"title_code")	
		tx_duty.value  = ds_2.NameValue(ds_2.RowPosition,"duty")	
		
		var ls_group_join_date
		ls_group_join_date  = ds_2.NameValue(ds_2.RowPosition,"group_join_date")	
		
		// 그룹입사일을 관계사전입그룹입사일에 셋팅
		ds_1.NameValue(ds_1.RowPosition,"mov_group_join_date") = ls_group_join_date
		
		// 관계사전입 발령일때 그룹입사일 update
		//if (ls_group_join_date == ''){
		//	ll_cnt = f_ds_select_q("ds_junip","select max(emp_no) select_1 " +	//주민번호의 max(사번)
  		//											    "  from p_pers_master a, " +
  		//											    "       (select resident_no " +
  		//											    "          from p_pers_master " +
  		//											    "         where emp_no = '"+ ds_1.NameValue(row,"emp_no") +"') b " +
  		//											    " where a.resident_no = b.resident_no " +
  		//											    "   and a.emp_no < '"+ ds_1.NameValue(row,"emp_no") +"' ")	
  		//
  		//	is_emp_no = ds_junip.NameValue(1,"select_1")
  		//
		//	arg_cmd = " update p_pers_master		" + 
		//				 "    set group_join_date = to_date('" + ls_group_join_date + "') " +
		//			    "  where emp_no = '" + is_emp_no + "' " 
		//	f_update_sql(arg_cmd)
		//}
		
		//이전발령
		tx_old_comp_code.value  	 = ds_2.NameValue(ds_2.RowPosition,"comp_code")
		tx_old_comp_name.value  	 = ds_2.NameValue(ds_2.RowPosition,"comp_name")
		tx_old_dept_code.value  	 = ds_2.NameValue(ds_2.RowPosition,"dept_code")
		tx_old_dept_name.value  	 = ds_2.NameValue(ds_2.RowPosition,"dept_name")
		tx_old_cost_dept_code.value = ds_2.NameValue(ds_2.RowPosition,"cost_dept_code")
		tx_old_cost_dept_name.value = ds_2.NameValue(ds_2.RowPosition,"cost_dept_name")
		tx_old_work_dept_code.value = ds_2.NameValue(ds_2.RowPosition,"work_dept_code")
		tx_old_work_dept_name.value = ds_2.NameValue(ds_2.RowPosition,"work_dept_name")
		tx_old_grade_name.value   	 = ds_2.NameValue(ds_2.RowPosition,"grade_name")
		tx_old_paystep.value			 = ds_2.NameValue(ds_2.RowPosition,"paystep")
		tx_old_jobgroup_name.value  = ds_2.NameValue(ds_2.RowPosition,"jobgroup_name")
		tx_old_jobkind_name.value   = ds_2.NameValue(ds_2.RowPosition,"jobkind_name")
		tx_old_title_name.value     = ds_2.NameValue(ds_2.RowPosition,"title_name")	
		tx_old_duty.value     = ds_2.NameValue(ds_2.RowPosition,"duty")	
		ds_1.NameValue(ds_1.RowPosition,"old_grade_code")   = ds_2.NameValue(ds_2.RowPosition,"grade_code")
		ds_1.NameValue(ds_1.RowPosition,"old_level_code")   = ds_2.NameValue(ds_2.RowPosition,"level_code")
		ds_1.NameValue(ds_1.RowPosition,"old_jobgroup_code")= ds_2.NameValue(ds_2.RowPosition,"jobgroup_code")
		ds_1.NameValue(ds_1.RowPosition,"old_jobkind_code") = ds_2.NameValue(ds_2.RowPosition,"jobkind_code")
		ds_1.NameValue(ds_1.RowPosition,"old_title_code")   = ds_2.NameValue(ds_2.RowPosition,"title_code")
		ds_1.NameValue(ds_1.RowPosition,"old_service_div")  = ds_2.NameValue(ds_2.RowPosition,"service_div_code")
		ds_1.NameValue(ds_1.RowPosition,"old_degree") = ds_2.NameValue(ds_2.RowPosition,"degree")		
	}	
}
//---------------------------------------------------------------------------
function add_dept_insert()                       //겸직부서 최종발령 가져와서 Insert
//---------------------------------------------------------------------------
{

	ll_cnt = f_ds_select_q("ds_select11"," select a.add_dept_code  select_1, 						" +
													" 		  	 a.seq			   select_2,   					" +
													"		 	 to_char(a.start_date,'yyyy.mm.dd') select_3," +
													"		  	 to_char(a.end_date,'yyyy.mm.dd')   select_4," +
													"		    b.long_name   select_5  							" +
													"   from p_order_add_dept a,									" +
													"  	   z_code_dept		  b,									" +
													"  	   (select max(a.spec_no_seq) spec_no_seq	 		" +
													" 		     from p_order_add_dept a,						   " +
													"			  		 p_order_master   b                    " +
													" 			 where a.emp_no = b.emp_no                   " +
													"		   	and a.spec_no_seq = b.spec_no_seq         " +
													"		   	and a.emp_no = '" + is_emp_no + "'        " +
													" 				and b.confirm_tag = '1' ) m_add				" +
													" where a.spec_no_seq  = m_add.spec_no_seq	 			" +
													"   and a.add_dept_code= b.dept_code  			   	   " +
													"	 and a.cancel_tag  <> 'T'			 						" +
													"   and a.emp_no       = '" + is_emp_no + "'		 		" ) 

	var i
	if (ll_cnt > 0){
		for (i=1;i<=ds_select11.CountRow;i++){
			ds_3.AddRow()
			ds_3.NameValue(ds_3.RowPosition,"emp_no") 		 = is_emp_no
			ds_3.NameValue(ds_3.RowPosition,"spec_no_seq")	 = is_spec_no_seq
			ds_3.NameValue(ds_3.RowPosition,"add_dept_code") = ds_select11.NameValue(i,"select_1")
			ds_3.NameValue(ds_3.RowPosition,"seq") 			 = ds_select11.NameValue(i,"select_2")
			ds_3.NameValue(ds_3.RowPosition,"start_date")    = ds_select11.NameValue(i,"select_3")
			ds_3.NameValue(ds_3.RowPosition,"end_date")      = ds_select11.NameValue(i,"select_4")
			ds_3.NameValue(ds_3.RowPosition,"add_dept_name") = ds_select11.NameValue(i,"select_5")
		}
	}
}
//---------------------------------------------------------------------------
function bt_dept_code()                       //부서 찾기 
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	
	send_arg = ccom_comp_code.codevalue + '@' + tx_dept_name.value
	
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_dept_comp_find_all_1h.html",send_arg,"dialogWidth:500px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	tx_dept_code.value = array[0]
	tx_dept_name.value = array[1]
	if (tx_work_dept_code.value == ''){
		tx_work_dept_code.value = tx_dept_code.value
		tx_work_dept_name.value = tx_dept_name.value
	}
	if (tx_cost_dept_code.value == ''){
		tx_cost_dept_code.value = tx_dept_code.value
		tx_cost_dept_name.value = tx_dept_name.value
	}
	ds_1.NameValue(ds_1.RowPosition,"degree") = array[2]
}
//---------------------------------------------------------------------------
function bt_work_dept_code()                       //근무부서 찾기 
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	
	send_arg = ccom_comp_code.codevalue + '@' + tx_work_dept_name.value
	
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_dept_comp_find_all_1h.html",send_arg,"dialogWidth:500px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	tx_work_dept_code.value = array[0]
	tx_work_dept_name.value = array[1]
	ds_1.NameValue(ds_1.RowPosition,"degree") = array[2]
}
//---------------------------------------------------------------------------
function bt_cost_dept_code()                       //원가부서 찾기 
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	
	send_arg = ccom_comp_code.codevalue + '@' + tx_cost_dept_name.value
	
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_dept_comp_find_all_1h.html",send_arg,"dialogWidth:500px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	tx_cost_dept_code.value = array[0]
	tx_cost_dept_name.value = array[1]
	ds_1.NameValue(ds_1.RowPosition,"degree") = array[2]
}
//---------------------------------------------------------------------------
function bt_add_dept_onclick(data)                       //겸직부서 찾기 
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	var	ls_data
	
	ls_data = data
	send_arg = ccom_comp_code.codevalue + '@' + data
	
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_dept_comp_find_all_1h.html",send_arg,"dialogWidth:500px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	ds_3.NameValue(ds_3.RowPosition,"add_dept_code") = array[0]
	ds_3.NameValue(ds_3.RowPosition,"add_dept_name") = array[1]
	ds_3.NameValue(ds_3.RowPosition,"degree") = array[2]
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	if (il_screen > 1) {
		div_btncancel_onclick()
		return
	}
	
  	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated) {
     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
        {  //저장 routine
        } 
   }     
}
//----------------------------------------------------------------
function order_approval()                      //발령품의서 출력
//----------------------------------------------------------------
{
	var ls_sort, ls_sort1, ls_sort2, ls_sort3, ls_sort4
	var array = new Array();
	
	result = window.showModalDialog(gs_home + "/general/p_web/04/p_order_rpt_sort_1h.html","","dialogWidth:250px;dialogHeight:200px");
   if(result == "") return;
   array   = result.split("@");
   ls_sort = array[0];   	
   
   if (ls_sort == '1'){	//발령구분순
		ls_sort1 = "a.order_code"
		ls_sort2 = "a.dept_code"
		ls_sort3 = "a.grade_code"
		ls_sort4 = "mast.emp_name"
	}
	else if (ls_sort == '2'){	//부서순
		ls_sort1 = "a.dept_code"
		ls_sort2 = "a.order_code"
		ls_sort3 = "a.grade_code"
		ls_sort4 = "mast.emp_name"
	}
	else if (ls_sort == '3'){	//직위순
		ls_sort1 = "a.grade_code"
		ls_sort2 = "a.order_code"
		ls_sort3 = "a.dept_code"
		ls_sort4 = "mast.emp_name"
	}
	else {	//성명순
		ls_sort1 = "mast.emp_name"
		ls_sort2 = "a.grade_code"
		ls_sort3 = "a.dept_code"
		ls_sort4 = "a.order_code"
	}
	
	arg_temp ="general_rpt/p_web/01r/p_order_master"        // 보고서 명
	
	arg_temp = arg_temp + "&RptParams=" + is_order_comp_name +
								 "&RptParams=" + tx_order_no.value +
	 							 "&RptParams=" + ls_sort1 + 
   							 "&RptParams=" + ls_sort2 + 
   							 "&RptParams=" + ls_sort3 +
   							 "&RptParams=" + ls_sort4 
   					 
	f_crystal_report(arg_temp)   //보고서 호출
	
}
//----------------------------------------------------------------
function close_rtn()                      //화면 닫기 
//----------------------------------------------------------------
{
	if (is_html == "p_order_paperno_1h.html"){
		makeCookie("@p_order_paperno@", is_order_comp + "@" + is_order_year + "@" + il_order_no_row)
   	top.frames['main_ct'].location.href(is_html +"?"+'u')
   }
   else if (is_html == "p_pers_master_1h.html"){
   	makeCookie("@p_pers_master@", is_master_emp_no + "@" + is_service_div_code)
   	top.frames['main_ct'].location.href(gs_home + "/general/p_web/02/p_pers_master_1h.html" +"?"+'r')
   }
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
//-----------------------------------------------------------------------
	var result="";
	var array = new Array();
   result = ""
   result = readCookie("@p_order_master@")
   if (result == "err") {
      alert("프로젝트  정보가 올바르지 않아서 실행할수 없습니다")
      return
   }   
	else {   
	   array = result.split("@");
      is_order_no = array[0]
      is_order_title = array[1]
      is_html = array[2]
      
      if (is_html == 'p_order_paperno_1h.html') {		//발령문서에서 띄운 경우
	      is_last_tag = array[3]
	      is_order_comp = array[4]
	      is_order_year = array[5]
	      il_order_no_row = array[6]
	      is_order_comp_name = array[7]
      }
      else{			//인사기본사항에서 띄운 경우
      	is_master_emp_no = array[3]
      	is_service_div_code = array[4]
      	is_last_tag = 'N'		// 버튼 숨기기
      }
      
      makeCookie("@p_order_master@","")	//쿠키 리셋
      
      if (is_last_tag == 'N') {
      	bt_confirm_all.style.visibility="hidden"
      	bt_cancel_all.style.visibility="hidden"
      	bt_order_confirm.style.visibility="hidden"
      	bt_order_cancel.style.visibility="hidden"
      	bt_order_obj.style.visibility="hidden"
      	top.frames['main_title'].div_u.style.visibility = "hidden"
  			top.frames['main_title'].div_r.style.visibility = "visible"	
  			
  			gd_1.format = is_format_2
  			gd_1.Editable=false
			gd_2.Editable=false
	
      }
      else{
      	gd_1.format = is_format_1
      }
      
      tx_order_no.value = is_order_no
      tx_order_title.value = is_order_title
      is_work_date = f_sysdate()
      
      if (is_init == 'Y') {
	   	ll_cnt = f_ds_select_q("ds_select1","select order_code select_1, order_name select_2 from p_code_order order by sort")		//발령
	  		ll_cnt = f_ds_select_q("ds_select2","select comp_code select_1, comp_name select_2 from z_code_comp where comp_code <> ' ' order by comp_code")		//사업체 전체는 제외
	  		ll_cnt = f_ds_select_q("ds_select3","select grade_code select_1, grade_name select_2 from p_code_grade order by grade_code")	//직위
	  		ll_cnt = f_ds_select_q("ds_select4","select level_code select_1, level_name select_2 from p_code_level order by level_code")	//직급
	  		ll_cnt = f_ds_select_q("ds_select5","select jobgroup_code select_1, jobgroup_name select_2 from p_code_jobgroup order by jobgroup_code")		//직군
	  		ll_cnt = f_ds_select_q("ds_select6","select jobkind_code select_1, jobkind_name select_2 from p_code_jobkind order by jobkind_code")	//직종
	  		ll_cnt = f_ds_select_q("ds_select7","select title_code select_1, title_name select_2 from p_code_title order by title_code")	//직책
	  		is_init = 'N'
   	}
      tr_1.Action = is_tr_1_addr                   // jsp update용 
      tr_3.Action = is_tr_3_addr                   // jsp update용 
      tr_4.Action = is_tr_4_addr                   // jsp update용 
      tr_5.Action = is_tr_5_addr                   // jsp update용 
      
      setTimeout("btnquery_onclick()",0.5)
    }    
}
//---------------------------------------------------------------------
function get_focus(focus)   // 각각의 gd에 focus를 부여함.
//---------------------------------------------------------------------
{
	il_screen = focus
}

</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
	if (row < 1) {
		return
  	}
	if (is_row_pos == 'Y') return		//정기승호자 추가로직이면 조회안함
	
	setTimeout("div_btnquery_onclick()",0.5)
	
	if  (row < 1 || is_last_tag == 'N') return	//최종발령이 아니면 return
																//최종발령이면 확정인 것만 로우별로 수정 못하도록함
	if (ds_1.NameValue(row,"confirm_tag") == '1' ){
		gd_1.Editable = false
		gd_2.Editable = false
		gf_protect_on('tab_page_input')
		bt_emp_no_1.disabled=1
		bt_dept_code_1.disabled=1
		bt_work_dept_code_1.disabled=1
		bt_cost_dept_code_1.disabled=1
	}
	else{
		gd_1.Editable = true
		gd_2.Editable = true
		gf_protect_off('tab_page_input')
		tx_emp_name.disabled = 1
		bt_emp_no_1.disabled=0
		bt_dept_code_1.disabled=0
		bt_work_dept_code_1.disabled=0
		bt_cost_dept_code_1.disabled=0
	}
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnKeyPress(kcode)>
	if (kcode == 13) {
    	if (ds_3.RowPosition == ds_3.CountRow)  
        btnadd_onclick()
    	else     
        ds_3.RowPosition++
	}
</script>
<SCRIPT language="javascript" for=gd_2 event=OnPopup(row,colid,data)>
	 if (colid == "add_dept_code") {
	    bt_add_dept_onclick(data)
	    return
	 }    
</SCRIPT>
<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)> // 부서명칭 셋팅
  if (is_row_pos == 'Y') return		//정기승호자 추가로직이면 조회안함
  if  (row < 1 || is_last_tag == 'N') return;
  if (colid == "confirm_tag" ) {
		if (ds_1.NameValue(row,colid) == '1' ){
			gd_2.Editable = false
			gf_protect_on('tab_page_input')
			bt_emp_no_1.disabled=1
			bt_dept_code_1.disabled=1
			bt_work_dept_code_1.disabled=1
			bt_cost_dept_code_1.disabled=1
		}
		else{
			gd_2.Editable = true
			gf_protect_off('tab_page_input')
			tx_emp_name.disabled = 1
			bt_emp_no_1.disabled=0
			bt_dept_code_1.disabled=0
			bt_work_dept_code_1.disabled=0
			bt_cost_dept_code_1.disabled=0
		}
  }


// 사원정보 가져오기에서 처리----------------------  
//  // 발령코드가 관계사 전입이면 주민번호로 전출데이터를 가져옴.
//  if (colid == "order_code" && ds_1.NameValue(row,colid) == '13') {		
//  		
//  		ll_cnt = f_ds_select_q("ds_junip","select max(emp_no) select_1 " +	//주민번호의 max(사번)
//  													 "  from p_pers_master a, " +
//  													 "       (select resident_no " +
//  													 "          from p_pers_master " +
//  													 "         where emp_no = '"+ ds_1.NameValue(row,"emp_no") +"') b " +
//  													 " where a.resident_no = b.resident_no " +
//  													 "   and a.emp_no < '"+ ds_1.NameValue(row,"emp_no") +"' ")	
//  		
//  		is_emp_no = ds_junip.NameValue(1,"select_1")
//  		
//  		set_emp_info()	//	사원정보 가져오기
//  }
  
  // 소속부서가 변경되면 원가,근무부서도 같은 값으로 변경
  if (colid == "comp_code" ) {
		ds_1.NameValue(row,"dept_code") = ''
		ds_1.NameValue(row,"dept_name") = ''
		ds_1.NameValue(row,"cost_dept_code") = ''
		ds_1.NameValue(row,"cost_dept_name") = ''
		ds_1.NameValue(row,"work_dept_code") = ''
		ds_1.NameValue(row,"work_dept_name") = ''
  }
  // 부서 셋팅
  if (colid == "dept_code" ) {
		ds_1.NameValue(row,"dept_name") = ds_1.NameValue(row,colid)		
  }
  if (colid == "cost_dept_code" ) {
		ds_1.NameValue(row,"cost_dept_name") = ds_1.NameValue(row,colid)		
  }   
  if (colid == "work_dept_code" ) {
		ds_1.NameValue(row,"work_dept_name") = ds_1.NameValue(row,colid)		
  }  
</SCRIPT>
<script language=JavaScript for=gd_1 event=OnClick(row,colid)>
	if (ds_1.NameValue(row,'confirm_tag') == '1') {	// 확정된 자료는 체크박스 수정못함
	   return
	} 
	
	if (colid == "ok_tag") {
	   if (ds_1.NameValue(row,colid) == 'T'){
	       ds_1.NameValue(row,colid) = 'F'
	   }
	   else{
	       ds_1.NameValue(row,colid) = 'T'    
	   }
	}
	
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnClick(row,colid)>
	if (ds_1.NameValue(row,"confirm_tag") == '1' )	return
		
	if (colid == "cancel_tag") {
	   if (ds_3.NameValue(row,colid) == 'T')
	       ds_3.NameValue(row,colid) = 'F'
	   else
	       ds_3.NameValue(row,colid) = 'T'    
	}	
</SCRIPT>

</HEAD>
<BODY style="FONT-SIZE: 12px"  onload=window_onload() oncontextmenu="return false" >

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code ds_1: " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code ds_2: " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("Error Code ds_3: " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_4 event=OnLoadError()>
  alert("Error Code ds_4: " + ds_4.ErrorCode + "\n" + "Error Message : " + ds_4.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_5 event=OnLoadError()>
  alert("Error Code ds_5: " + ds_5.ErrorCode + "\n" + "Error Message : " + ds_5.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code ds_spcall: " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
  is_moving_tag = 'Y'
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
  alert("Error Code : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_4 event=OnFail()>
  alert("Error Code : " + tr_4.ErrorCode + "\n" + "Error Message : " + tr_4.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_5 event=OnFail()>
  alert("Error Code : " + tr_5.ErrorCode + "\n" + "Error Message : " + tr_5.ErrorMsg + "\n");
</SCRIPT>

<OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE=""></OBJECT>	
<OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_2
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_3
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_4
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_5
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT>
<OBJECT id=ds_select 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select1
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select2
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select3
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select4
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select5
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select6
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select7
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select8
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select9
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select10
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_select11
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_update 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_junip
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_last_order 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=ds_new_empno 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>
<OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_order_master_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_3
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_order_add_dept_1tr=ds_3)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_4
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_order_pers_master_1tr=ds_4)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_5
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_order_pers_master_2tr=ds_5)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>

<DIV id=hdept_page_3
         style="Z-INDEX: 111; LEFT: 3px; WIDTH: 165px; POSITION: absolute; TOP: 4px; HEIGHT: 27px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" >
             <td BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="center">문서번호</div></td>
          	 <td >
			        <INPUT id=tx_order_no size=13 READONLY ></td>
         </tr>                 
      </table>     
</DIV>
<DIV id=hdept_page_3
         style="Z-INDEX: 111; LEFT: 180px; WIDTH: 250px; POSITION: absolute; TOP: 4px; HEIGHT: 27px;FONT-SIZE: 12px" >
 		<table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" >
             <td BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="center">문서제목</div></td>
          	 <td >
			        <INPUT id=tx_order_title size=25 READONLY ></td>
         </tr>                 
      </table>
</DIV>
<DIV id=gd_1_button 
style="Z-INDEX: 107; LEFT: 435px; WIDTH: 700px; POSITION: absolute; TOP: 7px; HEIGHT: 20px">
<input id=bt_confirm_all type="button" value="전체선택" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=all_confirm()>
<input id=bt_cancel_all type="button" value="전체해제" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=all_cancel()>
<input id=bt_order_confirm type="button" value="발령확정" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=order_confirm()>
<input id=bt_order_cancel type="button" value="발령취소" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=order_cancel()>
<input id=bt_order_obj type="button" value="정기승호자" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
          "  onclick=order_objlist()>
<input type="button" value="발령품의서" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
             "  onclick=order_approval()>
<input type="button" value="닫기" 
        style="filter='progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr=#C7E2E2, EndColorStr=#FFFFFF)';font-size: 10pt; border:1 solid #000000; CURSOR: hand; 
            border:1 #A1A9A9 solid"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
             "  onclick=close_rtn()>
</div> 

<OBJECT id=gd_1  onfocus="get_focus(1)"
    style="POSITION: absolute; LEFT: 2px;TOP: 35px;  WIDTH: 390px; HEIGHT: 99%; Z-INDEX: 102;FONT-SIZE: 12px " 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AutoInsert" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="BorderStyle"  VALUE=4>
	<param name="ViewSummary"    value=1>
	<PARAM NAME="DataID" VALUE="ds_1">	
</OBJECT>
<DIV id=tab_page_input 
         style="LEFT: 395px; WIDTH: 600px; POSITION: absolute; TOP: 35px; HEIGHT: 350px; BACKGROUND-COLOR: #FFFFFF">
	
	<table width="100%"  height="100%" BORDER="2"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
     	<tr BGCOLOR="white" > 
			<td width="100%" height="7%" BGCOLOR="#BBE0F4" style="COLOR: BLACK; Font: Bold"  colspan=4> 
				<DIV align=center>신규발령정보</DIV></td>					
   	</tr>
		<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">사번</div></td>
			<td width="30%" > 
			  	<INPUT id=tx_emp_no MAXLENGTH=100 size=10  >
			  	<INPUT id=bt_emp_no_1 type=button value=" ..." onclick=bt_emp_no() ></td>		      
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">성명</div></td>
			<td width="30%" > 
			  	<INPUT id=tx_emp_name MAXLENGTH=100 disabled size=10  ></td>			
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">순번</div></td>
			<td width="30%" > 
			  	<OBJECT id=em_seq
                      style="WIDTH: 82px"
				          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
				        <param name=Alignment  value=1>
						  <param name=SelectAll  value=true>
                    <param name=ReadOnlyBackColor value='silver'>
				        <param name=Numeric value=true></OBJECT></td>
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">적용발령일자</div></td>
			<td width="30%" > 
			  	<OBJECT id=em_apply_order_date
                      style="WIDTH: 82px"
				          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
				        <param name=Format value="YYYY.MM.DD">
                    <param name=Alignment  value=1>
						  <param name=SelectAll  value=true>
                    <param name=Numeric value=false>
                    <param name=ReadOnlyBackColor value='silver'>
				        <param name=PromptChar   value=""></OBJECT></td>			
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">발령종류</div></td>
			<td width="30%" colspan=3> 
			  	<OBJECT id=ccom_order_code style="WIDTH: 200px; color=#CC3333"
	                 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	            <PARAM NAME="ComboDataID" VALUE="ds_select1">
	            <PARAM NAME="CodeCColumn" VALUE="select_1">
	            <PARAM NAME="DataCColumn" VALUE="select_2">
	            <param name=DataID     value=ds_1>
	            <PARAM NAME=CodeColumn VALUE=order_code>
	            <param name=Auto       value=false>
               <param name=Enable     value=true></OBJECT></td>         
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">사업체</div></td>
			<td width="30%" colspan=3> 
			  	<OBJECT id=ccom_comp_code style="WIDTH: 200px; color=#CC3333"
	                 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	            <PARAM NAME="ComboDataID" VALUE="ds_select2">
	            <PARAM NAME="CodeCColumn" VALUE="select_1">
	            <PARAM NAME="DataCColumn" VALUE="select_2">
	            <param name=DataID     value=ds_1>
	            <PARAM NAME=CodeColumn VALUE=comp_code>
	            <param name=Auto       value=false>
               <param name=Enable     value=true></OBJECT></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">부서</div></td>
			<td width="30%" colspan=3> 
			  <INPUT id=tx_dept_code tabIndex=-1 size=7  >
		      <INPUT id=bt_dept_code_1 type=button value=" ..." onclick=bt_dept_code() >
		      <INPUT id=tx_dept_name MAXLENGTH=100 disabled size=45 ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">근무부서</div></td>
			<td width="30%" colspan=3> 
			  	<INPUT id=tx_work_dept_code tabIndex=-1 size=7  >
			  	<INPUT id=bt_work_dept_code_1 type=button value=" ..." onclick=bt_work_dept_code() >
		      <INPUT id=tx_work_dept_name MAXLENGTH=100 disabled size=45 ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">원가부서</div></td>
			<td width="30%" colspan=3> 
			  	<INPUT id=tx_cost_dept_code tabIndex=-1 size=7  >
			  	<INPUT id=bt_cost_dept_code_1 type=button value=" ..." onclick=bt_cost_dept_code() >
		      <INPUT id=tx_cost_dept_name MAXLENGTH=100 disabled size=45 ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직위</div></td>
			<td width="30%" > 
			  	<OBJECT id=ccom_grade_code style="WIDTH: 130px; color=#CC3333"
	                 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	            <PARAM NAME="ComboDataID" VALUE="ds_select3">
	            <PARAM NAME="CodeCColumn" VALUE="select_1">
	            <PARAM NAME="DataCColumn" VALUE="select_2">
	            <param name=DataID     value=ds_1>
	            <param name=CodeColumn value=grade_code>
	            <param name=Auto       value=false>
               <param name=Enable     value=true></OBJECT>	         
	      </td>
	      <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직군</div></td>
			<td width="30%" > 
			  	<OBJECT id=ccom_jobgroup_code style="WIDTH: 130px; color=#CC3333"
	                 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	            <PARAM NAME="ComboDataID" VALUE="ds_select5">
	            <PARAM NAME="CodeCColumn" VALUE="select_1">
	            <PARAM NAME="DataCColumn" VALUE="select_2">
	            <param name=DataID     value=ds_1>
	            <param name=CodeColumn value=jobgroup_code>
	            <param name=Auto       value=false>
               <param name=Enable     value=true></OBJECT></td>			
     	</tr>
     	<tr BGCOLOR="white"> 
     		<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직종</div></td>
			 <td width="30%" > 
			  	<OBJECT id=ccom_jobkind_code style="WIDTH: 130px; color=#CC3333"
	                 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	            <PARAM NAME="ComboDataID" VALUE="ds_select6">
	            <PARAM NAME="CodeCColumn" VALUE="select_1">
	            <PARAM NAME="DataCColumn" VALUE="select_2">
	            <param name=CodeColumn value=jobkind_code>
	            <param name=DataID     value=ds_1>
	            <param name=Auto       value=false>
               <param name=Enable     value=true></OBJECT></td>
     		<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">호봉</div></td>
			<td width="30%" > 
				<OBJECT id=em_paystep tabIndex=1
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="0">
					<param name=ReadOnlyBackColor value='silver'>
				   <PARAM NAME="PromptChar" VALUE=""></OBJECT></td>	      
	   </tr>
	   <tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직책</div></td>
			<td width="30%" > 
			  	<OBJECT id=ccom_title_code style="WIDTH: 130px; color=#CC3333"
	                 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
	            <PARAM NAME="ComboDataID" VALUE="ds_select7">
	            <PARAM NAME="CodeCColumn" VALUE="select_1">
	            <PARAM NAME="DataCColumn" VALUE="select_2">
	            <param name=DataID     value=ds_1>
	            <param name=CodeColumn value=title_code>
	            <param name=Auto       value=false>
               <param name=Enable     value=true></OBJECT></td>
	      <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">담당직무</div></td>
			<td width="30%" > 
			  	<INPUT id=tx_duty MAXLENGTH=50 size=23 ></td>
	   </tr>
	   <tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">비고</div></td>
			<td width="30%" colspan=3> 
			  	<TEXTAREA id=tx_remark MAXLENGTH=200 rows=2 cols=64 border="2" ></TEXTAREA></td>
	   </tr>
	</table>    
</DIV>

<OBJECT id=tb_1 
    style="FONT-SIZE: 12px; Z-INDEX: 106; LEFT: 395px; WIDTH: 200px; POSITION: absolute; TOP: 390px; HEIGHT: 20px"  
    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
  <param name="BackColor"  value="#BBE0F4">
  <param name="TextColor"  value="BLACK">
  <PARAM NAME="Format" VALUE="
    <T>divid=tab_page_1 title='겸직부서'</T>
    <T>divid=tab_page_2 title='이전발령'</T>
    "></OBJECT>
    
<DIV id=tab_page_1 
      style="Z-INDEX: 100; LEFT: 395px; WIDTH: 600px; POSITION: absolute; TOP: 410px; HEIGHT: 34.5%;FONT-SIZE: 12px" >
	<OBJECT id=gd_2   onfocus="get_focus(2)"
         style="Z-INDEX: 100; LEFT: 0px; WIDTH: 600px; POSITION: absolute; TOP: 1px; HEIGHT: 100%;FONT-SIZE: 12px" 
          classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	     <PARAM NAME="MultiRowSelect" VALUE="-1">
	     <PARAM NAME="AutoInsert" VALUE="-1">
        <PARAM NAME="BorderStyle"  VALUE=4>
	     <PARAM NAME="AllShowEdit" VALUE="-1">
	     <PARAM NAME="Editable" VALUE="-1">
	     <PARAM NAME="ColSizing" VALUE="-1">
        <PARAM NAME="Format" VALUE="
  		   <C> Name='순번'  id=seq align=center width=50 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  		   <C> Name='겸직부서코드'  id=add_dept_code EditStyle=Popup width=80 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  		   <C> Name='겸직부서명칭'  id=add_dept_name Edit=None width=180 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  		   <C> Name='겸직시작일'  id=start_date align=center width=80  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  		   <C> Name='겸직종료일'  id=end_date align=center width=80  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  		   <C> Name='해제'  id=cancel_tag align=center EditStyle=CheckBox width=50  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
  		   ">
	      <PARAM NAME="DataID" VALUE="ds_3"></OBJECT>
</DIV>	    

<DIV id=tab_page_2
      style="Z-INDEX: 500; LEFT: 395px; WIDTH: 600px; POSITION: absolute; TOP: 410px; HEIGHT: 34.5%;FONT-SIZE: 12px" >
	<table width="100%"  height="100%" BORDER="2"    CELLSPACING="0"     style="FONT-SIZE: 12px">
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">사업체</div></td>
			<td width="30%" colspan=3> 
				<INPUT id=tx_old_comp_code tabIndex=-1 size=7 disabled >
			  	<INPUT id=tx_old_comp_name tabIndex=-1 size=25 disabled ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">부서</div></td>
			<td width="30%" colspan=3> 
			  	<INPUT id=tx_old_dept_code tabIndex=-1 size=7 disabled >
		      <INPUT id=tx_old_dept_name MAXLENGTH=100 disabled size=45 ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">근무부서</div></td>
			<td width="30%" colspan=3> 
			  	<INPUT id=tx_old_work_dept_code tabIndex=-1 size=7 disabled >
			  	<INPUT id=tx_old_work_dept_name MAXLENGTH=100 disabled size=45 ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">원가부서</div></td>
			<td width="30%" colspan=3> 
			  	<INPUT id=tx_old_cost_dept_code tabIndex=-1 size=7 disabled >
			  	<INPUT id=tx_old_cost_dept_name MAXLENGTH=100 disabled size=45 ></td>
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직위</div></td>
			<td width="30%" > 
				<INPUT id=tx_old_grade_name tabIndex=-1 size=12 disabled ></td>
     		<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직군</div></td>
			<td width="30%" > 
				<INPUT id=tx_old_jobgroup_name tabIndex=-1 size=12 disabled ></td>	      
     	</tr>
     	<tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직종</div></td>
			<td width="30%" > 
			  	<INPUT id=tx_old_jobkind_name tabIndex=-1 size=12 disabled ></td>
			<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">호봉</div></td>
			<td width="40%" > 
				<INPUT id=tx_old_paystep tabIndex=-1 size=12 disabled ></td>
	   </tr>
	   <tr BGCOLOR="white"> 
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">직책</div></td>
			<td width="30%" > 
			  	<INPUT id=tx_old_title_name tabIndex=-1 size=12 disabled ></td>	      
	   	<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">담당직무</div></td>
			<td width="30%"  > 
			  	<INPUT id=tx_old_duty tabIndex=-1 size=12 disabled ></td>	      
	   </tr>	   	
	</table>    	
</DIV>

<OBJECT id=Bind_1 
    style="Z-INDEX: 107; LEFT: 241px; POSITION: absolute; TOP: 3px" 
    classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	   <C>Col=emp_no  			Ctrl=tx_emp_no  				Param=value Enable=enable</C>
	   <C>Col=emp_name  			Ctrl=tx_emp_name 				Param=value Enable=enable</C>
	   <C>Col=apply_order_date	Ctrl=em_apply_order_date  	Param=text	Enable=enable</C>
	   <C>Col=seq			  		Ctrl=em_seq			  			Param=text  Enable=enable</C>
	   <C>Col=dept_code			Ctrl=tx_dept_code 			Param=value Enable=enable</C>
	   <C>Col=dept_name			Ctrl=tx_dept_name 			Param=value Enable=enable</C>
	   <C>Col=cost_dept_code	Ctrl=tx_cost_dept_code		Param=value Enable=enable</C>
	   <C>Col=cost_dept_name	Ctrl=tx_cost_dept_name		Param=value Enable=enable</C>
	   <C>Col=work_dept_code	Ctrl=tx_work_dept_code		Param=value Enable=enable</C>
	   <C>Col=work_dept_name	Ctrl=tx_work_dept_name		Param=value Enable=enable</C>
	   <C>Col=paystep		  		Ctrl=em_paystep		  		Param=text  Enable=enable</C>
	   <C>Col=duty		  			Ctrl=tx_duty		  			Param=value Enable=enable</C>
	   <C>Col=remark  			Ctrl=tx_remark		  			Param=value Enable=enable</C>
		
		<C>Col=old_comp_code			Ctrl=tx_old_comp_code			Param=value Enable=enable</C>
	   <C>Col=old_comp_name			Ctrl=tx_old_comp_name			Param=value Enable=enable</C>
	   <C>Col=old_dept_code			Ctrl=tx_old_dept_code 			Param=value Enable=enable</C>
	   <C>Col=old_dept_name			Ctrl=tx_old_dept_name 			Param=value Enable=enable</C>
	   <C>Col=old_cost_dept_code	Ctrl=tx_old_cost_dept_code		Param=value Enable=enable</C>
	   <C>Col=old_cost_dept_name	Ctrl=tx_old_cost_dept_name		Param=value Enable=enable</C>
	   <C>Col=old_work_dept_code	Ctrl=tx_old_work_dept_code		Param=value Enable=enable</C>
	   <C>Col=old_work_dept_name	Ctrl=tx_old_work_dept_name		Param=value Enable=enable</C>
	   <C>Col=old_grade_code		Ctrl=tx_old_grade_code  		Param=value Enable=enable</C>
	   <C>Col=old_grade_name		Ctrl=tx_old_grade_name  		Param=value Enable=enable</C>
	   <C>Col=old_paystep		  	Ctrl=tx_old_paystep		  		Param=value Enable=enable</C>
	   <C>Col=old_jobgroup_code	Ctrl=tx_old_jobgroup_code		Param=value Enable=enable</C>
	   <C>Col=old_jobgroup_name	Ctrl=tx_old_jobgroup_name		Param=value Enable=enable</C>
	   <C>Col=old_jobkind_code 	Ctrl=tx_old_jobkind_code	  	Param=value Enable=enable</C>
	   <C>Col=old_jobkind_name 	Ctrl=tx_old_jobkind_name	  	Param=value Enable=enable</C>
	   <C>Col=old_title_code	  	Ctrl=tx_old_title_code	  		Param=value Enable=enable</C>
	   <C>Col=old_title_name	  	Ctrl=tx_old_title_name	  		Param=value Enable=enable</C>
	   <C>Col=old_duty			  	Ctrl=tx_old_duty			  		Param=value Enable=enable</C>
	   "></OBJECT>	       	   
</BODY></HTML>