<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : p_emp_result_pass_1h.html 	                  -->
<!-- 2. 유형(시나리오): 조회 및 입력											-->
<!-- 3. 기 능 정 의   : 합격승인등록     	                           -->
<!-- 4. 변 경 이 력   : 권미생 작성												-->
<!-- 5. 관련프로그램  :	C_daily_work(05)   									-->
<!-- 6. 특 기 사 항   :															   -->
<!-- *************************************************************	-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value
var is_staff_no = top.frames['security'].empno.value
var is_ds_1_addr = gs_home + '/general/p_web/03/p_emp_result_pass_1q.jsp?arg_employ_degree='         
var is_tr_1_addr = gs_home + '/general/p_web/03/p_emp_result_pass_1tr.jsp'
var is_ds_2_addr = gs_home + '/general/p_web/03/p_emp_result_pass_insert_1q.jsp?arg_employ_degree='         
var is_tr_2_addr = gs_home + '/general/p_web/03/p_emp_result_pass_insert_1tr.jsp'
var is_ds_hp_master_addr = gs_home + '/general/p_web/03/p_emp_result_pass_hp_master_1q.jsp?arg_resident_no='         
var is_ds_hp_school_addr = gs_home + '/general/p_web/03/p_emp_result_pass_hp_school_1q.jsp?arg_resident_no='         
var is_ds_hp_career_addr = gs_home + '/general/p_web/03/p_emp_result_pass_hp_career_1q.jsp?arg_resident_no='         
var is_ds_hp_family_addr = gs_home + '/general/p_web/03/p_emp_result_pass_hp_family_1q.jsp?arg_resident_no='         
var is_tr_hp_addr = gs_home + '/general/p_web/03/p_emp_result_pass_hp_plus_1tr.jsp'
var is_ds_rhp_addr = gs_home + '/general/p_web/03/p_emp_result_hp_plus_1q.jsp'  //최종승인마감:close_tag N update
var is_tr_rhp_addr = gs_home + '/general/p_web/03/p_emp_result_hp_plus_1tr.jsp'	//최종승인마감:close_tag N update
var is_employ_degree
var is_last_approval              
var is_appl_no
var is_work_date = top.frames['security'].gs_sysdate.value.substr(0,10)
var is_sort =""
var is_ds_seq_addr = gs_home + '/general/p_web/99/p_spec_unq_no_1q.jsp'  
var is_hp_fail	//홈페이지 이력서 정보 이관시 에러나면 return
var THeader="resident_no:STRING(14):KEYVALUETYPE";		//최종승인마감:close_tag N update
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	ds_1.DataID = is_ds_1_addr + is_employ_degree
	ds_1.SyncLoad=true
	ds_1.Reset()

}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	if (ds_1.IsUpdated){
	 	if (confirm("변경되었습니다 저장하시겠습니까?")){	
	 		
			var ls_seq='00', j=1		
			ll_cnt = f_select2_q("select max(emp_no) select_1, " +				//신규사번최종테이블
										" 		  to_char(to_date('" + is_work_date + "'),'yyyymm') select_2 " +
										"  from p_pers_last_empno 		" + 			
										" where substr(emp_no, 1,6) = to_char(to_date('" + is_work_date + "'),'yyyymm') " +
										"	group by to_char(to_date('" + is_work_date + "'),'yyyymm') ")
										
			if (ll_cnt == 0) {
			    ls_max_empno = ''
			    ls_yymm = is_work_date.substr(0,4) + is_work_date.substr(5,2)
			}
			else {    
			    ls_max_empno = ds_select2.NameValue(1, "select_1")	//max사번
			    ls_yymm = ds_select2.NameValue(1, "select_2")		//년월
			}    
			
			// 최종승인하면  HP의 이력서를 수정 가능하도록 마감여부를 'N'으로 처리
	        ds_rhp.DataID = is_ds_rhp_addr
			  ds_rhp.SyncLoad=true
			  ds_rhp.Reset()
			  ds_rhp.SetDataHeader(THeader)
			  
			for (i=1 ;i<=ds_1.CountRow ;i++) {		
				if(ds_1.NameValue(i, "last_approval") == 'T' && ds_1.NameValue(i, "b_emp_no") == ''){
			    		
		    		//-신규사번생성-------------------------------------------------------------------------------
		    		if (j == 2)		// 두번째부터 NameMax
						ls_max_empno = ds_1.NameMax("b_emp_no",0,0)
					if (ls_max_empno != "")		// 사번의 뒷두자리 숫자로 전환
				 		ls_temp = parseInt(ls_max_empno.substr(6,2), 10)	
				 	else
				 		ls_temp = 0				
					ls_temp = ls_temp + 1 + ""
				 	ls_seq = ls_seq.substr(0, ls_seq.length - ls_temp.length)
				 	ls_seq = ls_seq + ls_temp
					is_emp_no = ls_yymm + ls_seq
					ds_1.NameValue(i, "b_emp_no") = is_emp_no	// 사번 셋팅
		    		j = 2			// Max(사번)이 DB에 저장되기 전이므로 2번째부터는 NameMax를 이용함
		    		//-------------------------------------------------------------------------------------------
		    		
		    		//-권한테이블 user_id 중복 체크--------------------------------------------------------------
				   //is_user_id = ds_1.NameValue(i,"b_user_id")
				   //ll_dup = f_ds_select_q("ds_select3","select a.empno select_1 " +
					//					  						  	 "  from z_authority_user a " +
					//					  						    " where a.empno  = '" + is_emp_no + "' " +
					//					  						    "   and a.user_id = '" + is_user_id + "' " +
					//					  						    "   and a.using_tag = 'Y' " )
				   // if (ll_dup > 0) {
				   // 	 ls_appl_name = ds_1.NameValue(i, "appl_name")
					//	 ls_appl_no = ds_1.NameValue(i, "appl_no")
				   //    alert("사용자권한에 사용중인 아이디가 존재하므로 사용하실 수 없습니다.")
			    	// 	 gd_1.Focus()
				   //    ds_1.RowPosition = i
	       	 	//	 gd_1.SetColumn("b_user_id")
				   // }
					//-------------------------------------------------------------------------------------------
					
		    	 	//-홈페이지 아이디 중복 체크-----------------------------------------------------------------		    	 	
		    	 	//if (is_user_id == ''){
					//	alert('사용자ID를 입력하십시오.')
			    	// 	gd_1.Focus()
					//	ds_1.RowPosition = i
	       	 	//	gd_1.SetColumn("b_user_id")
					//	return
					//}
			    	//gf_create_file("userid_search.txt",is_user_id)
			      //result = window.showModalDialog("http://www.worldro.net/userid_search.htm",'a',"dialogWidth:1px;dialogHeight:1px");
			    	//ls_ret = gf_read_file("userid_search.txt")
			    	//if (ls_ret == 'YES'){
			    	// 	alert("사용중인 아이디가 존재하므로 사용하실 수 없습니다.")
			    	// 	gd_1.Focus()
			    	// 	ds_1.RowPosition = i
	       	 	//	gd_1.SetColumn("b_user_id")
			    	// 	return
				   //}				   
				  	//gf_delete_file("userid_search.txt")
			      //---------------------------------------------------------------------------------------------
			 
		   	}
		   	ds_1.NameValue(i,"b_last_pass_tag") = ds_1.NameValue(i,"last_approval")
		   	
				// HP close_tag = 'N'
				ds_rhp.AddRow()
				ds_rhp.NameValue(ds_rhp.RowPosition,'resident_no') = ds_1.NameValue(i,'appl_no')				  		
		        
			} //for close
			
		tr_hp.Post()		// HP close_tag = 'N'
	 	tr_1.Post()
	 	btnquery_onclick()
		}
	}
}
//-------------------------------------------------------------------------------
function pers_copy()                  // DB에 Insert
//--------------------------------------------------------------------------------
{
   if  (ds_1.CountRow < 1) {
		alert("이관할 자료가 없습니다.")
		return
	}

	if (ds_1.IsUpdated){
		alert('변경된 자료를 저장하신후 작업하십시오.')
		return
	}
			
	if (confirm("자료를 이관하시겠습니까?")) {
		ds_2.DataID = is_ds_2_addr + is_employ_degree
		ds_2.SyncLoad=true
		ds_2.Reset()
		
		if (ds_2.NameValue(ds_2.RowPosition,"c_emp_no") != ""){
			alert("이미 이관된 자료입니다!!")
			return
		}
		
		for (i=1 ;i<=ds_2.CountRow ;i++) {
			if(ds_2.NameValue(i, "last_pass_tag") == 'T'){
				ds_2.NameValue(i, "tag") = 'Y'	// 이관대상 자료
				ds_2.NameValue(i, "b_regist_date") = is_work_date	// 신규사번등록 테이블에 사번 생성일 셋팅
				ds_2.UserStatus(i) = 1
				
				//채용 홈페이지 조회
				
				ls_resident_no = ds_2.NameValue(i,"appl_no")	//합격자 주민번호
				
				ds_master.DataID = is_ds_hp_master_addr + ls_resident_no	//이력서
				ds_master.SyncLoad=true
				ds_master.Reset()				
				ds_master.UserStatus(1) = 1
				
				
				alert(ds_master.NameValue(ds_master.RowPosition,'birth'))
				
				
				ds_school.DataID = is_ds_hp_school_addr + ls_resident_no	//학력
				ds_school.SyncLoad=true
				ds_school.Reset()				
				for (i=1 ;i<=ds_school.CountRow ;i++) {
					ds_school.UserStatus(i) = 1
					
					ds_seq.SyncLoad=true;              // spec_no_seq 구하기
 					ds_seq.reset()
					ds_school.NameValue(i,"spec_no_seq") = ds_seq.NameValue(1,"nextval")
				}
				
				ds_career.DataID = is_ds_hp_career_addr + ls_resident_no	//경력
				ds_career.SyncLoad=true
				ds_career.Reset()				
				for (i=1 ;i<=ds_career.CountRow ;i++) {
					ds_career.UserStatus(i) = 1
					
					ds_seq.SyncLoad=true;              // spec_no_seq 구하기
 					ds_seq.reset()
					ds_career.NameValue(i,"spec_no_seq") = ds_seq.NameValue(1,"nextval")					
				}
				
				ds_family.DataID = is_ds_hp_family_addr + ls_resident_no	//가족
				ds_family.SyncLoad=true
				ds_family.Reset()				
				for (i=1 ;i<=ds_family.CountRow ;i++) {
					ds_family.UserStatus(i) = 1
					
					ds_seq.SyncLoad=true;              // spec_no_seq 구하기
 					ds_seq.reset()
					ds_family.NameValue(i,"spec_no_seq") = ds_seq.NameValue(1,"nextval")
				}
				
				//return //--------------------------------- 삭제
				
				tr_hp.Post()
				if (is_hp_fail == 'Y'){
					alert('홈페이지 자료 이관시 에러발생!!')
					return false	//홈페이지 이력서 정보를 읽어와 (p_pers_address/p_pers_school_car/p_pers_career/p_pers_family)insert
				}
			}
		}
		
		tr_2.Post()		//신규사번 생성된 정보를(p_emp_applicant)에서 읽어와 p_pers_lst_empno/p_pers_master에 insert
		
		
	}
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
  ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
  
  ll_cnt = f_select_q("select a.employ_degree select_1 from p_emp_degree a where a.progress_tag = 'T' ") 
  	if (ll_cnt > 0) {
  		is_employ_degree = ds_select.NameValue(ds_select.RowPosition,"select_1")
      employ_degree.value = is_employ_degree
  	}
  	if (ll_cnt == 0) {
	  	alert("현재 진행중인 면접일정이 없습니다.")
	  	employ_degree.value = ''
	  	return
  }
  
  ccom_last_approval.CodeValue = 'A'
  
  ll_cnt = f_select1_q("select apply_code select_1, apply_name select_2 from p_emp_code_apply")
  ds_seq.DataID = is_ds_seq_addr
  tr_1.Action = is_tr_1_addr
  tr_2.Action = is_tr_2_addr
  tr_hp.Action = is_tr_hp_addr
  tr_rhp.Action = is_tr_rhp_addr
  
  btnquery_onclick()
}
</SCRIPT>
<BODY  onload=setTimeout('window_onload()',1) oncontextmenu="return false" >

<script language=JavaScript for=ds_1 event=OnRowPosChanged(row)>
	if (ds_1.NameValue(row, "b_emp_no") != '' ){// 이관된 자료의 체크박스는 수정하지 못하게함
		gd_1.Editable=false		
	}	
	else{
		gd_1.Editable=true
	}	
</script>
<script language=JavaScript for=gd_1 event=OnClick(row,colid)>
	if (row == 0) {					// 헤더클릭시 소트
  		if (is_sort == "+" + colid)
   	  ds_1.SortExpr = "-" + colid;
  	   else
   	  ds_1.SortExpr = "+" + colid;
   	  
  	  is_sort = ds_1.SortExpr;
  	  ds_1.Sort();
  	}

	if (ds_1.NameValue(row,'b_emp_no') != '') {	// 이관된 자료의 체크박스는 수정하지 못하게함
	   return
	}   
	   
	if (colid == "last_approval") {
	   if (ds_1.NameValue(row,colid) == 'T')
	       ds_1.NameValue(row,colid) = 'F'
	   else
	       ds_1.NameValue(row,colid) = 'T'    
	}
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=onFilter(row)>
      switch (ccom_last_approval.CodeValue) {
              case "T":
              				if (ds_1.NameValue(row,"last_approval") == "T" ) return true
              				else return false;
              				break;
              case "F":
              				if (ds_1.NameValue(row,"last_approval") != "T" ) return true
              				else return false;
              				break;
              default:
                        return true
                        break;
      }
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_master event=OnLoadError()>
  alert("Error Code : " + ds_master.ErrorCode + "\n" + "Error Message : " + ds_master.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_school event=OnLoadError()>
  alert("Error Code : " + ds_school.ErrorCode + "\n" + "Error Message : " + ds_school.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_career event=OnLoadError()>
  alert("Error Code : " + ds_career.ErrorCode + "\n" + "Error Message : " + ds_career.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_family event=OnLoadError()>
  alert("Error Code : " + ds_family.ErrorCode + "\n" + "Error Message : " + ds_family.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_rhp event=OnLoadError()>
  alert("Error Code : " + ds_rhp.ErrorCode + "\n" + "Error Message : " + ds_rhp.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_hp event=OnFail()>
  alert("Error Code : " + tr_hp.ErrorCode + "\n" + "Error Message : " + tr_hp.ErrorMsg + "\n");
  is_hp_fail = 'Y'
</SCRIPT>
<SCRIPT language=JavaScript for=tr_rhp event=OnFail()>
  alert("Error Code : " + tr_rhp.ErrorCode + "\n" + "Error Message : " + tr_rhp.ErrorMsg + "\n");
</SCRIPT>
<script language=JavaScript for=tr_2 event=OnSuccess()>
  alert("인사마스터 이관이 완료 되었습니다!!");
</script>

<script language=JavaScript for=ccom_last_approval event=onCloseUp()>
  	gd_1.ReDraw = false
   	ds_1.Filter()
   	gd_1.ReDraw = true
</SCRIPT>

</HEAD>
<Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<Object id=ds_select3
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_update 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT>
<OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
    <param name=UseFilter       value=true>
</OBJECT>
<OBJECT id=ds_2
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_master
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_school
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_career
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_family
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=ds_rhp
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT>
<OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_emp_result_pass_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_2
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_emp_result_pass_insert_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_hp
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_master_1tr=ds_master, I:p_school_1tr=ds_school, I:p_career_1tr=ds_career, I:p_family_1tr=ds_family)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>
<OBJECT id=tr_rhp
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:p_emp_result_hp_plus_1tr=ds_rhp)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>

<DIV id=div_employ_degree 
         style="Z-INDEX: 111; LEFT: 4px; WIDTH: 150px; POSITION: absolute; TOP: 2px; HEIGHT: 18px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="center">채용차수</div></td>
             <td >
						<INPUT id=employ_degree readonly style=" FONT-SIZE: 12px;" size=10 ></td>
         </tr>                 
      </table>
</DIV>    
<DIV id=div_last_approval
    style="FONT-SIZE: 12px; Z-INDEX: 200; LEFT: 160px; WIDTH: 138px; POSITION: absolute; TOP: 3px; HEIGHT: 25px" >
      <table width="100%"  HEIGHT="100%" BORDER="1"  align="center"   CELLSPACING="0" CELLPADDING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
          <td width="40%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">최종승인</div></td>
          <td width="60%"> 
			     <OBJECT id=ccom_last_approval width=80px 
			      classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
			     <param name=Data     value="A^전체,T^승인,F^미승인">
			     <param name=DataID     value=ds_1>
			     <PARAM NAME="Enable" VALUE="-1">
			     </OBJECT>
			 </td>
         </tr>
      </table>
</DIV>    
<LABEL id=Label_1 
       style="LEFT: 310px; WIDTH: 500px; POSITION: absolute; TOP: 10px; HEIGHT: 19px; color:Red"><저장후에 자료이관 버튼을 클릭하시면 최종승인된 자료가 인사마스터에 등록됩니다>
</LABEL>       
<input id=bt_pers_copy type="button" value="자료이관" 
        style="color:#2E4A4A; font-size:13px; CURSOR: hand; WIDTH=85px; background-color:#E9F5F5; border:1 #A1A9A9 solid; height:22px;   
        LEFT: 860px; POSITION: absolute; TOP: 5px;"  onclick=pers_copy()>
<OBJECT id=gd_1 
    style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 1px; WIDTH: 1005px; POSITION: absolute; TOP: 30px;
    HEIGHT: 100%" classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
   <PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="Format" VALUE="
     <C> Name='응시자 주민등록번호'  id=appl_no edit=none width=154 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='성명'  id=appl_name edit=none width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='성별'  id=sex  edit=none width=80 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='응시분야1'  id=appl_part edit=none EditStyle=Lookup Data='ds_select1:select_1:select_2' width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='응시분야2'  id=appl_part2 edit=none EditStyle=Lookup Data='ds_select1:select_1:select_2' width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='최종승인'  id=last_approval EditStyle=CheckBox  width=100 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     <C> Name='사번'  id=b_emp_no edit=none  width=100 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
     ">
	<PARAM NAME="DataID" VALUE="ds_1"></OBJECT>
</BODY></HTML>