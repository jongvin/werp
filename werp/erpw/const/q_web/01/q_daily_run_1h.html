<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : q_daily_run_1h.html 					-->
<!-- 2. 유형(시나리오): shared window 조회및 입력					-->
<!-- 3. 기 능 정 의   : 장비운행일보등록  	  				-->
<!-- 4. 변 경 이 력   : 김 동우 작성						-->
<!-- 5. 관련프로그램  :								-->
<!-- 6. 특 기 사 항   :								-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var is_work_date = top.frames['security'].gs_sysdate.value
var is_ds_1_addr = gs_home + '/const/q_web/01/q_daily_run_1q.jsp?arg_dept='
var is_tr_1_addr = gs_home + '/const/q_web/01/q_daily_run_1tr.jsp'
var is_ds_seq_addr = gs_home + '/const/m_web/00/m_spec_unq_no_1q.jsp'                 // seq_no구하기 
</SCRIPT>


<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	check_close()
	invoice_close()
	
	ds_1.DataID = is_ds_1_addr + is_dept_code + '&arg_date=' + is_work_date
	ds_1.SyncLoad=true
	ds_1.Reset()
	
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("equp_code");
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	ds_seq.SyncLoad=true;             // seq no 구하기
 	ds_seq.reset()

	ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
	ds_1.NameValue(ds_1.RowPosition,"run_date") = is_work_date
	ds_1.NameValue(ds_1.RowPosition,"seq") = ds_seq.NameValue(1,"nextval")
	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	 ds_1.AddRow()
	 init_move()
	 bt_equp_onclick()

}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	 ds_1.InsertRow(ds_1.RowPosition)
	 init_move()
	 bt_equp_onclick()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	if  (gd_1.MultiRowSelect){               // multi row select 일 경우
	     for (i=ds_1.CountRow ;i >0 ;i--)
	     {
	        if (ds_1.RowMark(i) == 1)
	               ds_1.DeleteRow(i)
	     }   
	    ds_1.MarkRows(ds_1.RowPosition,ds_1.RowPosition)  //삭제작업완료후 MARK
	} 
	else
	     ds_1.DeleteRow(ds_1.RowPosition)  
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
var ls_chk=0
	if (ds_1.IsUpdated){
	   if  (confirm("변경되었습니다 저장하시겠습니까?")){
	   	for (i=1; i<= ds_1.CountRow; i++){
		   	if (ds_1.NameValue(i,"spec_unq_num") == 0){
		   		ls_chk++
	   		}
	   	}
	   	if (ls_chk == 0) {
	       		tr_1.Post()
	       	}
       		else {
	   		alert("투입내역을 반드시 입력하십시오\n\n저장되지않았습니다.")
	       		
	       	}
	   }
 	} 
  
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	        {  //저장 routine
	        }   
 
	   }     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

	// top.frames['main_ct'].window.close()     
}

//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	result = f_dept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	dept_name.value = is_dept_name
	btnquery_onclick()
}     
//---------------------------------------------------------------------------
function bt_equp_onclick()                     //장비코드 찾기
//---------------------------------------------------------------------------
{
	if ( ds_1.RowPosition == 0 ) {
	    return
	}
	var result;
	var array = new Array();
	send_arg = is_dept_code + '@' 
	result = window.showModalDialog(gs_home + "/const/q_web/00/q_code_equipment_find_1h.html", send_arg,"dialogWidth:670px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	tx_equp_code.value = array[0]
	tx_eqp_name.value  = array[1]
	tx_eqp_size.value  = array[2]
	em_unitcost.text   = array[3]
}

//---------------------------------------------------------------------------
function bt_spec_onclick()                     //실행내역 찾기
//---------------------------------------------------------------------------
{
	if ( ds_1.RowPosition == 0 ) {
	    return
	}
	var result;
	var array = new Array();
	result = window.showModalDialog(gs_home + "/comm_search/y_budget_find_1h.html","lab@" + is_dept_code+ "@" + ds_1.NameValue(ds_1.RowPosition,"spec_unq_num"),"dialogWidth:1020px;dialogHeight:700px");
	if(result == "") return;
	array = result.split("@");
	ds_1.NameString(ds_1.RowPosition,"spec_no_seq") = array[0];   // 실행 상위 unq_no 
	ds_1.NameString(ds_1.RowPosition,"spec_unq_num") = array[1];  // 실행내역 unq_no 
	ds_1.NameString(ds_1.RowPosition,"spec_name") = array[6];          // 실행내역 명칭 
	
}
//-------------------------------------------------------------------------------
function sp_call()                  //Stored Procedure Call 
//--------------------------------------------------------------------------------
{
/*   var ls_bef_date
   ls_sql = "SELECT to_char(MAX(run_date),'yyyy.mm.dd')  select_1  " + 
                        "   FROM q_daily_run " + 
                        "   WHERE dept_code  = '" + is_dept_code + "' " + 
                        "        AND run_date < '" + is_work_date + "'  "
   ll_cnt = f_select9_q(ls_sql)
   ls_bef_date = ds_select9.NameValue(1,'select_1')
   ls_bef_date =prompt("복사할 날짜를 입력하십시요",ls_bef_date)

   if (ls_bef_date == null)
      return

   ls_sql = "SELECT count(*)   select_1  " + 
                        "   FROM q_daily_run " + 
                        "   WHERE dept_code  = '" + is_dept_code + "' " + 
                        "        AND run_date =  '" + ls_bef_date + "'  "
   ll_cnt = f_select9_q(ls_sql)
   ll_cnt = ds_select9.NameValue(1,'select_1')
   ll_cnt = parseInt(ll_cnt)
   if (ll_cnt == 0) {
       alert("입력한 날짜에는 데이타가 없습니다")
       return
   }
*/
	if  (confirm("이전출역자료를 복사하시겠습니까?")) {
	        ds_spcall.DataID = 'q_prevdata_copy_procedure.jsp?arg_dept_code=' + is_dept_code + '&arg_date=' + is_work_date
	        ds_spcall.SyncLoad = true
	        ds_spcall.reset()
		btnquery_onclick()
	}
}
//---------------------------------------------------------------------------------
function f_select9_q(ls_sql)
//---------------------------------------------------------------------------------
{
  var i,j,ll_find,ll_from,ls_colcnt,ll_cnt
  ll_find = 0
  ll_from = ls_sql.lastIndexOf("select_")
  for(i=ll_from ; i < ls_sql.length ; i++) {
     if  (ls_sql.substr(i,1) == "_") { 
         for (j=i; j < ls_sql.length ; j++) {
             if (ls_sql.substr(j,1) == " ") {
                 ll_find = 1
                 break
             }    
         }
     }
   if (ll_find == 1) break
  }      
  ls_colcnt = ls_sql.substr(i+1, j-i)
  

  switch(parseInt(ls_colcnt))  
    {
     case 1 : ds_select9.DataID="/werp/erpw/comm_function/comm_select_1q.jsp?in_sql=" + ls_sql; break 
     case 2 : ds_select9.DataID="/werp/erpw/comm_function/comm_select_2q.jsp?in_sql=" + ls_sql; break 
     }
 ds_select9.SyncLoad = true
 ds_select9.reset()
 ll_cnt = ds_select9.CountRow
 return ll_cnt
} 

//-------------------------------------------------------------------------------
function query_prev()                  //이전자료 조회
//--------------------------------------------------------------------------------
{
	ll_cnt = f_select_q("select to_char(max(run_date),'yyyy.mm.dd') select_1 " +
	                    "from q_daily_run where dept_code = " + "'" + is_dept_code + "'" +
	                    " and to_char(run_date,'yyyy.mm.dd') < " + "'" + is_work_date + "'")
	
	ls_temp = ds_select.NameValue(ds_select.RowPosition,"select_1")
	
	if (ll_cnt > 0 && ls_temp != '') {
		is_work_date     = ds_select.NameValue(ds_select.RowPosition,"select_1")
		em_select_yymm.text = is_work_date
		btnquery_onclick()
	}
	else {
		alert("이전자료가 존재하지 않습니다")
	}
}
//-------------------------------------------------------------------------------
function query_next()                  //다음자료 조회
//--------------------------------------------------------------------------------
{
	ll_cnt = f_select_q("select to_char(min(run_date),'yyyy.mm.dd') select_1 " +
	                    "from q_daily_run where dept_code = " + "'" + is_dept_code + "'" +
	                    " and to_char(run_date,'yyyy.mm.dd') > " + "'" + is_work_date + "'")
	
	ls_temp = ds_select.NameValue(ds_select.RowPosition,"select_1")
	
	if (ll_cnt > 0 && ls_temp != '') {
		is_work_date     = ds_select.NameValue(ds_select.RowPosition,"select_1")
		em_select_yymm.text = is_work_date
		btnquery_onclick()
	}
	else {
		alert("다음자료가 존재하지 않습니다")
	}
}
//-------------------------------------------------------------------------------
function select_yymm()                  //년월 선택 
//--------------------------------------------------------------------------------
{
   is_work_date = em_select_yymm.text.substr(0,4) + "." + em_select_yymm.text.substr(5,2)  + "." +  em_select_yymm.text.substr(8,2)
   ds_1.ClearData()
   btnquery_onclick()
}
//-------------------------------------------------------------------------------
function check_close()                  
//--------------------------------------------------------------------------------
{  
   is_cur_date = em_select_yymm.text.substr(0,4) + "." + em_select_yymm.text.substr(5,2) + '.01'
   is_close_tag = f_close_chk(is_dept_code,is_cur_date,'C')   // 각단위업무마감여부 체크(현장코드,년월,업무구분)
   if (is_close_tag) {
       tx_close.value = '마감'
       gd_1.Editable = false
//	    button_1.style.visibility='hidden'
//	    button_2.style.visibility='hidden'
	    button_3.style.visibility='hidden'
//	    button_5.style.visibility='hidden'
//	    ds_1.ReadOnly=true
//	    ds_2.ReadOnly=true
	    top.frames['main_title'].div_r.style.visibility="visible"
     	top.frames['main_title'].div_u.style.visibility="hidden"
     	top.frames['main_title'].div_p.style.visibility="hidden"
     	top.frames['main_title'].div_s.style.visibility="hidden" 
		
		bt_equp_code.disabled = true
		bt_spec_unq_num.disabled = true
		tx_equp_code.disabled = true
		tx_eqp_name.disabled = true
		tx_eqp_size.disabled = true
		em_run_time.readonly = true
		em_suspension_time.readonly = true
		em_extra_time.readonly = true
//		em_settle_time.readonly = true
//		em_unitcost.readonly = true
		em_settle_amt.readonly = true
		em_fuel_qty.readonly = true
		em_fuel_amt.readonly = true
		em_oil_qty.readonly = true
		em_oil_amt.readonly = true
		tx_repair_remark.disabled = true
		em_repair_amt.readonly = true
		tx_move_remark.disabled = true
		em_move_amt.readonly = true
		tx_run_remark.disabled = true

   }    
   else {
       tx_close.value = ''
       gd_1.Editable = true
//       button_1.style.visibility='visible'
//       button_2.style.visibility='visible'
       button_3.style.visibility='visible'
//	       button_5.style.visibility='visible'
//       ds_1.ReadOnly=false
//       ds_2.ReadOnly=false
//       top.frames['main_title'].div_r.style.visibility="hidden"
       	top.frames['main_title'].div_u.style.visibility="visible"
//       top.frames['main_title'].div_p.style.visibility="hidden"
//       top.frames['main_title'].div_s.style.visibility="hidden"
		
		bt_equp_code.disabled = false
		bt_spec_unq_num.disabled = false
		tx_equp_code.disabled = false
		tx_eqp_name.disabled = false
		tx_eqp_size.disabled = false
		em_run_time.readonly = false
		em_suspension_time.readonly = false
		em_extra_time.readonly = false
//		em_settle_time.readonly = false
//		em_unitcost.readonly = false
		em_settle_amt.readonly = false
		em_fuel_qty.readonly = false
		em_fuel_amt.readonly = false
		em_oil_qty.readonly = false
		em_oil_amt.readonly = false
		tx_repair_remark.disabled = false
		em_repair_amt.readonly = false
		tx_move_remark.disabled = false
		em_move_amt.readonly = false
		tx_run_remark.disabled = false
   }
   
}  
//-------------------------------------------------------------------------------
function invoice_close()                  
//--------------------------------------------------------------------------------
{
	is_cur_date = em_select_yymm.text.substr(0,4) + "." + em_select_yymm.text.substr(5,2) + '.01'
	ll_cnt = f_ds_select_q("ds_invoice", "select regist_no select_1, invoice_num select_2 " +
  													 "	from q_monthly_payment a " +
 													 "	where a.dept_code='" + is_dept_code + "' and a.yymm='" + is_cur_date + "' and invoice_num is not null ")
	
	if (ll_cnt == 0) {
		button_3.style.visibility='visible'
		top.frames['main_title'].div_u.style.visibility="visible"

		bt_equp_code.disabled = false
		bt_spec_unq_num.disabled = false		
		tx_equp_code.disabled = false
		tx_eqp_name.disabled = false
		tx_eqp_size.disabled = false
		em_run_time.readonly = false
		em_suspension_time.readonly = false
		em_extra_time.readonly = false
//		em_settle_time.readonly = false
//		em_unitcost.readonly = false
		em_settle_amt.readonly = false
		em_fuel_qty.readonly = false
		em_fuel_amt.readonly = false
		em_oil_qty.readonly = false
		em_oil_amt.readonly = false
		tx_repair_remark.disabled = false
		em_repair_amt.readonly = false
		tx_move_remark.disabled = false
		em_move_amt.readonly = false
		tx_run_remark.disabled = false
	}
	
	else {
		button_3.style.visibility='hidden'
		top.frames['main_title'].div_r.style.visibility="visible"
		top.frames['main_title'].div_u.style.visibility="hidden"
     	top.frames['main_title'].div_p.style.visibility="hidden"
     	top.frames['main_title'].div_s.style.visibility="hidden"

		bt_equp_code.disabled = true
		bt_spec_unq_num.disabled = true
		tx_equp_code.disabled = true
		tx_eqp_name.disabled = true
		tx_eqp_size.disabled = true
		em_run_time.readonly = true
		em_suspension_time.readonly = true
		em_extra_time.readonly = true
//		em_settle_time.readonly = true
//		em_unitcost.readonly = true
		em_settle_amt.readonly = true
		em_fuel_qty.readonly = true
		em_fuel_amt.readonly = true
		em_oil_qty.readonly = true
		em_oil_amt.readonly = true
		tx_repair_remark.disabled = true
		em_repair_amt.readonly = true
		tx_move_remark.disabled = true
		em_move_amt.readonly = true
		tx_run_remark.disabled = true
	}
} 
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_1');
	var xArr   = new Array(false);
	var yArr   = new Array(true);

	f_reSize(objArr, xArr, yArr);
}  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
   if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
   tr_1.Action = is_tr_1_addr 
	dept_name.value = is_dept_name
   ds_seq.DataID = is_ds_seq_addr                       // SEQ NO 의 DATAID
	em_select_yymm.text = is_work_date
	btnquery_onclick()
}
</SCRIPT>
<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
	alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
	alert("Error Code(tr_1) : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=em_select_yymm event=onKillFocus()>
        if (em_select_yymm.Modified){ 
	   select_yymm()
	   }
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_yymm event=onKeyDown(kcode,scode)>
        if ((em_select_yymm.Modified) && kcode == 13 ){ 
	   select_yymm()
	   }
</SCRIPT>        	
<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
	if (kcode == 13) {
	    if (ds_1.RowPosition == ds_1.CountRow)  
	        btnadd_onclick()
	    else     
	        ds_1.RowPosition++
	}
</SCRIPT>
<SCRIPT language=JavaScript  event=OnColumnChanged(row,colid) for=ds_1>
	if (colid == "run_time" || colid == "extra_time") {
		id_time = ds_1.NameValue(row,"run_time") + ds_1.NameValue(row,"extra_time");
		ds_1.NameValue(row,"settle_time") = id_time
		ds_1.NameValue(row,"settle_amt") = id_time * ds_1.NameValue(row,"unitcost")
	}
	if (colid == "equp_code" ) {
		is_equp_code = ds_1.NameValue(row,"equp_code")
		ll_cnt = f_select_q("select eqp_name select_1, eqp_size select_2, " +
	                    "DECODE(PRICE_METHOD,'1',unit_price,decode(price_method,'2',trunc(unit_price /10,0),trunc(unit_price/250,0))) select_3 " +
	                    "from q_code_equipment where dept_code = " + "'" + is_dept_code + "'" +
	                    "and equp_code = " + "'" + is_equp_code + "'")
	        if (ll_cnt > 0 ) {
	        	tx_eqp_name.value = ds_select.NameValue(ds_select.RowPosition,"select_1")
	        	tx_eqp_size.value = ds_select.NameValue(ds_select.RowPosition,"select_2")
	        	em_unitcost.text  = ds_select.NameValue(ds_select.RowPosition,"select_3")
	        	id_time = ds_1.NameValue(row,"run_time") + ds_1.NameValue(row,"extra_time")
			ds_1.NameValue(row,"settle_amt") = id_time * ds_1.NameValue(row,"unitcost")
	        }
	} 
</SCRIPT>


<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select9
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_close_check 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_invoice 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	 <param name=SortExpr       value="+equp_code">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:q_daily_run_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	
<comment id="__NSID__"><OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) oncontextmenu="return false">
<div class=main_div>
<table border="0" width="100%" height="100%" cellspacing="0" style="font: 12px">
	<tr height="20px">
		<td class=td_green colspan="2">
			<table BORDER="0" CELLSPACING="0" CELLPADDING="0" class=main_table>
				<tr> 
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="43px" class=font_green_bold>현장명</div></td>
					<td width="166px">
						<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" style=" FONT-SIZE: 12px;" size=25 onkeyDown="keyDown()"></td>
					<td width="80px">
						<input type="button" value="검색" onclick=dept_code_find() class=img_btnFind onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"></td>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="55px" class=font_green_bold>출역일자</td>
					<td width="105px">
						
						<comment id="__NSID__"><OBJECT id=em_select_yymm width=100 style="background: white;"
								classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME="IsComma" VALUE="0">
							<PARAM NAME="MaxLength" VALUE="8">
							<PARAM NAME="Format" VALUE="YYYY-MM-DD">
							<param name=ClipMode       value=false>
							<PARAM NAME="Numeric" VALUE="0">
							<PARAM NAME="SelectAll" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					<td width="30px">
						<input type="button" id=img_fr class=img_btnCalendar_S OnClick="var result = gn_Cal_Yyyymmdd(); 
							if(!is_null(result)){ em_select_yymm.text = result.substr(0,8);} ; select_yymm()">
					</td>
					<td width="30px">
						<input type="text" id=tx_close style="Z-INDEX:100; COLOR: #ff0080; background: #DCF2EC; BORDER-RIGHT: 1px; BORDER-TOP: 1px;BORDER-LEFT: 1px; BORDER-BOTTOM: 1px;" tabindex=-1 size=4 ></td>
					<td width="*" align="right">
						<input id=button_1 type="button" value="이전자료" onclick=query_prev() class=img_btn4_1 onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<input id=button_2 type="button" value="다음자료" onclick=query_next() class=img_btn4_1 onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<input id=button_3 type="button" value="이전투입자료복사" onclick=sp_call() class=img_btn8_1 onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;
					</td>
				</tr>                 
			</table>
		</td>
	</tr>
	<tr height="*">
		<td width="40%">
			<comment id="__NSID__"><OBJECT id=gd_1 style="width: 100%; height: 100%"
			classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="-1">
				<PARAM NAME="AutoInsert" VALUE="-1">
				<PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="AllShowEdit" VALUE="-1">
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="Format" VALUE="
					<C> Name='장비코드' ID=equp_code  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=74 </C>
					<C> Name='장 비 명' ID=eqp_name  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=180 </C>
					<C> Name='규    격' ID=eqp_size  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=110 </C>
				">
				<PARAM NAME="DataID" VALUE="ds_1">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="60%">
			<table width="100%" height="100%" BORDER="1"  CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
				<tr BGCOLOR="white"> 
					<td width="100px"  BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
						<div align="right">*장비코드</div></td>
					<td width="80%"> 
						<INPUT type=text id=tx_equp_code  MAXLENGTH=10 tabIndex=4 size=12>
						<INPUT id=bt_equp_code type=button class=img_btnFind_S onclick=bt_equp_onclick()></td>
							
					</td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">*장비명/규격</div></td>
					<td width="80%"> 
						<INPUT id=tx_eqp_name disabled  MAXLENGTH=30 tabIndex=0 size=35>
						<INPUT id=tx_eqp_size disabled  MAXLENGTH=20 tabIndex=0 size=28>
					</td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">*투입내역</div></td>
					<td width="80%" > 
						<INPUT id=tx_spec_unq_num  MAXLENGTH=18 tabIndex=0 size=12 disabled >
						<INPUT id=bt_spec_unq_num  type=button class=img_btnFind_S onclick=bt_spec_onclick()>
						<INPUT id=tx_name  MAXLENGTH=40 tabIndex=0 size=47 disabled >
					</td>
				</tr>
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">단가구분</div></td>
					<td width="80%" > 
						<comment id="__NSID__"><object id=ccom_price_method
						classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
						height=106 width=130>
							<PARAM NAME="Alignment" VALUE="1">
							<param name=Data     value="1^시간당,2^일당,3^월당">
							<param name=Auto     value=false>
							<param name=Enable   value=false>
							<param name=DataID     value=ds_1>
							<param name=CodeColumn value=price_method>
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
				</tr>                   
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">작업시간</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_run_time tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">대기시간</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_suspension_time tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">조정시간</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_extra_time tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">부과시간</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_settle_time tabIndex=0
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
							<PARAM NAME=ReadOnlyForeColor VALUE="#CC3333">
							<PARAM NAME="ReadOnly" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">부과단가</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_unitcost tabIndex=0
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="0">
							<PARAM NAME="PromptChar" VALUE="">
							<PARAM NAME=ReadOnlyForeColor VALUE="#CC3333">
							<PARAM NAME="ReadOnly" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">부과금액</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_settle_amt tabIndex=5
						style="WIDTH: 130px;  COLOR:#CC3333; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">연료수량</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_fuel_qty tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
					</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">연료금액</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_fuel_amt tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">잡유수량</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_oil_qty tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">잡유금액</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_oil_amt tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
					</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">수리내역</div></td>
					<td width="80%"> 
						<INPUT id=tx_repair_remark  MAXLENGTH=30 tabIndex=5 size=67></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">수리금액</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_repair_amt tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">운반내역</div></td>
					<td width="80%"> 
						<INPUT id=tx_move_remark  MAXLENGTH=30 tabIndex=5 size=67></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">운반금액</div></td>
					<td width="80%"> 
						<comment id="__NSID__"><OBJECT id=em_move_amt tabIndex=5
						style="WIDTH: 130px; " 
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="2">
							<PARAM NAME="MaxLength" VALUE="13">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				</tr>                 
				<tr BGCOLOR="white"> 
					<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
						<div align="right">작업내용</div></td>
					<td width="80%"> 
						<INPUT id=tx_run_remark  MAXLENGTH=30 tabIndex=5 size=67></td>
					</td>
				</tr> 
			</table>    
		</td>
	</tr>
</table>

<comment id="__NSID__"><OBJECT id=bd_data 
    	style="Z-INDEX: 108; LEFT: 124px; WIDTH: 22px; POSITION: absolute; TOP: -37px; HEIGHT: 18px" 
    	classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	    	<C>Col=equp_code       Ctrl=tx_equp_code Param=value Enable=enable</C>
	    	<C>Col=eqp_name        Ctrl=tx_eqp_name Param=value Enable=enable</C>
	    	<C>Col=eqp_size        Ctrl=tx_eqp_size Param=value Enable=enable</C>
		<C>Col=spec_unq_num    Ctrl=tx_spec_unq_num Param=value Enable=enable</C>
		<C>Col=spec_name            Ctrl=tx_name Param=value Enable=enable</C>
		<C>Col=run_time        Ctrl=em_run_time Param=text Enable=enable</C>
		<C>Col=suspension_time Ctrl=em_suspension_time Param=text Enable=enable</C>
		<C>Col=extra_time      Ctrl=em_extra_time Param=text Enable=enable</C>
		<C>Col=settle_time     Ctrl=em_settle_time Param=text Enable=enable</C>
		<C>Col=unitcost        Ctrl=em_unitcost Param=text Enable=enable</C>
		<C>Col=settle_amt      Ctrl=em_settle_amt Param=text Enable=enable</C>
		<C>Col=fuel_qty        Ctrl=em_fuel_qty Param=text Enable=enable</C>
		<C>Col=fuel_amt        Ctrl=em_fuel_amt Param=text Enable=enable</C>
		<C>Col=oil_qty         Ctrl=em_oil_qty Param=text Enable=enable</C>
		<C>Col=oil_amt         Ctrl=em_oil_amt Param=text Enable=enable</C>
		<C>Col=repair_remark   Ctrl=tx_repair_remark Param=value Enable=enable</C>
		<C>Col=repair_amt      Ctrl=em_repair_amt Param=text Enable=enable</C>
		<C>Col=move_remark     Ctrl=tx_move_remark Param=value Enable=enable</C>
		<C>Col=move_amt        Ctrl=em_move_amt Param=text Enable=enable</C>
		<C>Col=run_remark      Ctrl=tx_run_remark Param=value Enable=enable</C>
		<C>Col=price_method    Ctrl=ccom_price_method Param=codevalue Enable=false</C>
	" >
</OBJECT></comment> <script> __ws__(__NSID__);</script></div>
</BODY></HTML>
