<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : f_request_1h.html 										-->
<!-- 2. 유형(시나리오): shared window 조회및 입력								-->
<!-- 3. 기 능 정 의   : 경비투입내역입력(자금청구)  	  						-->
<!-- 4. 변 경 이 력   : 정호준 작성													-->
<!-- 5. 관련프로그램  :																	-->
<!-- 6. 특 기 사 항   :																	-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 

<script language="javascript" src="../../../comm_function/t_common/script/Common.js"></script>
<script language="javascript" src="../../../comm_function/t_common/script/Standard.js"></script>
<script language="javascript" src="../../../comm_function/t_common/script/Gauce.js"></script>
<script language="javascript" src="../../../comm_function/t_common/script/DefaultActions.js"></script>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var is_emp_dept = top.frames['security'].dept_code.value
var is_work_date
var is_close_check

var is_ds_1_addr = gs_home + '/const/f_web/01/f_request_1q.jsp?arg_dept_code='
var is_tr_1_addr = gs_home + '/const/f_web/01/f_request_1tr.jsp'
</script>
<!-- ======================================================================= -->
<!--                      Function                          -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	close_chk()

	ds_1.DataID = is_ds_1_addr + is_dept_code + "&arg_date=" + is_work_date
	ds_1.SyncLoad=true
	ds_1.Reset()
	
}

//------------------------------------------------------------------------
function close_chk()                     // 마감 체크
//------------------------------------------------------------------------
{
/*	
	is_close_check = f_close_chk(is_dept_code, is_work_date,'E')   // 각단위업무마감여부 체크(현장코드,년월,업무구분)

	if (is_close_check) {
		ds_1.ReadOnly = true
		tx_rqst_detail.disabled=1
		bt_cust_code.disabled=1
		tx_cust_name.disabled=1
		tx_vatcode.disabled=1
		tx_code.disabled=1
		bt_vat_code.disabled=1
		tx_acntcode.disabled=1
		tx_acntname.disabled=1
		bt_acnt_code.disabled=1
		bt_spec_unq_num.disabled=1
	}
	else {
		ds_1.ReadOnly = false
		tx_rqst_detail.disabled=0
		bt_cust_code.disabled=0
		tx_cust_name.disabled=0
		tx_vatcode.disabled=0
		tx_code.disabled=0
		bt_vat_code.disabled=0
		tx_acntcode.disabled=0
		tx_acntname.disabled=0
		bt_acnt_code.disabled=0
		bt_spec_unq_num.disabled=0
	}

}
*/

	is_cur_date = em_select_yymm.text.substr(0,4) + "." + em_select_yymm.text.substr(5,2) + '.01'
   is_close_tag = f_close_chk(is_dept_code,is_cur_date,'C')   // 각단위업무마감여부 체크(현장코드,년월,업무구분)
   
/*   ll_cnt = f_ds_select_q("ds_invoice", "select NVL(COUNT(*) ,0) select_1 from f_request " +
		 											 " where dept_code = '" + is_dept_code + "' and trunc(rqst_date, 'MM') = '" + is_cur_date + "' and " +
		 											 " res_class = 'X' and invoice_num is not null " ) */

   if (is_close_tag) {
//      if (ds_invoice.NameValue(1, "select_1") > 0)
//       	tx_close.value = '전표생성'
   	if (is_close_tag)
       	tx_close.value = '마감'
       gd_1.Editable = false
//	    button_1.style.visibility='hidden'
//	    button_2.style.visibility='hidden'
//	    button_3.style.visibility='hidden'
//	    button_5.style.visibility='hidden'
//	    ds_1.ReadOnly=true
//	    ds_2.ReadOnly=true
	    top.frames['main_title'].div_r.style.visibility="visible"
     	top.frames['main_title'].div_u.style.visibility="hidden"
     	top.frames['main_title'].div_p.style.visibility="hidden"
     	top.frames['main_title'].div_s.style.visibility="hidden"
     	
     	ccom_res_type.Auto = false
     	ccom_res_type.Enable = false
     	ccom_exe_type.Auto = false
     	ccom_income_type.Auto = false
     	ccom_dr_class.Auto = false
     	ccom_exe_type.Enable = false
     	ccom_income_type.Enable = false
     	ccom_dr_class.Enable = false
     	tx_rqst_detail.disabled = true
		bt_cust_code.disabled = true
//		tx_cust_name.disabled = true
//		tx_acntcode.disabled = true
//		tx_acntname.disabled = true
		bt_acnt_code.disabled = true
		bt_spec_unq_num.disabled = true
		bt_acnt_code_del.disabled = true
		bt_vat_code_del.disabled = true
		em_amt.readonly = true
		em_cash_amt.readonly = true
		em_vat.readonly = true
		em_income_amt.readonly = true
		em_civi_amt.readonly = true
		em_receipt_date.readonly = true
		em_credit_card_no.readonly = true
		bt_card_no.disabled = true
		tx_card_user.disabled = true
		ccom_fund_type.Auto = false
		ccom_fund_type.Enable = false

   }    
   else {
       tx_close.value = ''
       gd_1.Editable = true
//       button_1.style.visibility='visible'
//       button_2.style.visibility='visible'
//       button_3.style.visibility='visible'
//	       button_5.style.visibility='visible'
//       ds_1.ReadOnly=false
//       ds_2.ReadOnly=false
//       top.frames['main_title'].div_r.style.visibility="hidden"
       	top.frames['main_title'].div_u.style.visibility="visible"
//       top.frames['main_title'].div_p.style.visibility="hidden"
//       top.frames['main_title'].div_s.style.visibility="hidden"

		ccom_res_type.Auto = true
     	ccom_exe_type.Auto = true
     	ccom_income_type.Auto = true
     	ccom_dr_class.Auto = true
     	tx_rqst_detail.disabled = false
		bt_cust_code.disabled = false
//		tx_cust_name.disabled = false
//		tx_acntcode.disabled = false
//		tx_acntname.disabled = false
		bt_acnt_code.disabled = false
		bt_spec_unq_num.disabled = false
		bt_acnt_code_del.disabled = false
		bt_vat_code_del.disabled = false
		em_amt.readonly = true
		em_cash_amt.readonly = false
		em_vat.readonly = false
		em_income_amt.readonly = false
		em_civi_amt.readonly = false
		em_receipt_date.readonly = false
		em_credit_card_no.readonly = false
		bt_card_no.disabled = false
		tx_card_user.disabled = false
		ccom_fund_type.Auto = true
   }
   
}  

//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("seq");
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	var ll_seq
	ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
	ds_1.NameValue(ds_1.RowPosition,"rqst_date") = is_work_date
	ds_1.NameValue(ds_1.RowPosition,"res_type") = 'F'
	ds_1.NameValue(ds_1.RowPosition,"exe_type") = '1'
	ds_1.NameValue(ds_1.RowPosition,'dr_class') = '1'
	ds_1.NameValue(ds_1.RowPosition,'income_type') = '0'
	ds_1.NameValue(ds_1.RowPosition,'temp_chk') = 'F'
	
	
	/*
	if  (ds_1.CountRow > 1) {
		ll_seq = ds_1.Max(3,1,ds_1.CountRow)
		ds_1.NameValue(ds_1.RowPosition,"seq") = ll_seq + 1
	}
	else {
		ds_1.NameValue(ds_1.RowPosition,"seq") = 1
	}
	*/
	ds_1.NameValue(ds_1.RowPosition,"fund_type") = '2'
	ds_1.NameValue(ds_1.RowPosition,"cost_type") = '1'
	//ds_1.NameValue(ds_1.RowPosition,"receipt_rqst_type") = '2'
	Fn_SetColumn()
	f_check_income_type()
}
//------------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	 ds_1.AddRow()
	 init_move()

}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	 ds_1.InsertRow(ds_1.RowPosition)
	 init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	if  (gd_1.MultiRowSelect){               // multi row select
		for (i=ds_1.CountRow ;i >0 ;i--) {
			if (ds_1.RowMark(i) == 1 ) {		
        		if (ds_1.NameValue(i, "invoice_num") == '' || ds_1.NameValue(i, "invoice_num") == null) {
            	ds_1.DeleteRow(i)
				}
				else {
					alert("전표가 생성된 내역은 삭제가 불가능합니다")
					return
				}
	      }
	   }   
	   ds_1.MarkRows(ds_1.RowPosition,ds_1.RowPosition)  //삭제작업완료후 MARK
	} 
	else {
     		ds_1.DeleteRow(ds_1.RowPosition)  
	}
}
//---------------------------------------------------------------------------
function data_chk()                       // 필수입력항목 체크(저장시 호출)
//---------------------------------------------------------------------------
{	var val_data = ''
	var ar_col = new Array();
	var ar_ermsg = new Array();

	ar_col[0] = 'cust_name'
	ar_col[1] = 'spec_unq_num'
	ar_col[2] = 'acntcode'
	ar_col[3] = 'receipt_date'
	ar_col[4] = 'vatcode'

	ar_ermsg[0] = '거래처 미입력 에러'
	ar_ermsg[1] = '투입내역 미입력 에러'
	ar_ermsg[2] = '계정과목 미입력 에러'
	ar_ermsg[3] = '계산서발행일(작성일) 미입력 에러'
	ar_ermsg[4] = '부가세코드 미입력 에러(부가세코드가 있을때)'


	for (i=1; i<= ds_1.CountRow; i++){
		for (j=0; j<= 4; j++){
			val_data = ''
			val_data = ds_1.namevalue( i, ar_col[j])
			if ( val_data==null )  {val_data = ''}
			if ( val_data==0 )  {val_data = ''}// spec_unq_num 숫자타입이라서 0이 디폴트로 들어가기때문에..미입력으로본다  (실제로 unq_num 이 0이면???)
			val_data =val_data.toString()
			
			if ( j != 4 ) {
				if ( !(val_data.length > 0 ) ) {
						alert( i+'번째 ' + ar_ermsg[j])
						return false
				}
			}
			else{
				if ( !(val_data.length > 0 ) && ds_1.NameValue(i,'vat') != 0 && is_work_date > '2006.04.30') { //부가세코드는 부가세가 잇을때만 필수입력
					alert( i+'번째 ' + ar_ermsg[j])
					return false
				}
			}
		}
	}

	return true
}

//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	
	if (is_close_check) {
		alert("마감된 자료이므로 수정 할 수 없습니다")
		return
	}
	
	if (ds_1.IsUpdated){
		if  (confirm("변경되었습니다 저장하시겠습니까?")){
			if ( data_chk()  ){
				tr_1.Post()
				//저장후 자동 추가 김상필님 요구사항
				btnadd_onclick()
			}
		}
	}
}
//---------------------------------------------------------------------------
function btnsave_onclick_bak()                       // 저장
//---------------------------------------------------------------------------
{
	var ls_chk=0,ls_spec_chk=0,ls_vat_chk=0,ls_rct_chk=0,ls_cst_chk=0,ls_fnd_chk=0
	
	if (is_close_check) {
		alert("마감된 자료이므로 수정 할 수 없습니다")
		return
	}
	
	if (ds_1.IsUpdated){
		if  (confirm("변경되었습니다 저장하시겠습니까?")){
		   	for (i=1; i<= ds_1.CountRow; i++){
			   	if (ds_1.NameValue(i,"cust_name") == '' && ds_1.NameValue(i,"res_type") != 'L'){
		   			ls_chk++
	   			}
	   			if (ds_1.NameValue(i,"spec_unq_num") == 0 && ds_1.NameValue(i,"res_type") == 'F'){ //&& ds_1.NameValue(i,"cost_type") == '1' ){
	   				ls_spec_chk++
	   			}
	   			if (is_work_date > '2006.04.30' && ds_1.NameValue(i,"vatcode") == ''  && ds_1.NameValue(i,'vat') != 0 ){
	   				ls_rct_chk++
	   			}
	   			if (ds_1.NameValue(i,"receipt_date") == '' ){
	   				ls_vat_chk++
	   			}
	   			/*if (ds_1.NameValue(i,"vatcode") != '' && ds_1.NameValue(i,"cust_code") == '' ){
	   				ls_cst_chk++
	   			}*/
//	   			if (ds_1.NameValue(i,"acntcode") != '' && (ds_1.NameValue(i,"fund_type") == '1' || ds_1.NameValue(i,"fund_type") == '4'  || ds_1.NameValue(i,"fund_type") == '5' )){
//	   				ls_fnd_chk++
//	   			}
	   		}
	   		
	   		if (ls_rct_chk == 0 && ls_chk == 0 && ls_spec_chk == 0 &&  ls_vat_chk == 0 && ls_cst_chk == 0 && ls_fnd_chk == 0) {
					tr_1.Post()
					//btnquery_onclick()
					//저장후 자동 추가 김상필님 요구사항
					btnadd_onclick() 
					return
	       	}
 				if (ls_chk != 0 ) {
   				alert("거래처를 반드시 입력하십시오 \n        저장되지않았습니다.")
   				return
   			}
				if (ls_spec_chk != 0 ) {
					alert("투입내역을 반드시 선택하십시오 \n         저장되지않았습니다.")
   				return
				}
				if (ls_rct_chk != 0 ) {
					alert("부가세계정과목을 반드시 선택하십시오 \n         저장되지않았습니다.")
   				return
				}
				if (ls_vat_chk != 0 ) {
				   alert("계산서발행일(작성일)을 반드시 선택하십시오 \n         저장되지않았습니다.");
   				return
				}
				if (ls_cst_chk != 0 ) {
					alert("부가세 코드가 있는것은 거래처코드를 입력하세요 \n         저장되지않았습니다.")
   				return
				}
				if (ls_fnd_chk != 0 ) {
					alert("자금구분이 현장지급과 외상인 경우만 계정코드를 입력합니다. \n         저장되지않았습니다.")
   				return
				}
				
	   }
	}
	return
}
//---------------------------------------------------------------------------
function bt_det_onclick()
//---------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	result = result = window.showModalDialog("../00/f_request_code_find_1h.html",'',"dialogWidth:840px;dialogHeight:700px");
	
	if(result == "") return;

	array = result.split("@");
			ds_1.NameString(ds_1.RowPosition,"code")      = array[0];   // 계정
			ds_1.NameString(ds_1.RowPosition,"det_code")  = array[1];   // 계정세부
			ds_1.NameString(ds_1.RowPosition,"soyo_name") = array[2];   // 계정명
			ds_1.NameString(ds_1.RowPosition,"det_name")  = array[3];   // 계정세부명
			return
}
//---------------------------------------------------------------------------
function bt_cust_onclick()                     //거래처 찾기
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();send_arg = ""
	result = window.showModalDialog(gs_home + "/const/f_web/00/f_cust_code_find_1h.html", send_arg,"dialogWidth:590px;dialogHeight:480px");
	
	if(result == "") return;

	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"cust_code") = array[0]
	ds_1.NameValue(ds_1.RowPosition,"cust_name") = array[1]
	f_format_cust_code()
}
//---------------------------------------------------------------------------
function bt_vat_onclick()                     //부가세코드 찾기
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	send_arg = ""
	result = window.showModalDialog(gs_home + "/const/f_web/00/f_vat_code_find_1h.html", send_arg,"dialogWidth:380px;dialogHeight:500px");
	
	if(result == "") return;

	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"vatcode") = array[0]
	ds_1.NameValue(ds_1.RowPosition,"code") = array[1]
}
//---------------------------------------------------------------------------
function bt_acnt_onclick()                     //계정코드 찾기
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	send_arg = ""
	result = window.showModalDialog(gs_home + "/const/f_web/00/f_acnt_code_find_1h.html", send_arg,"dialogWidth:380px;dialogHeight:500px");
	
	if(result == "") return;

	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"acntcode") = array[0]
	ds_1.NameValue(ds_1.RowPosition,"acntname") = array[1]
}
//---------------------------------------------------------------------------
function bt_acnt_del_onclick()                     //계정코드 샥제
//---------------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"acntcode") = ''
	ds_1.NameValue(ds_1.RowPosition,"acntname") = ''

}
//---------------------------------------------------------------------------
function bt_vat_del_onclick()                     //계정코드 샥제
//---------------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"vatcode") = ''
	ds_1.NameValue(ds_1.RowPosition,"code") = ''

}
//---------------------------------------------------------------------------
function bt_soyo_del_onclick()                     //계정코드 샥제
//---------------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"code") = ''
	ds_1.NameValue(ds_1.RowPosition,"det_code") = ''
	ds_1.NameValue(ds_1.RowPosition,"soyo_name") = ''
	ds_1.NameValue(ds_1.RowPosition,"det_name") = ''

}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	        {  //저장 routine
	        }   
 
	   }     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

	// top.frames['main_ct'].window.close()     
}
//-------------------------------------------------------------------------------
function query_prev()                  //이전자료 조회
//--------------------------------------------------------------------------------
{
	ll_cnt = f_select_q("select to_char(max(rqst_date),'yyyy.mm.dd') select_1 " +
	                    "from f_request where dept_code = " + "'" + is_dept_code + "'" +
	                    " and to_char(rqst_date,'yyyy.mm.dd') < " + "'" + is_work_date + "' and res_class='X' ")
	
	ls_temp = ds_select.NameValue(ds_select.RowPosition,"select_1")
	
	if (ll_cnt > 0 && ls_temp != '') {
		is_work_date     = ds_select.NameValue(ds_select.RowPosition,"select_1")
		em_select_yymm.text = is_work_date
		btnquery_onclick()
	}
	else {
		alert("이전자료가 존재하지 않습니다")
	}
}
//-------------------------------------------------------------------------------
function query_next()                  //다음자료 조회
//--------------------------------------------------------------------------------
{
	ll_cnt = f_select_q("select to_char(min(rqst_date),'yyyy.mm.dd') select_1 " +
	                    "from f_request where dept_code = " + "'" + is_dept_code + "'" +
	                    " and to_char(rqst_date,'yyyy.mm.dd') > " + "'" + is_work_date + "' and res_class='X' ")
	
	ls_temp = ds_select.NameValue(ds_select.RowPosition,"select_1")
	
	if (ll_cnt > 0 && ls_temp != '') {
		is_work_date     = ds_select.NameValue(ds_select.RowPosition,"select_1")
		em_select_yymm.text = is_work_date
		btnquery_onclick()
	}
	else {
		alert("다음자료가 존재하지 않습니다")
	}
}
//---------------------------------------------------------------------------
function bt_spec_onclick()                     //실행내역 찾기
//---------------------------------------------------------------------------
{
	if ( ds_1.RowPosition == 0 ) {
		return
	}
	if (ds_1.NameValue(ds_1.RowPosition,"res_type") != 'F' ) {
		return
	}
	var result;
	var array = new Array();
	result = window.showModalDialog(gs_home + "/comm_search/y_budget_find_1h.html","exp@" + is_dept_code,"dialogWidth:1020px;dialogHeight:700px");
	if(result == "") return;
	array = result.split("@");
	ds_1.NameString(ds_1.RowPosition,"spec_no_seq") = array[0];   // 실행 상위 unq_no 
	ds_1.NameString(ds_1.RowPosition,"spec_unq_num") = array[1];  // 실행내역 unq_no 
	ds_1.NameString(ds_1.RowPosition,"spec_name") = array[2];          // 실행내역 명칭 
}

//---------------------------------------------------------------------------
function bt_req_spec_onclick()                     //자금청구내역 찾기
//---------------------------------------------------------------------------
{
	if ( ds_1.RowPosition == 0 ) {
		return
	}
	/*
	if (ds_1.NameValue(ds_1.RowPosition,"res_type") != 'F' ) {
		alert('자원구분이 현장관리비 일대만 내역입력가능합니다')
		return
	}
	*/
	var arg = gs_home +'@'+ is_dept_code +'@'+ is_dept_name +'@'+ is_work_date +'@'+ is_emp_dept 

	result = window.showModalDialog("f_req_find_1h.html",arg + is_dept_code,"dialogWidth:1020px;dialogHeight:700px");
	//alert(result)
	if(result == "") return;

	var result;
	var array = new Array();
	array = result.split("@");
	ds_1.NameString(ds_1.RowPosition,"spec_no_seq") = array[0];   // 실행 상위 unq_no 
	ds_1.NameString(ds_1.RowPosition,"spec_unq_num") = array[1];  // 실행내역 unq_no 
	ds_1.NameString(ds_1.RowPosition,"spec_name") = array[2];          // 실행내역 명칭 
	ds_1.NameString(ds_1.RowPosition,'detail_code') = array[3];
}

//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	result = f_dept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	dept_name.value = is_dept_name
	btnquery_onclick()
}   
//-------------------------------------------------------------------------------
function select_yymm()                  //년월 선택 
//--------------------------------------------------------------------------------
{
   is_work_date = em_select_yymm.text.substr(0,4) + "." + em_select_yymm.text.substr(5,2)  + "." +  em_select_yymm.text.substr(8,2)
   ds_1.ClearData()
   btnquery_onclick()
 
}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//----------------------------------------------------------------
function excel_down()                      //엑셀자료 내리기(공종별) 
//----------------------------------------------------------------
{	var filename = '투입내역';
	var sheet_name = filename+'('+is_dept_name+'_'+is_work_date+')';
	file_name = sheet_name+".xls";
	gd_1.GridToExcel(sheet_name, file_name, 2)

 //var temp_1
 //temp_1 = is_dept_name + '   [' + em_select_yymm.text + ']'
 //gd_1.RunExcelSheet(temp_1)
   
}

//----------------------------------------------------------------
function f_format_cust_code()
//----------------------------------------------------------------
{var s_temp 
 s_temp = ds_1.NameValue(ds_1.RowPosition,"cust_code")
 
  if (ds_1.RowPosition < 1)
 	 return
 
  if (s_temp.length == 14) {
    em_cust_code.Format="000000-0000000"
	 //em_cust_code.MaxLength ="13"
  }
  else {
      em_cust_code.Format="000-00-00000999"
		//em_cust_code.MaxLength ="13"
  }
}
//---------------------------------------------------------------------------
function stand_acntcode_find()                     //내역별계정코드찾기
//---------------------------------------------------------------------------
{
	var result;
	var send_arg;
	var array = new Array();
	send_arg = ds_1.namevalue(ds_1.rowposition, 'detail_code')
	result = window.showModalDialog(gs_home + "/const/f_web/00/f_stand_acntcode_find_1h.html", send_arg,"dialogWidth:380px;dialogHeight:500px");
	
	if(result == "") return;

	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"acntcode") = array[0]
	ds_1.NameValue(ds_1.RowPosition,"acntname") = array[1]
}
//---------------------------------------------------------------------------
function btnACC_CODE_onClick()
//---------------------------------------------------------------------------
{

	var ls_detail_code = ds_1.NameValue(ds_1.RowPosition, 'detail_code')
//	alert(ls_detail_code)
	f_ds_select_q('ds_stand_acntcode' ,"select count(*) select_1 from y_stand_detail_acntcode where detail_code = '"+ls_detail_code+"'" )
	
	//alert(ds_stand_acntcode.namevalue(1, 'select_1'))
	if (ds_stand_acntcode.namevalue(1, 'select_1') > 0 ){
		stand_acntcode_find()
		return
	}

	var lrArgs = new C_Dictionary();
	var lrRet = null;
	
	lrArgs.set("SEARCH_CONDITION", tx_acntcode.value);

	if (C_isNull(tx_acntcode.value))
	{
		lrRet = C_LOV("T_ACC_CODE1", lrArgs,"F");
	}
	else
	{
		lrRet = C_LOV("T_ACC_CODE1", lrArgs,"T");
	}
	
	if (lrRet == null) return;

	//txtACC_CODE.value = lrRet.get("ACC_CODE");
	//txtACC_NAME.value = lrRet.get("ACC_NAME");
	ds_1.NameValue(ds_1.RowPosition,"acntcode") = lrRet.get("ACC_CODE");
	ds_1.NameValue(ds_1.RowPosition,"acntname") = lrRet.get("ACC_NAME");
}
//---------------------------------------------------------------------------
function btnvat_CODE_onClick()
//---------------------------------------------------------------------------
{

	var ls_detail_code = ds_1.namevalue(ds_1.rowposition, 'detail_code')
	//alert(ls_detail_code)
	//f_ds_select_q('ds_stand_acntcode' ,"select count(*) select_1 from y_stand_detail_acntcode where detail_code = '"+ls_detail_code+"'" )
	
//	if (ds_stand_acntcode.namevalue(1, 'select_1') > 0 ){
//		stand_acntcode_find()
//		return
//	}

	var lrArgs = new C_Dictionary();
	var lrRet = null;
	
	lrArgs.set("SEARCH_CONDITION", tx_vatcode.value);

	if (C_isNull(tx_vatcode.value))
	{
		lrRet = C_LOV("T_ACC_CODE1", lrArgs,"F");
	}
	else
	{
		lrRet = C_LOV("T_ACC_CODE1", lrArgs,"T");
	}
	
	if (lrRet == null) return;

	//txtACC_CODE.value = lrRet.get("ACC_CODE");
	//txtACC_NAME.value = lrRet.get("ACC_NAME");
	ds_1.NameValue(ds_1.RowPosition,"vatcode") = lrRet.get("ACC_CODE");
	ds_1.NameValue(ds_1.RowPosition,"code") = lrRet.get("ACC_NAME");
}
//---------------------------------------------------------------------------
function btnCUST_CODE_onClick()
//---------------------------------------------------------------------------
{
	var lrArgs = new C_Dictionary();
	var lrRet = null;
	
	lrArgs.set("CUST_CODE",ds_1.NameValue(ds_1.RowPosition,"cust_code"));
	
	var lrRet = window.showModalDialog(gs_home + "/general/t_web/01/t_RCustCodeR.jsp",lrArgs,"center:yes;dialogWidth:806px;dialogHeight:423px;status:no;help:no;");
	
	if (lrRet == null) {
		return
	}
	ds_1.NameValue(ds_1.RowPosition,"cust_code") = lrRet.CUST_CODE;
	ds_1.NameValue(ds_1.RowPosition,"cust_name") = lrRet.CUST_NAME;

//	lrArgs.set("SEARCH_CONDITION", ds_1.NameValue(ds_1.RowPosition,"cust_code"));
//
//	if (C_isNull(ds_1.NameValue(ds_1.RowPosition,"cust_code")) || ds_1.NameValue(ds_1.RowPosition,"cust_code")=='undefined')
//	{
//		lrRet = C_LOV("T_CUST_CODE1", lrArgs,"F");
//	}
//	else
//	{
//		lrRet = C_LOV("T_CUST_CODE1", lrArgs,"T");
//	}
//
//	if (lrRet == null) return;
//
//	//txtCUST_CODE.value = lrRet.get("CUST_CODE");
//	//txtCUST_NAME.value = lrRet.get("CUST_NAME");
//
//	ds_1.NameValue(ds_1.RowPosition,"cust_code") = lrRet.get("CUST_CODE");
//	ds_1.NameValue(ds_1.RowPosition,"cust_name") = lrRet.get("CUST_NAME");
	f_format_cust_code()
}
//---------------------------------------------------------------------------
function btnCARD_CARDNO_onClick()
//---------------------------------------------------------------------------
{
	var lrArgs = new C_Dictionary();
	var lrRet = null;
	//G_addDataSet(dsLOV, null, null, null, "LOV");

	//lrArgs.set("COMP_CODE", txtCOMP_CODE.value);
	//lrArgs.set("CARD_CLS", "1");
	//lrArgs.set("CARDNO", txtCARD_CARDNO.value);
	lrArgs.set("COMP_CODE", '');
	lrArgs.set("CARD_CLS", "1");
	lrArgs.set("CARDNO", ds_1.namevalue(ds_1.rowposition, 'credit_card_no'));
	lrArgs.set("CARD_OWNER", ds_1.namevalue(ds_1.rowposition, 'card_user'));
	
	 if (C_isNull(ds_1.NameValue(ds_1.RowPosition,"credit_card_no")) && C_isNull(ds_1.NameValue(ds_1.RowPosition,"card_user")))
	{
		lrRet = C_LOV("T_ACC_CREDCARD3", lrArgs,"F");
	}
	else
	{
		lrRet = C_LOV("T_ACC_CREDCARD3", lrArgs,"T");
	}

	if (lrRet == null) return;
	
	//lrRet = C_LOV("T_ACC_CREDCARD3", lrArgs,"F");
	//dsSLIP_D.NameString(dsSLIP_D.RowPosition, "CARD_SEQ")		= lrRet.get("CARD_SEQ");
	
	ds_1.namevalue(ds_1.rowposition, 'credit_card_no')		= lrRet.get("CARDNO");
	ds_1.namevalue(ds_1.rowposition, 'card_user')	= lrRet.get("CARD_OWNER");
}

//---------------------------------------------------------------------------
function f_check_income_type()
//---------------------------------------------------------------------------
{
	var ls_income_type = ds_1.namevalue(ds_1.RowPosition, 'income_type')

	if (ls_income_type == '0') {
		em_vat.readonly = false
		em_income_amt.readonly = true
		em_civi_amt.readonly = true
		ds_1.NameValue(ds_1.RowPosition,'income_amt') = 0
		ds_1.NameValue(ds_1.RowPosition,'civi_amt') = 0
	}
	else {
		em_vat.readonly = true
		em_income_amt.readonly = false
		em_civi_amt.readonly = false
		ds_1.NameValue(ds_1.RowPosition,'vat') = 0
		ds_1.NameValue(ds_1.RowPosition,'vatcode') = ''
	}

}
//---------------------------------------------------------------------------
function f_check_item_code()
//---------------------------------------------------------------------------
{
	var ls_res_type = ds_1.namevalue(ds_1.rowposition, 'res_type')
	//alert(ls_res_type)
	if (ls_res_type =='S'	){
		
		ccom_item_code.style.visibility="visible"
		item_title.style.visibility="visible"
		ls_item_code = ds_1.namevalue(ds_1.rowposition, 'item_code')
		
		if ( !ls_item_code.length > 0) {
		alert('안전관리비 항목을 선택하세요')
		ds_1.namevalue(ds_1.rowposition, 'item_code') = '01'
		}

		//ccom_item_code.focus();
	}
	else{
		ccom_item_code.style.visibility = 'hidden'
		item_title.style.visibility="hidden"
		ds_1.namevalue(ds_1.rowposition, 'item_code') = ''
	}

}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{

  if (f_reject_window()) return 
	top.frames['main_title'].mouse_over()
	is_work_date = f_sysdate()
	tr_1.Action = is_tr_1_addr 
	dept_name.value = is_dept_name
	em_select_yymm.text = is_work_date
	
	//f_select1_q("select '' select_1, '' select_2, '0' select_3 from dual union all select code select_1, name select_2, code select_3 from f_request_acnt")
	
	f_ds_select_q("ds_safety_code","	select safety_code select_1, child_name select_2  from e_safety_code_child  where class_tag = '033'	 order by safety_code")
	btnquery_onclick()	
	resize()
	
}
//----------------------------------------------------------------------------
function resize()                              // resize event
//----------------------------------------------------------------------------
{
   gd_1.width = 452
   gd_1.height = document.body.clientHeight - 30 - 10
}
</SCRIPT>
<!-- ======================================================================= -->
<!--                     Event                          -->
<!-- ======================================================================= -->
<script language=JavaScript for=ccom_res_type event=OnCloseUp()>
	setTimeout('f_check_item_code()',1)

</script>
<script language=JavaScript for=ccom_income_type event=OnCloseUp()>
	setTimeout('f_check_income_type()',1)

</script>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
	if (kcode == 13) {
	    if (ds_1.RowPosition == ds_1.CountRow)  
	        btnadd_onclick()
	    else     
	        ds_1.RowPosition++
	}
</SCRIPT>

<SCRIPT language=JavaScript for=em_select_yymm event=onKillFocus()>
        if (em_select_yymm.Modified){ 
	   select_yymm()
	   }
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_yymm event=onKeyDown(kcode,scode)>
        if ((em_select_yymm.Modified) && kcode == 13 ){ 
	   select_yymm()
	   }
</SCRIPT>        	

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
	alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=ds_stand_acntcode event=OnLoadError()>
	alert("Error Code : " + ds_stand_acntcode.ErrorCode + "\n" + "Error Message : " + ds_stand_acntcode.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
	alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=OnRowPosChanged(row)>
   f_format_cust_code();
   f_check_item_code()
   
   if (row < 1)
   	return
   	
	if (ds_1.NameValue(row, "invoice_num") == "" || ds_1.NameValue(row, "invoice_num") == null ) {
		tx_invoice_check.value = ''
		gd_1.ColumnProp("res_type","Edit") = ''
		gd_1.ColumnProp("rqst_detail","Edit") = ''
//       top.frames['main_title'].div_r.style.visibility="hidden"
//      	top.frames['main_title'].div_u.style.visibility="visible"
//       top.frames['main_title'].div_p.style.visibility="hidden"
//       top.frames['main_title'].div_s.style.visibility="hidden"

		ccom_res_type.Auto = true
     	ccom_exe_type.Auto = true
     	ccom_income_type.Auto = true
     	ccom_dr_class.Auto = true
     	tx_rqst_detail.disabled = false
		bt_cust_code.disabled = false
//		tx_cust_name.disabled = false
//		tx_acntcode.disabled = false
//		tx_acntname.disabled = false
		bt_acnt_code.disabled = false
		bt_spec_unq_num.disabled = false
		bt_acnt_code_del.disabled = false
		bt_vat_code_del.disabled = false
		em_amt.readonly = true
		em_cash_amt.readonly = false
		if (ds_1.NameValue(row,'income_type') == '0') {
			em_vat.readonly = false
			em_income_amt.readonly = true
			em_civi_amt.readonly = true
		}
		else {
			em_vat.readonly = true
			em_income_amt.readonly = false
			em_civi_amt.readonly = false
		}
		em_receipt_date.readonly = false
		em_credit_card_no.readonly = false
		bt_card_no.disabled = false
		tx_card_user.disabled = false
		ccom_fund_type.Auto = true
	}
	else {   
		tx_invoice_check.value = '전표생성'
		gd_1.ColumnProp("res_type","Edit") = 'none'
		gd_1.ColumnProp("rqst_detail","Edit") = 'none'
//   		top.frames['main_title'].div_r.style.visibility="visible"
//	     	top.frames['main_title'].div_u.style.visibility="hidden"
//	     	top.frames['main_title'].div_p.style.visibility="hidden"
//	     	top.frames['main_title'].div_s.style.visibility="hidden"
     	
     	ccom_res_type.Auto = false
     	ccom_res_type.Enable = false
     	ccom_exe_type.Auto = false
     	ccom_income_type.Auto = false
     	ccom_dr_class.Auto = false
     	ccom_exe_type.Enable = false
     	ccom_income_type.Enable = false
     	ccom_dr_class.Enable = false
     	tx_rqst_detail.disabled = true
		bt_cust_code.disabled = true
//		tx_cust_name.disabled = true
//		tx_acntcode.disabled = true
//		tx_acntname.disabled = true
		bt_acnt_code.disabled = true
		bt_spec_unq_num.disabled = true
		bt_acnt_code_del.disabled = true
		bt_vat_code_del.disabled = true
		em_amt.readonly = true
		em_cash_amt.readonly = true
		em_vat.readonly = true
		em_income_amt.readonly = true
		em_civi_amt.readonly = true
		em_receipt_date.readonly = true
		em_credit_card_no.readonly = true
		bt_card_no.disabled = true
		tx_card_user.disabled = true
		ccom_fund_type.Auto = false
		ccom_fund_type.Enable = false
	}
</SCRIPT>
<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>
	if ( colid == 'code' ) {
		//ds_select2.ClearAll()
		//ds_1.NameValue(row, 'det_code') = ''
		//ls_code = ds_1.NameValue(row, colid)
		//if ( ls_code != '' ) {
			//f_select2_q(" select '' select_1, '' select_2 from dual union all select det_code select_1, name select_2 from f_request_acnt_det where code = '" + ls_code + "' " )
		//}
	}
</script>

<SCRIPT language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>
	if (colid == 'cash_amt'){
		if (ds_1.NameValue(row,'income_type') == '0') {
			ds_1.NameValue(row,'vat') = parseInt(ds_1.NameValue(row,'cash_amt') * 0.1,10);
		}
		ds_1.NameValue(row,'amt') = ds_1.NameValue(row,'bill_amt') + ds_1.NameValue(row,'cash_amt')
	}

	if (colid == 'income_amt'){
		ds_1.NameValue(row,'civi_amt') = parseInt(ds_1.NameValue(row,'income_amt') * 0.1,10);
	}

	if (colid == 'bill_amt'){
			ds_1.NameValue(row,'amt') = ds_1.NameValue(row,'bill_amt') + ds_1.NameValue(row,'cash_amt')
	}

//if  ((colid  ==  "amt")  ||   (colid  ==  "vat")|| (colid   ==  "deduct_amt")  || (colid   ==  "bill_amt")){
//     ds_1.NameValue(row,"cash_amt") = ds_1.NameValue(row,"amt") + ds_1.NameValue(row,"vat") - ds_1.NameValue(row,"bill_amt") - ds_1.NameValue(row,"deduct_amt")
     //tx_bill_cash_amt.text = ds_1.NameValue(row,"amt") + ds_1.NameValue(row,"vat") - ds_1.NameValue(row,"deduct_amt")
//}
</SCRIPT>
<!-- ======================================================================= -->
<!--                      Component                          -->
<!-- ======================================================================= -->

<comment id="__NSID__"><Object id=ds_safety_code
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_stand_acntcode
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=dsLOV
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
       <param name=SortExpr       value="+select_3"> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>            
<comment id="__NSID__"><Object id=ds_close_check
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> 
      <param name=SortExpr       value="+select_3"> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT></comment> <script> __ws__(__NSID__);</script>	
<comment id="__NSID__"><OBJECT id=ds_invoice 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:f_request_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	
</HEAD>

<!-- ======================================================================= -->
<!--                     Body                         -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0;"  onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<div class=main_div>
	<!--  <table class=main_table > -->
	<table width="100%" height="95%" BORDER="0"  cellpadding="0"  CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
		<TR height="23px">
			<TD class=td_green>
					<table border= "0" cellpadding="0" cellspacing="0" class=main_table>
						<tr>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td width="45px" class=font_green_bold>현장명</td>
							<td width="166">
								<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"   style="ime-mode:active"   style=" FONT-SIZE: 12px" style="ime-mode:active " size=25 onkeyDown="keyDown()"   >
							</td>
							<td width="60">
								<input id="button_query" type="button" value="검색" class="img_btnFind"   onclick=dept_code_find()
										onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"  >
							</td>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td width="55px" class=font_green_bold>투입일자</td>
							<td width="80">
								<comment id="__NSID__"><OBJECT id=em_select_yymm 
										 style="width: 100%; background: white;" 
										classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
										 <PARAM NAME="Alignment" VALUE="1">
										 <PARAM NAME="IsComma" VALUE="0">
										 <PARAM NAME="MaxLength" VALUE="8">
										 <PARAM NAME="Format" VALUE="YYYY-MM-DD">
										 <param name=ClipMode       value=false>
										 <PARAM NAME="Numeric" VALUE="0">
										 <PARAM NAME="SelectAll" VALUE="-1">
								</OBJECT></comment> <script> __ws__(__NSID__);</script>
							</td>
							<td width=25px>
									<input id=img_fr type=button class="img_btnCalendar_S"
												onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"
												OnClick="var result = gn_Cal_Yyyymmdd(); if(!is_null(result)){ em_select_yymm.text = result.substr(0,10);  select_yymm();} ; btnquery_onclick();">
							</td>
							<td width="50px">
								<input type="text" id=tx_close style="Z-INDEX:100; COLOR: #ff0080; background: #DCF2EC; BORDER-RIGHT: 1px; BORDER-TOP: 1px;BORDER-LEFT: 1px; BORDER-BOTTOM: 1px;" tabindex=-1 size=8 readonly ></td>
							<td width="*" align="right">
									<input id=bt_query_prev type="button" value="이전자료" 
										class="img_btn4_1"
										onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"  onclick=query_prev()>
									<input id=bt_query_next type="button" value="다음자료" 
										class="img_btn4_1"
										onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"   onclick=query_next()>
							
									<input id=bt_excel_gd_parent_query type="button" value="엑셀" class="img_btn4_1" onclick=excel_down()
										 onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"  > &nbsp;&nbsp;
							</td>
						</tr>
					</table>

			</TD>
		</TR>
		<TR height="*">
			<TD>
					<table border=0   CELLSPACING="0"  width=100% height=100%>
					<TR>
						<TD>
								<comment id="__NSID__"><OBJECT id=gd_1 
										style="width:100%; height:100%;" 
										classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
									<PARAM NAME="MultiRowSelect" VALUE="-1">
									<PARAM NAME="DataID" VALUE="ds_1">
									<PARAM NAME="AutoInsert" VALUE="-1">
									<PARAM NAME="BorderStyle"  VALUE=1>
									<PARAM NAME="AllShowEdit" VALUE="-1">
									<PARAM NAME="Editable" VALUE="0">
									<PARAM NAME="ColSizing" VALUE="-1">
									<PARAM NAME="Format" VALUE="
									  <C> Name='순번' ID=seq Edit=None Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=55 </C>
									  <C> Name='자원구분' ID=res_type Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 
											EditStyle=Combo Data='F:현장관리비,S:안전관리비,C:공사비,L:노무비 '</C>
									  <C> Name='적요' ID=rqst_detail  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=270 </C>
									  <C> Name='공급가' ID=amt show=false  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 </C>
									  <C> Name='부가세' ID=vat show=false BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 </C>
									  ">
								</OBJECT></comment> <script> __ws__(__NSID__);</script>
						</TD>
						<TD width=551px>
								
									<table width="100%" height="100%" BORDER="1"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
										<tr > 
											<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
												  <div align="right">자원구분</div></td>
											<td  colspan=17 > 
												<table width="100%" height="1px" BORDER="0"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
													<tr > 
														<td>
															<table border="0" cellspacing="0" cellpadding="0">
																<tr>
																	<td>
															<comment id="__NSID__"><OBJECT id=ccom_res_type 
																classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
																								 height=106 width=103px;>
																<PARAM NAME="Alignment" VALUE="1">
																<PARAM NAME=Data VALUE="F^현장관리비,S^안전관리비,C^공사비,L^노무비">
																<PARAM NAME="ReadOnly" VALUE="-1">
																<param name=DataID           value=ds_1>
																<param name=CodeColumn      value=res_type>
															</OBJECT></comment> <script> __ws__(__NSID__);</script>
																	</td>
																	<td>
															&nbsp;&nbsp;<input type="text" id="tx_invoice_check" size="10" style="border: 1 solid white; COLOR: #ff0080;" readonly >
																	</td>
																</tr>
															</table>
														</td>
														<td align=right>
															<div id=item_title style="visibility: hidden">안전관리항목
															</div>
														</td>
														<td>
															<comment id="__NSID__"><OBJECT id=ccom_item_code   
																 style="WIDTH: 150px; visibility: hidden"
																 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
																<PARAM NAME="Alignment" VALUE="1">
																<PARAM NAME="ComboDataID" VALUE="ds_safety_code">
																<PARAM NAME="CodeCColumn" VALUE="select_1">
																<PARAM NAME="DataCColumn" VALUE="select_2">
																<param name=DataID           value=ds_1>
																<param name=CodeColumn      value=item_code>
															</OBJECT></comment> <script> __ws__(__NSID__);</script>
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr > 
											<td    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												  <div align="right">투입구분</div></td>
											<td colspan=7> 
												<comment id="__NSID__"><OBJECT id=ccom_exe_type 
													classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
																					 height=106 width=103px;>
													<PARAM NAME="Alignment" VALUE="1">
													<PARAM NAME=Data VALUE="1^현금,2^법인카드,3^미불금">
													<PARAM NAME="ReadOnly" VALUE="-1">
													<param name=DataID           value=ds_1>
													<param name=CodeColumn      value=exe_type>
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
											<td    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												  <div align="right">소득세구분</div></td>
											<td colspan=7> 
												<comment id="__NSID__"><OBJECT id=ccom_income_type
													classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
																					 height=106 width=103px;>
													<PARAM NAME="Alignment" VALUE="1">
													<PARAM NAME=Data VALUE="0^  ,1^일용직,2^퇴직소득,3^기타소득">
													<PARAM NAME="ReadOnly" VALUE="-1">
													<param name=DataID           value=ds_1>
													<param name=CodeColumn      value=income_type>
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>
										<tr > 
											<td    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												  <div align="right">차대구분</div></td>
											<td colspan=17 > 
												<comment id="__NSID__"><OBJECT id=ccom_dr_class 
													classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
																					 height=106 width=103px;>
													<PARAM NAME="Alignment" VALUE="1">
													<PARAM NAME=Data VALUE="1^차변,2^대변">
													<PARAM NAME="ReadOnly" VALUE="-1">
													<param name=DataID           value=ds_1>
													<param name=CodeColumn      value=dr_class>
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>
										<tr > 
											<td    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												  <div align="right">적요</div></td>
											<td  colspan=17 > 
												<INPUT id=tx_rqst_detail   size=59
												maxLength="50" onChange="LimitTextLength(this)" onKeyUp="LimitTextLength(this)" ></td>
										</tr>
										<tr > 
											<td  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												<div align="right">*거래처</div></td>
											<td colspan=17  > 
												<!--  <INPUT id=tx_cust_code  MAXLENGTH=13  size=13 readOnly >-->
												<table  height="1px" BORDER="0"    CELLSPACING="0" align="left">
													<tr>
														<td>
															<comment id="__NSID__"><OBJECT id=em_cust_code tabIndex=0 
																style="WIDTH: 90px;" 
																classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
																<PARAM NAME="Alignment" VALUE="1">
			<!--													<PARAM NAME="Format" VALUE="000-00-00000"> -->
																<PARAM NAME="ReadOnly" VALUE=true>
																<PARAM NAME="SelectAll" VALUE="-1">
																<PARAM NAME="PromptChar" VALUE="">
																<PARAM NAME="MaxLength" VALUE="13">
															</OBJECT></comment> <script> __ws__(__NSID__);</script>
														</td>
														<td>
															<INPUT id=bt_cust_code  type=button class=img_btnFind_S onclick=btnCUST_CODE_onClick()
													onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;" readonly>
														
																<INPUT id=tx_cust_name  MAXLENGTH=50  size=40 readonly >
															</td>
														</td>
													</tr>
												</table>
												
											</td>
										</tr>
										<tr > 
											 <td BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												  <div align="right">*투입내역</div></td>
											 <td   colspan=17 > 
												  <INPUT id=tx_spec_unq_num  MAXLENGTH=18 tabIndex=0 size=13 readonly >
												  <INPUT id=bt_spec_unq_num  type=button class=img_btnFind_S onclick=bt_req_spec_onclick()
														onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
												  <INPUT id=tx_spec_name  MAXLENGTH=40 tabIndex=0 size=40 readonly ></td>
										</tr>    
										<tr > 
											<td    BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3   > 
												<div align="right">*계정과목</div></td>
											<td colspan=17  > 
												<INPUT id=tx_acntcode MAXLENGTH=8 tabIndex=0 size=13 readOnly >
												<INPUT id=bt_acnt_code type=button class=img_btnFind_S onclick=btnACC_CODE_onClick()
													onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
												<INPUT id=tx_acntname  MAXLENGTH=30 tabIndex=0 size=40 readOnly >
												<INPUT id=bt_acnt_code_del style="FONT-SIZE: 10px" type=button value=삭제 onclick=bt_acnt_del_onclick() ></td>
										</tr>                
										<tr > 
											<td    BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3   > 
												<div align="right">부가세계정</div></td>
											<td colspan=17  > 
												<INPUT id=tx_vatcode MAXLENGTH=8 tabIndex=0 size=13 readOnly >
												<INPUT id=bt_vat_code type=button class=img_btnFind_S onclick=bt_vat_onclick()
													onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
												<INPUT id=tx_code  MAXLENGTH=30 tabIndex=0 size=40 readOnly >
												<INPUT id=bt_vat_code_del style="FONT-SIZE: 10px" type=button value=삭제 onclick=bt_vat_del_onclick() >
												</td>
										</tr>                
										<tr > 
											<td   width="15%"  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												<div align="right">금액</div></td>
											<td  width="10%"  style="COLOR: BLACK"  colspan=2  > 
												<div align="right">공급가</div></td>
											<td  width="20%" colspan=4  > 
												<comment id="__NSID__"><OBJECT id=em_cash_amt   
													style="WIDTH: 90px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
											<td   width="10%" style="COLOR: BLACK"  colspan=2  > 
												<div align="center"> + 기타</div></td>
											<td  width="20%" colspan=4  > 
												<comment id="__NSID__"><OBJECT id=em_bill_amt   
													style="WIDTH: 90px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
											<td   width="5%" style="COLOR: BLACK"  colspan=1  > 
												<div align="center"> = </div></td>
											<td  width="20%" colspan=4  > 
												<comment id="__NSID__"><OBJECT id=em_amt   tabindex=-1
													style="WIDTH: 90px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="readonly" VALUE=true>
				                        <param name=ReadOnlyBackColor       value=silver>
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>                
										<tr > 
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
													 <div align="right">부가세</div>
											</td>
										 
											<td  colspan=17 > 
												<comment id="__NSID__"><OBJECT id=em_vat   
													style="WIDTH: 103px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>
										<tr > 
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
													 <div align="right">소득세</div>
											</td>
										 
											<td  colspan=7 > 
												<comment id="__NSID__"><OBJECT id=em_income_amt  
													style="WIDTH: 103px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
													 <div align="right">주민세</div>
											</td>
										 
											<td  colspan=7 > 
												<comment id="__NSID__"><OBJECT id=em_civi_amt   
													style="WIDTH: 103px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>
										<tr > 
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
													 <div align="right">원절사금액</div>
											</td>
										 
											<td  colspan=17 > 
												<comment id="__NSID__"><OBJECT id=em_deduct_amt   
													style="WIDTH: 103px; " 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="13">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>
										<tr > 
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												<div align="right">계산서발행일</div></td>
											<td  colspan=17 > 
												<comment id="__NSID__"><OBJECT id=em_receipt_date  
													style="WIDTH: 103px;" 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="1">
													<PARAM NAME="Format" VALUE="YYYY-MM-DD">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT>&nbsp;&nbsp;[작성일]</comment> <script> __ws__(__NSID__);</script></td>
										</tr>        
										<tr > 
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
												<div align="right">지급예정일</div></td>
											<td colspan=17  > 
												<comment id="__NSID__"><OBJECT id=em_pay_date  
													style="WIDTH: 103px;" 
													classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
													<PARAM NAME="Alignment" VALUE="1">
													<PARAM NAME="Format" VALUE="YYYY-MM-DD">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="PromptChar" VALUE="">
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>        
										<tr > 										
											<td width="15%"  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
													<div align="right">신용카드번호</div></td>
											<td colspan=17 >	
												<table width="100%" height="100%" BORDER="0"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
													<tr>
														<td  width=120px> 
																<comment id="__NSID__"><OBJECT id=em_credit_card_no tabIndex=0 
																style="WIDTH: 100%;" 
																classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
																<PARAM NAME="Alignment" VALUE="1">
																<PARAM NAME="Format" VALUE="0000-0000-0000-0000">
																<PARAM NAME="ReadOnly" VALUE=false>
																<PARAM NAME="SelectAll" VALUE="-1">
																<PARAM NAME="PromptChar" VALUE="">
																<PARAM NAME="MaxLength" VALUE="13">
															</OBJECT></comment> <script> __ws__(__NSID__);</script>
														<td>
															<INPUT id=bt_card_no  type=button class=img_btnFind_S onclick=btnCARD_CARDNO_onClick()
																onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
														</td>
													</tr>
												</table>
											</td>
										</tr>
										<tr > 
											<td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3   > 
												<div align="right">카드사용자</div></td>
											<td colspan=17  > 
													<input  id= tx_card_user  MAXLENGTH=18 tabIndex=0 size=13  >
											</td>
										</tr>
										<tr BGCOLOR="white"> 
											<td BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3   > 
												<div align="right">자금구분</div></td>
											<td  colspan=17 > 
												<comment id="__NSID__"><OBJECT id=ccom_fund_type 
													classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
																					 height=106 width=103px;>
													<PARAM NAME="Alignment" VALUE="1">
													<PARAM NAME=Data VALUE="2^현장지급,5^공동사발생">
													<PARAM NAME="ReadOnly" VALUE="-1">
													<param name=DataID           value=ds_1>
													<param name=CodeColumn      value=fund_type>
												</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
										</tr>
										<tr > 
											<td   height="100px" BGCOLOR="#FFFFFF" style="COLOR: BLUE" colspan=20 > 
													 <div align="center">보증금 및 유가증권은 일반전표에서 등록하십시오...</div>
											</td>
									</table>    

						</TD>
					</TR>
					</TABLE>
			</td>
		</tr>
	</table>
</div>

<comment id="__NSID__"><OBJECT id=bd_data 
		style="Z-INDEX: 108; LEFT: 124px; WIDTH: 22px; POSITION: absolute; TOP: -37px; HEIGHT: 18px" 
		classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	   <C>Col=seq            Ctrl=em_seq Param=text Enable=enable</C>
		<C>Col=rqst_detail    Ctrl=tx_rqst_detail Param=value Enable=enable</C>
		<C>Col=cust_code      Ctrl=em_cust_code Param=text Enable=enable</C>
		<C>Col=cust_name      Ctrl=tx_cust_name Param=value Enable=enable</C>
		<C>Col=vatcode        Ctrl=tx_vatcode Param=value Enable=enable</C>
		<C>Col=code           Ctrl=tx_code Param=value Enable=enable</C>
		<C>Col=amt            Ctrl=em_amt Param=text Enable=enable</C>
		<C>Col=vat            Ctrl=em_vat Param=text Enable=enable</C>
		<C>Col=income_amt     Ctrl=em_income_amt Param=text Enable=enable</C>
		<C>Col=civi_amt       Ctrl=em_civi_amt Param=text Enable=enable</C>
		<C>Col=acntcode       Ctrl=tx_acntcode Param=value Enable=enable</C>
		<C>Col=acntname       Ctrl=tx_acntname Param=value Enable=enable</C>
		<C>Col=acntname       Ctrl=tx_acntname Param=value Enable=enable</C>
		<C>Col=receipt_date   Ctrl=em_receipt_date Param=text Enable=enable</C>
		<C>Col=pay_date   Ctrl=em_pay_date Param=text Enable=enable</C>
		<C>Col=credit_card_no Ctrl=em_credit_card_no Param=text Enable=enable</C>
		<C>Col=card_user      Ctrl=tx_card_user Param=value Enable=enable</C>
		<C>Col=spec_unq_num   Ctrl=tx_spec_unq_num Param=value Enable=enable</C>
		<C>Col=spec_name      Ctrl=tx_spec_name Param=value Enable=enable</C>
		<C>Col=cash_amt      Ctrl=em_cash_amt Param=text Enable=enable</C>
		<C>Col=bill_amt      Ctrl=em_bill_amt Param=text Enable=enable</C>
		<C>Col=deduct_amt      Ctrl=em_deduct_amt Param=text Enable=enable</C>
		<C>Col=bill_cash_amt      Ctrl=tx_bill_cash_amt Param=text Enable=enable</C>
		<C>Col=soyo_name      Ctrl=tx_soyo_name Param=value Enable=enable</C>
		<C>Col=det_name      Ctrl=tx_det_name Param=value Enable=enable</C>
	" >
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</BODY></HTML>
