
<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : r_received_plan_1h.html				 					-->
<!-- 2. 유형(시나리오): shared window 조회및 입력								-->
<!-- 3. 기 능 정 의   : 년간수주계획입력(수주/영업)  	  						-->
<!-- 4. 변 경 이 력   : 김 동우 작성												-->
<!-- 						 : 이 준구 수정 ( 2006/1/6 )								-->
<!--                  : 황보은영 추가 ( 2006/04/17)                     -->
<!-- 5. 관련프로그램  :																	-->
<!-- 6. 특 기 사 항   :																	-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<!-- ======================================================================= -->
<!--                      Function                          -->
<!-- ======================================================================= -->
<script language="JavaScript">
var gs_home = top.frames['security'].gs_home.value
var is_work_date = top.frames['security'].gs_sysdate.value
var is_user_dept = readCookie("@deptcode@")
var is_yymm
var is_ds_1_addr = gs_home + '/const/r_web/01/r_received_plan_1q.jsp?arg_year='
var is_tr_1_addr = gs_home + '/const/r_web/01/r_received_plan_1tr.jsp'
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	if ( r_check[0].checked ) 	r_chk = '(1)'
	if	( r_check[1].checked )  r_chk = '(2)'
	if	( r_check[2].checked )  r_chk = '(1,2)'
	
	ds_1.DataID = is_ds_1_addr + em_select_yymm.text + "&arg_masterdept_tag=" + r_chk
	ds_1.SyncLoad=true
	ds_1.Reset()
	
	
	if ( r_check[2].checked )
		gd_1.Editable = false
	else
		gd_1.Editable = true
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("tmp_received_plan_year");
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	if ( r_check[0].checked )
		sales_team = 1
	if ( r_check[1].checked )
		sales_team = 2

	ds_1.NameValue(ds_1.RowPosition,"masterdept_tag") = sales_team
	ds_1.NameValue(ds_1.RowPosition,"received_plan_year") = is_yymm
	ds_1.NameValue(ds_1.RowPosition,"tmp_received_plan_year") = is_yymm.substr(0,7)
	ds_1.NameValue(ds_1.RowPosition,"const_tag") = '1'
	ds_1.NameValue(ds_1.RowPosition,"pq_tag") = 'A'
	ds_1.NameValue(ds_1.RowPosition,"receive_tag") = '1'
	ds_1.NameValue(ds_1.RowPosition,"constkind_tag") = '01'
	ds_1.NameValue(ds_1.RowPosition,"new_tag") = 'Y'
	ds_1.NameValue(ds_1.RowPosition,"no") = ds_1.Max(4,0,0) + 1
	ds_1.NameValue(ds_1.RowPosition,"decision_yn") = 'N'
	ds_1.NameValue(ds_1.RowPosition,"decision_yn1") = '미확정'
	
	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	if ( r_check[2].checked ) {
		alert("추가할 수 없습니다: 관리부서를 선택하십시오")
		return
	}
	ds_1.AddRow()
	init_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	if ( r_check[2].checked ) {
		alert("삽입할 수 없습니다: 관리부서를 선택하십시오")
		return
	}
	ds_1.InsertRow(ds_1.RowPosition)
	init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	if  (gd_1.MultiRowSelect){               // multi row select 일 ]
		for (i=ds_1.CountRow ;i >0 ;i--) {
			if (ds_1.RowMark(i) == 1 ) {			
				if (ds_1.NameValue(i, "decision_yn") == "Y"){
					alert("확정된 내역은 삭제가 불가능합니다")
					return
				}
				ds_1.DeleteRow(i)
			}
		}   
		ds_1.MarkRows(ds_1.RowPosition,ds_1.RowPosition)  //삭제작업완료후 MARK
	} 
	else {
		if (ds_1.NameValue(ds_1.RowPosition, "decision_yn") == "Y") {
			alert("확정된 내역은 삭제가 불가능합니다")
			return
		}
		ds_1.DeleteRow(ds_1.RowPosition)  
	}
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	var ls_chk=0
  if (ds_1.IsUpdated){
  	 if (ds_1.RowPosition > 0) {
	  	 ls_year = ds_1.NameValue(ds_1.RowPosition, "tmp_received_plan_year") + '.01'
	  	 if(!f_check_date(ls_year)) {
	  	 	alert("계획년월이 올바르지 않습니다")
	     	gd_1.SetColumn("tmp_received_plan_year");
	  	 	return
	    }
    }
	 var ll_dup
	 ll_dup = f_dup_chk("ds_1","tmp_received_plan_year@no")
	 if (ll_dup > 0) {
	     alert("계획년월이 중복되었습니다: 계획년월을 수정하십시요 ")
	     ds_1.RowPosition = ll_dup
     	  gd_1.SetColumn("tmp_received_plan_year");
	     return
	 }
  }
	
	if (ds_1.IsUpdated){
		if (confirm("변경되었습니다 저장하시겠습니까?")){
			tr_1.Post()
		}
	}
	return
}
//---------------------------------------------------------------------------
function bt_order_onclick()                     //발주처 찾기
//---------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	result = window.showModalDialog(gs_home + "/const/r_web/00/r_order_find_1h.html",'',"dialogWidth:640px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"order_no") = array[0]
	ds_1.NameValue(ds_1.RowPosition,"order_name") = array[1]

}   
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	        {  //저장 routine
	        }   
 
	   }     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

	// top.frames['main_ct'].window.close()     
}

//---------------------------------------------------------------------------------
function f_select4_q(ls_sql)
//---------------------------------------------------------------------------------
{
  var i,j,ll_find,ll_from,ls_colcnt
  ll_find = 0
  ll_from = ls_sql.lastIndexOf("select_")
  for(i=ll_from ; i < ls_sql.length ; i++) {
     if  (ls_sql.substr(i,1) == "_") { 
         for (j=i; j < ls_sql.length ; j++) {
             if (ls_sql.substr(j,1) == " ") {
                 ll_find = 1
                 break
             }    
         }
     }
   if (ll_find == 1) break
  }      
  ls_colcnt = ls_sql.substr(i+1, j-i)
  

 ds_select4.DataID="../../../comm_function/comm_select_2q.jsp?in_sql=" + ls_sql
 ds_select4.SyncLoad = true
 ds_select4.reset()
 ll_cnt = ds_select4.CountRow
 return ll_cnt
} 
//-------------------------------------------------------------------------------
function select_yymm()                  //년월 선택 
//--------------------------------------------------------------------------------
{
	is_yymm = em_select_yymm.text.substr(0,4) + ".01.01"
   	ds_1.ClearData()
   	btnquery_onclick()
 
} 
//---------------------------------------------------------------------
function Fn_decision()										//확정
//---------------------------------------------------------------------
{
	if ( (is_user_dept == "040200" && r_check[0].checked) || (is_user_dept == "040300" && r_check[1].checked) )	{   // 영업1, 2 팀일 경우
		//bt_dicision.style.visibility = 'visible'	
	}
	else {
		alert("해당 관리부서에서만 실행가능합니다")
		return
//		bt_dicision.style.visibility = 'hidden'	
	}
	
	
	if (ds_1.CountRow == 0) {
		alert("내역이 존재하지 않습니다")
		return
	}
	
	if (confirm("확정후 수정은 불가능합니다: 확정하시겠습니까?")) {
		for(i=1; i<=ds_1.CountRow; i++) {
			ds_1.Namevalue(i, "decision_yn") = 'Y'
		}
		
		if (ds_1.IsUpdated)
			tr_1.Post()
	}
}
//---------------------------------------------------------------------
function excel_down()
//---------------------------------------------------------------------
{
    var filename = em_select_yymm.text+'수주계획';
	//gd_1.RunExcel(filename)
	gd_1.GridToExcel(filename, filename, 1) 
}

//------------------------------------------------------------------------
function btnquery_prt_onclick()                     // 미리보기
//------------------------------------------------------------------------
{
	if ( r_check[2].checked ) {
		alert("보고서를 열 수 없습니다: 관리부서를 선택하세요")
		return
	}
	
	if ( r_check[0].checked ) 	r_chk = 1
	if	( r_check[1].checked )  r_chk = 2
	
   var arg_temp
   arg_temp ="const_rpt/r_web/01r/"      // 보고서 디렉토리

   arg_temp = arg_temp + 'r_received_plan_year'   // 보고서명
   
   arg_temp = arg_temp + "&RptParams=" + em_select_yymm.text
   arg_temp = arg_temp + "&RptParams=" + r_chk
//   alert(arg_temp);
   f_crystal_report(arg_temp)   //보고서 호출
}
  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
	top.frames['main_title'].mouse_over()
	ll_cnt = f_select1_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '008' order by etc_code") //공사구분
	ll_cnt = f_select2_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '010' order by etc_code") //분야구분
	ll_cnt = f_select3_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '011' order by etc_code") //수주구분
	ll_cnt = f_select4_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '007' order by etc_code") //공사종류
	tr_1.Action = is_tr_1_addr 
	is_yymm = is_work_date.substr(0,4) + ".01.01"
	em_select_yymm.text = is_yymm
	btnquery_onclick()
	
	gd_1.ColumnProp("tmp_received_plan_year", "EditLimit") = 7
	gd_1.ColumnProp("no", "EditLimit") = 5
}
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr=new Array('gd_1');
	var xArr =new Array(true);
	var yArr =new Array(true);

	f_reSize(objArr, xArr, yArr);
}
</SCRIPT>
<!-- ======================================================================= -->
<!--                     Event                          -->
<!-- ======================================================================= -->
<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
	if (kcode == 13) {
	    if (ds_1.RowPosition == ds_1.CountRow)  
	        btnadd_onclick()
	    else     
	        ds_1.RowPosition++
	}
</SCRIPT>
<SCRIPT language="javascript" for=gd_1 event=OnPopup(row,colid,data)>
	 if (colid == "order_name") {
	    bt_order_onclick()
	    return
	 }    
</SCRIPT>
<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>

	var ls_in_date = ""
	if ( row < 1)	return
	
	if (colid == "tmp_received_plan_year") {
		ls_in_date = ds_1.NameValue(row, "tmp_received_plan_year")
		ls_in_date = ls_in_date.replace(/\./g,"")
		
		if ( ls_in_date.length > 6)
			ls_in_date = ls_in_date.substr(0,7)
		else if ( ls_in_date.length < 6) {
			ds_1.NameValue(row, "tmp_received_plan_year") = ls_in_date
			ds_1.NameValue(row,"received_plan_year") = ds_1.NameValue(row,"tmp_received_plan_year") + '.01'
			return
		}
		ds_1.NameValue(row, "tmp_received_plan_year") = ls_in_date.substr(0,4) + "." + ls_in_date.substr(4,2)
		ds_1.NameValue(row,"received_plan_year") = ds_1.NameValue(row,"tmp_received_plan_year") + '.01'
		
	}
	
</SCRIPT>


<SCRIPT language=JavaScript for=em_select_yymm event=onKillFocus()>
	if (em_select_yymm.Modified){ 
		select_yymm()
	}
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_yymm event=onKeyDown(kcode,scode)>
	if ((em_select_yymm.Modified) && kcode == 13 ){ 
		select_yymm()
	}
</SCRIPT>        	

<SCRIPT language=JavaScript for=ds_select event=OnLoadError()>
	alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
	alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
	alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code(ds_spcall) : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
</SCRIPT>

<script language=JavaScript for=ds_1 event=OnRowPosChanged(row)>
	if (row < 1) return
	
	if (ds_1.NameValue(row, "decision_yn") == "Y") {
		gd_1.ColumnProp("tmp_received_plan_year", "Edit") = 'none'
		gd_1.ColumnProp("const_name", "Edit") = 'none'
		gd_1.ColumnProp("order_name", "Edit") = 'none'
		gd_1.ColumnProp("const_tag", "Edit") = 'none'
		gd_1.ColumnProp("pq_tag", "Edit") = 'none'
		gd_1.ColumnProp("receive_tag", "Edit") = 'none'
		gd_1.ColumnProp("constkind_tag", "Edit") = 'none'
		//gd_1.ColumnProp("masterdept_tag", "Edit") = 'none'
		gd_1.ColumnProp("new_tag", "Edit") = 'none'
		gd_1.ColumnProp("received_plan_amt", "Edit") = 'none'
		gd_1.ColumnProp("pre_profit_rate", "Edit") = 'none'
	}
	else {
		gd_1.ColumnProp("tmp_received_plan_year", "Edit") = ''
		gd_1.ColumnProp("const_name", "Edit") = ''
		gd_1.ColumnProp("order_name", "Edit") = ''
		gd_1.ColumnProp("const_tag", "Edit") = ''
		gd_1.ColumnProp("pq_tag", "Edit") = ''
		gd_1.ColumnProp("receive_tag", "Edit") = ''
		gd_1.ColumnProp("constkind_tag", "Edit") = ''
		//gd_1.ColumnProp("masterdept_tag", "Edit") = ''
		gd_1.ColumnProp("new_tag", "Edit") = ''
		gd_1.ColumnProp("received_plan_amt", "Edit") = ''
		gd_1.ColumnProp("pre_profit_rate", "Edit") = ''
	}
</script>

<!-- ======================================================================= -->
<!--                      Component                          -->
<!-- ======================================================================= -->
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select1
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select2
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select3
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select4
     style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
     classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
		<PARAM NAME="KeyName" VALUE="toinb_dataid4">
		<PARAM NAME="KeyValue" VALUE="JSP(I:r_received_plan_1tr=ds_1)">
		<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	
</HEAD>

<!-- ======================================================================= -->
<!--                     Body                         -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=window_onload() oncontextmenu="return false" >
<DIV class=main_div>	
<TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0">
	<TR height="20px">
		<TD class=td_green>
			<table border= "0" cellpadding="0" cellspacing="0" class=main_table>
				<tr>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="55px" class=font_green_bold>계획년도</td>
					<td width="95px">
						<comment id="__NSID__"><OBJECT id=em_select_yymm 
							 style="Z-INDEX: 101; WIDTH: 65px; background: white;" 
							classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
								<PARAM NAME="Alignment" VALUE="1">
								<PARAM NAME="IsComma"   VALUE="0">
								<PARAM NAME="MaxLength" VALUE="8">
								<PARAM NAME="Format"    VALUE="YYYY">
								<PARAM name=ClipMode    VALUE=false>
								<PARAM NAME="Numeric"   VALUE="0">
								<PARAM NAME="SelectAll" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="40px" class=font_green_bold>구분</td>
					<td width="20px">
						<input type="radio" value="1" checked name="r_check" align="absmiddle" onclick="btnquery_onclick()"></td>
					<td width="50px">영업1팀</td>
					<td width="20px">
						<input type="radio" value="2" name="r_check" align="absmiddle" onclick="btnquery_onclick()"></td>
					<td width="50px">영업2팀</td>
					<td width="20px">
						<input type="radio" value="3" name="r_check" align="absmiddle" onclick="btnquery_onclick()"></td>
					<td>전체</td>
					<td width="*" align="right">
						<input type="button" id="bt_dicision" value="확정" onclick="Fn_decision()" class=img_btn2_1>
						<input type="button" name="bt_excel_down" value="엑셀전환" Onclick="excel_down()" class=img_btn4_1>
						<input type="button" value="신규수주계획" class=img_btnRpt6_1 onclick="btnquery_prt_onclick()"> &nbsp;&nbsp;</td>
				</tr>
			</table>
		</TD>
	</TR>
	<TR>
		<TD>
			<comment id="__NSID__"><OBJECT id=gd_1 
				style="FONT-SIZE: 12px; Z-INDEX: 102; width: 100%; height: 100%;" 
				classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
					<PARAM NAME="MultiRowSelect" VALUE="-1">
					<PARAM NAME="DataID" VALUE="ds_1">
					<PARAM NAME="AutoInsert" VALUE="-1">
					<PARAM NAME="BorderStyle"  VALUE=1>
			   	<PARAM NAME="SortView"       VALUE="Left">
					<PARAM NAME="AllShowEdit" VALUE="-1">
					<PARAM NAME="Editable" VALUE="-1">
					<PARAM NAME="ColSizing" VALUE="-1">
					<PARAM  NAME="ViewSummary"    value=1>
					<PARAM NAME="Format" VALUE="
						<C> Name='*계획년월' ID=tmp_received_plan_year Align=Center sort=true BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=78 
							SumText='합 계'  SumColor=Black SumBgColor=Pink align=center </C>
						<C> Name='순번' ID=no Align=Center Show=false BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=30 </C>
						<C> Name='*공사명' ID=const_name BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=145 </C>
						<C> Name='발주처코드' ID=order_no  Show=false EditStyle=Popup sort=true BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center Align=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=83 </C>>
						<C> Name='발주처명' ID=order_name EditStyle=Popup sort=true BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=142 </C>
						<C> Name='공사구분' ID=const_tag sort=true Align=Center EditStyle=Lookup Data='ds_select1:select_1:select_2'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=73 </C> 
						<C> Name='분야구분' ID=pq_tag sort=true Align=Center EditStyle=Lookup Data='ds_select2:select_1:select_2'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=73 </C> 
						<C> Name='수주구분' ID=receive_tag sort=true Align=Center EditStyle=Lookup Data='ds_select3:select_1:select_2'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=73 </C> 
						<C> Name='공사종류' ID=constkind_tag sort=true Align=Center EditStyle=Lookup Data='ds_select4:select_1:select_2'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=73 </C> 
						<C> Name='주관부서' ID=masterdept_tag Edit='none' Align=Center EditStyle=combo Data='1:영업1팀,2:영업2팀'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=61 </C>
						<C> Name='신규' ID=new_tag Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=45
							EditStyle=Combo Data='Y:예,N:아니오'</C>
						<C> Name='계획금액' ID=received_plan_amt sort=true BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=90 
							SumText=@sum SumColor=Black SumBgColor=Pink </C>
						<C> Name='추정이익율' ID=pre_profit_rate edit=RealNumeric Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=65 </C> 
						<C> Name='확정여부' ID=decision_yn1 Edit='none' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 Align=center </C> 
					">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</TD>
	</TR>
</TABLE></DIV>
</BODY></HTML>