<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- *************************************************************		-->
<!-- 1. 프로그램 id   :  r_plan_result_monthly_1h.html   	            -->
<!-- 2. 유형(시나리오):  조회							          		         -->
<!-- 3. 기 능 정 의   :  월별 계획대 실적 조회         				-->
<!-- 4. 변 경 이 력   :  황보은영 작성												-->
<!-- 5. 관련프로그램  :																	-->
<!-- 6. 특 기 사 항   :																	-->
<!-- *************************************************************		-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value

var is_r_check = 1
var is_ds_1_addr = gs_home + '/const/r_web/04/r_plan_result_monthly_1q.jsp?arg_date='          //조회용 


</SCRIPT>

<!-- ======================================================================= -->
<!--                      Function                          -->
<!-- ======================================================================= -->
<script language="JavaScript">
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{

	  ds_1.DataID = is_ds_1_addr + em_select_yymm.text + '&arg_won=' + select_won.value
	  ds_1.SyncLoad=true
	  ds_1.Reset()

	  gd_1.ColumnProp('title','NAME') = em_select_yymm.text.substr(5,7) + '월'
	  
	  F_count_rate()

}

//------------------------------------------------------------------------
function redraw_won()                     // 조회  
//------------------------------------------------------------------------
{
	if (select_won.value == 1000000 || select_won.value == 100000000) {
		ll_width1 = 60
		ll_width2 = 50
	}
	else if (select_won.value == 1000) {
		ll_width1 = 80
		ll_width2 = 70
	}
	else if (select_won.value == 1) {
		ll_width1 = 100
		ll_width2 = 90
	}
	gd_1.redraw = false
/*
	gd_1.ColumnProp('last_year','Value')='{last_year}';
	gd_1.ColumnProp('mon_01','Value')='{mon_01}';
	gd_1.ColumnProp('mon_02','Value')='{mon_02}';
	gd_1.ColumnProp('mon_03','Value')='{mon_03}';
	gd_1.ColumnProp('mon_04','Value')='{mon_04}';
	gd_1.ColumnProp('mon_05','Value')='{mon_05}';
	gd_1.ColumnProp('mon_06','Value')='{mon_06}';
	gd_1.ColumnProp('mon_07','Value')='{mon_07}';
	gd_1.ColumnProp('mon_08','Value')='{mon_08}';
	gd_1.ColumnProp('mon_09','Value')='{mon_09}';
	gd_1.ColumnProp('mon_10','Value')='{mon_10}';
	gd_1.ColumnProp('mon_11','Value')='{mon_11}';
	gd_1.ColumnProp('mon_12','Value')='{mon_12}';
	gd_1.ColumnProp('mon_st','Value')='{mon_st}';
   gd_1.ColumnProp('mon_sum','Value')='{mon_sum}';
	gd_1.ColumnProp('sum_all','Value')='{sum_all}';
*/
	gd_1.ColumnProp('last_year','width')=ll_width1;
	gd_1.ColumnProp('mon_01','width')=ll_width2;
	gd_1.ColumnProp('mon_02','width')=ll_width2;
	gd_1.ColumnProp('mon_03','width')=ll_width2;
	gd_1.ColumnProp('mon_04','width')=ll_width2;
	gd_1.ColumnProp('mon_05','width')=ll_width2;
	gd_1.ColumnProp('mon_06','width')=ll_width2;
	gd_1.ColumnProp('mon_07','width')=ll_width2;
	gd_1.ColumnProp('mon_08','width')=ll_width2;
	gd_1.ColumnProp('mon_09','width')=ll_width2;
	gd_1.ColumnProp('mon_10','width')=ll_width2;
	gd_1.ColumnProp('mon_11','width')=ll_width2;
	gd_1.ColumnProp('mon_12','width')=ll_width2;
	gd_1.ColumnProp('mon_st','width')=ll_width1;
	gd_1.ColumnProp('mon_sum','width')=ll_width1;
	gd_1.ColumnProp('sum_all','width')=ll_width1;

	 btnquery_onclick()
 	gd_1.redraw = true

}
//------------------------------------------------------------------------
 function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
    ds_1.Undo(ds_1.RowPosition)                                     //해당 row만 취소한다.

}

//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
   
	var work_date = f_sysdate()
	work_date = work_date.substr(0,4) + "." + work_date.substr(5,7)
	em_select_yymm.text = work_date

   redraw_won()
}
//---------------------------------------------------------------------
function window_onunload()
//---------------------------------------------------------------------
{
	
}
//---------------------------------------------------------------------
function F_count_rate()
//---------------------------------------------------------------------
{
	var array_code = new Array
	var code = ""
	
	for ( i=1; i<=ds_1.CountRow; i++ ) {
		if ( ds_1.NameValue(i, "st") == '계획')
			code += ds_1.NameValue(i, "etc_code") + '@'
	}
	
	array_code = code.split("@")
	
	for ( i=0; i<array_code.length; i++) {
		plan_a = 0
		real_a = 0
		for ( j=1; j<=ds_1.CountRow; j++ ) {
			if ( ds_1.NameValue(j, "etc_code") == array_code[i] ) {
				if ( ds_1.NameValue(j, "st") == '계획' )
					plan_a = ds_1.NameValue(j, "mon_st")
				else
					real_a = ds_1.NameValue(j, "mon_st")
				
				ds_1.NameValue(j, "mon_rate") = parseInt(real_a) / parseInt(plan_a) * 100
				if (parseInt(plan_a) == 0)
					ds_1.NameValue(j, "mon_rate") = 0
			}
		}
	}
}
//----------------------------------------------------------------------------
function Fn_count_rate(fir_text, sec_text)
//-----------------------------------------------------------------------------
{
	i = 0
	j = 999.99
	z = -999.99
	ls_res = ""
	ls_fir = parseInt(fir_text)
	ls_sec = parseInt(sec_text)
	
	if (ls_fir == 0)
		return i;
	if (ls_sec == 0)
		return i;
		
	ls_res = ls_fir / ls_sec * 100
	
	if (ls_res > 999.99)
		return j;
	else if (ls_res < -999.99)
		return z;
	else
		return ls_res; 
}

//---------------------------------------------------------------------
function excel_down()
//---------------------------------------------------------------------
{
    var filename = em_select_yymm.text+'수주실적';
	//gd_1.RunExcel(filename)
	gd_1.GridToExcel(filename, filename, 1) 
}
  
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr=new Array('gd_1');
	var xArr =new Array(true);
	var yArr =new Array(true);

	//f_reSize(objArr, xArr, yArr);
}     
</SCRIPT>

<!-- ======================================================================= -->
<!--                     Event                          -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=em_select_yymm event=onKillFocus()>
	if (em_select_yymm.Modified){ 
		btnquery_onclick()
	}
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_yymm event=onKeyDown(kcode,scode)>
	if ((em_select_yymm.Modified) && kcode == 13 ){ 
		btnquery_onclick()
	}
</SCRIPT>   
<script language=JavaScript for=gd_1 event=OnUserColor(row,eventid)>
if(eventid == "ucolor") {
   if (ds_1.NameValue(row,'st') == '계획') {
       return 'blue'
   }
 }
</script>
<!-- ======================================================================= -->
<!--                      Component                          -->
<!-- ======================================================================= -->

<comment id="__NSID__"><OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 ></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px;  parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT></comment> <script> __ws__(__NSID__);</script>	
	
</HEAD>
<!-- ======================================================================= -->
<!--                     Body                         -->
<!-- ======================================================================= -->

<BODY style="FONT-SIZE: 12px; margin:0;" onload="setTimeout('window_onload()',1)" oncontextmenu="return false" >
<DIV class=main_div>
<TABLE BORDER="0" WIDTH="100%" HEIGHT="100%" CELLSPACING="0">
	<TR height="20px">
		<TD class=td_green>
			<table border="0" cellpadding="0" cellspacing="0" class=main_table>
				<tr>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="56px" class=font_green_bold>조회년월</td>
					<td>
						<comment id="__NSID__"><OBJECT id=em_select_yymm 
								 style="Z-INDEX: 101; WIDTH: 80px; background: white;" 
								classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
								 <PARAM NAME="Alignment" VALUE="1">
								 <PARAM NAME="IsComma" VALUE="0">
								 <PARAM NAME="MaxLength" VALUE="6">
								 <PARAM NAME="Format" VALUE="YYYY-mm">
								 <param name=ClipMode       value=false>
								 <PARAM NAME="Numeric" VALUE="0">
								 <PARAM NAME="SelectAll" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
					<td>
						<select id=select_won onChange=redraw_won()>
							<option value=1> 원
							<option value=1000> 천원
							<option value=1000000 selected> 백만원
							<option value=100000000> 억원
						</select>
					</td>
					<td width="*">&nbsp;</td>
					<td align="right">
						<input type="button" name="bt_excel_down" value="엑셀전환" Onclick="excel_down()" class=img_btn4_1 onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;
					</td>
				</tr>
			</table>
		</TD>
	</TR>
	<TR>
		<TD>
			<comment id="__NSID__"><OBJECT id=gd_1 
					style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%;  HEIGHT: 100%;" 
					classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="-1">
				<PARAM NAME="AutoInsert" VALUE="-1">
				<PARAM NAME="AllShowEdit" VALUE="-1">
				<PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="Editable" VALUE=false>
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="SortView"  VALUE="Left">
				<PARAM NAME="DataID" VALUE="ds_1">
				<PARAM NAME="Format" VALUE="
				  <FC> Name='수주구분'   ID=receive_name Align=Center   HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=60 suppress=1</C>
				  <FC> Name='분야구분'   ID=pq_name Align=Center   HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=50 suppress=1</C>
				  <FC> Name='공사명'   ID=long_name Align=left   HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=150 </C>
				  <FC> Name='차수'   ID=cont_no Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=30 </C>
				  <FG> Name='공 사 기 간' HeadBgColor=#BBE0F4
					  <C> Name='착공일'   ID=start_date Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=65 </C>
					  <C> Name='완공일'   ID=completion_date Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=65 </C>
				  </G>
				  <FG> Name='당초수주액' HeadBgColor=#BBE0F4
				  	  <C>  ID=last_year Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 </C>
				  	  <C>  ID=st Align=center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} Color=@ucolor HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=40 </C>
				  </G>
				  <G> Name='월  별  수  주  실  적' HeadBgColor=#BBE0F4
				  <C> Name='1월'   ID=mon_01 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='2월'   ID=mon_02 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='3월'   ID=mon_03 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='4월'   ID=mon_04 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='5월'   ID=mon_05 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='6월'   ID=mon_06 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='7월'   ID=mon_07 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='8월'   ID=mon_08 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='9월'   ID=mon_09 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='10월'   ID=mon_10 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='11월'   ID=mon_11 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  <C> Name='12월'   ID=mon_12 Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=80 </C>
				  </G>
				  <G> Name='' ID=title HeadBgColor=#BBE0F4
				  	<C> Name='현누계'   ID=mon_st  Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 </C>
				  	<C> Name='달성도%'   ID=mon_rate  Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=50 </C>
				  </G> 
				  <C> Name='년계'   ID=mon_sum  Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 </C>
				  <C> Name='누계'   ID=sum_all  Align=right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=100 </C>
				  
				">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
	</tr>
</table></DIV>


</BODY></HTML>



