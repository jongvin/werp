<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : r_tender_planamt_1h.html 							-->
<!-- 2. 유형(시나리오): shared window 조회및 입력								-->
<!-- 3. 기 능 정 의   : 예정가조합생성	  										-->
<!-- 4. 변 경 이 력   : 김 동우 작성												-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :																-->
<!-- *************************************************************	-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="/erpw/erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 

<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value

var is_ds_1_addr = gs_home + '/const/r_web/02/r_tender_planamt_1q.jsp?'
var is_tr_1_addr = gs_home + '/const/r_web/02/r_tender_planamt_1tr.jsp'
var is_work_date
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	ds_1.DataID = is_ds_1_addr
	ds_1.SyncLoad=true
	ds_1.Reset()
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("comp_date");
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"comp_date")  = is_work_date
	ds_1.NameValue(ds_1.RowPosition,"rate") = 100
	
	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	 btninsert_onclick()

}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	if (ds_1.CountRow > 0) {
		ds_1.InsertRow(1)
	}
	else {
		ds_1.AddRow()
	}
	init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	var ls_receive_code,ls_date

	ls_receive_code = ds_1.NameValue(ds_1.RowPosition,"receive_code")
	ls_date         = ds_1.NameValue(ds_1.RowPosition,"comp_date")

	arg_cmd = " delete from r_tender_planamt_output " +
		       "  where receive_code = " + "'" + ls_receive_code + "'" +
		       "    and comp_date = " + "'" + ls_date + "'" 

	f_update_sql(arg_cmd)
	ds_1.DeleteRow(ds_1.RowPosition)  
	tr_1.Post()
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	sa_position = ds_1.RowPosition

	if (ds_1.IsUpdated){
	    if  (confirm("변경되었습니다 저장하시겠습니까?")) {
       		tr_1.Post()
	        btnquery_onclick()
	        ds_1.RowPosition = sa_position
	    }    
	} 
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	        {  //저장 routine
	        }   
 
	   }     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

	// top.frames['main_ct'].window.close()     
}

//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//---------------------------------------------------------------------------
function bt_receive_onclick()                     //수주코드 찾기
//---------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	result = window.showModalDialog(gs_home + "/const/r_web/00/r_receive_code_find_1h.html",'',"dialogWidth:740px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");

	tx_receive_code.value = array[0]
	tx_name.value = array[1]
	tx_order_name.value = array[2]
	em_survey_amt.text = array[3]
	em_tender_date.text = array[4]

}
//---------------------------------------------------------------------------
function Checkbox_1_onclick()
//---------------------------------------------------------------------------
{
	if (ck_choice_tag01.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag01") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag01") = 'N'
	if (ck_choice_tag02.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag02") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag02") = 'N'
	if (ck_choice_tag03.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag03") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag03") = 'N'
	if (ck_choice_tag04.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag04") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag04") = 'N'
	if (ck_choice_tag05.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag05") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag05") = 'N'
	if (ck_choice_tag06.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag06") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag06") = 'N'
	if (ck_choice_tag07.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag07") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag07") = 'N'
	if (ck_choice_tag08.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag08") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag08") = 'N'
	if (ck_choice_tag09.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag09") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag09") = 'N'
	if (ck_choice_tag10.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag10") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag10") = 'N'
	if (ck_choice_tag11.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag11") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag11") = 'N'
	if (ck_choice_tag12.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag12") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag12") = 'N'
	if (ck_choice_tag13.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag13") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag13") = 'N'
	if (ck_choice_tag14.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag14") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag14") = 'N'
	if (ck_choice_tag15.checked)
		ds_1.NameValue(ds_1.RowPosition,"choice_tag15") = 'Y'
	else
		ds_1.NameValue(ds_1.RowPosition,"choice_tag15") = 'N'
}
//---------------------------------------------------------------------------
function create_rtn()                         // 조합생성
//---------------------------------------------------------------------------
{
	var li_rate,ll_cnt,ls_code,ls_date,li_cnt
	var li_1,li_2,li_3,li_4,ls_key,li_amt
	var array = new Array();
	
	if (ds_1.RowPosition < 1) return
	
	ls_code = ds_1.NameValue(ds_1.RowPosition,"receive_code")
	ls_date = ds_1.NameValue(ds_1.RowPosition,"comp_date")
	li_rate = ds_1.NameValue(ds_1.RowPosition,"rate")

	if (ls_code == '' ) {
		alert('반드시 수주코드를 입력하십시오...')
		return
	}
	if (ls_date == '') {
		alert('반드시 계산일자를 일력하십시오...')
		return
	}
	if (li_rate == 0) {
		alert('비율을 입력하십시오...')
		return
	}

	li_cnt = 0
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag01") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag02") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag03") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag04") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag05") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag06") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag07") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag08") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag09") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag10") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag11") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag12") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag13") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag14") == 'Y') li_cnt++
	if (ds_1.NameValue(ds_1.RowPosition,"choice_tag15") == 'Y') li_cnt++
	
	if(li_cnt != 3 && li_cnt != 4){
		alert("조합가 선택은 3개 또는 4개만 할 수 있습니다... \n     다시선택한 후 작업하시기 바랍니다.")
		return
	}
	
	ll_cnt = 0
	ll_cnt = f_select_q("select receive_code select_1 " +
						      " from r_tender_planamt_output where receive_code = " + "'" + ls_code + "'" +
							   "  and comp_date = " + "'" + ls_date + "'" )

	if (ll_cnt > 0 ) {
		if  (confirm("기존자료가 존재합니다 재계산하시겠습니까?")){
			arg_cmd = " delete from r_tender_planamt_output " +
				       "  where receive_code = " + "'" + ls_code + "'" +
				       "    and comp_date = " + "'" + ls_date + "'" 
		
			f_update_sql(arg_cmd)
		}
		else {
			return
		}
	}

	if (ds_1.IsUpdated){
  		tr_1.Post()
  	}
	array[1]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt01")
	array[2]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt02")
	array[3]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt03")
	array[4]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt04")
	array[5]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt05")
	array[6]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt06")
	array[7]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt07")
	array[8]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt08")
	array[9]  = ds_1.NameValue(ds_1.RowPosition,"plan_amt09")
	array[10] = ds_1.NameValue(ds_1.RowPosition,"plan_amt10")
	array[11] = ds_1.NameValue(ds_1.RowPosition,"plan_amt11")
	array[12] = ds_1.NameValue(ds_1.RowPosition,"plan_amt12")
	array[13] = ds_1.NameValue(ds_1.RowPosition,"plan_amt13")
	array[14] = ds_1.NameValue(ds_1.RowPosition,"plan_amt14")
	array[15] = ds_1.NameValue(ds_1.RowPosition,"plan_amt15")
	
	if (li_cnt == 4) {
		for (li_1 = 1 ;li_1 <= 12 ;li_1++){
			for (li_2 = li_1 + 1 ; li_2 <= 13;li_2++){
				for (li_3 = li_2 + 1 ; li_3 <= 14;li_3++){  
					for (li_4 = li_3 + 1 ; li_4 <= 15;li_4++){
//						if  array[li_1] = 0 or array[li_2] = 0 or array[li_3] = 0 or array[li_4] = 0 then continue
						
						ls_key = ''
						if (li_1 < 10) {
							ls_key = '0' + li_1;
						}
						else {
							ls_key = '' + li_1;
						}
						if (li_2 < 10) {
							ls_key = ls_key + '0' + li_2;
						}
						else {
							ls_key = ls_key + li_2;
						}
						if (li_3 < 10) {
							ls_key = ls_key + '0' + li_3;
						}
						else {
							ls_key = ls_key + li_3;
						}
						if (li_4 < 10) {
							ls_key = ls_key + '0' + li_4;
						}
						else {
							ls_key = ls_key + li_4;
						}
						li_amt = 0
						li_amt = array[li_1] + array[li_2] + array[li_3] + array[li_4]	 	 
						
						li_amt = Math.ceil(li_amt / 4)
						
						arg_cmd = " insert into r_tender_planamt_output " +
				      			 "  ( receive_code,comp_date,combination,avg_amt ) " +
				       			 "  VALUES ( " + "'" + ls_code + "'" + "," + "'" + ls_date + "'" +
				       			 "," + "'" + ls_key + "'" + "," + li_amt + " )"
						f_update_sql(arg_cmd)
		
alert('a' + li_amt)							
					}
				}                  
			}
		}
	}
	else {
		for (li_1 = 1 ;li_1 <= 13 ;li_1++){
			for (li_2 = li_1 + 1 ; li_2 <= 14;li_2++){
				for (li_3 = li_2 + 1 ; li_3 <= 15;li_3++){  
					  
//					if  array[li_1] = 0 or array[li_2] = 0 or array[li_3] = 0 or array[li_4] = 0 then continue

					ls_key = ''
					if (li_1 < 10) {
						ls_key = '0' + li_1;
					}
					else {
						ls_key = '' + li_1;
					}
					if (li_2 < 10) {
						ls_key = ls_key + '0' + li_2;
					}
					else {
						ls_key = ls_key + li_2;
					}
					if (li_3 < 10) {
						ls_key = ls_key + '0' + li_3;
					}
					else {
						ls_key = ls_key + li_3;
					}

					li_amt = 0
					li_amt = array[li_1] + array[li_2] + array[li_3]
					
					li_amt = Math.ceil(li_amt / 3)
					
					arg_cmd = " insert into r_tender_planamt_output " +
			      			 "  ( receive_code,comp_date,combination,avg_amt ) " +
			       			 "  VALUES ( " + "'" + ls_code + "'" + "," + "'" + ls_date + "'" +
			       			 "," + "'" + ls_key + "'" + "," + li_amt + " )"
					f_update_sql(arg_cmd)
alert('b' + li_amt)							
				}
			}
		}
	}
	alert("정상처리되었습니다...")
}
//---------------------------------------------------------------------------
function print_rtn()                         // 입찰예가분석표 미리보기
//---------------------------------------------------------------------------
{
	if (ds_1.CountRow < 1) { 
		alert("선택한 내역이 없기때문에 들어갈수 없습니다")
		return
	}   
	if (ds_1.IsUpdated){
		tr_1.Post()
	}
	var ls_code,ls_date
	ls_code = ds_1.NameValue(ds_1.RowPosition,"receive_code")
	ls_date = ds_1.NameValue(ds_1.RowPosition,"comp_date")
	makeCookie("@r_tender_planamt_list@",ls_code + "@" + ls_date + "@" + 
                                   gs_home + '/const/r_web/02/r_tender_planamt_1h.html' + "@" )
	top.frames['main_ct'].location.href(gs_home + "/const/r_web/02r/r_tender_planamt_list_1h.html" +"?"+'p')
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
	is_work_date = f_sysdate()
	tr_1.Action = is_tr_1_addr 
	btnquery_onclick()
}

</SCRIPT>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
	if (kcode == 13) {
	    if (ds_1.RowPosition == ds_1.CountRow)  
	        btnadd_onclick()
	    else     
	        ds_1.RowPosition++
	}
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
{

	if (ds_1.NameValue(row,"choice_tag01") == 'Y') 
		ck_choice_tag01.checked = -1
	else
		ck_choice_tag01.checked = 0

	if (ds_1.NameValue(row,"choice_tag02") == 'Y') 
		ck_choice_tag02.checked = -1
	else
		ck_choice_tag02.checked = 0

	if (ds_1.NameValue(row,"choice_tag03") == 'Y') 
		ck_choice_tag03.checked = -1
	else
		ck_choice_tag03.checked = 0

	if (ds_1.NameValue(row,"choice_tag04") == 'Y') 
		ck_choice_tag04.checked = -1
	else
		ck_choice_tag04.checked = 0

	if (ds_1.NameValue(row,"choice_tag05") == 'Y') 
		ck_choice_tag05.checked = -1
	else
		ck_choice_tag05.checked = 0

	if (ds_1.NameValue(row,"choice_tag06") == 'Y') 
		ck_choice_tag06.checked = -1
	else
		ck_choice_tag06.checked = 0

	if (ds_1.NameValue(row,"choice_tag07") == 'Y') 
		ck_choice_tag07.checked = -1
	else
		ck_choice_tag07.checked = 0

	if (ds_1.NameValue(row,"choice_tag08") == 'Y') 
		ck_choice_tag08.checked = -1
	else
		ck_choice_tag08.checked = 0

	if (ds_1.NameValue(row,"choice_tag09") == 'Y') 
		ck_choice_tag09.checked = -1
	else
		ck_choice_tag09.checked = 0

	if (ds_1.NameValue(row,"choice_tag10") == 'Y') 
		ck_choice_tag10.checked = -1
	else
		ck_choice_tag10.checked = 0

	if (ds_1.NameValue(row,"choice_tag11") == 'Y') 
		ck_choice_tag11.checked = -1
	else
		ck_choice_tag11.checked = 0

	if (ds_1.NameValue(row,"choice_tag12") == 'Y') 
		ck_choice_tag12.checked = -1
	else
		ck_choice_tag12.checked = 0

	if (ds_1.NameValue(row,"choice_tag13") == 'Y') 
		ck_choice_tag13.checked = -1
	else
		ck_choice_tag13.checked = 0

	if (ds_1.NameValue(row,"choice_tag14") == 'Y') 
		ck_choice_tag14.checked = -1
	else
		ck_choice_tag14.checked = 0

	if (ds_1.NameValue(row,"choice_tag15") == 'Y') 
		ck_choice_tag15.checked = -1
	else
		ck_choice_tag15.checked = 0
}  
</SCRIPT>

</HEAD>
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
	alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
	alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>

<BODY style="FONT-SIZE: 12px" onload=window_onload() oncontextmenu="return false" >
<OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT>	
<OBJECT id=ds_1 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
	 <param name=SortExpr       value="-comp_date+receive_code">
</OBJECT>
<OBJECT id=tr_1 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:r_tender_planamt_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT>	

<Object id=ds_select
	style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT>
<OBJECT id=ds_update
	style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT>

<DIV id=gd_1_button 
style="Z-INDEX: 107; LEFT: 500px; WIDTH: 500px; POSITION: absolute; TOP: 7px; HEIGHT: 20px">
<input id=bt_copy type="button" value="조합생성" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand;
	background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=create_rtn()>
<input id=bt_request type="button" value="조회/출력" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand;
	background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=print_rtn()>
</DIV>

<OBJECT id=gd_1 
    	style="FONT-SIZE: 12px; Z-INDEX: 102; LEFT: 2px; WIDTH: 402px; POSITION: absolute; TOP: 30px; HEIGHT: 630px" 
    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="0">
	<PARAM NAME="AutoInsert" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="Editable" VALUE="0">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="format" VALUE="
	  <C> Name='계산일자'   ID=comp_date Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=70 </C>
	  <C> Name='수주코드' ID=receive_code Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=80 </C>
	  <C> Name='공사명' ID=name BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=215 </C>
	  ">
	<PARAM NAME="DataID" VALUE="ds_1">
</OBJECT>
<DIV id=tab_page_1 
         style="LEFT: 406px; WIDTH: 606px; POSITION: absolute; TOP: 30px; HEIGHT: 200px; BACKGROUND-COLOR: BLACK">
	<table width="100%"  height="100%"  BORDER="5"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="right">계산일자</div></td>
	 		<td width="85%" colspan=17> 
				<OBJECT id=em_comp_date tabIndex=1
							style="WIDTH: 103px;" 
							classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME="format" VALUE="YYYY-MM-DD">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
		</tr>                 
		<tr BGCOLOR="white"> 
			<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
				<div align="right">수주코드</div></td>
			<td width="85%" colspan=17> 
        		<INPUT id=tx_receive_code  style="TEXT-ALIGN: center"  MAXLENGTH=6 tabIndex=2 size=10 readonly >
			  	<INPUT id=bt_receive_code  type=button value=.. tabIndex=3 onclick=bt_receive_onclick()></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
    		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
        		<div align="right">공사명</div></td>
    		<td width="85%" colspan=17> 
         		<INPUT id=tx_name  MAXLENGTH=40 tabIndex=0 size=42 readonly ></td>
		</tr>                 
		<tr BGCOLOR="white"> 
    		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
        		<div align="right">발주처</div></td>
    		<td width="85%" colspan=17> 
         		<INPUT id=tx_order_name  MAXLENGTH=40 tabIndex=0 size=42 readonly ></td>
		</tr>                 
		<tr BGCOLOR="white"> 
    		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
        		<div align="right">기초금액</div></td>
    		<td width="35%" colspan=7> 
       		<OBJECT id=em_survey_amt tabIndex=0
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="ReadOnly" VALUE="-1">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
    		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
        		<div align="right">입찰일자</div></td>
    		<td width="35%" colspan=7> 
				<OBJECT id=em_tender_date tabIndex=0 
					style="WIDTH: 103px;" 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<PARAM NAME="ReadOnly" VALUE="-1">
					<PARAM NAME="format" VALUE="YYYY-MM-DD">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
		</tr>                 
	</table>    

</DIV>
<DIV id=tab_page_2 
         style="LEFT: 406px; WIDTH: 606px; POSITION: absolute; TOP: 250px; HEIGHT:410px; BACKGROUND-COLOR: BLACK">
	<table width="100%"  height="100%"  BORDER="5"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="right">비율</div></td>
	 		<td width="85%" colspan=17> 
       		<OBJECT id=em_rate tabIndex=4
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxDecimalPlace" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT>(%)</td>
		</tr>                 
		<tr BGCOLOR="white"> 
			<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
				<div align="center">순번</div></td>
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4 > 
				<div align="center">예정가</div></td>
			<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
				<div align="center">채택여부</div></td>
			<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
				<div align="center">순번</div></td>
			<td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4 > 
				<div align="center">예정가</div></td>
			<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
				<div align="center">채택여부</div></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">1</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt01 tabIndex=5
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag01 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()" ></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">2</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt02 tabIndex=6
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag02 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">3</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt03 tabIndex=7
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag03 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">4</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt04 tabIndex=8
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag04 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">5</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt05 tabIndex=9
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag05 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">6</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt06 tabIndex=10
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag06 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">7</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt07 tabIndex=11
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag07 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">8</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt08 tabIndex=12
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag08 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">9</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt09 tabIndex=13
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag09 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">10</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt10 tabIndex=14
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag10 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">11</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt11 tabIndex=15
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag11 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">12</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt12 tabIndex=16
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag12 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">13</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt13 tabIndex=17
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag13 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">14</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt14 tabIndex=18
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=3> 
				<INPUT id=ck_choice_tag14 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
		<tr BGCOLOR="white"> 
	 		<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3> 
	     		<div align="center">15</div></td>
	 		<td width="20%" colspan=4> 
       		<OBJECT id=em_plan_amt15 tabIndex=19
					style="WIDTH: 130px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></td>
			<td width="15%" colspan=13> 
				<INPUT id=ck_choice_tag15 style="Z-INDEX: 100;" align=center type=checkbox onclick="Checkbox_1_onclick()"></td>
     	</tr>                 
	</table>    

</DIV>

<OBJECT id=bd_data 
    	style="Z-INDEX: 108; LEFT: 124px; WIDTH: 22px; POSITION: absolute; TOP: -37px; HEIGHT: 18px" 
    	classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
 		<C>Col=comp_date     Ctrl=em_comp_date      Param=text   Enable=enable</C>
		<C>Col=receive_code  Ctrl=tx_receive_code   Param=value  Enable=enable</C>
		<C>Col=name          Ctrl=tx_name           Param=value  Enable=enable</C>
		<C>Col=order_name    Ctrl=tx_order_name     Param=value  Enable=enable</C>
		<C>Col=survey_amt    Ctrl=em_survey_amt     Param=text   Enable=enable</C>
		<C>Col=tender_date   Ctrl=em_tender_date    Param=text   Enable=enable</C>
		<C>Col=rate          Ctrl=em_rate           Param=text   Enable=enable</C>
		<C>Col=plan_amt01    Ctrl=em_plan_amt01     Param=text   Enable=enable</C>
		<C>Col=choice_tag01  Ctrl=ck_choice_tag01   Param=value  Enable=enable</C>
		<C>Col=plan_amt02    Ctrl=em_plan_amt02     Param=text   Enable=enable</C>
		<C>Col=choice_tag02  Ctrl=ck_choice_tag02   Param=value  Enable=enable</C>
		<C>Col=plan_amt03    Ctrl=em_plan_amt03     Param=text   Enable=enable</C>
		<C>Col=choice_tag03  Ctrl=ck_choice_tag03   Param=value  Enable=enable</C>
		<C>Col=plan_amt04    Ctrl=em_plan_amt04     Param=text   Enable=enable</C>
		<C>Col=choice_tag04  Ctrl=ck_choice_tag04   Param=value  Enable=enable</C>
		<C>Col=plan_amt05    Ctrl=em_plan_amt05     Param=text   Enable=enable</C>
		<C>Col=choice_tag05  Ctrl=ck_choice_tag05   Param=value  Enable=enable</C>
		<C>Col=plan_amt06    Ctrl=em_plan_amt06     Param=text   Enable=enable</C>
		<C>Col=choice_tag06  Ctrl=ck_choice_tag06   Param=value  Enable=enable</C>
		<C>Col=plan_amt07    Ctrl=em_plan_amt07     Param=text   Enable=enable</C>
		<C>Col=choice_tag07  Ctrl=ck_choice_tag07   Param=value  Enable=enable</C>
		<C>Col=plan_amt08    Ctrl=em_plan_amt08     Param=text   Enable=enable</C>
		<C>Col=choice_tag08  Ctrl=ck_choice_tag08   Param=value  Enable=enable</C>
		<C>Col=plan_amt09    Ctrl=em_plan_amt09     Param=text   Enable=enable</C>
		<C>Col=choice_tag09  Ctrl=ck_choice_tag09   Param=value  Enable=enable</C>
		<C>Col=plan_amt10    Ctrl=em_plan_amt10     Param=text   Enable=enable</C>
		<C>Col=choice_tag10  Ctrl=ck_choice_tag10   Param=value  Enable=enable</C>
		<C>Col=plan_amt11    Ctrl=em_plan_amt11     Param=text   Enable=enable</C>
		<C>Col=choice_tag11  Ctrl=ck_choice_tag11   Param=value  Enable=enable</C>
		<C>Col=plan_amt12    Ctrl=em_plan_amt12     Param=text   Enable=enable</C>
		<C>Col=choice_tag12  Ctrl=ck_choice_tag12   Param=value  Enable=enable</C>
		<C>Col=plan_amt13    Ctrl=em_plan_amt13     Param=text   Enable=enable</C>
		<C>Col=choice_tag13  Ctrl=ck_choice_tag13   Param=value  Enable=enable</C>
		<C>Col=plan_amt14    Ctrl=em_plan_amt14     Param=text   Enable=enable</C>
		<C>Col=choice_tag14  Ctrl=ck_choice_tag14   Param=value  Enable=enable</C>
		<C>Col=plan_amt15    Ctrl=em_plan_amt15     Param=text   Enable=enable</C>
		<C>Col=choice_tag15  Ctrl=ck_choice_tag15   Param=value  Enable=enable</C>
	" >
</OBJECT>
</DIV>
</BODY></HTML>
