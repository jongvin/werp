<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- ************************************************************* -->
<!-- 1. 프로그램 id   : e_accident_report_1h.html 	             -->
<!-- 2. 유형(시나리오): 조회및 입력											 -->
<!-- 3. 기 능 정 의   :      	                         -->
<!-- 4. 변 경 이 력   : 황보은영 작성										 -->
<!-- 5. 관련프로그램  :															 -->
<!-- 6. 특 기 사 항   :															 -->
<!-- ************************************************************* -->
<HTML><HEAD>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
var gs_home = parent.frames['security'].gs_home.value

var is_ds_1_addr = gs_home + '/const/e_web/02/e_accident_report_1q.jsp?arg_dept_code='
var is_ds_2_addr = gs_home + '/const/e_web/02/e_accident_report_detail_1q.jsp?arg_dept_code=' 
var is_ds_3_addr = gs_home + '/const/e_web/02/e_accident_report_detail_2q.jsp?arg_dept_code=' 
        
var is_tr_1_addr = gs_home + '/const/e_web/02/e_accident_report_1tr.jsp'
var is_tr_2_addr = gs_home + '/const/e_web/02/e_accident_report_detail_1tr.jsp'
var is_tr_3_addr = gs_home + '/const/e_web/02/e_accident_report_detail_2tr.jsp'

var il_focus=1
var check_save = 1
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var il_nindex = 1
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function div_init_move()                 //하위 입력시 초기 셋팅.
//------------------------------------------------------------------------
{
	if (il_nindex == 1) {
	  ds_2.NameValue(ds_2.RowPosition,"dept_code") = ds_1.NameValue(ds_1.RowPosition,"dept_code")
	  ds_2.NameValue(ds_2.RowPosition, "seq") = ds_1.NameValue(ds_1.RowPosition, "seq")
	  gd_2.Focus()
	  gd_2.SetColumn('name')
	}
	
	if (il_nindex == 2) {
	  ds_3.NameValue(ds_3.RowPosition,"dept_code") = ds_1.NameValue(ds_1.RowPosition,"dept_code")
	  ds_3.NameValue(ds_3.RowPosition, "seq") = ds_1.NameValue(ds_1.RowPosition, "seq")
	  ds_3.NameValue(ds_3.RowPosition, "d_seq") = ds_3.Max(3,0,0) + 1
	  gd_3.Focus()
	  gd_3.SetColumn('item_name')
	}                               
}
//------------------------------------------------------------------------
function init_move()                 
//------------------------------------------------------------------------
{
  check_save = 1
  ds_1.NameValue(ds_1.RowPosition, "dept_code") = is_dept_code
  ds_1.NameValue(ds_1.RowPosition, "seq") = ds_1.Max(2,0,0) + 1
  gd_1.Focus()
  gd_1.SetColumn('seq')
}
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회
//------------------------------------------------------------------------
{
 if (il_focus == 1) { 
   ds_1.DataID = is_ds_1_addr + is_dept_code
   ds_1.SyncLoad=true  //DataSet Loading하는 시점과 관련..
   ds_1.Reset()
 }   
 else {
	div_btnquery_onclick()
 }
}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위조회  
//------------------------------------------------------------------------
{
	if ( ds_1.RowPosition < 1) {
	 ds_2.DataID=is_ds_2_addr + ' ' + "&arg_seq=" + ' ' 
    ds_2.SyncLoad=true 
    ds_2.Reset()
	 return 
	}                                                   // dept_code가 변경되었을 경우 하위조회를 원상복귀.
	
	if (il_nindex == 1) {
	 ds_2.DataID=is_ds_2_addr + ds_1.NameValue(ds_1.RowPosition,"dept_code") + "&arg_seq=" + ds_1.NameValue(ds_1.RowPosition, "seq"); 
    ds_2.SyncLoad=true 
    ds_2.Reset()
   }
   
   if (il_nindex == 2) {
	 ds_3.DataID=is_ds_3_addr + ds_1.NameValue(ds_1.RowPosition,"dept_code") + "&arg_seq=" + ds_1.NameValue(ds_1.RowPosition, "seq"); 
    ds_3.SyncLoad=true 
    ds_3.Reset()
   }

    IFrame_upload.btnquery_onclick(f_get_parent_key())
}

//------------------------------------------------------------------------
function f_get_parent_key()                     // IFrame_upload에서 호출하는 함수 parent_key 를 return
//------------------------------------------------------------------------
{
   IFrame_upload.is_job_code = 'E';
   IFrame_upload.is_dir_name = '안전관리';
   IFrame_upload.is_title = '재해';

	var ls_parent_key = ds_1.NameValue(ds_1.RowPosition,"dept_code") + ds_1.NameValue(ds_1.RowPosition, "seq");

	return ls_parent_key;
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
if (il_focus == 1) {
    if (ds_2.IsUpdated) {
       tb_1.ActiveIndex = 1
       alert("재해자인적사항을 먼저 저장하십시요")
       return
    }
    if (ds_3.IsUpdated) {
       tb_1.ActiveIndex = 2
       alert("물적재해사항을 먼저 저장하십시요")
       return
    } 
       
   ds_1.InsertRow(1)
   init_move()
}   
else
   div_btnadd_onclick()  
}
//------------------------------------------------------------------------
function div_btnadd_onclick()                  // 하위 추가
//------------------------------------------------------------------------
{
    if (ds_1.IsUpdated) {
       il_focus=1
       alert("재해등록 정보를 먼저 저장하십시요")
       return
    }
    if (il_nindex == 1) {
	    if (ds_1.NameValue(ds_1.RowPosition,'dept_code') != ""){
	       ds_2.AddRow()
	       div_init_move()
	    }
	 }
	 
	 if (il_nindex == 2) {
	 	 if (ds_1.NameValue(ds_1.RowPosition,'dept_code') != ""){
	       ds_3.AddRow()
	       div_init_move()
	    }
	 }
 }
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
  if  (il_focus == 1) { 
    if (ds_2.IsUpdated) { //변경여부 조회
       tb_1.ActiveIndex = 1
       alert("재해자 인적사항을 먼저 저장하십시요")
       return
    }
    
    if (ds_3.IsUpdated) { //변경여부 조회
       tb_1.ActiveIndex = 2
       alert("물적재해사항을 먼저 저장하십시요")
       return
    }
       
      ds_1.InsertRow(ds_1.RowPosition);
      init_move()
      return
  }      
//  하위 로직만 수행 
  if (ds_1.IsUpdated) {
     il_focus=1
     alert("재해등록 정보를 먼저 저장하십시요")
     return
  }   


 if (ds_1.NameValue(ds_1.RowPosition,'dept_code') != "")  {
      ds_2.InsertRow(ds_2.RowPosition);
      div_init_move()    
  }    
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
  if  (il_focus == 1) {
     if (ds_2.IsUpdated) {
       tb_1.ActiveIndex = 1
       alert("재해자인적사항을 먼저 저장하십시요")
       return
     }   
  	  if (ds_2.CountRow > 0 ){
  	  		alert('재해자인적사항의 자료부터 삭제하십시요')   //ds_2의 범위는 arg_empno 변수값에 걸러진 내용까지 해당.
  	  		return
  	  }
  	  
  	  if (ds_3.IsUpdated) {
       tb_1.ActiveIndex = 2
       alert("물적재해사항을 먼저 저장하십시요")
       return
     }   
  	  if (ds_3.CountRow > 0 ){
  	  		alert('물적재해사항의 자료부터 삭제하십시요')   //ds_2의 범위는 arg_empno 변수값에 걸러진 내용까지 해당.
  	  		return
  	  	}
  	check_save = 2
    ds_1.DeleteRow(ds_1.RowPosition)
  }     
  else
      div_btndelete_onclick()        
} 
//------------------------------------------------------------------------     
function div_btndelete_onclick()           //하위 삭제
//------------------------------------------------------------------------
{
  if (ds_1.IsUpdated) {
     il_focus=1
     alert("재해등록 정보를 먼저 저장하십시요")
     return
  }   
  if (il_nindex == 1) {
	  if  (gd_2.MultiRowSelect){               // multi row select 일 경우
	     for (i=ds_2.CountRow ;i >0 ;i--){
	        if (ds_2.RowMark(i) == 1)
	               ds_2.DeleteRow(i)
	      }  
	     if  (ds_2.RowPosition != 0)          
	          ds_2.MarkRows(ds_2.RowPosition,ds_2.RowPosition)  //삭제작업완료후 MARK
	  }
	  else
	     ds_2.DeleteRow(ds_2.RowPosition) 
  } 
  
  if (il_nindex == 2) {
	  if  (gd_3.MultiRowSelect){               // multi row select 일 경우
	     for (i=ds_3.CountRow ;i >0 ;i--){
	        if (ds_3.RowMark(i) == 1)
	               ds_3.DeleteRow(i)
	      }  
	     if  (ds_3.RowPosition != 0)          
	          ds_3.MarkRows(ds_3.RowPosition,ds_3.RowPosition)  //삭제작업완료후 MARK
	  }
	  else
	     ds_3.DeleteRow(ds_3.RowPosition) 
  } 
  
 }
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{   

alert(ds_1.NameValue(ds_1.RowPosition,'accident_date').substr(8,2)) ;
alert(ds_1.NameValue(ds_1.RowPosition,'accident_date').substr(10,2)) ;

   if (il_focus == 1) {
   	 if ( check_save == 1) {
	     if (ds_1.IsUpdated){
	   	 var ll_dup
	   	 ll_dup = f_dup_chk("ds_1","seq")
	   	 if (ll_dup > 0) {
	   	     alert("순번이 중복되었습니다: 순번을 수정하십시요 ")
	   	     ds_1.RowPosition = ll_dup
	        	  gd_1.SetColumn("seq");
	   	     return
	   	 }
	   	 	if (em_accident_date.text == "" || em_accident_date.text == "        "){
	     	 	alert("사고일자를 입력하십시요")
	     	 	em_accident_date.focus()
	     	 	return
	       }
	     	 if (ccom_disaster.codevalue == ""){
	     	 	alert("재해방생형태를 선택하십시요")
	     	 	return
	       }
			 for (i=1 ; i <= ds_1.CountRow ; i++ )
			 {
				if ((ds_1.NameValue(i,'accident_date').substr(8,2) < 24 ) && (ds_1.NameValue(i,'accident_date').substr(10,2) < 60 ) && ( f_check_date(ds_1.NameValue(i,'accident_date').substr(0,8)) )  ) 
				{
				}
				else
				{
					alert('사고일자가 유효하지않습니다. \n수정해주세요');
					return false ;
				}

			 }

	    }
     }
     if (ds_1.IsUpdated)  {
         if  (confirm("변경되었습니다 저장하시겠습니까?")) 
             tr_1.Post()
      } 
   }   
   if (il_focus == 2) {
     if (ds_2.IsUpdated){
   	 var ll_dup
   	 ll_dup = f_dup_chk("ds_2","civil_register_number")
   	 if (ll_dup > 0) {
   	     alert("주민등록번호가 중복되었습니다: 주민등록번호를 수정하십시요 ")
   	     ds_2.RowPosition = ll_dup
        	  gd_2.SetColumn("civil_register_number");
   	     return
   	 }
     }
     if (ds_2.IsUpdated)  {
         if  (confirm("변경되었습니다 저장하시겠습니까?"))
             tr_2.Post()
    
      } 
   }
   if (il_focus == 3) {   
      if (ds_3.IsUpdated)  {
         if  (confirm("변경되었습니다 저장하시겠습니까?"))
             tr_3.Post()
    
      } 
   }
	
	IFrame_upload.btnsave_onclick()
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
 if (il_focus == 1) 
    ds_1.Undo(ds_1.RowPosition);  //Original Data로 되돌림.
 else
 	 if (il_focus == 2)
    	ds_2.Undo(ds_2.RowPosition);
    else (il_focus == 3)
    	ds_3.Undo(ds_3.RowPosition);    
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated) {
     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
        {  //저장 routine
        }   
 
       }     
top.frames['main_ct'].location.href(ls_arg)
top.frames['main_title'].div_r.style.visibility="hidden"             
top.frames['main_title'].div_u.style.visibility="hidden"             

// top.frames['main_ct'].window.close()     
}

//---------------------------------------------------------------------------
function bt_zip_onclick()                     //우편번호 찾기
//---------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	result = window.showModalDialog(gs_home + "/comm_search/z_zip_find_1h.html", '',"dialogWidth:640px;dialogHeight:500px");
	if(result == "") return;

	array = result.split("@");
	ds_2.NameValue(ds_2.RowPosition, "zip_number") = array[0]
	ds_2.NameValue(ds_2.RowPosition, "address1") = array[1]
	
	gd_2.Focus()
   gd_2.SetColumn('address2')
}

//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_focus = focus
}


//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	result = f_dept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	dept_name.value = is_dept_name

  il_screen = 1   //parent를 다시 읽음 
	btnquery_onclick()
	div_btnquery_onclick()
}  

//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}

//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_1','div_file_upload','gd_2', 'tb_1');
	var xArr   = new Array(false, true,true,true);
	var yArr   = new Array(true,true,false,false);

	f_reSize(objArr, xArr, yArr);
}  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
  top.frames['main_title'].mouse_over()
  
  //재해발생형태 코드
  ll_cnt = f_ds_select_q("ds_disaster","select safety_code select_1, child_name select_2 from e_safety_code_child where class_tag = 32 order by safety_code")
  //상해종류 코드
  ll_cnt = f_ds_select_q("ds_injure_code","select safety_code select_1, child_name select_2 from e_safety_code_child where class_tag = 34 order by safety_code")
  //상재부위 코드
  ll_cnt = f_ds_select_q("ds_injure_part","select safety_code select_1, child_name select_2 from e_safety_code_child where class_tag = 35 order by safety_code")
  
  dept_name.value = is_dept_name
  ds_1.DataID = is_ds_1_addr + is_dept_code
  ds_1.SyncLoad = true
  tr_1.Action = is_tr_1_addr
  tr_2.Action = is_tr_2_addr
  tr_3.Action = is_tr_3_addr
  btnquery_onclick()
  div_btnquery_onclick()

  tb_1.ActiveIndex = 1
  
}
</SCRIPT>


<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_disaster event=OnLoadError()>
  alert("Error Code(ds_disaster) : " + ds_disaster.ErrorCode + "\n" + "Error Message : " + ds_disaster.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_injure_code event=OnLoadError()>
  alert("Error Code(ds_injure_code) : " + ds_injure_code.ErrorCode + "\n" + "Error Message : " + ds_injure_code.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_injure_part event=OnLoadError()>
  alert("Error Code(ds_injure_part) : " + ds_injure_part.ErrorCode + "\n" + "Error Message : " + ds_injure_part.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code(tr_1) : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("Error Code(ds_3) : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code(tr_2) : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
  alert("Error Code(tr_3) : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ccom_div event=onCloseUp()>
 il_focus=1
 btnquery_onclick()
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnSuccess()>
 gf_key_copy("ds_1","seq@key_seq")
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=OnRowPosChanged(row)> //row의 위치변경시 발생
	if (row < 1)  return
	div_btnquery_onclick()
	if (ds_2.CountRow > 0 )
		em_seq.Enable = false
	else
		em_seq.Enable = true

</SCRIPT>

<SCRIPT language=JavaScript for=ds_1 event=CanRowPosChange(row)>

	if (ds_2.IsUpdated) {
	   alert("재해자인적사항을 먼저 저장하십시요")
	   il_focus=2
	   return false
	}
	else if (ds_3.IsUpdated) {
	   alert("물적재해사항을 먼저 저장하십시요")
	   il_focus=3
	   return false
	}
	else 
		return true 
	
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_1.RowPosition == ds_1.CountRow)  
        btnadd_onclick()
    else     
        ds_1.RowPosition++
}
</script>
<script language=JavaScript for=gd_2 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_2.RowPosition == ds_2.CountRow)  
        div_btnadd_onclick()
    else     
        ds_2.RowPosition++
}
</script>
<SCRIPT language=JavaScript for=gd_2 event=OnPopup(row,colid,data)>
	if(colid == 'zip_number')
		bt_zip_onclick()
</SCRIPT>

<SCRIPT language=JavaScript for=tb_1 event=OnSelChanged(nIndex)>
	il_nindex = nIndex
	div_btnquery_onclick()
</SCRIPT>

<script language=JavaScript for=ds_3 event=OnColumnChanged(row,colid)>
var tmp_amt = 0
	if (row < 1) return
	
	if (colid == "item_qty")
		ds_3.NameValue(row, "dis_amt") = ds_3.NameValue(row, "item_qty") * ds_3.NameValue(row, "item_price")
		
	if (colid == "item_price")
		ds_3.NameValue(row, "dis_amt") = ds_3.NameValue(row, "item_qty") * ds_3.NameValue(row, "item_price")
		
// 피해금액 구하기	
	for ( i= 1 ; i <= ds_3.CountRow ; i++ )
	{	
		tmp_amt += parseInt(ds_3.NameValue(i,'dis_amt')) 	
	}
		em_dis_amt.text = tmp_amt	
</script>
<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>    
    
<comment id="__NSID__"><OBJECT id=ds_disaster
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_injure_code
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_injure_part
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
    
<comment id="__NSID__"><OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:e_accident_report_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>


<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:e_accident_report_detail_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tr_3 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:e_accident_report_detail_2tr=ds_3)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
</HEAD>


<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="font: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) oncontextmenu="return false">
<div class=main_div>
<table border="0" width="100%" height="100%" cellspacing="0">
	<tr height="20px">
		<td class=td_green colspan="2">
			<table border="0" cellspacing="0" cellpadding="0" class=main_table>
				<tr>
					<td width="15px"><img src="../../../image/bullet3.gif" align="absmiddle"></td>
					<td width="42px" class=font_green_bold>현장명</td>
					<td width="145px">
						<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" style=" FONT-SIZE: 12px;" size=22 onkeyDown="keyDown()">
					</td>
					<td>
						<input type="button" value="검색" onclick=dept_code_find() class=img_btnFind onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"></td>
					<td width="*">　</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr height="*">
		<td width="23%">
			<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
			    style="FONT-SIZE: 12px; Z-INDEX: 100; width: 100%; HEIGHT: 100%" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
				<PARAM NAME="MultiRowSelect" VALUE="-1">
				<PARAM NAME="AutoInsert" VALUE="-1">
			    <PARAM NAME="BorderStyle"  VALUE=1>
			    <PARAM NAME="SortView"  VALUE="Left">
				<PARAM NAME="AllShowEdit" VALUE="-1">
				<PARAM NAME="Editable" VALUE="false">
				<PARAM NAME="UsingOneClick"  VALUE="1">
				<PARAM NAME="DragDropEnable"  VALUE="true">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="DataID" VALUE="ds_1">
				<PARAM NAME="Format" VALUE="
			     <C> Name='NO' id=seq width=35  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK align=center </C>
			     <C> Name='사고일자' id=accident_date sort=true Align=center width=77  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} mask='XXXX.XX.XX'  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='재해발생형태'  id=disaster_name  width=97  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  ">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="77%">
			<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="2"  style="table-layout: fixed">
				<tr height="20px">
					<td width="15px"><img src="../../../image/bullet1.gif" align="absmiddle" ></td>
					<td width="200px" class=font_green_bold>재해 등록</td>
					<td width="*">　</td>
				</tr>
				<tr height="30%">
					<td colspan="3">
						<table width="100%" border="1" align="center" cellspacing="0" style="font-size: 12px;">
							<tr>
								<td width="80" align="center" bgcolor="#BBE0F4" style="color: black">순번</td>
								<td width="80">
									<comment id="__NSID__"><OBJECT id=em_seq 
								        style="WIDTH: 50px; HEIGHT: 20px; FONT-SIZE: 12px" 
									   classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
								         <param name=ReadOnlyBackColor  value=silver>
								         <param name=Alignment      value=1>
								         <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
								</td>
								
								<td width="80" align="center" bgcolor="#BBE0F4" style="color: black">사고일자</td>
								<td width="110"><comment id="__NSID__"><OBJECT id=em_accident_date   
								                 style="WIDTH: 100; HEIGHT: 20px; FONT-SIZE: 12px" 
													  classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
												<param name=Format value="####-##-## ##:##">
								            	<param name=ReadOnlyBackColor  value=silver>
								            	<param name=Alignment      value=1>
								            	<param name=Numeric value=false>
												<param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
								
								<td width="100" align="center" bgcolor="#BBE0F4" style="color: black">재해발생형태</td>
								<td width="110" height="25%">
									<comment id="__NSID__"><object id=ccom_disaster
										classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
					               height=150 width=90 VIEWASTEXT>
										<PARAM NAME="Alignment" VALUE="1">
										<param name=ComboDataID         value=ds_disaster>
					               <param name=CodeCColumn        value=select_1>
					               <param name=DataCColumn         value=select_2>
					               <param name=ReadOnlyBackColor     value="#F2F2F2">
					               <param name=Auto     value=false>
										<param name=Enable   value=false>
									</object></comment> <script> __ws__(__NSID__);</script>
								</td>
								<td width="80" align="center" bgcolor="#BBE0F4" style="color: black">피해금액</td>
								<td width="*">
									<comment id="__NSID__"><OBJECT id=em_dis_amt
										style="WIDTH: 100%;" 
										classid=CLSID:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											<param name=IsComma			value=true>
											<param name=Enable			value=false>
											<PARAM NAME="PromptChar" VALUE="">
											<PARAM NAME="Numeric" VALUE="1">
											<param name=Alignment   value=2>					
											<param name=ReadOnly value="true">
									</OBJECT></comment> <script> __ws__(__NSID__);</script>
								</td>
							</tr>
						</table>
						<table border="1" width="100%" align="center" cellspacing="0" style="font-size: 12px;  border-top: 0">
							<tr>
								<td width="100" align="center" bgcolor="#BBE0F4" style="color: black">사고경위</td>
								<td height="25%" colspan="2">
									<textarea id="tx_accident" cols=42 rows=3
										maxLength="2000" onChange="LimitTextLength(this)" onKeyUp="LimitTextLength(this)"  style="font-size:12px" ></textarea></td>
										
								<td width="100" align="center" bgcolor="#BBE0F4" style="color: black">재해원인</td>
								<td height="25%" colspan="2">
									<textarea id="tx_dis_cause" cols=42 rows=3
										maxLength="2000" onChange="LimitTextLength(this)" onKeyUp="LimitTextLength(this)"  style="font-size:12px" ></textarea></td>	
							</tr>
							<tr>
								<td width="100" align="center" bgcolor="#BBE0F4" style="color: black">조치사항</td>
								<td height="25%" colspan="2">
									<textarea id="tx_solution" cols=42 rows=3
									   maxLength="2000" onChange="LimitTextLength(this)" onKeyUp="LimitTextLength(this)"  style="font-size:12px"></textarea></td>
									   
								<td width="100" align="center" bgcolor="#BBE0F4" style="color: black">대책</td>
								<td height="25%" colspan="2">
									<textarea id="tx_dis_measures" cols=42 rows=3
									   maxLength="2000" onChange="LimitTextLength(this)" onKeyUp="LimitTextLength(this)" style="font-size:12px" ></textarea></td>
							</tr>
							<tr>
								<td width="100" align="center" bgcolor="#BBE0F4" style="color: black">기타</td>
								<td height="25%" colspan="5">
									<textarea id="tx_etc" cols=105 rows=3
										maxLength="100" onChange="LimitTextLength(this)" onKeyUp="LimitTextLength(this)" style="font-size:12px" ></textarea></td>
							</tr>
						</table>
					</td>
				</tr>
<!--				<tr height="20px">
					<td width="15px"><img src="../../../image/bullet1.gif" align="absmiddle" ></td>
					<td width="200px" class=font_green_bold>재해자 인적사항</td>
					<td width="*">&nbsp;</td>
				</tr>-->
				<tr height="30%">
					<td colspan="3">
						<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0">
							<tr height="20px">
								<td width="240">
									<comment id="__NSID__"><OBJECT id=tb_1 
									    style="FONT-SIZE: 12px; Z-INDEX: 200; width:100%; height: 20px; " 
									    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
									  <param name="BackColor"  value="#BBE0F4">
									  <param name="TextColor"  value="BLACK">
									  <PARAM NAME="Format" VALUE="
									    <T>divid=tab_page_1 title='재해자인적사항'</T>
									    <T>divid=tab_page_2 title='물적재해사항'</T>
									    ">
									</OBJECT></comment> <script> __ws__(__NSID__);</script>
								</td>
								<td align="right">* 주민등록번호에 "-"를 넣지 마세요</td>
							</tr>
							<tr height="*">
								<td colspan=2>
									<div id="tab_page_1" style="width: 100%; height: 100%; position: absolute;">
										<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
											style="Z_INDEX: 100; FONT-SIZE: 12px; width: 100%; height: 100%;"
										    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
										   <PARAM NAME="MultiRowSelect" VALUE="-1">
										   <PARAM NAME="AutoInsert" VALUE="-1">
										   <PARAM NAME="SortView"  VALUE="Left">
										   <PARAM NAME="AllShowEdit" VALUE="-1">
										   <PARAM NAME="BorderStyle"  VALUE=1>
										   <PARAM NAME="Editable" VALUE="-1">
										   <PARAM NAME="ColSizing" VALUE="-1">
										   <PARAM NAME="DragDropEnable"  VALUE="true">
										   <PARAM NAME="DataID" VALUE="ds_2">   
										   <PARAM NAME="Format" VALUE=" 
										     <FC> Name='이름'  id=name sort=true width=75  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </FC>
										     <C> Name='주민등록번호'  id=civil_register_number sort=true Mask='XXXXXX-XXXXXXX' Align='center' width=94  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='성별'  id=sex editstyle=combo data='1:남성,2:여성' Align='center' width=54 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
											 <C> Name='우편번호'  id=zip_number Mask='XXX-XXX' Align='center' width=54 EditStyle=PopupFix BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='주소'  id=address1  width=200  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='상세주소'  id=address2  width=200  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='업체명'  id=sbcr_name  width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='직종명'  id=job_type  width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='취업일'  id=join_date  width=75  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <G> Name='상해' HeadBgColor='#BBE0F4' 
											     <C> Name='종류'  id=injure_code sort=true Data='ds_injure_code:select_1:select_2' EditStyle=Lookup  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
											     <C> Name='부위'  id=injure_part_code sort=true Data='ds_injure_part:select_1:select_2' EditStyle=Lookup width=60 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     </G>
										     <C> Name='처리결과'  id=result_type sort=true Data='01:공상,02:산재,03:사망' EditStyle=Combo Align='center' width=72  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     ">
										</OBJECT></comment> <script> __ws__(__NSID__);</script>
									</div>
									<div id="tab_page_2" style="width: 100%; height: 100%; position: absolute;">
										<comment id="__NSID__"><OBJECT id=gd_3 onfocus="get_focus(3)"
											style="Z_INDEX: 100; FONT-SIZE: 12px; width: 100%; height: 100%;"
										    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
										   <PARAM NAME="MultiRowSelect" VALUE="-1">
										   <PARAM NAME="AutoInsert" VALUE="-1">
										   <PARAM NAME="SortView"  VALUE="Left">
										   <PARAM NAME="AllShowEdit" VALUE="-1">
										   <PARAM NAME="BorderStyle"  VALUE=1>
										   <PARAM NAME="Editable" VALUE="-1">
										   <PARAM NAME="ColSizing" VALUE="-1">
										   <PARAM NAME="DragDropEnable"  VALUE="true">
										   <PARAM NAME="DataID" VALUE="ds_3">   
										   <PARAM NAME="Format" VALUE=" 
										     <C> Name='품목'  id=item_name width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='규격'  id=item_size width=150 BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
										     <C> Name='수량'  id=item_qty  width=80  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK align=right</C>
										     <C> Name='단가'  id=item_price  width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK align=right</C>
										     <C> Name='피해금액'  id=dis_amt Edit='none' width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK align=right</C>
										   ">
										</OBJECT></comment> <script> __ws__(__NSID__);</script>
									</div>
								</td>
							</tr>
						</table>
					</td>
				</tr>
				<tr height="*">
					<td colspan="3">
						
						<!-- 파일첨부 Iframe  -->
						<DIV id=div_file_upload
						     style=" Z_INDEX: 100; FONT-SIZE: 12px; width: 100%; height: 100%;">
						<IFRAME ID=IFrame_upload FRAMEBORDER=0 SCROLLING=NO SRC="../../../comm_function/file_upload/file_upload.html" 
						              style="WIDTH: 100%;  HEIGHT: 100%"></IFRAME>
						</DIV>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>

<comment id="__NSID__"><OBJECT id=Bind_1 
    style="Z-INDEX: 107; LEFT: 241px; POSITION: absolute; TOP: 3px" 
    classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
 	<PARAM NAME="BindInfo" VALUE="
 		<C> Col=seq Ctrl=em_seq Param=text Enable=enable </C>
 		<C> Col=accident_date Ctrl=em_accident_date Param=text Enable=enable </C>
 		<C> Col=disaster_code Ctrl=ccom_disaster Param=codevalue Enable=enable </C>
 		<C> Col=dr_accident Ctrl=tx_accident Param=value Enable=enable </C>
 		<C> Col=dr_solution Ctrl=tx_solution Param=value Enable=enable </C>
 		<C> Col=etc Ctrl=tx_etc Param=value Enable=enable </C>
 		<C> Col=dis_cause Ctrl=tx_dis_cause Param=value Enable=enable </C>
 		<C> Col=dis_measures Ctrl=tx_dis_measures Param=value Enable=enable </C>
 	   <C> Col=dis_amt Ctrl=em_dis_amt Param=text Enable=enable </C> 
 	">
</OBJECT></comment> <script> __ws__(__NSID__);</script>      
</div>
</BODY></HTML>