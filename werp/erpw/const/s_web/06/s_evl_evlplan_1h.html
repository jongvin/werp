<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- ************************************************************** -->
<!-- 1. 프로그램 id   : s_evl_evlplan_1h.html 	  				        -->
<!-- 2. 유형(시나리오): shared window 조회및 입력					     -->
<!-- 3. 기 능 정 의   : 평가계획입력(외주관리)  	  				     -->
<!-- 4. 변 경 이 력   : 김 동우 작성						              -->
<!-- 5. 관련프로그램  :					          			              -->
<!-- 6. 특 기 사 항   :					          			              -->
<!-- *************************************************************  -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value
var is_dept_code = top.frames['security'].gs_dept_code.value
var is_dept_name = top.frames['security'].gs_dept_name.value
var is_work_date,is_year,is_class=''
var is_ds_1_addr = gs_home + '/const/s_web/06/s_evl_evlplan_1q.jsp?arg_year='
var is_tr_1_addr = gs_home + '/const/s_web/06/s_evl_evlplan_1tr.jsp'
var is_filter = "tot"
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	ds_1.DataID = is_ds_1_addr + is_year + "&arg_class=" + is_class
	ds_1.SyncLoad=true
	ds_1.Reset()
}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_1.Focus();
	gd_1.SetColumn("seq");
}
//-----------------------------------------------------------------------
function init_move()               // 초기값세팅
//-----------------------------------------------------------------------
{
	ds_1.NameValue(ds_1.RowPosition,"evl_year") = is_work_date.substr(0,4)
	ds_1.NameValue(ds_1.RowPosition,"proj_close") = 'N'
	ds_1.NameValue(ds_1.RowPosition,"bonsa_close") = 'N'
//	if  (ds_1.CountRow > 1) {
//		ds_1.NameValue(ds_1.RowPosition,"degree") = ds_1.NameValue(ds_1.RowPosition + 1,"degree") + 1
//	}   
//	else {      
//		ds_1.NameValue(ds_1.RowPosition,"degree") = 1
//	}
	Fn_SetColumn()
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	 btninsert_onclick()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	 if  (ds_1.CountRow > 0) { 
	     ds_1.RowPosition=1
	     ds_1.InsertRow(ds_1.RowPosition)
	 }    
	 else 
	     ds_1.AddRow()     

	 init_move()
}

//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	var ll_cnt,ls_year,li_degree,ls_class,i
	
	ls_year   = ds_1.NameValue(ds_1.RowPosition,'evl_year')
	li_degree = ds_1.NameValue(ds_1.RowPosition,'degree')
	ls_class  = ds_1.NameValue(ds_1.RowPosition,'evl_class')
	
	ll_cnt = f_select_q("select nvl(count(*),0) select_1 from s_evl_evldept where evl_year = '" + ls_year + "' and degree = " + li_degree + " and evl_class = '" + ls_class + "'")
	if (ll_cnt > 0) {
		i = ds_select.NameValue(ds_select.RowPosition,'select_1')
		if (i > 0) {
			alert('하위에 내역이 존재함으로 삭제할 수 없습니다...')
			return
		}
	}
	ds_1.DeleteRow(ds_1.RowPosition)  
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	var ls_chk=0,ls_spec_chk=0
	
	if (ds_1.IsUpdated){
	
 	   if (f_start_end_chk()) {}                  //종료일자가 시작일자보다 큰지를 check
	   else return 
	   
		if  (confirm("변경되었습니다 저장하시겠습니까?")){
		   	for (i=1; i<= ds_1.CountRow; i++){
			   	if (ds_1.NameValue(i,"evl_class") == '3' && ds_1.NameValue(i,"dept_code") == ''){
		   			ls_chk++
	   			}
	   		}
	   		if (ls_chk == 0) {
					tr_1.Post()
					btnquery_onclick()
       		}
    			else {
					alert("준공평가는 반드시 현장코드를 입력해야 합니다... \n        저장되지않았습니다.")
	       	}
    	}
	}
	return
}
//------------------------------------------------------------------------
function f_start_end_chk()                       //종료일자가 시작일자보다 반드시 크거나 같아야하는 로직 체크
//------------------------------------------------------------------------
{
  var ll_ret_row
     ll_ret_row = gf_gd_start_end_date('ds_1','evl_f_date','evl_t_date')
	  if (ll_ret_row > 0)  {
	     alert('평가기간의 종료일자가 시작일자보다 반드시 커야합니다')
	     ds_1.RowPosition = ll_ret_row	      
	     return false
	  }   
     ll_ret_row = gf_gd_start_end_date('ds_1','from_date','to_date')
	  if (ll_ret_row > 0)  {
	     alert('대상기간의 종료일자가 시작일자보다 반드시 커야합니다')
	     ds_1.RowPosition = ll_ret_row	      
	     return false
	  }   
  return true        
}

//---------------------------------------------------------------------------
function bt_t_onclick()                     //공통평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"t_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"t_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_a_onclick()                     //건설평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"a_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"a_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_m_onclick()                     //설비평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"m_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"m_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_e_onclick()                     //전기평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"e_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"e_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_c_onclick()                     //토목평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"c_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"c_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_j_onclick()                     //조경평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"j_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"j_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_mat_onclick()                     //자재평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"mat_id")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"mat_name") = array[1]
}
//---------------------------------------------------------------------------
function bt_2_onclick()                     //2차평가자찾기
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return

	var result;
	var send_arg;
	var array = new Array();
	send_arg = "@"
	result = window.showModalDialog(gs_home + "/general/p_web/99/p_emp_no_find_1h.html", send_arg,"dialogWidth:690px;dialogHeight:500px");
	
	if(result == "") return;
	array = result.split("@");
	ds_1.NameValue(ds_1.RowPosition,"id2")   = array[0]
	ds_1.NameValue(ds_1.RowPosition,"name2") = array[1]
}
//----------------------------------------------------------------------------
function proj_insert()                     // 현장등록가기
//---------------------------------------------------------------------------- 
{
	var parm;

	if (ds_1.CountRow < 1) { 
		alert("선택한 내역이 없기때문에 들어갈수 없습니다")
		return
	}   

	makeCookie("@s_evl_evldept@",ds_1.NameValue(ds_1.RowPosition,"evl_year") + "@" + 
											  ds_1.NameValue(ds_1.RowPosition,"degree") + "@" + 
											  ds_1.NameValue(ds_1.RowPosition,"evl_class")  + "@" + 	
                                   ds_1.NameValue(ds_1.RowPosition,"from_date") + "@" + 
                                   ds_1.NameValue(ds_1.RowPosition,"to_date") + "@" + gs_home +'/const/s_web/06/s_evl_evlplan_1h.html' )

	top.frames['main_ct'].location.href(gs_home + "/const/s_web/06/s_evl_evldept_1h.html" +"?"+'u')
	
}
//----------------------------------------------------------------------------
function code_insert()                     // 항목코드등록가기
//---------------------------------------------------------------------------- 
{
	var parm;

	if (ds_1.CountRow < 1) { 
		alert("선택한 내역이 없기때문에 들어갈수 없습니다")
		return
	}   

	makeCookie("@s_evl_evldept@",ds_1.NameValue(ds_1.RowPosition,"evl_year") + "@" + 
											  ds_1.NameValue(ds_1.RowPosition,"degree") + "@" + 
											  ds_1.NameValue(ds_1.RowPosition,"evl_class")  + "@" + 	
                                   is_filter + "@" + ds_1.RowPosition + "@" + gs_home +'/const/s_web/06/s_evl_evlplan_1h.html' )

	top.frames['main_ct'].location.href(gs_home + "/const/s_web/06/s_code_insert_evl_2h.html" +"?"+'u')
	
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------

{
	if (ds_1.IsUpdated) {
	     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
	        {  //저장 routine
	        }   
 
	   }     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

	// top.frames['main_ct'].window.close()     
}
//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	if(ds_1.RowPosition < 1) return
	
	var ls_chk
	
	ls_chk = ds_1.NameValue(ds_1.RowPosition,'evl_class')
	if (ls_chk != '3') {
		alert('준공평가일 경우만 현장을 선택하십시오...')
		return
	}
	result = f_dept_code_find('')
	if (result==false)return
	
	
	ds_1.NameValue(ds_1.RowPosition,'dept_code') = top.frames['security'].gs_dept_code.value
	ds_1.NameValue(ds_1.RowPosition,'long_name') = top.frames['security'].gs_dept_name.value

	
	
}   
//-------------------------------------------------------------------------------
function select_yymm()                  //년도 선택 
//--------------------------------------------------------------------------------
{
   is_year = em_select_yymm.text
   ds_1.ClearData()
   btnquery_onclick()
 
}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
}
//----------------------------------------------------------------
function excel_down()                      //엑셀자료 내리기(공종별) 
//----------------------------------------------------------------
{
 var temp_1
 temp_1 = is_dept_name + '   [' + em_select_yymm.text + ']'
 gd_1.GridToExcel(temp_1,'c:\aa.xls',0)
   
}
//--------------------------------------------------------------------------
function   rd_1_proc()
//----------------------------------------------------------------
{
	bt_1.checked=true
	bt_2.checked=false
	bt_3.checked=false
	bt_4.checked=false
	is_filter = "1p"
	filter_function()
}
//--------------------------------------------------------------------------
function   rd_2_proc()
//----------------------------------------------------------------
{
	bt_1.checked=false
	bt_2.checked=true
	bt_3.checked=false
	bt_4.checked=false
	is_filter = "2p"
	filter_function()
}
//--------------------------------------------------------------------------
function   rd_3_proc()
//----------------------------------------------------------------
{
	bt_1.checked=false
	bt_2.checked=false
	bt_3.checked=true
	bt_4.checked=false
	is_filter = "3p"
	filter_function()
}
//--------------------------------------------------------------------------
function   rd_tot_proc()
//----------------------------------------------------------------
{
	bt_1.checked=false
	bt_2.checked=false
	bt_3.checked=false
	bt_4.checked=true
	is_filter = "tot"
	filter_function()
}
//--------------------------------------------------------------------------
function   filter_function()
//----------------------------------------------------------------
{
	gd_1.ReDraw = false
	ds_1.Filter()
	gd_1.ReDraw = true
}  
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_1','tab_page_1');
	var xArr   = new Array(false, false);
	var yArr   = new Array(true,true);

	f_reSize(objArr, xArr, yArr);
}  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
	top.frames['main_title'].mouse_over()
	is_work_date = f_sysdate()
	tr_1.Action = is_tr_1_addr 
	
	em_select_yymm.text = is_work_date.substr(0,4)
	is_year = is_work_date.substr(0,4)
	btnquery_onclick()
}
</SCRIPT>
<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=em_select_yymm event=onKillFocus()>
	if (em_select_yymm.Modified){ 
		select_yymm()
	}
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_yymm event=onKeyDown(kcode,scode)>
	if ((em_select_yymm.Modified) && kcode == 13 ){ 
		select_yymm()
	}
</SCRIPT>        	

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
	alert("Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
	alert("Error Code : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
	if (kcode == 13) {
	    if (ds_1.RowPosition == ds_1.CountRow)  
	        btnadd_onclick()
	    else     
	        ds_1.RowPosition++
	}
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=onFilter(row)>
      switch (is_filter) {
              case "tot":
                         return true
                         break;
              case "1p":
                         if (ds_1.NameValue(row,"evl_class") == '1') return true
                         else return false;
                         break;
              case "2p":
                         if (ds_1.NameValue(row,"evl_class") == '2') return true
                         else return false;
                         break;
              case "3p":
                         if (ds_1.NameValue(row,"evl_class") == '3') return true
                         else return false;
                         break;
        }
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_close_check
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
	classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
    <param name=UseFilter       value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT></comment> <script> __ws__(__NSID__);</script>	
<comment id="__NSID__"><OBJECT id=tr_1 
    	classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
   	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:s_evl_evlplan_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>	

</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<div class=main_div>
<table border="0" width="100%" height="100%" cellspacing="0">
	<tr height="20px">
		<td class=td_green colspan="2">
			<table BORDER="0" CELLSPACING="0" cellpadding="0" class=main_table>
				<tr> 
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="55px" class=font_green_bold>계획년도</td>
					<td width="80px">
						<comment id="__NSID__"><OBJECT id=em_select_yymm 
						       style="WIDTH: 80px; background: white;" 
						      classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
								<PARAM NAME="Alignment" VALUE="1">
								<PARAM NAME="IsComma" VALUE="0">
								<PARAM NAME="MaxLength" VALUE="8">
								<PARAM NAME="Format" VALUE="YYYY">
								<param name=ClipMode       value=false>
								<PARAM NAME="Numeric" VALUE="0">
								<PARAM NAME="SelectAll" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
					<td width="250px"> 
						<input id=bt_4 type="radio" value="1" defaultChecked=true checked=true onclick="rd_tot_proc()">전체   
						<input id=bt_1 type="radio" value="2"  onclick="rd_1_proc()">상반기    
						<input id=bt_2 type="radio" value="2"  onclick="rd_2_proc()">하반기  
						<input id=bt_3 type="radio" value="2"  onclick="rd_3_proc()">준공    
					</td>
					<td width="*" align="right">
						<INPUT  id=bt_proj_code  type=button  class="img_btn6_1"  value=대상현장등록 onclick=proj_insert() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
  						<INPUT  id=bt_code_insert  type=button  class="img_btn6_1"  value=평가항목등록 onclick=code_insert() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;
					</td>
         	</tr>                 
      	</table>
      </td>
   </tr>
   <tr>
   	<td width="68%">
			<comment id="__NSID__"><OBJECT id=gd_1 
			    	style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%; HEIGHT: 100%" 
			    	classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="DataID" VALUE="ds_1">
				<PARAM NAME="AutoInsert" VALUE="-1">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="AllShowEdit" VALUE="-1">
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="Format" VALUE="
				  <C> Name='년도' ID=evl_year Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=33 </C>
				  <C> Name='차수' ID=degree Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=30 </C>
				  <C> Name='구분' ID=evl_class Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=40 
				  		EditStyle=Combo Data='1:상반기,2:하반기,3:준공 '</C>
				  <C> Name='현장' ID=long_name   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=130 </C>
				  <C> Name='대상현장' ID=cnt_dept Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=55 </C>
				  <G> Name=' 평가 기간'  HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK   
				  <C> Name='From' ID=evl_f_date Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=68 </C>
				  <C> Name='To' ID=evl_t_date Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=68 </C></G>
				  <G> Name=' 대상 기간'  HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK   
				  <C> Name='From' ID=from_date Align=Center BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=68 </C>
				  <C> Name='To' ID=to_date Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=68 </C></G>
				  <G> Name=' 마감여부'  HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK   
				  <C> Name='현장' ID=proj_close  Align=Center  EditStyle=Combo Data='Y:예,N:아니오 ' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=48 </C>
				  <C> Name='본사' ID=bonsa_close  Align=Center  EditStyle=Combo Data='Y:예,N:아니오 '  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4 HeadColor=BLACK Width=48 </C></G>
				  ">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="32%">
			<table width="100%" height="100%" BORDER="1"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
				<tr BGCOLOR="white"> 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6 > 
		        		<div align="right">*평가년도</div></td>
		    		<td width="70%" colspan=14> 
					 	<INPUT style="FONT-SIZE:12px;" id=tx_evl_year tabIndex=3 maxLength=4 size=5 ></td>
		   	</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6 > 
		        		<div align="right">*평가차수</div></td>
		    		<td width="70%" colspan=14> 
					 	<INPUT style="FONT-SIZE:12px;" id=tx_degree tabIndex=3 maxLength=4 size=5 ></td>
		   	</tr>                 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6 > 
		        		<div align="right">평가구분</div></td>
		    		<td width="70%" colspan=14> 
						<comment id="__NSID__"><OBJECT id=ccom_evl_class tabIndex=2
							classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
		                                        height=106 width=60px;>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME=Data VALUE="1^상반기,2^하반기,3^준공">
							<PARAM NAME="ReadOnly" VALUE="-1">
							<param name=DataID           value=ds_1>
							<param name=CodeColumn      value=evl_class>
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
		         	</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6  > 
						<div align="right">*평가현장</div></td>
		    		<td width="70%" colspan=14> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_long_name  MAXLENGTH=2 tabIndex=0 size=22 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_dept_code type=button class=img_btnFind_S onclick=dept_code_find()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6 > 
						<div align="right">평가기간</div></td>
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">From</div></td>
		    		<td width="25%" colspan=5> 
						<comment id="__NSID__"><OBJECT id=em_evl_f_date tabIndex=10 
							style="WIDTH: 70px;" 
							classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME="Format" VALUE="YYYY-MM-DD">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">To</div></td>
		    		<td width="25%" colspan=5> 
						<comment id="__NSID__"><OBJECT id=em_evl_t_date tabIndex=10 
							style="WIDTH: 70px;" 
							classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME="Format" VALUE="YYYY-MM-DD">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
		   	</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6 > 
						<div align="right">대상기간</div></td>
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">From</div></td>
		    		<td width="25%" colspan=5> 
						<comment id="__NSID__"><OBJECT id=em_from_date tabIndex=10 
							style="WIDTH: 70px;" 
							classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME="Format" VALUE="YYYY-MM-DD">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">To</div></td>
		    		<td width="25%" colspan=5> 
						<comment id="__NSID__"><OBJECT id=em_to_date tabIndex=10 
							style="WIDTH: 70px;" 
							classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							<PARAM NAME="Alignment" VALUE="1">
							<PARAM NAME="Format" VALUE="YYYY-MM-DD">
							<PARAM NAME="SelectAll" VALUE="-1">
							<PARAM NAME="PromptChar" VALUE="">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
		   	</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=6 rowspan=7 > 
						<div align="right">1차평가(본사)</div></td>
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">공통</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_t_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_t_code type=button class=img_btnFind_S onclick=bt_t_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">건축</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_a_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_a_code type=button class=img_btnFind_S onclick=bt_a_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">설비</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_m_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_m_code type=button class=img_btnFind_S onclick=bt_m_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">전기</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_e_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_e_code type=button class=img_btnFind_S onclick=bt_e_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">토목</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_c_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_c_code type=button class=img_btnFind_S onclick=bt_c_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">조경</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_j_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_j_code type=button class=img_btnFind_S onclick=bt_j_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
						<div align="right">자재</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_mat_name  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_mat_code type=button class=img_btnFind_S onclick=bt_mat_onclick()></td>
				</tr>                 
				<tr BGCOLOR="white"> 
		    		<td width="40%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=8  > 
						<div align="right">2차평가(본사)</div></td>
		    		<td width="60%" colspan=12> 
					  	<INPUT style="FONT-SIZE:12px;" id=tx_name2  MAXLENGTH=2 tabIndex=0 size=15 readOnly >
					  	<INPUT style="FONT-SIZE:12px;" id=bt_2_code type=button class=img_btnFind_S onclick=bt_2_onclick()></td>
				</tr>                 
			</table> 
		</td>
	</tr>
</table>

<comment id="__NSID__"><OBJECT id=bd_data 
    	style="Z-INDEX: 108; LEFT: 124px; WIDTH: 22px; POSITION: absolute; TOP: -37px; HEIGHT: 18px" 
    	classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	   <C>Col=evl_year     Ctrl=tx_evl_year      Param=value Enable=enable</C>
	   <C>Col=degree       Ctrl=tx_degree        Param=value Enable=enable</C>
		<C>Col=long_name    Ctrl=tx_long_name     Param=value Enable=enable</C>
		<C>Col=evl_f_date   Ctrl=em_evl_f_date    Param=text  Enable=enable</C>
		<C>Col=evl_t_date   Ctrl=em_evl_t_date    Param=text  Enable=enable</C>
		<C>Col=from_date    Ctrl=em_from_date     Param=text  Enable=enable</C>
		<C>Col=to_date      Ctrl=em_to_date       Param=text  Enable=enable</C>
		<C>Col=t_name       Ctrl=tx_t_name        Param=value Enable=enable</C>
		<C>Col=a_name       Ctrl=tx_a_name        Param=value Enable=enable</C>
		<C>Col=m_name       Ctrl=tx_m_name        Param=value Enable=enable</C>
		<C>Col=e_name       Ctrl=tx_e_name        Param=value Enable=enable</C>
		<C>Col=c_name       Ctrl=tx_c_name        Param=value Enable=enable</C>
		<C>Col=j_name       Ctrl=tx_j_name        Param=value Enable=enable</C>
		<C>Col=mat_name     Ctrl=tx_mat_name      Param=value Enable=enable</C>
		<C>Col=name2        Ctrl=tx_name2         Param=value Enable=enable</C>
	" >
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</div>
</BODY></HTML>
