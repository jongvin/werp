<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : s_pay_1h.html								-->
<!-- 2. 유형(시나리오): 조회및 입력															-->
<!-- 3. 기 능 정 의   : 기성차수등록및 기성고 조회 작성                        	-->
<!-- 4. 변 경 이 력   :  박두현 작성																		-->
<!-- 5. 관련프로그램  :																						-->
<!-- 6. 특 기 사 항   :																							-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
// <LINK rel="stylesheet" type="text/css" href="../../../comm_function/env.css">
var gs_home = top.frames['security'].gs_home.value
var gs_user_id = top.frames['security'].user_id.value
var gs_empno = top.frames['security'].empno.value
var is_ds_1_addr = 's_prgs_yymm_1q.jsp?arg_dept_code='                        //기성년월 목록 
var is_ds_2_addr = 's_pay_1q.jsp?arg_dept_code='                       //기성 
var is_ds_3_addr = gs_home + '/const/s_web/03/s_sbc_list_cash.jsp?arg_dir='                     
var is_tr_1_addr = gs_home + '/const/s_web/04/s_prgs_yymm_1tr.jsp'
var is_tr_2_addr = gs_home + '/const/s_web/04/s_pay_1tr.jsp'
var is_ds_seq_addr = gs_home + '/const/y_web/00/y_spec_unq_no_1q.jsp'                 // seq_no구하기 
var is_sbcr_code = ""
var is_dept_code = ""
var is_dept_name = ""
var il_screen = 1
var is_close_check
var is_returnvalue=""
var is_tr_2_success='N'
var is_comp_vat_tot_old = 0
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>

//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
   if  (is_dept_code == "") {
     alert("현장을 선택하십시요(검색을 누르십시요)")
      return
  }     

	if (il_screen > 1){
	div_btnquery_onclick()
	return
	}   
	ds_1.DataID = is_ds_1_addr + is_dept_code
	ds_1.SyncLoad=true
	ds_1.Reset()
	if (ds_1.CountRow < 1)       
	    ds_2.ClearData()
//	div_btnquery_onclick()
	    

}

//-----------------------------------------------------------------------
function  init_move()
//-----------------------------------------------------------------------
{

           // 월에 + 1 하는 로직 
 if (ds_1.CountRow > 1)
    ls_yymm = ds_1.NameValue(2,"comp_yymm")
 else { 
	 ls_temp = top.frames['security'].gs_sysdate.value
	 ls_yymm = ls_temp.substr(0,4) + ls_temp.substr(5,2)
 }  
 ls_yyyy = ls_yymm.substr(0,4)
 ls_mm   = ls_yymm.substr(4,2) 
 if (ls_mm == "12") {
     ls_mm = "01"
     ls_yyyy = parseInt(ls_yyyy) + 1
 }    
 else {
     ls_mm = parseInt(ls_mm, 10) + 1
     if (parseInt(ls_mm, 10) < 10)
        ls_mm = '0' + ls_mm     
 }
 ls_yymm = ls_yyyy + ls_mm
 if (ds_1.CountRow ==  1) { // 초기에 데이타가 한건도 없을경우에는 system date를 setting한다.
	 ls_temp = top.frames['security'].gs_sysdate.value
	 ls_yymm = ls_temp.substr(0,4) + ls_temp.substr(5,2)
 }	 
    //----------------------------------------------------------------------
 ds_1.NameValue(ds_1.RowPosition,"comp_yymm") = ls_yymm
 ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
 ds_1.NameValue(ds_1.RowPosition,"seq") = 1
ll_cnt = f_select_q("select to_char(last_day(to_date('" + ls_temp + "')),'YYYY.MM.DD') select_1 from dual")
ds_1.NameValue(ds_1.RowPosition,'slip_dt') = ds_select.NameValue(ds_select.RowPosition,'select_1')

 
 is_close_check = f_close_chk(is_dept_code,ls_yymm,'S')   // 각단위업무마감여부 체크(현장코드,년월,업무구분)
// if (is_close_check)
//	 ds_2.ReadOnly = true
// else
//    ds_2.ReadOnly = false
}
//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
   if  (is_dept_code == "") {
     alert("현장을 선택하십시요(검색을 누르십시요)")
      return
  }     
if (il_screen > 1){
	div_btnadd_onclick()
	return
}   

   btninsert_onclick()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
   if  (is_dept_code == "") {
     alert("현장을 선택하십시요(검색을 누르십시요)")
      return
  }     
if (il_screen > 1){
	div_btninsert_onclick()
	return
}   
 if  (ds_1.CountRow != 0) {
     if (ds_1.RowStatus(1) == 1 ) {    //최종차수가 입력 모드일경우는 추가 할수 없음. 
        alert("최종 차수가 저장이 안되었으므로 작업을 할수 없습니다")
        return
     }   
     ds_1.RowPosition=1
     ds_1.InsertRow(ds_1.RowPosition) 
 }
 else     
    ds_1.AddRow()

 init_move()

}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	if  (is_dept_code == "") {
		alert("현장을 선택하십시요(검색을 누르십시요)")
		return
	}     
	if (il_screen > 1){
		div_btndelete_onclick()
		return
	}   
	if  (ds_2.CountRow > 0 ) {
		alert("하위가 존재하므로 삭제할수 없습니다")
		return
	}      
	ds_1.DeleteRow(ds_1.RowPosition)
	btnsave_onclick()      // 기성화면은 자동으로 저장하기위해 (op통일:기성화면에서만 자동 저장)
}
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	tr_1.Action = is_tr_1_addr

	if (ds_1.IsUpdated){
		if  (confirm("변경되었습니다 저장하시겠습니까?")) {
			tr_1.Post()
		} else {
			btnquery_onclick()
		}
	}
	div_btnsave_onclick()    //무조건 DS_2도 저장함...END USER를 위해..
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
    div_btncancel_onclick()
}
//----------------------------------------------------------------------
function div_init_move()                         //하위 공통 initial move
//----------------------------------------------------------------------
{
  ds_2.NameValue(ds_2.RowPosition,"dept_code") = is_dept_code
  ds_2.NameValue(ds_2.RowPosition,"yymm") = ds_1.NameValue(ds_1.RowPosition,"yymm")
  ds_2.NameValue(ds_2.RowPosition,"seq") = ds_1.NameValue(ds_1.RowPosition,"seq")
  ds_2.NameValue(ds_2.RowPosition,"web_yn") = '1'
  
//  sp_call()       // 계약내역 복사..
//  div_btnquery_onclick()   // 복사를 하였으므로 하위를 재 조회한다.
}

//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
 if (ds_1.CountRow < 1) return
 is_close_check = f_close_chk(is_dept_code,ds_1.NameValue(ds_1.RowPosition,"comp_yymm"),'S')   // 각단위업무마감여부 체크(현장코드,년월,업무구분)

 
 if (ds_1.RowPosition==1) {
	 if (is_close_check) {
//		 ds_2.ReadOnly = true
		 tx_chg_resign.disabled = 1
		 tx_checker.disabled = 1
		 tx_pay_cond.disabled = 1
		 tx_tm_deduction_detail.disabled = 1
	 }
	 else {
//		ds_2.ReadOnly = false
		tx_chg_resign.disabled = 0
		tx_checker.disabled = 0
		tx_pay_cond.disabled = 0
		tx_tm_deduction_detail.disabled = 0
		ccom_ta_tag.Enable = 0
	 }
 }
 else {
// 	ds_2.ReadOnly = true
 	tx_chg_resign.disabled = 1
 	tx_checker.disabled = 1
	tx_pay_cond.disabled = 1
	tx_tm_deduction_detail.disabled = 1
 ccom_ta_tag.Enable = 0
 }	    
ds_2.DataID = is_ds_2_addr +  is_dept_code + "&arg_yymmdd=" + ds_1.NameValue(ds_1.RowPosition,"yymm") + 
                                              "&arg_seq=" + ds_1.NameValue(ds_1.RowPosition,"seq")
                                              
ds_2.SyncLoad=true
ds_2.Reset()
if (ds_1.RowPosition==1 && ds_2.CountRow > 0 && is_close_check == false){
	if (ds_2.NameValue(1,'invoice_num') != '' ) {
//		ds_2.ReadOnly = true
		tx_chg_resign.disabled = 1
		tx_checker.disabled = 1
		tx_pay_cond.disabled = 1
		tx_tm_deduction_detail.disabled = 1
	}
	else {
//		ds_2.ReadOnly = false
		tx_chg_resign.disabled = 0
		tx_checker.disabled = 0
		tx_pay_cond.disabled = 0
		tx_tm_deduction_detail.disabled = 0
		ccom_ta_tag.Enable = 0
	}
	ds_2.Reset()
}
 
 
}

//-----------------------------------------------------------------------
function div_btnadd_onclick()                    //하위 추가
//-----------------------------------------------------------------------
{
 if  (is_dept_code == "") {
     alert("현장을 선택하십시요(검색을 누르십시요)")
      return
 }     

if (ds_1.RowPosition !=1 ) {
   alert("최종 기성년월일경우에만 추가 할수 있습니다") 
   return
}
if (ds_2.CountRow > 0){
	if (ds_2.NameValue(1,"invoice_num") != '' ) {
		alert('이미 전표가 생성된자료입니다...')
		return
	}
}
   
if (ds_1.RowStatus(1) == 1 )  // ds_1의 첫번째가 입력이었으면 자동으로 저장함. 
   tr_1.Post()

 var param;
 parm = is_dept_code + "@" + ds_1.NameValue(1,"comp_yymm") + ds_1.NameValue(1,"seq")

 is_returnvalue = window.showModalDialog("s_pay_order_search_1h.html" ,parm,"dialogWidth:"+600+"px; dialogHeight:"+600+"px");

 if (is_returnvalue == "") 
 {
   return
 }	
 else
 {
   order_copy_add()
 }
}
//----------------------------------------------------------------
function order_copy_add()                  // .....
//-----------------------------------------------------------------
{
   ls_tempvalue = new Array();
	ls_tempvalue=is_returnvalue.split("@");
  
   tot_cnt = ls_tempvalue.length - 2  // 넘오어는 배열중 마지막에 @이 붙어 있으므로 하나 뻄 
                                      // 그리고배열은 0부터 시작하니깐 하나더 뻄
      for (j=0; j <= tot_cnt ; j=j+1){    //  1개씩 짝이므로 (1 row당 1column)
         sp_call(ls_tempvalue[j])
   }

 il_screen = 1   //parent를 다시 읽음 
 btnquery_onclick()
 il_screen = 2   

}
//-----------------------------------------------------------------
function sp_call(ll_order_number)               //sp call(기성내역을 을 최종차수로 복사) 
//------------------------------------------------------------------
{
	var ll_yymm,ll_seq
        ll_yymm = ds_1.NameValue(ds_1.RowPosition,"yymm")
        ll_seq = ds_1.NameValue(ds_1.RowPosition,"seq")
        ds_update.DataID = 'y_sp_s_yymm_create.jsp?arg_dept_code=' + is_dept_code + 
                           '&arg_yymm=' + ll_yymm  +
                           '&arg_seq=' + ll_seq  +
                           '&arg_order_number=' + ll_order_number 
        ds_update.SyncLoad = true
        ds_update.reset()
}
//-----------------------------------------------------------------
function close_rtn()               //정산처리
//------------------------------------------------------------------
{
	var ll_yymm,ll_seq,ll_order_number,ll_row,ls_rt,ls_tot_amt,ls_cash,ls_temp
	var ll_cnt,ls_chk,ls_reson

	if (ds_2.CountRow < 1) return

	if (ds_1.RowPosition !=1 ) {
	   alert("최종 기성년월일경우에만 정산 할수 있습니다")
	   return
	}
	if (ds_2.NameValue(1,"invoice_num") != '') {
		alert('이미 전표가 생성된자료입니다...')
		return
	}
	if (ds_2.NameValue(ds_2.RowPosition,'close_tag') == 'Y'){
		alert('이미 정산된 자료입니다...')
		return
	}
	if (ds_2.NameValue(ds_2.RowPosition,'web_yn') != '1'){
		alert('전자기성제출자료는 정산처리를 할수없습니다\n \n전표생성시 자동으로 정산됩니다')
		return
	}

	ll_yymm = ds_1.NameValue(ds_1.RowPosition,"yymm")
	ll_seq = ds_1.NameValue(ds_1.RowPosition,"seq")
	ll_order_number = ds_2.NameValue(ds_2.RowPosition,'order_number')

	ll_cnt = f_select_q("select nvl(count(*),0) select_1 " +
	                     " from s_chg_cn_list " +
	                     " where dept_code = '" + is_dept_code + "'" +
	                     "   and order_number = " + ll_order_number + "" +
						 "   and nvl(APPROVE_CLASS,'1') <> '6' ")
    if (ds_select.ErrorCode != 0 || ll_cnt == 0) {alert("에러발생" + ds_select.ErrorMsg);return;}
	if (ds_select.NameValue(ds_select.RowPosition,'select_1') > 0) {
		alert("변경계약중인 자료가 존재합니다.");
		return;
	}

	ll_cnt = f_select_q("SELECT" +
						" 	nvl(B.DEPT_CODE,'') select_1" +
						" FROM" +
						" 	S_CN_DETAIL A," +
						" 	(SELECT * FROM S_PRGS_DETAIL WHERE DEPT_CODE = '" + is_dept_code + "' AND ORDER_NUMBER = " + ll_order_number + 
										" AND YYMM = '" + ll_yymm + "' AND SEQ = " + ll_seq + ") B" +
						" WHERE" +
						" 	A.DEPT_CODE = B.DEPT_CODE(+) AND A.ORDER_NUMBER = B.ORDER_NUMBER(+) AND A.SPEC_NO_SEQ = B.SPEC_NO_SEQ(+) AND A.DETAIL_UNQ_NUM = B.DETAIL_UNQ_NUM(+)" +
						" AND A.DEPT_CODE = '" + is_dept_code + "' AND A.ORDER_NUMBER = " + ll_order_number + "" +
						" AND B.DEPT_CODE Is Null")
	if (ds_select.ErrorCode != 0) {alert("에러발생" + ds_select.ErrorMsg);return;}
	if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "") {
		alert("계약내역과 기성내역이 틀린 자료가 존재합니다.");
		return;
	}

	ll_cnt = f_select_q("select nvl(warrant_guarantee_rt,0) select_1 " +
	                     " from s_cn_list " +
	                     " where dept_code = '" + is_dept_code + "'" +
	                     "   and order_number = " + ll_order_number )
    if (ds_select.ErrorCode != 0) {alert("에러발생");return;}
	ls_chk = parseInt(ds_select.NameValue(ds_select.RowPosition,'select_1'),10)
	if (ls_chk != 0 ) {
		ll_cnt = f_select_q("select send_yn select_1,nosend_reson select_2 " +
		                     " from s_guarantee_accept " +
		                     " where dept_code = '" + is_dept_code + "'" +
		                     "   and order_number = " + ll_order_number +
		                     "   and guarantee_class = '3' ")
		if (ds_select.ErrorCode != 0) {alert("에러발생");return;}
		if (ll_cnt < 1 ) {
			alert('하자증권이 제출되지않아 정산처리를 하실 수 없습니다...')
			return
		}
		else {
			ls_chk   = ds_select.NameValue(ds_select.RowPosition,'select_1')
			ls_reson = ds_select.NameValue(ds_select.RowPosition,'select_2')
			if (ls_chk == 'N' && (ls_reson == '0' || ls_reson == '')){
				alert('하자증권이 제출되지않아 정산처리를 하실 수 없습니다...')
				return
			}
		}
	}
		
	if  (confirm("해당 계약에 대하여 정산하시겠습니까?")){
	}
	else {
		return
	}

	ds_update.DataID = 'y_sp_s_prgs_close.jsp?arg_dept_code=' + is_dept_code + '&arg_yymm=' + ll_yymm +
	                  '&arg_seq=' + ll_seq + '&arg_order_number=' + ll_order_number 
	ds_update.SyncLoad = true
	ds_update.reset()
	if (ds_update.ErrorCode != 0) {alert("에러발생");return;}

	ll_row = ds_2.RowPosition
	//ccom_ta_tag.CodeValue = 'Y' //전표생성시 준공금청구로 변경
	ds_2.NameValue(ll_row,'comp_pre_tm_tot') = ds_2.NameValue(ll_row,'comp_sbc_tot')
	is_comp_vat_tot_old = ds_2.NameValue(ll_row,'comp_vat_tot')
	ds_2.NameValue(ll_row,'comp_vat_tot') = ds_2.NameValue(ll_row,'vat')
	
	ds_2.NameValue(ll_row,'supply_notax_tot') = ds_2.NameValue(ll_row,'supply_amt_notax')
	ds_2.NameValue(ll_row,'tm_prgs_notax') = ds_2.NameValue(ll_row,'supply_amt_notax') - ds_2.NameValue(ll_row,'pre_prgs_notax');

	ds_2.NameValue(ll_row,'purchase_tot') = ds_2.NameValue(ll_row,'purchase_vat')
	ds_2.NameValue(ll_row,'tm_purchase_vat') = ds_2.NameValue(ll_row,'purchase_vat') - ds_2.NameValue(ll_row,'pre_purchase_vat');
	vat_process()
	ds_2.NameValue(ll_row,'comp_advance_amt') = ds_2.NameValue(ll_row,'comp_amt')
	prepay_process()
	if (ds_2.NameValue(ll_row,'comp_amt') == 0) {
		ds_2.NameValue(ll_row,'comp_pay_amt') = ds_2.NameValue(ll_row,'comp_sbc_tot');//공급가
		ds_2.NameValue(ll_row,'tm_pay') = ds_2.NameValue(ll_row,'comp_pay_amt') - ds_2.NameValue(ll_row,'pre_pay');
		ds_2.NameValue(ll_row,'tot_vat4') = ds_2.NameValue(ll_row,'vat'); //차인지불(부가세)
		ds_2.NameValue(ll_row,'tot_vat3') = ds_2.NameValue(ll_row,'tot_vat4') - ds_2.NameValue(ll_row,'tot_vat2');

		ls_rt = ds_2.NameValue(ll_row,'prgs_cash_rt') * 0.01;
		
		ls_tot_amt = ds_2.NameValue(ll_row,'comp_pay_amt') + ds_2.NameValue(ll_row,'tot_vat4')

		ls_cash = Math.round(ls_tot_amt * ls_rt);
		ls_temp = ls_cash - ds_2.NameValue(ll_row,'pre_cash');
	   if (ls_temp < 0) {
			ds_2.NameValue(ll_row,'comp_cash_tot') = ds_2.NameValue(ll_row,'pre_cash'); //현금
			ds_2.NameValue(ll_row,'comp_bill_tot') = ls_tot_amt - ds_2.NameValue(ll_row,'pre_cash');
		}
		else {
			ds_2.NameValue(ll_row,'comp_cash_tot') = ls_cash; //현금
			ds_2.NameValue(ll_row,'comp_bill_tot') = ls_tot_amt - ls_cash;
		}
		
		ds_2.NameValue(ll_row,'tm_cash') = ds_2.NameValue(ll_row,'comp_cash_tot') - ds_2.NameValue(ll_row,'pre_cash');
		ds_2.NameValue(ll_row,'tm_bill') = ds_2.NameValue(ll_row,'comp_bill_tot') - ds_2.NameValue(ll_row,'pre_bill');
	}
	tr_2.Post()
}

//-----------------------------------------------------------------------
function div_btninsert_onclick()                    //하위 삽입.
//-----------------------------------------------------------------------
{
   div_btnadd_onclick() 
}

//------------------------------------------------------------------------
function div_btndelete_onclick()                //하위 삭제
//------------------------------------------------------------------------
{
	if  (is_dept_code == "") return
	if  (ds_2.RowPosition < 1) return
	if (ds_2.NameValue(ds_2.RowPosition,'web_yn') > '1') {
		alert('이미 업체에 기성요청한 자료는 삭제할 수 없습니다...')
		if (top.frames['security'].user_id.value != "kilee") {
			return
		} else {
			if (!confirm("정말작업하시겠니까")) return;
		}
	}
	if  (ds_1.RowPosition !=1) { 
		alert("최종 차수가 아니므로 삭제할수 없습니다")
		return
	}

	if (ds_2.NameValue(1,"invoice_num") != '') {
		alert('이미 전표가 생성된자료입니다...')
		return
	}


	// 하위 로직 수정.
	ll_yymm  = ds_2.NameValue(ds_2.RowPosition,"yymm") 
	ll_seq = ds_2.NameValue(ds_2.RowPosition,"seq")
	ll_order_number = ds_2.NameValue(ds_2.RowPosition,"order_number")

	ds_2.DeleteRow(ds_2.RowPosition)
	if (confirm("삭제되었습니다 저장하시겠습니까?")){
		arg_cmd = "delete from s_prgs_detail_web   " +   
		                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
		                 "         yymm = to_char('" + ll_yymm + "') and "   + 
				           "         seq = " + ll_seq + "  and    "   + 
				           "         order_number = " + ll_order_number + "   "   
		arg_cmd = arg_cmd + "@ delete from s_prgs_parent_web   " +   
		                 "  where (dept_code = '" + is_dept_code + "' and "   + 
		                 "         yymm = to_char('" + ll_yymm + "')  and "   + 
				           "         seq = " + ll_seq + " and    "   + 
				           "         order_number = " + ll_order_number + ")   "   
		arg_cmd = arg_cmd +  "@ delete from s_prgs_detail   " +   
		                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
		                 "         yymm = to_char('" + ll_yymm + "') and "   + 
				           "         seq = " + ll_seq + "  and    "   + 
				           "         order_number = " + ll_order_number + "   "   
		arg_cmd = arg_cmd +  "@ delete from s_prgs_parent   " +   
		                 "  where (dept_code = '" + is_dept_code + "' and "   + 
		                 "         yymm = to_char('" + ll_yymm + "')  and "   + 
				           "         seq = " + ll_seq + " and    "   + 
				           "         order_number = " + ll_order_number + ") "
		arg_cmd = arg_cmd +  "@ delete from S_PAY_DEGREE   " +   
		                 "  where (dept_code = '" + is_dept_code + "' and "   + 
		                 "         yymm = to_char('" + ll_yymm + "')  and "   + 
				           "         seq = " + ll_seq + " and    "   + 
				           "         order_number = " + ll_order_number + ") "
		is_tr_2_success = 'Y'
		f_update_sql_multy(arg_cmd)
		if (is_tr_2_success != 'Y') {
			il_screen = 2   //parent를 다시 읽음 
			div_btnquery_onclick()
			alert('다시 작업하십시요')
			return
		}
		tr_2.Post()
    }
	il_screen = 2   //parent를 다시 읽음 
	div_btnquery_onclick()
}
//---------------------------------------------------------------------------
function div_btnsave_onclick()                  //하위 저장 
//---------------------------------------------------------------------------
{
 tr_2.Action = is_tr_2_addr
 
 if (ds_2.IsUpdated){
    if  (confirm("변경되었습니다 저장하시겠습니까?"))
        tr_2.Post()
   }
 
}
//----------------------------------------------------------------------------
function div_btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
  ds_2.Undo(ds_2.RowPosition)
}


//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated) {
     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
        {  //저장 routine
        }   
 
   }     
top.frames['main_ct'].location.href(ls_arg)
top.frames['main_title'].div_r.style.visibility="hidden"             
top.frames['main_title'].div_u.style.visibility="hidden"             

// top.frames['main_ct'].window.close()     
}
//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	result = f_dept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	dept_name.value = is_dept_name

  il_screen = 1   //parent를 다시 읽음 
	btnquery_onclick()
}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}

//---------------------------------------------------------------------------
function request_cancel()                        //기성요청취소
//---------------------------------------------------------------------------
{
	if (ds_2.RowPosition < 1) return

	if (ds_2.NameValue(ds_2.RowPosition,'web_yn') != '2') {
		alert("기성요청상태에서만 취소할수있습니다...")
		return
	}
	if (ds_2.NameValue(ds_2.RowPosition,'invoice_num') != ''){
		alert('이미 전표가 생성되었습니다...')
		return
	}
	
	ds_2.NameValue(ds_2.RowPosition,"web_yn") = '1'
	
	div_btnsave_onclick()
}

//---------------------------------------------------------------------------
function prgs_request()                        //기성요청
//---------------------------------------------------------------------------
{
	if (ds_2.RowPosition < 1) return

	if (ds_1.RowPosition !=1 ) {
	   alert("최종 기성년월일경우에만 요청 할수 있습니다")
	   return
	}

	ll_cnt = f_ds_select_q("ds_cert","select corp_id select_1 from s_cert_master where corp_id = '" + ds_2.NameValue(ds_2.RowPosition,'sbcr_code') + "' ")
	
	if (ll_cnt == 0) {
	   alert('인증서가 제출되어있지않음으로 기성요청을 할수없습니다')
	   return
	}
	
   if  (confirm("기성요청은 협력업체에 자료를 요청합니다.(요청후 기성수정불가). \n 기성요청를 하시겠습니까?")){
   }
   else {
   	return
   }
	if (ds_2.NameValue(ds_2.RowPosition,"web_yn") != '1' && ds_2.NameValue(ds_2.RowPosition,'web_yn') != '4') {
		alert("미처리 중에서만 요청처리를 하실 수 있습니다...")
		return
	}
	if (ds_2.NameValue(ds_2.RowPosition,'invoice_num') != ''){
		alert('이미 전표가 생성되었습니다...')
		return
	}
	
	ds_2.NameValue(ds_2.RowPosition,"web_yn") = '2'
	
	var ls_sql
	ls_sql = "select a.inout_tel select_1 " + 
            "  from s_wbs_request a, " + 
            "       s_estimate_list b " + 
            "  where a.sbcr_code = b.sbcr_code " + 
            "    and a.profession_wbs_code = b.profession_wbs_code " + 
            "    and b.dept_code = '" + is_dept_code + "' " + 
            "    and b.order_number = " + ds_2.NameValue(ds_2.RowPosition,'order_number') + " "
	ll_cnt = f_ds_select_q("ds_phone",ls_sql)
	var ls_phone,ls_yymm
   if (ll_cnt == 1) { 
	   ls_phone = ds_phone.NameValue(1,'select_1')
	   if (ls_phone != '') {
	      ls_yymm = ds_1.NameValue(ds_1.RowPosition,'comp_yymm')
	      ls_yymm = ls_yymm.substr(0,4) + '.' + ls_yymm.substr(4,2)
//       	gf_mail_to("월드건설",'','',ls_phone,"월드건설 (" + ls_yymm + ") 월분 기성제출바랍니다")
	   }
   }
	div_btnsave_onclick()
}
//---------------------------------------------------------------------------
function prgs_ok()                        //기성확정
//---------------------------------------------------------------------------
{
	var li_unq_num,ll_cnt,ls_order_number,ls_sbcr_code,ls_tm_pay,ls_tm_vat,ls_yymm,ls_cust_code,ls_rep_name,ls_pay_dt   
	var ls_addr1,ls_type,ls_kind,ls_sbc_name,ls_gong,ls_chk,ls_sbcr_name,ls_tm_cash,ls_tm_bill,arg_cmd,ls_tot,ls_seq
	var ls_unque_file_name,ls_reportname,ls_parm
	var ls_dir,ls_home,ls_hash,ls_tm_prgs,ls_tm_prgs_notax,ls_tax_gb,ls_comp_code
	var ls_business,ls_comp_name,ls_comp_code,ls_owner,ls_uptae,ls_upjong,ls_addr
	var ls_hash_url = ''

	if (ds_2.RowPosition < 1) return
	if (ds_1.RowPosition !=1 ) {
	   alert("최종 기성년월일경우에만 정산 할수 있습니다")
	   return
	}

	if (gs_user_id == 'jb0903' || gs_user_id == 'hyj623' || gs_user_id == '1' || gs_user_id == '1' || gs_user_id == 'kilee') {
		if (ds_2.NameValue(ds_2.RowPosition,"web_yn") != '4' && ds_2.NameValue(ds_2.RowPosition,"web_yn") != '5') {
			alert("기성접수 상태에서만 확정처리를 하실 수 있습니다...")
			return
		}
		if (ds_2.NameValue(ds_2.RowPosition,"web_yn") == '5') {
			if (!confirm("이미 확정한 자료입니다 다시한번 확정하시겠습니까?")) {
				return
			}
		}
	} else {
		if (ds_2.NameValue(ds_2.RowPosition,"web_yn") != '4' ) {
			alert("기성접수 상태에서만 확정처리를 하실 수 있습니다...")
			return
		}
	}

	ll_Sql = "SELECT f_s_pay_chk('" + is_dept_code + "'," +
								     "" + ds_2.NameValue(ds_2.RowPosition,'order_number') + "," +
							         "'" + ds_2.Namevalue(ds_2.RowPosition,'yymm') + "'," +
							         "" + ds_2.Namevalue(ds_2.RowPosition,'seq') + ") select_1 from dual"
	ll_cnt = f_select_q(ll_Sql)
	if (ds_select.ErrorCode != 0 || ll_cnt == 0) {alert("에러발생");alert(ds_select.ErrorMsg);return;}
	if (ds_select.NameValue(ds_select.RowPosition,'select_1') > 0) {
		alert(ds_select.NameValue(ds_select.RowPosition,'select_1'))
		if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "1")
			alert(" 해당년월 이후 자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "2")
			alert(" 기성내역합계와 기성총액이 차이가 존재 합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "3")
			alert(" 기성작성후 변경계약확정한 자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "4")
			alert(" 전회기성내역이 틀린자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "5")
			alert(" 전회기성내역이 틀린자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "6")
			alert(" 전회기성내역이 틀린자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "7")
			alert(" 전회기성내역이 틀린자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "8")
			alert(" 상위내역과 하위내역 합계가 틀린자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "9")
			alert(" 상위내역과 하위내역 합계가 틀린자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "10")
			alert(" 계약금액을 보다 기성금액이 많은 자료가 존재합니다.");
		else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "11")
			alert(" 정산기성의경우 변경계약중인 자료가 존재할수 없습니다. 계약내용을 확인하세요");
		else
			alert(" 번째 기성내역 금액 합과 지급기성 합계가 틀립니다. 확인해주세요");
		return;
	}

	if (ds_2.NameValue(ds_2.RowPosition,'pay_dt') == '') {
		alert('반드시 세금계산서 발행일을 입력하시기 바랍니다...')
		return
	}

	ds_seq.SyncLoad=true;             // seq no 구하기
	ds_seq.reset()
	li_unq_num = ds_seq.NameValue(1,"nextval")
	is_tr_2_success = 'Y'
	if (ds_2.IsUpdated) {
		tr_2.Post()
		if (is_tr_2_success != 'Y') {
			alert('다시 작업하십시요')
			return
		}   
	}

	ds_2.NameValue(ds_2.RowPosition,'slipseq') = li_unq_num
	ds_2.NameValue(ds_2.RowPosition,'web_yn') = '5'

	ll_cnt = ds_2.RowPosition
	ls_order_number  = ds_2.NameValue(ll_cnt,'order_number')
	ls_sbcr_code     = ds_2.NameValue(ll_cnt,'sbcr_code')
	ls_sbcr_name     = ds_2.NameValue(ll_cnt,'sbcr_name')
	ls_tm_pay        = ds_2.NameValue(ll_cnt,'tm_pay')
	ls_tm_vat        = ds_2.NameValue(ll_cnt,'tm_vat')
	ls_yymm          = ds_2.Namevalue(ll_cnt,'yymm')
	ls_seq           = ds_2.Namevalue(ll_cnt,'seq')
	ls_cust_code     = ds_2.NameValue(ll_cnt,"cust_code")
	ls_rep_name      = ds_2.NameValue(ll_cnt,"rep_name1")
	ls_addr1          = ds_2.NameValue(ll_cnt,"address1")
	ls_type          = ds_2.NameValue(ll_cnt,"kind_bussinesstype")
	ls_kind          = ds_2.NameValue(ll_cnt,"kinditem")
	ls_sbc_name      = ds_2.NameValue(ll_cnt,'sbc_name')
	ls_tm_cash       = ds_2.NameValue(ll_cnt,'tm_cash')
	ls_tm_bill       = ds_2.NameValue(ll_cnt,'tm_bill')
	ls_pay_dt        = ds_2.NameValue(ll_cnt,'pay_dt')
	ls_tm_prgs       = ds_2.NameValue(ll_cnt,'tm_prgs')
	ls_tm_prgs_notax = ds_2.NameValue(ll_cnt,'tm_prgs_notax')
	ls_chk = ls_tm_pay + '';
	ls_gong = 11 - ls_chk.length;
	ls_tot = ls_tm_pay + ls_tm_vat

	if (ls_tm_prgs != 0 && ls_tm_prgs_notax == 0) {
		ls_tax_gb = '1'
	}
	else {
		if (ls_tm_prgs == 0 && ls_tm_prgs_notax != 0) {
			ls_tax_gb = '2'
		}
		else {
			ls_tax_gb = '3'
		}
	}
	
	ls_comp_code = is_dept_code.substr(0,2)
 	ll_cnt = f_ds_select_q("ds_comp","select comp_name select_1,business_number select_2,comp_owner select_3," +
 	           "       uptae select_4,upjong select_5,comp_addr select_6 " +
 	           " from z_code_comp where comp_code = '" + ls_comp_code + "'" )
	ls_comp_name = ds_comp.NameValue(ds_comp.RowPosition,'select_1')
	ls_business  = ds_comp.NameValue(ds_comp.RowPosition,'select_2')
	ls_owner     = ds_comp.NameValue(ds_comp.RowPosition,'select_3')
	ls_uptae     = ds_comp.NameValue(ds_comp.RowPosition,'select_4')
	ls_upjong    = ds_comp.NameValue(ds_comp.RowPosition,'select_5')
	ls_addr      = ds_comp.NameValue(ds_comp.RowPosition,'select_6')

 	arg_cmd= " INSERT INTO S_ACCOUNT_PROCESS  " +
				"         ( INV_ID,DEPT_CODE,CST_DOC_NO,PUB_DATE,CORP_REG_NO,sup_tamt,sup_ttax, " +
				"           PROC_GB,iss_date,iss_by,tax_gb)   " +
				"  VALUES ( " + li_unq_num + ",'" + is_dept_code+ "'," + ls_order_number + ",'" + ls_pay_dt + "'" +
				",'" + ls_sbcr_code + "'," + ls_tm_pay + "," + ls_tm_vat + ", " +
				"  			  '1','" + ls_yymm + "'," + ls_seq + ",'" + ls_tax_gb + "' )  "
   f_update_sql(arg_cmd)
   if (ds_update.ErrorCode != 0) {alert("에러발행");return;}
 	arg_cmd= " INSERT INTO S_ELEC_ACCOUNT  " +
				"  VALUES ( " + li_unq_num + ",'','" + ls_cust_code + "','" + ls_sbcr_name + "'" +
				",'" + ls_rep_name + "','" + ls_type + "','" + ls_kind + "','" + ls_addr1 + "', " +
				"           '" + ls_business + "','" + ls_comp_name + "','" + ls_owner + "','" + ls_uptae + "','" + ls_upjong + "','" + ls_addr + "'," +
				"           '','','','','','','" + ls_pay_dt + "'," + ls_gong + "," + ls_tm_pay + "," + ls_tm_vat + 
				",'" + ls_pay_dt + "','" + ls_sbc_name + "'," +
				"           ''," + ls_tm_pay + " ,1," + ls_tm_pay + "," + ls_tm_vat + ",''," +
				"           null,'','',0,0,0,0,'',null,'','',0,0,0,0,'',null,'','',0,0,0,0,''," + ls_tot +
				" ," + ls_tm_cash + ",0," +  ls_tm_bill + ",0,'2'," +
            "           '','','','' ) "
   f_update_sql(arg_cmd)
	if (ds_update.ErrorCode != 0) {alert("에러발행");return;}

// 세금계산서를 PDF화일로 저장한다...   
	ls_unque_file_name = "s_account_dem_"  + li_unq_num + ".pdf"
	ls_reportname = "C:\\WISENET\\Report\\b2b_rpt\\s_account_dem" + ls_tax_gb + ".rpt"
	
	ls_parm = "sm_code=s_web" + 
	      "&dept_Code=" + is_dept_code + 
	       "&order_number=" + ls_order_number + 
		  "&rptname=" + ls_reportname +
		  "&expname=" + ls_unque_file_name + 
		  "&inv_id=" + li_unq_num

	window.showModalDialog("http://rpt.worldro.net:100/EXPORTHTML_ACNT.asp?" + ls_parm,null,"dialogWidth:300px;dialogHeight:100px");

	ls_unque_file_name = "s_account_sup_" + li_unq_num + ".pdf"
	ls_reportname = "C:\\WISENET\\Report\\b2b_rpt\\s_account_sup" + ls_tax_gb + ".rpt"

	ls_parm = "sm_code=s_web" + 
	      "&dept_Code=" + is_dept_code + 
	       "&order_number=" + ls_order_number + 
		  "&rptname=" + ls_reportname +
		  "&expname=" + ls_unque_file_name + 
		  "&inv_id=" + li_unq_num

	window.showModalDialog("http://rpt.worldro.net:100/EXPORTHTML_ACNT.asp?" + ls_parm,null,"dialogWidth:300px;dialogHeight:100px");

	ls_home = "@appdata@oraeproq@iAS@9.0.4@j2ee@eproq@applications@eproq@eproq@wisenet@contract@s_web@"

	ls_dir =  ls_home + is_dept_code + '-' + ls_order_number + "@" + "prgs@" + "s_account_sup_" + li_unq_num + ".pdf"

	ds_3.DataID = is_ds_3_addr + ls_dir
	ds_3.SyncLoad=true
	ds_3.Reset()

	ls_hash = ds_3.NameValue(1,'hash_return')
	if (ls_hash.length >= 100 || ls_hash == '') {
		alert('헤쉬 값이 100바이트보다 크기때문에 처리할수없습니다')
		return
    }
	ls_hash_url = ls_hash
	ls_hash_url = ls_hash_url.replace(/\%/g,"%25")
	ls_hash_url = ls_hash_url.replace(/\&/g,"%26")
	ls_hash_url = ls_hash_url.replace(/\=/g,"%3D")
	ls_hash_url = ls_hash_url.replace(/\'/g,"%27%27")
	ls_hash_url = ls_hash_url.replace(/\//g,"%2F")
	ls_hash_url = ls_hash_url.replace(/\+/g,"%2B")
  	arg_cmd= " UPDATE S_ELEC_ACCOUNT  " +
				"  SET CERT_HASH = '" + ls_hash_url + "'" +
				" WHERE INV_ID = " + li_unq_num

	ls_row = ds_2.RowPosition

	is_tr_2_success = 'Y'
	f_update_sql(arg_cmd)
	if (is_tr_2_success != 'Y') {
		alert('다시 작업하십시요')
		div_btnquery_onclick()
		ds_2.RowPosition = ls_row
		return
	}

//   is_tr_2_success = 'Y'
//   if (ds_2.IsUpdated) {
//	  tr_2.Post()
//	  if (is_tr_2_success != 'Y') {
//	     alert('다시 작업하십시요')
//	     return
//	  }   
//	}

	arg_cmd = " UPDATE S_PAY SET web_yn = '5', slipseq = " + li_unq_num +
                 "  where  dept_code = '" + is_dept_code + "'  and "   +
                 "         yymm  = '" + ds_2.Namevalue(ds_2.RowPosition,'yymm')  + "' and  "   +
                 "         seq  = " + ds_2.Namevalue(ds_2.RowPosition,'seq') + " and  "   +
                 "         order_number = " + ds_2.NameValue(ds_2.RowPosition,'order_number') + "  "
	is_tr_2_success = 'Y'
	f_update_sql(arg_cmd)
	if (is_tr_2_success != 'Y') {
		alert('다시 작업하십시요')
		div_btnquery_onclick()
		ds_2.RowPosition = ls_row
		return
	}
	div_btnquery_onclick()
	ds_2.RowPosition = ls_row
	alert('정상처리되었습니다...')
}

//---------------------------------------------------------------------------
function prgs_accept()                        //기성접수
//---------------------------------------------------------------------------
{
	var arg_cmd,ls_yymm,ll_seq,ll_order_number,ls_row

	if (ds_2.RowPosition < 1) return

	if (ds_1.RowPosition !=1 ) {
	   alert("최종 기성년월일경우에만 접수 할수 있습니다")
	   return
	}

	ls_row = ds_2.RowPosition
	if (ds_2.NameValue(ds_2.RowPosition,"web_yn") != '3') {
		alert("제출 자료만 접수 처리를 하실 수 있습니다...")
		if (top.frames['security'].user_id.value != "kilee") {
			return		
		} else {
			if (!confirm("정말하겠습니까?")) return;
		}
	}
	ls_yymm         = ds_2.NameValue(ds_2.RowPosition,"yymm")
	ll_seq          = ds_2.NameValue(ds_2.RowPosition,"seq")
	ll_order_number = ds_2.NameValue(ds_2.RowPosition,"order_number")

	if (ds_2.IsUpdated){
		tr_2.Post()
	}

	ds_2.NameValue(ds_2.RowPosition,"web_yn") = '4'

    arg_cmd = "delete from s_prgs_detail   " +   
                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
                 "         yymm  = '" + ls_yymm  + "' and  "   + 
                 "         seq  = " + ll_seq + " and  "   + 
                 "         order_number = " + ll_order_number + "  "
    arg_cmd = arg_cmd + "@ delete from s_prgs_parent   " +   
                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
                 "         yymm  = '" + ls_yymm  + "' and  "   + 
                 "         seq  = " + ll_seq + " and  "   + 
                 "         order_number = " + ll_order_number + "  "
    arg_cmd = arg_cmd + "@ insert into s_prgs_parent " +  
            " SELECT * " + 
            " FROM s_prgs_parent_web    " +  
                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
                 "         yymm  = '" + ls_yymm  + "' and  "   + 
                 "         seq  = " + ll_seq + " and  "   + 
                 "         order_number = " + ll_order_number + "  "
    arg_cmd = arg_cmd + "@ insert into s_prgs_detail  " +  
            " SELECT * " + 
            " FROM s_prgs_detail_web   " +  
                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
                 "         yymm  = '" + ls_yymm  + "' and  "   + 
                 "         seq  = " + ll_seq + " and  "   + 
                 "         order_number = " + ll_order_number + "  "
	is_tr_2_success = 'Y'
	f_update_sql_multy(arg_cmd)
	if (is_tr_2_success != 'Y') {
		alert('다시 작업하십시요')
		div_btnquery_onclick()
		ds_2.RowPosition = ls_row
		return
	}
	ds_spcall.DataID = 'y_sp_s_prgs_tot_cmpt.jsp?arg_dept_code=' + is_dept_code + '&arg_yymm=' + ls_yymm +
	                  '&arg_seq=' + ll_seq  + '&arg_order_number=' + ll_order_number 
	ds_spcall.SyncLoad = true
	ds_spcall.reset()
	if (is_tr_2_success != 'Y') {
		alert('다시 작업하십시요')
		div_btnquery_onclick()
		ds_2.RowPosition = ls_row
		return
	}
	arg_cmd = " UPDATE S_PAY SET WEB_YN = '4', slipseq = 0 " +
                 "  where  dept_code = '" + is_dept_code + "'  and "   +
                 "         yymm  = '" + ls_yymm  + "' and  "   +
                 "         seq  = " + ll_seq + " and  "   +
                 "         order_number = " + ll_order_number + "  "
	is_tr_2_success = 'Y'
	f_update_sql(arg_cmd)
	if (is_tr_2_success != 'Y') {
		alert('다시 작업하십시요')
		div_btnquery_onclick()
		ds_2.RowPosition = ls_row
		return
	}
	div_btnquery_onclick()
	ds_2.RowPosition = ls_row
	alert("정상처리되었습니다...")
}
//---------------------------------------------------------------------------
function prgs_detail()                        //기성내역  들어가기 
//---------------------------------------------------------------------------
{
	var ls_chk,ls_tag,ll_row
	
	ll_row = ds_2.RowPosition
	
	if (ll_row < 1) return
	
	ls_data = ds_2.NameValue(ll_row,"dept_code") + "@" + is_dept_name + "@" + 
	         ds_2.NameValue(ll_row,"yymm") + "@" + 
	         ds_2.NameValue(ll_row,"seq") + "@" + 
	         ds_2.NameValue(ll_row,"order_number") + "@" + ds_2.NameValue(ll_row,"sbc_name") 
	ls_chk = ds_2.NameValue(ll_row,"web_yn")

	if (ds_1.RowPosition > 1) {
   	ls_tag = "T"
	}
	else {
		if (is_close_check) { 		
	   	ls_tag = "T"
	   }
	   else {
			if (ls_chk == '2' || ls_chk == '3' || ls_chk == '4' || ls_chk == '5') {
		   	ls_tag = "T"
		   }
		   else {
		   	if (ds_2.NameValue(ll_row,'invoice_num') != '') {
			   	ls_tag = "T"
		   	}
		   	else {
			   	ls_tag = "F"
		   	}
		   }
	   }
	}
	if (is_sec == 'r')
	   ls_tag = 'T'
	ls_data = ls_data + "@" + ls_tag

	makeCookie("@s_prgs_detail@",ls_data)
	is_temp = is_sec
   if (is_sec != 'r') {
     is_temp = 's'
   }
	if  (ls_tag == 'T' ){
	   top.frames['main_ct'].location.href(gs_home + "/const/s_web/04/s_prgs_detail_1h.html" +"?"+is_temp)
	}
	else {
   	top.frames['main_ct'].location.href(gs_home + "/const/s_web/04/s_prgs_detail_1h.html" +"?"+is_temp)
	}    
}

//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_screen = focus
	if (is_sec == 'r') return   // 조회권한일경우 
	if (il_screen == 1) {
		top.frames['main_title'].div_r.style.visibility="hidden"
		top.frames['main_title'].div_u.style.visibility="visible"
	}
	else {
		if (ds_1.RowPosition != 1) {
			 top.frames['main_title'].div_r.style.visibility="visible"
		    top.frames['main_title'].div_u.style.visibility="hidden"
		}
		else {
			if (is_close_check) {
				 top.frames['main_title'].div_r.style.visibility="visible"
			    top.frames['main_title'].div_u.style.visibility="hidden"
			 }
			 else {
			 	 top.frames['main_title'].div_u.style.visibility="visible"             
			    top.frames['main_title'].div_r.style.visibility="hidden"
			 }
	  }
	}
}
//---------------------------------------------------------------------------
function slip_call()                        //전표조회
//---------------------------------------------------------------------------
{
	if (ds_2.RowPosition < 1) return
	var ll_invoice_num,li_sql,ll_cnt
	if (ds_2.NameValue(1,'invoice_num') == '') {
		alert('전표가 생성되지 않았습니다...')
		return
	}
	ll_invoice_num = parseInt(ds_2.NameValue(1,"invoice_num"),10)
	li_sql = " SELECT to_char(make_dt,'YYYYMMDD') select_1,make_seq select_2,slip_kind_tag select_3,make_comp_code select_4 " +
	         " FROM t_acc_slip_head where slip_id = " + ll_invoice_num
	ll_cnt = f_select_q(li_sql)
	if (ll_cnt < 1) {
		alert('전표가 생성되지 않았습니다...')
		return
	}

	var lrArgs = new Array();
	var lsURL = gs_home + "/general/t_web/01/t_WSlipR.jsp"
	lrArgs.opener = window;
	lrArgs.SLIP_ID = ll_invoice_num;
	lrArgs.SLIP_IDSEQ = 0;
	lrArgs.MAKE_DT        = ds_select.NameValue(1,'select_1');
	lrArgs.MAKE_SEQ       = parseInt(ds_select.NameValue(1,'select_2'),10);
	lrArgs.SLIP_KIND_TAG  = ds_select.NameValue(1,'select_3');
	lrArgs.MAKE_COMP_CODE = ds_select.NameValue(1,'select_4');
	lrArgs.READONLY_TF = 'T';
	
	window.showModalDialog(lsURL,lrArgs,"center:yes;dialogWidth:1024px;dialogheight:800px;status:no;help:no;scroll:no");
}
//---------------------------------------------------------------------------
function slip_delete()                        //전표삭제
//---------------------------------------------------------------------------
{
	if (ds_2.RowPosition < 1) return
	var ll_invoice_num,li_sql,ll_cnt,ls_tag
	
	if (ds_2.NameValue(1,'invoice_num') == '') {
		alert('전표가 생성되지 않았습니다...')
		return
	}
	if (ds_2.NameValue(1,'slip_st') == 'C') {
		alert('확정된 전표는 삭제하실 수 없습니다...')
		return
	}
	if  (confirm("전표를 삭제하시겠습니까?")){
	}
	else {
		return
	}
	ll_invoice_num = parseInt(ds_2.NameValue(1,"invoice_num"),10)

	ds_spcall.DataID = gs_home + '/const/y_slip_delete_procedure.jsp?arg_seq=' + ll_invoice_num
	ds_spcall.SyncLoad = true
	ds_spcall.reset()
	for (i=1; i <= ds_2.CountRow ; i++){
		ds_2.NameValue(i,'invoice_num') = ''
	}
	tr_2.Post()

	div_btnquery_onclick()
}
//---------------------------------------------------------------------
function slip_rtn()
//---------------------------------------------------------------------
{
	var result,li_unq_num,send_arg;
	var array = new Array();
	var i,ll_order_number,ll_cnt,ls_chk,ls_reson,ls_guarantee_yn,ll_amt,ll_rt,ll_temp_amt,ll_Sql
   	var ll_chk = 'Y'
	if (ds_2.RowPosition < 1) return

	if (ds_2.IsUpdated){
        tr_2.Post()
	}

	if (ds_1.NameValue(ds_1.RowPosition,'slip_dt') == '') {
		alert('전표일이 존재하지 않아 전표생성을 할 수 없습니다...')
		return
	}
	for (i=1; i <= ds_2.CountRow ; i++){
//		ll_Sql = "SELECT f_s_pay_chk('" + ds_2.NameValue(i,'dept_code') + "'," +
//								     "" + ds_2.NameValue(i,'order_number') + "," +
//							         "'" + ds_2.NameValue(i,'yymm') + "'," +
//							         "" + ds_2.NameValue(i,'seq') + ") select_1 from dual"
//		ll_cnt = f_select_q(ll_Sql)
//		if (ds_select.ErrorCode != 0 || ll_cnt == 0) {alert("에러발생");alert(ds_select.ErrorMsg);return;}
//		if (ds_select.NameValue(ds_select.RowPosition,'select_1') > 0) {
//			alert(ds_select.NameValue(ds_select.RowPosition,'select_1'))
//			if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "1")
//				alert(i + " 해당년월 이후 자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "2")
//				alert(i + " 기성내역합계와 기성총액이 차이가 존재 합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "3")
//				alert(i + " 기성작성후 변경계약확정한 자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "4")
//				alert(i + " 전회기성내역이 틀린자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "5")
//				alert(i + " 전회기성내역이 틀린자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "6")
//				alert(i + " 전회기성내역이 틀린자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "7")
//				alert(i + " 전회기성내역이 틀린자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "8")
//				alert(i + " 상위내역과 하위내역 합계가 틀린자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "9")
//				alert(i + " 상위내역과 하위내역 합계가 틀린자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "10")
//				alert(i + " 계약금액을 보다 기성금액이 많은 자료가 존재합니다.");
//			else if (ds_select.NameValue(ds_select.RowPosition,'select_1') == "11")
//				alert(i + " 정산기성의경우 변경계약중인 자료가 존재할수 없습니다. 계약내용을 확인하세요");
//			else
//				alert(i + " 번째 기성내역 금액 합과 지급기성 합계가 틀립니다. 확인해주세요");
//			//return;
//			ll_chk = 'N'
//		}

		if (ds_2.NameValue(i,'pay_dt') == '') {
			alert('세금계산서 발행일이 존재하지 않아 전표생성을 할 수 없습니다...')
			return
		}
		if (ds_2.NameValue(i,'check_dt') == '') {
			alert('지급희망일을 입력하지 않아 전표생성을 할 수 없습니다...')
			return
		}
		if ( (ds_2.NameValue(i,'comp_sbc_tot') + ds_2.NameValue(i,'vat')) < (ds_2.NameValue(i,'comp_pre_tm_tot') + ds_2.NameValue(i,'comp_vat_tot')) ) {
		   alert('기성누계금액이 계약금액을 초과할수없습니다 \n (' + ds_2.NameValue(i,'sbc_name') + ' ) ')
		   return
		}
		if (ds_2.NameValue(i,'tm_pre_tax') != 0 || ds_2.NameValue(i,'tm_pre_notax') != 0){
			ll_order_number = ds_2.NameValue(i,'order_number')
			ll_cnt = f_select_q("select max(invoice_num) select_1 " +
			                     " from s_guarantee_accept " +
			                     " where dept_code = '" + is_dept_code + "'" +
			                     "   and order_number = " + ll_order_number +
			                     "   and guarantee_class = '2'")
			if (ll_cnt < 1 || ds_select.NameValue(1,'select_1') == '') {
				alert(ds_2.NameValue(i,'sbc_name') + ' 선급금지급전표가 생성되지않아 전표생성을 하실 수 없습니다...')
				return
			}
		}
		
		if (ds_2.NameValue(i,'comp_sbc_tot') == ds_2.NameValue(i,'comp_pre_tm_tot')){
			ll_order_number = ds_2.NameValue(i,'order_number')
			ll_cnt = f_select_q("select nvl(warrant_guarantee_rt,0) select_1 " +
			                     " from s_cn_list " +
			                     " where dept_code = '" + is_dept_code + "'" +
			                     "   and order_number = " + ll_order_number )
		    if (ds_select.ErrorCode != 0) {alert("에러발생");return;}
			ls_chk = parseInt(ds_select.NameValue(ds_select.RowPosition,'select_1'),10)
			if (ls_chk != 0 ) {
				ll_cnt = f_select_q("select send_yn select_1,nosend_reson select_2 " +
				                     " from s_guarantee_accept " +
				                     " where dept_code = '" + is_dept_code + "'" +
				                     "   and order_number = " + ll_order_number +
				                     "   and guarantee_class = '3' ")
				if (ds_select.ErrorCode != 0) {alert("에러발생");return;}
				if (ll_cnt < 1 ) {
//					alert(ds_2.NameValue(i,'sbc_name') + ' 하자증권이 제출되지않아 전표생성을 하실 수 없습니다...')
//					return
				}
				else {
					ls_chk   = ds_select.NameValue(ds_select.RowPosition,'select_1')
					ls_reson = ds_select.NameValue(ds_select.RowPosition,'select_2')
					if (ls_chk == 'N' && (ls_reson == '0' || ls_reson == '')){
//						alert(ds_2.NameValue(i,'sbc_name') + ' 하자증권이 제출되지않아 전표생성을 하실 수 없습니다...')
//						return
					}
				}
			}
		}
	}
	if (ll_chk == 'N') {alert("전산실에 문의 바랍니다.");return;}


	if (ds_2.NameValue(1,"invoice_num") != '' ) {
		alert('이미 전표가 생성된 자료입니다...')
		return
	}
	if  (confirm("전표생성을 하시면 수정하실수 없습니다 계속하시겠습니까?")) {
	}
	else {
		return
	}
	var ls_yymm,li_seq


	ls_yymm = ds_1.NameValue(ds_1.RowPosition,'yymm')
	ls_date = top.frames['security'].gs_sysdate.value
	li_seq  = ds_1.NameValue(ds_1.RowPosition,'seq')

	ds_spcall.DataID = 's_sp_slip_prgs_procedure.jsp?arg_dept_code=' + is_dept_code + 
																'&arg_date=' + ls_yymm + 
																'&arg_seq=' + li_seq +
																'&arg_user=' + gs_empno
	ds_spcall.SyncLoad = true
	ds_spcall.reset()

	div_btnquery_onclick()
	if (ds_2.NameValue(1,'invoice_num') != '') {
		alert("정상처리되었습니다...")
		slip_call()
//		ds_2.ReadOnly = true
		tx_chg_resign.disabled = 1
		tx_checker.disabled = 1
		tx_pay_cond.disabled = 1
		tx_tm_deduction_detail.disabled = 1
	}
	else{
		alert("전표가 생성되지않았습니다...")
	}
}
//------------------------------------------------------------------------
function btnquery_prt_onclick()                     // 미리보기
//------------------------------------------------------------------------
{
   var arg_temp,ls_temp
   if (ds_2.CountRow < 1) return

	ls_temp = ds_2.NameValue(ds_2.RowPosition,"invoice_num");
	
	if (ls_temp == ''){
		alert('전표가 생성되지않아 출력하실 수 없습니다...')
		return
	}

	arg_temp = "const_rpt/d_web/01r/"       
	arg_temp = arg_temp + "d_slip_report"  
	
	arg_temp = arg_temp + "&RptParams=" + ds_2.NameValue(ds_2.RowPosition,"invoice_num")
	f_crystal_report(arg_temp)   
}

//---------------------------------------------------------------------------
function bt_pay_rpt1()                        // 기성고조서(을)_현장용
//---------------------------------------------------------------------------
{
   var arg_temp
   arg_temp ="const_rpt/s_web/04r/"        // 보고서 디렉토리
   ls_yymm  = ds_2.NameValue(ds_2.RowPosition,"yymm") 
   ls_seq 	= ds_2.NameValue(ds_2.RowPosition,"seq")
   ls_order_number = ds_2.NameValue(ds_2.RowPosition,"order_number")

       arg_temp = arg_temp + "s_pay_proj1"    // 보고서명 
	    arg_temp = arg_temp + "&RptParams=" + is_dept_code + 
		                         "&RptParams=" + ls_yymm + 
		                         "&RptParams=" + ls_seq + 
		                         "&RptParams=" + ls_order_number
	
   f_crystal_report(arg_temp)   //보고서 호출
}
//---------------------------------------------------------------------------
function bt_pay_rpt2()                        // 기성고조서(병)_현장용
//---------------------------------------------------------------------------
{
   var arg_temp
   arg_temp ="const_rpt/s_web/04r/"        // 보고서 디렉토리
   ls_yymm  = ds_2.NameValue(ds_2.RowPosition,"yymm") 
   ls_seq 	= ds_2.NameValue(ds_2.RowPosition,"seq")
   ls_order_number = ds_2.NameValue(ds_2.RowPosition,"order_number")

       arg_temp = arg_temp + "s_pay_proj2"    // 보고서명 
	    arg_temp = arg_temp + "&RptParams=" + is_dept_code + 
		                         "&RptParams=" + ls_yymm + 
		                         "&RptParams=" + ls_seq + 
		                         "&RptParams=" + ls_order_number
   f_crystal_report(arg_temp)   //보고서 호출
}
//---------------------------------------------------------------------------
function bt_paybon_rpt1()                        // 기성고조서(갑)_본사용
//---------------------------------------------------------------------------
{
   var arg_temp
   arg_temp ="const_rpt/s_web/04r/"        // 보고서 디렉토리
   ls_yymm  = ds_2.NameValue(ds_2.RowPosition,"yymm") 
   ls_seq 	= ds_2.NameValue(ds_2.RowPosition,"seq")

       arg_temp = arg_temp + "s_pay_bon1"    // 보고서명 
	    arg_temp = arg_temp + "&RptParams=" + is_dept_code + 
		                         "&RptParams=" + ls_yymm + 
		                         "&RptParams=" + ls_seq 
   f_crystal_report(arg_temp)   //보고서 호출

}
//---------------------------------------------------------------------------
function bt_paybon_rpt2()                        // 기성고조서(을)_본사용
//---------------------------------------------------------------------------
{
   var arg_temp
   arg_temp ="const_rpt/s_web/04r/"        // 보고서 디렉토리
   ls_yymm  = ds_2.NameValue(ds_2.RowPosition,"yymm") 
   ls_seq 	= ds_2.NameValue(ds_2.RowPosition,"seq")

       arg_temp = arg_temp + "s_pay_bon2"    // 보고서명 
	    arg_temp = arg_temp + "&RptParams=" + is_dept_code + 
		                         "&RptParams=" + ls_yymm + 
		                         "&RptParams=" + ls_seq 
   f_crystal_report(arg_temp)   //보고서 호출

}
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_1','gd_2');
	var xArr   = new Array(false,false);
	var yArr   = new Array(true,true);

	f_reSize(objArr, xArr, yArr);
}  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
     top.frames['main_title'].title_name.value = " " + "기성 내역 등록"  

	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
   	ds_seq.DataID = is_ds_seq_addr                       // SEQ NO 의 DATAID

	dept_name.value = is_dept_name
	tr_1.Action = is_tr_1_addr
	tr_2.Action = is_tr_2_addr
	
	is_sec = gf_initial_security()
	is_temp = is_sec
   if (is_sec != 'r') {
     is_temp = 'u'
   }	
	if (is_sec == 'r') {
	   button_1.style.visibility='hidden'
	   button_3.style.visibility='hidden'
	   button_4.style.visibility='hidden'
	   button_5.style.visibility='hidden'
	   button_6.style.visibility='hidden'
	   button_7.style.visibility='hidden'
//	   button_cancel.style.visibility='hidden'
	}
//   if (gs_user_id == 'jb0903' || gs_user_id == 'hyj623' || gs_user_id == '1' || gs_user_id == '1' || gs_user_id == 'kilee') 
//       button_cancel.style.visibility='visible'
   
	btnquery_onclick()

   // -------------------------기성내역으로 들어갔다가 다시 돌아왔을경우 해당 발주번호로 가기위해서 다음로직수행
   var result="";
	var array = new Array();
	result = readCookie("@s_prgs_detail@")
	if (result == "err") {
		get_focus(1)
      return
   }   
	else {
		get_focus(2)
	   array = result.split("@");
	   ls_date = array[2]
	   ll_seq  = parseInt(array[3])
      ll_order_number = parseInt(array[4])  //발주 번호
      ds_2.RowPosition = ds_2.ValueRow(4,ll_order_number)   // 4는 "order_number" column 임
      makeCookie("@s_prgs_detail@","")
    }
}
//---------------------------------------------------------------------
function vat_process()
//---------------------------------------------------------------------
{
	var ls_tot_amt,ls_vat,ls_comp_amt,ls_rt,ls_chk_amt,ll_row,ls_cash,ls_temp
	
		ll_row = ds_2.RowPosition
	//if (ds_2.NameValue(ll_row,'comp_vat_tot') == ds_2.OrgNameValue(ll_row,'comp_vat_tot')) {
	//	return
	//}	

	if (ds_2.NameValue(ll_row,'comp_vat_tot') == is_comp_vat_tot_old) {
		return
	}

		ls_vat     = ds_2.Namevalue(ll_row,'comp_vat_tot')
		ls_tot_amt = ds_2.NameValue(ll_row,'comp_pre_tm_tot')
		ls_chk_amt = ds_2.NameValue(ll_row,'notax_sup_pur_tot')
		ls_comp_amt = ls_vat * 10;
		if (ls_chk_amt == 0) {             //면세금액(계약)이 0이면 총금액을 과세로 한다.
			ds_2.NameValue(ll_row,'tax_tot') = ls_tot_amt         //순공사비(과세)
		}
		else {
			if (ls_vat == ds_2.Namevalue(ll_row,"vat")) {
				//최종 부가세가 계약금액 부가세와 일치할경우 최종기성으로 보고 계약금액을 기성금액과 일치 시킨다.
				ds_2.NameValue(ll_row,'tax_tot') = ds_2.NameValue(ll_row,'supply_amt_tax')
			} else {
				ds_2.NameValue(ll_row,'tax_tot') = ls_comp_amt         //순공사비(과세)
			}
		}

		ds_2.NameValue(ll_row,'tm_prgs') = ds_2.NameValue(ll_row,'tax_tot') - ds_2.NameValue(ll_row,'pre_prgs');
		
		ds_2.NameValue(ll_row,'supply_notax_tot') = ls_tot_amt - ds_2.NameValue(ll_row,'tax_tot') - ds_2.NameValue(ll_row,'purchase_tot'); //순공사비(면세)
		ds_2.NameValue(ll_row,'tm_prgs_notax') = ds_2.NameValue(ll_row,'supply_notax_tot') - ds_2.NameValue(ll_row,'pre_prgs_notax');
		
		ds_2.NameValue(ll_row,'notax_tot') = ds_2.NameValue(ll_row,'supply_notax_tot') + ds_2.NameValue(ll_row,'purchase_tot'); //면세계
		ds_2.NameValue(ll_row,'notax_tm_sup_pur_tot') = ds_2.NameValue(ll_row,'notax_tot') - ds_2.NameValue(ll_row,'notax_pre_sup_pur_tot');
		
		ds_2.NameValue(ll_row,'comp_pre_tm_tot') = ds_2.NameValue(ll_row,'tax_tot') + ds_2.NameValue(ll_row,'notax_tot'); //소계
		ds_2.NameValue(ll_row,'comp_tm_tot') = ds_2.NameValue(ll_row,'comp_pre_tm_tot') - ds_2.NameValue(ll_row,'comp_pre_tot');
		
		ds_2.NameValue(ll_row,'tm_vat') = ls_vat - ds_2.NameValue(ll_row,'pre_vat'); // 부가세
		
//		ls_rt = ls_comp_amt / ls_tot_amt; //과세율
//		
//		ls_tot_amt = ds_2.NameValue(row,'comp_advance_amt')
//		ds_2.NameValue(row,'tot_pre_tax') = parseInt(ls_tot_amt * ls_rt,10) //선급금(과세)
//		ds_2.NameValue(row,'tm_pre_tax') = ds_2.NameValue(row,'tot_pre_tax') - ds_2.NameValue(row,'pre_pre_tax'); 
//		
//		ds_2.NameValue(row,'tot_pre_notax') = ls_tot_amt - ds_2.NameValue(row,'tot_pre_tax'); //선급금(면세)
//		ds_2.NameValue(row,'tm_pre_notax') = ds_2.NameValue(row,'tot_pre_notax') - ds_2.NameValue(row,'pre_pre_notax');
//		
//		ds_2.NameValue(row,'comp_advance_amt') = ds_2.NameValue(row,'tot_pre_tax') + ds_2.NameValue(row,'tot_pre_notax'); //선급금(소계)
//		ds_2.NameValue(row,'tm_advance_deduction') = ds_2.NameValue(row,'comp_advance_amt') - ds_2.NameValue(row,'pre_advance_deduction');
//		
//		ds_2.NameValue(row,'tot_pre_vat') = parseInt(ds_2.NameValue(row,'tot_pre_tax') * 0.1,10); //선급금(부가세)
//		ds_2.NameValue(row,'tm_pre_vat') = ds_2.NameValue(row,'tot_pre_vat') -ds_2.NameValue(row,'pre_pre_vat');
		
		ds_2.NameValue(ll_row,'tot_vat4') = ds_2.NameValue(ll_row,'comp_vat_tot') - ds_2.NameValue(ll_row,'tot_pre_vat'); //차인지불(부가세)
		ds_2.NameValue(ll_row,'tot_vat3') = ds_2.NameValue(ll_row,'tot_vat4') - ds_2.NameValue(ll_row,'tot_vat2');
		
		ls_rt = ds_2.NameValue(ll_row,'prgs_cash_rt') * 0.01;

		ls_tot_amt = ds_2.NameValue(ll_row,'comp_pay_amt') + ds_2.NameValue(ll_row,'tot_vat4')
		
		ls_cash = parseInt(ls_tot_amt * ls_rt,10);
		ls_temp = ls_cash - ds_2.NameValue(ll_row,'pre_cash');
	   if (ls_temp < 0) {
			ds_2.NameValue(ll_row,'comp_cash_tot') = ds_2.NameValue(ll_row,'pre_cash'); //현금
			ds_2.NameValue(ll_row,'comp_bill_tot') = ls_tot_amt - ds_2.NameValue(ll_row,'pre_cash');
		}
		else {
			ds_2.NameValue(ll_row,'comp_cash_tot') = ls_cash; //현금
			ds_2.NameValue(ll_row,'comp_bill_tot') = ls_tot_amt - ls_cash;
		}
				
		ds_2.NameValue(ll_row,'tm_cash') = ds_2.NameValue(ll_row,'comp_cash_tot') - ds_2.NameValue(ll_row,'pre_cash');
		ds_2.NameValue(ll_row,'tm_bill') = ds_2.NameValue(ll_row,'comp_bill_tot') - ds_2.NameValue(ll_row,'pre_bill');
		
}
//---------------------------------------------------------------------
function prepay_process()
//---------------------------------------------------------------------
{
	var ls_tot_amt,ls_vat,ls_comp_amt,ls_rt,ls_chk_amt,ll_row,ls_cash,ls_temp
	ll_row = ds_2.RowPosition

	ls_tot_amt = ds_2.NameValue(ll_row,'comp_advance_amt')
	if (ds_2.NameValue(ll_row,'comp_amt') == ls_tot_amt) {
		ds_2.NameValue(ll_row,'tot_pre_tax') = ds_2.NameValue(ll_row,'safety_amt1'); //선급금(과세)
		ds_2.NameValue(ll_row,'tm_pre_tax') = ds_2.NameValue(ll_row,'tot_pre_tax') - ds_2.NameValue(ll_row,'pre_pre_tax');

		ds_2.NameValue(ll_row,'tot_pre_notax') = ds_2.NameValue(ll_row,'safety_amt2'); //선급금(면세)
		ds_2.NameValue(ll_row,'tm_pre_notax') = ds_2.NameValue(ll_row,'tot_pre_notax') - ds_2.NameValue(ll_row,'pre_pre_notax');

		ds_2.NameValue(ll_row,'comp_advance_amt') = ds_2.NameValue(ll_row,'tot_pre_tax') + ds_2.NameValue(ll_row,'tot_pre_notax'); //선급금(소계)
		ds_2.NameValue(ll_row,'tm_advance_deduction') = ds_2.NameValue(ll_row,'comp_advance_amt') - ds_2.NameValue(ll_row,'pre_advance_deduction');

		ds_2.NameValue(ll_row,'tot_pre_vat') = ds_2.NameValue(ll_row,'previous_vat'); //선급금(부가세)
		ds_2.NameValue(ll_row,'tm_pre_vat') = ds_2.NameValue(ll_row,'tot_pre_vat') - ds_2.NameValue(ll_row,'pre_pre_vat');
	} else {
		ls_rt = ds_2.NameValue(ll_row,'safety_amt1') / ds_2.NameValue(ll_row,'comp_amt'); //과세율

		ds_2.NameValue(ll_row,'tot_pre_tax') = parseInt(ls_tot_amt * ls_rt,10); //선급금(과세)
		ds_2.NameValue(ll_row,'tm_pre_tax') = ds_2.NameValue(ll_row,'tot_pre_tax') - ds_2.NameValue(ll_row,'pre_pre_tax');

		ds_2.NameValue(ll_row,'tot_pre_notax') = ls_tot_amt  - parseInt(ls_tot_amt * ls_rt,10); //선급금(면세)
		ds_2.NameValue(ll_row,'tm_pre_notax') = ds_2.NameValue(ll_row,'tot_pre_notax') - ds_2.NameValue(ll_row,'pre_pre_notax');

		ds_2.NameValue(ll_row,'comp_advance_amt') = ds_2.NameValue(ll_row,'tot_pre_tax') + ds_2.NameValue(ll_row,'tot_pre_notax'); //선급금(소계)
		ds_2.NameValue(ll_row,'tm_advance_deduction') = ds_2.NameValue(ll_row,'comp_advance_amt') - ds_2.NameValue(ll_row,'pre_advance_deduction');

		ds_2.NameValue(ll_row,'tot_pre_vat') = parseInt(ds_2.NameValue(ll_row,'tot_pre_tax') * 0.1,10); //선급금(부가세)
		ds_2.NameValue(ll_row,'tm_pre_vat') = ds_2.NameValue(ll_row,'tot_pre_vat') - ds_2.NameValue(ll_row,'pre_pre_vat');
	}		

	ds_2.NameValue(ll_row,'comp_pay_amt') = ds_2.NameValue(ll_row,'comp_pre_tm_tot') - ds_2.NameValue(ll_row,'comp_advance_amt');//공급가
	ds_2.NameValue(ll_row,'tm_pay') = ds_2.NameValue(ll_row,'comp_pay_amt') - ds_2.NameValue(ll_row,'pre_pay');

	ds_2.NameValue(ll_row,'tot_vat4') = ds_2.NameValue(ll_row,'comp_vat_tot') - ds_2.NameValue(ll_row,'tot_pre_vat'); //차인지불(부가세)
	ds_2.NameValue(ll_row,'tot_vat3') = ds_2.NameValue(ll_row,'tot_vat4') - ds_2.NameValue(ll_row,'tot_vat2');

	ls_rt = ds_2.NameValue(ll_row,'prgs_cash_rt') * 0.01;
		
	ls_tot_amt = ds_2.NameValue(ll_row,'comp_pay_amt') + ds_2.NameValue(ll_row,'tot_vat4')
		
	ls_cash = parseInt(ls_tot_amt * ls_rt,10);
	ls_temp = ls_cash - ds_2.NameValue(ll_row,'pre_cash');
	if (ls_temp < 0) {
		ds_2.NameValue(ll_row,'comp_cash_tot') = ds_2.NameValue(ll_row,'pre_cash'); //현금
		ds_2.NameValue(ll_row,'comp_bill_tot') = ls_tot_amt - ds_2.NameValue(ll_row,'pre_cash');
	} else {
		ds_2.NameValue(ll_row,'comp_cash_tot') = ls_cash; //현금
		ds_2.NameValue(ll_row,'comp_bill_tot') = ls_tot_amt - ls_cash;
	}
			
	ds_2.NameValue(ll_row,'tm_cash') = ds_2.NameValue(ll_row,'comp_cash_tot') - ds_2.NameValue(ll_row,'pre_cash');
	ds_2.NameValue(ll_row,'tm_bill') = ds_2.NameValue(ll_row,'comp_bill_tot') - ds_2.NameValue(ll_row,'pre_bill');
}
//---------------------------------------------------------------------
function window_onunload()
//---------------------------------------------------------------------
{
}
//---------------------------------------------------------------------
function tab_changed()
//---------------------------------------------------------------------
{

}
</SCRIPT>

<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code(tr_1) : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("Error Code(ds_3) : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
  is_tr_2_success = 'N'
</SCRIPT>

<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
  is_tr_2_success = 'N'
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code(tr_2) : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
  is_tr_2_success = 'N'
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnColumnPosChanged(row,colid)>
	if (ds_1.SysStatus(row) == '1') {
		gd_1.ColumnProp('comp_yymm', 'Edit') = ""
		gd_1.ColumnProp('seq', 'Edit') = ""
//		gd_1.ColumnProp('slip_dt', 'Edit') = ""
	} else {
		gd_1.ColumnProp('comp_yymm', 'Edit') = "None"
		gd_1.ColumnProp('seq', 'Edit') = "None"
//		gd_1.ColumnProp('slip_dt', 'Edit') = "None"
	}
</script>
<script language=JavaScript for=gd_1 event=OnExit(row,colid,olddata)>
	if (ds_1.SysStatus(row) == '1') {
		gd_1.ColumnProp('comp_yymm', 'Edit') = ""
		gd_1.ColumnProp('seq', 'Edit') = ""
	} else {
		gd_1.ColumnProp('comp_yymm', 'Edit') = "None"
		gd_1.ColumnProp('seq', 'Edit') = "None"
	}
</script>

<SCRIPT language=JavaScript  event=OnColumnChanged(row,colid) for=ds_1>
if (row == 1) {
   if (colid == "comp_yymm") {
      ds_1.NameValue(row,"yymm") = ds_1.NameValue(row,"comp_yymm") + '01'
		ll_cnt = f_select_q("select to_char(last_day(to_date('" + ds_1.NameValue(row,"yymm") + "')),'YYYY.MM.DD') select_1 from dual")
		ds_1.NameValue(ds_1.RowPosition,'slip_dt') = ds_select.NameValue(ds_select.RowPosition,'select_1')
   }
}
else {
   ds_1.NameValue(row,colid) = ds_1.OrgNameValue(row,colid)
   alert("최종 차수 이전것은 수정할수 없습니다")
   return false
}       
</SCRIPT>
<SCRIPT language=JavaScript for=em_comp_vat_tot event=onKillFocus()>
	vat_process()
</SCRIPT>
<SCRIPT language=JavaScript for=em_comp_vat_tot event=onSetFocus()>
	is_comp_vat_tot_old = em_comp_vat_tot.text
</SCRIPT>

<script language=JavaScript for=em_comp_advance_amt event=onKillFocus()>
	prepay_process()
</SCRIPT>
<script language=JavaScript for=em_tm_cash event=onKillFocus()>
	var ls_tot_amt,ls_vat,ls_comp_amt,ls_rt,ls_chk_amt,ll_row
	ll_row = ds_2.RowPosition
	il_screen = 2
	ls_tot_amt = ds_2.NameValue(ll_row,"tm_pay") + ds_2.NameValue(ll_row,'tot_vat3')
	
	if (ds_2.NameValue(ll_row,"tm_cash") > ls_tot_amt) {
		ds_2.NameValue(ll_row,"tm_cash") = ds_2.OrgNameValue(ll_row,"tm_cash")
		em_tm_cash.Text = ds_2.OrgNameValue(ll_row,"tm_cash")
		alert("지불금액을 초과할수 없습니다")
	}
	ds_2.NameValue(ll_row,"tm_bill") =  ds_2.NameValue(ll_row,"tm_pay") + ds_2.NameValue(ll_row,'tot_vat3') - ds_2.NameValue(ll_row,"tm_cash")   
	ds_2.NameValue(ll_row,"comp_bill_tot") =  ds_2.NameValue(ll_row,"pre_bill") + ds_2.NameValue(ll_row,"tm_bill")   
	ds_2.NameValue(ll_row,"comp_cash_tot") =  ds_2.NameValue(ll_row,"pre_cash") + ds_2.NameValue(ll_row,"tm_cash")   
</SCRIPT>


<script language=JavaScript for=gd_2 event=OnKeyPress(kcode)>
</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>

{
  if  (row < 1) return;
 	if (row == 1) {
		gd_1.ColumnProp('slip_dt', 'Edit') = ""
	} else {
		gd_1.ColumnProp('slip_dt', 'Edit') = "None"
	}
 
  div_btnquery_onclick() 
}  
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_2>
	if (ds_2.NameValue(row,'close_tag') == 'Y') {
		em_comp_vat_tot.ReadOnly = true
		em_comp_advance_amt.ReadOnly = true
	}
	else {
		em_comp_vat_tot.ReadOnly = false
		em_comp_advance_amt.ReadOnly = false
	}
</SCRIPT>

<SCRIPT language=JavaScript event=OnSelChanged(nIndex) for=tb_1>
{
 }             
</SCRIPT>
<SCRIPT language=JavaScript event=CanSelChange(nIndex) for=tb_1>
{
}
 
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=CanRowPosChange(row)>
    div_btnsave_onclick()  
    return true
</SCRIPT>
<SCRIPT language=JavaScript for=gd_2 event=OnDblClick(row,colid)>
ds_2.RowPosition=row
prgs_detail()
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><Object id=ds_sysdate
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_phone
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 
<comment id="__NSID__"><OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_comp
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
  
 <comment id="__NSID__"><OBJECT id=ds_update
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><OBJECT id=ds_cert
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>

 <comment id="__NSID__"><OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
    
<comment id="__NSID__"><OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_close_check 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select
   style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 10px" 
   classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:s_prgs_yymm_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
	
<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:s_pay_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) onunload=window_onunload() oncontextmenu="return false" >
<div class=main_div>
<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0">
	<tr height="20px">
		<td class=td_green colspan="3">
			<table BORDER="0" CELLSPACING="0" cellpadding="0" class=main_table>
				<tr> 
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="43px" class=font_green_bold>현장명</td>
					<td width="166px">
						<INPUT style="FONT-SIZE:12px;" id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" style=" FONT-SIZE: 12px;" size=25 onkeyDown="keyDown()"></td>
					<td width="60px">
						<INPUT  type=button  class="img_btnFind"  value=검색 onclick=dept_code_find() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"></td>
					<td width="*" align="right">
						<INPUT  id="button_yul" type=button  class="img_btnRpt7_1"  value="하도급기성(을)" onclick=bt_pay_rpt1() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  id="button_byoung" type=button  class="img_btnRpt7_1"  value=하도급기성(병) onclick=bt_pay_rpt2() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
<!-- <input type="button" id="button_1" value=" 전표출력" 
          style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
           background-color:#E9F5F5; border:1 #A1A9A9 solid; LEFT: 490px; POSITION: absolute; WIDTH: 60px; TOP: 7px;  height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=btnquery_prt_onclick()>
<input type="button" id="button_cancel" value=" 요청취소" 
          style="color:#2E4A4A; font-size:13px; CURSOR: hand; visibility:hidden;
           background-color:#E9F5F5; border:1 #A1A9A9 solid; LEFT: 560px; POSITION: absolute; WIDTH: 60px; TOP: 7px;  height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=request_cancel()>
-->
						<INPUT  id="button_2"  type=button  class="img_btn4_1"  value=기성내역 onclick=prgs_detail() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  id=button_1  type=button  class="img_btn4_1"  value=전표조회 onclick=slip_call() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  id=button_3  type=button  class="img_btn4_1"  value=전표삭제 onclick=slip_delete() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  id=button_4  type=button  class="img_btn4_1"  value=전표생성 onclick=slip_rtn() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;
<!--<input type="button" id="button_4" value=" 기성요청" 
          style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
           background-color:#E9F5F5; border:1 #A1A9A9 solid; LEFT: 760px; POSITION: absolute; WIDTH: 60px; TOP: 7px;  height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=prgs_request()>
<input type="button" id="button_5" value=" 기성접수" 
          style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
           background-color:#E9F5F5; border:1 #A1A9A9 solid; LEFT: 820px; POSITION: absolute; WIDTH: 60px; TOP: 7px;  height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=prgs_accept()>
<INPUT  id="button_6" style="LEFT: 860px; POSITION: absolute;  TOP: 7px; "  type=button  class="img_btn4_1"  value=기성확정 onclick=prgs_ok() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
-->           
						<INPUT  id="button_7" type=button  class="img_btn4_1"  value=정산처리 onclick=close_rtn() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr height="*">
		<td width="16%">
			<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
			    style="FONT-SIZE: 12px; Z-INDEX: 105; WIDTH:100%;  HEIGHT: 100%" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AllShowEdit" VALUE="-1">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="Editable" VALUE="-1">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="DataID" VALUE="ds_1">
				<PARAM NAME="Format" VALUE=" 
					  <C> Name=년월 ID=comp_yymm  MASK='XXXX.XX'   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=50 </C> 
					  <C> Name=No ID=seq   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=20 </C> 
					  <C> Name=전표일자 ID=slip_dt   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=70 </C> 
			      ">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="30%">
			<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
			    style="FONT-SIZE: 12px; Z-INDEX: 105; WIDTH:100%; HEIGHT: 100%" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AllShowEdit" VALUE="0">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="DataID" VALUE="ds_2">
				<PARAM NAME="Format" VALUE=" 
				  <C> Name=계약명 ID=sbc_name  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=150 </C> 
				  <C> Name=업체명 ID=sbcr_name   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=125 </C> 
				  <C> Name=발주 ID=order_number  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=30 </C>
				  <C> Name=차수 ID=prgs_degree  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=30 </C> 
			      ">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="*">
   <table width="100%" height="100%"  BORDER="1" CELLSPACING="0" style="FONT-SIZE: 12px">
      <tr BGCOLOR="white"> 
            <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
                  <div align="right">기성구분</div></td>
            <td width="42%" > 
				   <comment id="__NSID__"><OBJECT id=ccom_ta_tag width=80px
				          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
					      <param name=Data     value="N^기성청구,Y^준공금청구">
				         <param name=DataID     value=ds_2>
				         <param name=CodeColumn value=close_tag>
				         <Param name=auto    value=false>
					      <PARAM NAME="Enable" VALUE=false></OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
          <td width="18%"   BGCOLOR="#53A9FF" style="COLOR: WHITE"  > 
              <div align="right">전표상태</div></td>
<!--          <td width="10%">
          		<INPUT style="FONT-SIZE:12px;" id=tx_slip_no  ReadOnly size=8 ></td> -->
          <td width="20%">
				   <comment id="__NSID__"><OBJECT id=ccom_slip_st width=80px
				          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
					      <param name=Data     value="A^미생성,C^확정,D^삭제,N^가승인">
				         <param name=DataID     value=ds_2>
				         <param name=CodeColumn value=slip_st>
				         <param name=Auto       value=false>
					      <PARAM NAME="Enable" VALUE="0"></OBJECT></comment> <script> __ws__(__NSID__);</script></TD> 
<!--           <td width="14%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
                  <div align="right">web제출</div></td>
            <td width="20%"> 
				   <comment id="__NSID__"><OBJECT id=ccom_web_yn width=80px
				          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
					      <param name=Data     value="1^미처리,2^요청,3^제출,4^접수,5^확정">
				         <param name=DataID     value=ds_2>
				         <param name=CodeColumn value=web_yn>
				         <param name=Auto       value=false>
					      <PARAM NAME="Enable" VALUE="0"></OBJECT></comment> <script> __ws__(__NSID__);</script></TD> -->
      </tr>                 
      <tr BGCOLOR="white" > 
          <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">업체명</div></td>
          <td width="42%" > 
               <INPUT style="FONT-SIZE:12px;" id=tx_sbcr_name   tabIndex=-1 size=30 READONLY disabled ></TD>
          <td width="18%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">계산서발행일</div></td>
          <td width="20%"> 
				   <comment id="__NSID__"><OBJECT id=em_pay_dt 
                      style="WIDTH: 80px"
				          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
				        <param name=Format value="YYYY-MM-DD">
                    <param name=SelectAll  value=true>
                    <param name=Numeric value=false>
				        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
      </tr>                 
      <tr BGCOLOR="white" > 
          <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">검사인</div></td>
          <td width="42%" >
          		<INPUT style="FONT-SIZE:12px;" id=tx_checker  size=10 ></TD>
          <td width="18%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">지급희망일</div></td>
          <td width="20%"> 
				   <comment id="__NSID__"><OBJECT id=em_check_dt 
                      style="WIDTH: 80px"
				          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
				        <param name=Format value="YYYY-MM-DD">
                    <param name=SelectAll  value=true>
                    <param name=Numeric value=false>
				        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
      </tr>                 
      <tr BGCOLOR="white" > 
          <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">지불조건</div></td>
          <td width="42%" colspan=3>
          		<INPUT style="FONT-SIZE:12px;" id=tx_pay_cond  size=54 ></TD>
      </tr>                 
      <tr BGCOLOR="white" > 
          <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
              <div align="right">기타공제내역</div></td>
          <td width="80%" colspan=3> 
          		<INPUT style="FONT-SIZE:12px;" id=tx_tm_deduction_detail  size=54 ></TD>
      </tr>
<!--      <tr BGCOLOR="white" > 
          <td width="14%"   BGCOLOR="#53A9FF" style="COLOR: WHITE"  > 
              <div align="right">결재상태</div></td>
          <td width="20%" >
				   <comment id="__NSID__"><OBJECT id=ccom_process width=80px
				          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
					      <param name=Data     value="0^미처리,1^결재중,3^반송,9^결재완료,C^취소전표">
				         <param name=DataID     value=ds_2>
				         <param name=CodeColumn value=t_slip_chk>
				         <param name=Auto       value=false>
					      <PARAM NAME="Enable" VALUE="0"></OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
      </tr>                  -->
      <tr BGCOLOR="white" > 
          <td colspan=4>
				   <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
				      <tr BGCOLOR="white" > 
			            <td width="18%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
			                  <div align="center">구분</div></td>
			            <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="center">계약</div></td>
			            <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="center">전회기성</div></td>
			            <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="center">금회기성</div></td>
			            <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="center">누계기성</div></td>
                  </tr>
				      <tr  BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
			                  <div align="right">순공사비(과세)</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_supply_amt_tax tabindex=-1 READONLY 
						                 style="WIDTH: 90px" 
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=Alignment  value=2>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_prgs tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_prgs  tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tax_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td width="3%"  BGCOLOR="#BBE0F4" style="COLOR: BLACK" rowspan=3 > 
			                  <div align="right">면세</div></td>
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
			                  <div align="right">순공사비</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_supply_amt_notax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_prgs_notax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_prgs_notax   tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_supply_notax_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="right">매입부가세</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_purchase_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_purchase_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_purchase_vat  tabindex=-1 READONLY  
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_purchase_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="right">[면세계]</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_notax_sup_pur_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_notax_pre_sup_pur_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_notax_tm_sup_pur_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_notax_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
			                  <div align="right">소 계</div></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_sbc_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_pre_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_tm_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_pre_tm_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2 > 
			                  <div align="right">부가세</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px" 
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_comp_vat_tot 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td width="3%"  BGCOLOR="#BBE0F4" style="COLOR: BLACK" rowspan=4 > 
			                  <div align="right">선급금공제</div></td>
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="right">과세</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_safety_amt1 tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_pre_tax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_pre_tax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tot_pre_tax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
			                  <div align="right">면세</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_safety_amt2 tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_pre_notax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_pre_notax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tot_pre_notax tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="right">소계</div></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_amt tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_pre_advance_deduction tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_tm_advance_deduction tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td>
								   <comment id="__NSID__"><OBJECT id=em_comp_advance_amt 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=SelectAll  value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="right">부가세</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_previous_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_pre_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_pre_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tot_pre_vat tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td width="3%"  BGCOLOR="#BBE0F4" style="COLOR: BLACK" rowspan=4 > 
			                  <div align="right">차인지불액</div></td>
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
			                  <div align="right">공급가</div></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_sbc_vat_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_pre_pay tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_tm_pay tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td BGCOLOR="#FDF9D9"> 
								   <comment id="__NSID__"><OBJECT id=em_comp_pay_amt tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=#FDF9D9>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1 > 
			                  <div align="right">부가세</div></td>
 			            <td > 
								   <comment id="__NSID__"><OBJECT id=em_tot_vat1 tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td > 
								   <comment id="__NSID__"><OBJECT id=em_tot_vat2 tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td > 
								   <comment id="__NSID__"><OBJECT id=em_tot_vat3 tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td > 
								   <comment id="__NSID__"><OBJECT id=em_tot_vat4 tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1 > 
			                  <div align="right">현금</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_comp_sbc_cash tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_cash tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_cash
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=SelectAll  value=true>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_comp_cash_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				      <tr BGCOLOR="white" > 
			            <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1 > 
			                  <div align="right">어음</div></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_comp_sbc_bill tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_pre_bill tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_tm_bill tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
 			            <td> 
								   <comment id="__NSID__"><OBJECT id=em_comp_bill_tot tabindex=-1 READONLY 
						                 style="WIDTH: 90px"
							              classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                                   <param name=Alignment  value=2>
                                   <param name=ReadOnly   value=true>
                                    <param name=ReadOnlyForeColor        value=black>
                                    <param name=ReadOnlyBackColor       value=silver>
						                 <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
                  </tr>
				   </table>
          </td>
       </tr>    
        <tr BGCOLOR="white" > 
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
                 <div align="right">비 고</div></td>
             <td width="80%" colspan=3> 
                 <TEXTAREA  style="FONT-SIZE:12px;" id=tx_chg_resign  rows=2 cols=55></TEXTAREA></td>
        		</tr>  		
  			</table>
  		</td>
	</tr>
</table>

<comment id="__NSID__"><OBJECT id=Bind_1 
    style="Z-INDEX: 107; LEFT: 241px; POSITION: absolute; TOP: 3px" 
    classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_2">
	<PARAM NAME="BindInfo" VALUE="
	   <C>Col=sbcr_name Ctrl=tx_sbcr_name Param=value Enable=enable</C>
	   <C>Col=pay_dt Ctrl=em_pay_dt Param=text Enable=enable</C>
	   <C>Col=checker Ctrl=tx_checker Param=value Enable=enable</C>
	   <C>Col=check_dt Ctrl=em_check_dt Param=text Enable=enable</C>
	   <C>Col=mediation_dt Ctrl=em_mediation_dt Param=text Enable=enable</C>
	   <C>Col=pay_cond Ctrl=tx_pay_cond Param=value Enable=enable</C>
	   <C>Col=tm_deduction_detail Ctrl=tx_tm_deduction_detail Param=value Enable=enable</C>
	   <C>Col=supply_amt_tax Ctrl=em_supply_amt_tax Param=text Enable=enable</C>
	   <C>Col=pre_prgs Ctrl=em_pre_prgs Param=text Enable=enable</C>
	   <C>Col=tm_prgs Ctrl=em_tm_prgs Param=text Enable=enable</C>
	   <C>Col=tax_tot Ctrl=em_tax_tot Param=text Enable=enable</C>
	   <C>Col=supply_amt_notax Ctrl=em_supply_amt_notax Param=text Enable=enable</C>
	   <C>Col=pre_prgs_notax Ctrl=em_pre_prgs_notax Param=text Enable=enable</C>
	   <C>Col=tm_prgs_notax Ctrl=em_tm_prgs_notax Param=text Enable=enable</C>
	   <C>Col=supply_notax_tot Ctrl=em_supply_notax_tot Param=text Enable=enable</C>
	   <C>Col=purchase_vat Ctrl=em_purchase_vat Param=text Enable=enable</C>
	   <C>Col=pre_purchase_vat Ctrl=em_pre_purchase_vat Param=text Enable=enable</C>
	   <C>Col=tm_purchase_vat Ctrl=em_tm_purchase_vat Param=text Enable=enable</C>
	   <C>Col=purchase_tot Ctrl=em_purchase_tot Param=text Enable=enable</C>
	   <C>Col=notax_sup_pur_tot Ctrl=em_notax_sup_pur_tot Param=text Enable=enable</C>
	   <C>Col=notax_pre_sup_pur_tot Ctrl=em_notax_pre_sup_pur_tot Param=text Enable=enable</C>
	   <C>Col=notax_tm_sup_pur_tot Ctrl=em_notax_tm_sup_pur_tot Param=text Enable=enable</C>
	   <C>Col=notax_tot Ctrl=em_notax_tot Param=text Enable=enable</C>
	   <C>Col=comp_sbc_tot Ctrl=em_comp_sbc_tot Param=text Enable=enable</C>
	   <C>Col=comp_pre_tot Ctrl=em_comp_pre_tot Param=text Enable=enable</C>
	   <C>Col=comp_tm_tot Ctrl=em_comp_tm_tot Param=text Enable=enable</C>
	   <C>Col=comp_pre_tm_tot Ctrl=em_comp_pre_tm_tot Param=text Enable=enable</C>
	   <C>Col=comp_amt Ctrl=em_comp_amt Param=text Enable=enable</C>
	   <C>Col=pre_advance_deduction Ctrl=em_pre_advance_deduction Param=text Enable=enable</C>
	   <C>Col=tm_advance_deduction Ctrl=em_tm_advance_deduction Param=text Enable=enable</C>
	   <C>Col=comp_advance_amt Ctrl=em_comp_advance_amt Param=text Enable=enable</C>
	   <C>Col=tot_vat1 Ctrl=em_tot_vat1 Param=text Enable=enable</C>
	   <C>Col=pre_pay Ctrl=em_pre_pay Param=text Enable=enable</C>
	   <C>Col=tm_pay Ctrl=em_tm_pay Param=text Enable=enable</C>
	   <C>Col=comp_pay_amt Ctrl=em_comp_pay_amt Param=text Enable=enable</C>
	   <C>Col=vat Ctrl=em_vat Param=text Enable=enable</C>
	   <C>Col=pre_vat Ctrl=em_pre_vat Param=text Enable=enable</C>
	   <C>Col=tm_vat Ctrl=em_tm_vat Param=text Enable=enable</C>
	   <C>Col=comp_vat_tot Ctrl=em_comp_vat_tot Param=text Enable=enable</C>
	   <C>Col=comp_sbc_vat_tot Ctrl=em_comp_sbc_vat_tot Param=text Enable=enable</C>
	   <C>Col=tot_vat2 Ctrl=em_tot_vat2 Param=text Enable=enable</C>
	   <C>Col=tot_vat3 Ctrl=em_tot_vat3 Param=text Enable=enable</C>
	   <C>Col=pre_tm_netpay_tot Ctrl=em_pre_tm_netpay_tot Param=text Enable=enable</C>
	   <C>Col=tot_vat4 Ctrl=em_tot_vat4 Param=text Enable=enable</C>
	   <C>Col=comp_sbc_cash Ctrl=em_comp_sbc_cash Param=text Enable=enable</C>
	   <C>Col=pre_cash Ctrl=em_pre_cash Param=text Enable=enable</C>
	   <C>Col=tm_cash Ctrl=em_tm_cash Param=text Enable=enable</C>
	   <C>Col=comp_cash_tot Ctrl=em_comp_cash_tot Param=text Enable=enable</C>
	   <C>Col=comp_sbc_bill Ctrl=em_comp_sbc_bill Param=text Enable=enable</C>
	   <C>Col=pre_bill Ctrl=em_pre_bill Param=text Enable=enable</C>
	   <C>Col=tm_bill Ctrl=em_tm_bill Param=text Enable=enable</C>
	   <C>Col=comp_bill_tot Ctrl=em_comp_bill_tot Param=text Enable=enable</C>
	   <C>Col=insurance1_amt1 Ctrl=em_insurance1_amt1 Param=text Enable=enable</C>
	   <C>Col=pre_employ_amt Ctrl=em_pre_employ_amt  Param=text Enable=enable</C>
	   <C>Col=tm_employ_amt Ctrl=em_tm_employ_amt Param=text Enable=enable</C>
	   <C>Col=comp_employ_tot Ctrl=em_comp_employ_tot Param=text Enable=enable</C>
	   <C>Col=pre_etc_amt Ctrl=em_pre_etc_amt  Param=text Enable=enable</C>
	   <C>Col=tm_etc_amt Ctrl=em_tm_etc_amt  Param=text Enable=enable</C>
	   <C>Col=comp_etc_tot Ctrl=em_comp_etc_tot  Param=text Enable=enable</C>
      <C>Col=safety_amt1    Ctrl=em_safety_amt1    Param=text Enable=enable</C>
      <C>Col=pre_pre_tax    Ctrl=em_pre_pre_tax    Param=text Enable=enable</C>
      <C>Col=tm_pre_tax     Ctrl=em_tm_pre_tax     Param=text Enable=enable</C>
      <C>Col=tot_pre_tax    Ctrl=em_tot_pre_tax    Param=text Enable=enable</C>
      <C>Col=safety_amt2    Ctrl=em_safety_amt2    Param=text Enable=enable</C>
      <C>Col=pre_pre_notax  Ctrl=em_pre_pre_notax  Param=text Enable=enable</C>
      <C>Col=tm_pre_notax   Ctrl=em_tm_pre_notax   Param=text Enable=enable</C>
      <C>Col=tot_pre_notax  Ctrl=em_tot_pre_notax  Param=text Enable=enable</C>
      <C>Col=previous_vat   Ctrl=em_previous_vat   Param=text Enable=enable</C>
      <C>Col=pre_pre_vat    Ctrl=em_pre_pre_vat    Param=text Enable=enable</C>
      <C>Col=tm_pre_vat     Ctrl=em_tm_pre_vat     Param=text Enable=enable</C>
      <C>Col=tot_pre_vat    Ctrl=em_tot_pre_vat    Param=text Enable=enable</C>
	   <C>Col=invoice_num    Ctrl=tx_slip_no Param=value Enable=enable</C>
         "></OBJECT></comment> <script> __ws__(__NSID__);</script>
</div>
</BODY></HTML>