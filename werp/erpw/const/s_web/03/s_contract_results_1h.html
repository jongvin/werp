<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : s_contract_result_1h.html							-->
<!-- 2. 유형(시나리오): 조회														-->
<!-- 3. 기 능 정 의   : 계약실적 		 		         	      		-->
<!-- 4. 변 경 이 력   : 권미생 작성												-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :																-->
<!-- *************************************************************	-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
// <LINK rel="stylesheet" type="text/css" href="../../../comm_function/env.css">
var gs_home = top.frames['security'].gs_home.value
var is_work_date = top.frames['security'].gs_sysdate.value
var is_dept_code = ''
var is_dept_name = '전체현장'
var is_wbs_code = ''
var is_mtrcode = ''
var ilIndex = 1

var is_ds_1_addr = gs_home + '/const/s_web/03/s_contract_results_1q.jsp?arg_from_dt='
var is_ds_2_addr = gs_home + '/const/s_web/03/s_contract_results_2q.jsp?arg_from_dt='
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 현장별조회
//------------------------------------------------------------------------
{
	is_tag = ccom_level.CodeValue
		
	is_from_dt = em_from_date.text.substr(0,4) + "." + em_from_date.text.substr(4,2)  + "." +  em_from_date.text.substr(6,2)
	is_to_dt = em_to_date.text.substr(0,4) + "." + em_to_date.text.substr(4,2)  + "." +  em_to_date.text.substr(6,2)

	if (ilIndex == 1){
		ds_1.DataID = is_ds_1_addr + is_from_dt + '&arg_to_dt=' + is_to_dt + 
							'&arg_class_tag=' + is_tag + '&arg_dept_code=' + is_dept_code +
							'&arg_wbs_code=' + is_wbs_code
		ds_1.SyncLoad=true
		ds_1.Reset()
	}else{
		ds_2.DataID = is_ds_2_addr + is_from_dt + '&arg_to_dt=' + is_to_dt + 
							'&arg_class_tag=' + is_tag + '&arg_dept_code=' + is_dept_code +
							'&arg_wbs_code=' + is_wbs_code
		ds_2.SyncLoad=true
		ds_2.Reset()
	}	
		
}
//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	result = f_dept_code_find(dept_name.value)
	if(result == false){
		is_dept_code = ''
		dept_name.value = '전체현장'
		return
	}

	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	dept_name.value = is_dept_name
}   
//---------------------------------------------------------------------------
function wbs_code_find()                       //공종찾기
//---------------------------------------------------------------------------
{
	var result;
	var array = new Array();
	result = window.showModalDialog(gs_home + "/const/s_web/00/s_profession_wbs_search_1h.html", wbs_name.value,"dialogWidth:600px;dialogHeight:500px");
	if(result == ""){
		is_wbs_code = ''
		wbs_name.value = '전체공종'
		return
	}

	array = result.split("@");
	is_wbs_code 		= array[0];   // 코드 
	wbs_name.value 	= array[1];  // 명칭

}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//----------------------------------------------------------------
function excel_down()                      //엑셀자료 내리기
//----------------------------------------------------------------
{
	var temp_1
	temp_1 = '계약실적 [' + em_from_date.text + '~' + em_to_date.text + ']'

   if  (! confirm("작업이 끝날때까지 기다려주세요")) return
   else{
   	if (ilIndex == 1)
			gd_1.GridToExcel(temp_1,'c:\aa.xls',0) 
		else 	
			gd_2.GridToExcel(temp_1,'c:\aa.xls',0) 
	}		
			
}
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_1');
	var xArr   = new Array(true);
	var yArr   = new Array(true);

	f_reSize(objArr, xArr, yArr);
}  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
	top.frames['main_title'].mouse_over()

	dept_name.value 	= is_dept_name
	wbs_name.value 	= '전체공종'

	em_from_date.text = is_work_date.substr(0,7) + '.01'
	is_from_dt = em_from_date.text.substr(0,4) + "." + em_from_date.text.substr(4,2)  + "." +  em_from_date.text.substr(6,2)
 	ll_cnt = f_ds_select_q("ds_date", " select to_char(last_day('" + is_work_date + "'),'yyyy.mm.dd') select_1 from dual") //마직막날짜
	em_to_date.text = ds_date.NameValue(1,"select_1")
	is_to_dt = em_to_date.text.substr(0,4) + "." + em_to_date.text.substr(4,2)  + "." +  em_to_date.text.substr(6,2)

	ccom_level.Index = 0;

}
</SCRIPT>

<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript event=OnSelChanged(nIndex) for=tb_1> //탭페이지변경
	ilIndex = nIndex
	btnquery_onclick()
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><OBJECT id=ds_1 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
      <Param Name="SubsumExpr" VALUE="100:long_name">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
      <Param Name="SubsumExpr" VALUE="100:profession_wbs_name">
</OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_date
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
</OBJECT></comment> <script> __ws__(__NSID__);</script>

</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->

<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) oncontextmenu="return false">
<div class=main_div> 
<table border="0" width="100%" height="100%" cellspacing="0">
	<tr height="40px">
		<td class=td_green>
			<table border="0" cellspacing="0" cellpadding="0" class=main_table>
				<tr height="20px">
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="43px" class=font_green_bold align="center">현장명</td>
					<td width="166px">
						<INPUT style="FONT-SIZE:12px;" id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" size=25  onkeyDown="keyDown()"></td>
					<td width="60px">
						<INPUT  type=button  class="img_btnFind"  value=검색 onclick=dept_code_find() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"></td>
					<td width="50px">
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="58px" class=font_green_bold align="center">기&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;간</td>
					<td width="35px" align="center">From</td>
					<td width="80px">
						<comment id="__NSID__"><OBJECT id=em_from_date tabindex=6 
						style="WIDTH: 80px; background: white;"
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
						<PARAM NAME="Alignment" VALUE="1">
						<param name=Format value="YYYY.MM.DD">
						<param name=ReadOnly   value=false>
						<param name=Numeric value=false></OBJECT></comment> <script> __ws__(__NSID__);</script> </td>
					<td width="20px" align="center">To</td>
					<td width="80px">
						<comment id="__NSID__"><OBJECT id=em_to_date tabindex=6 
						style="WIDTH: 80px; background: white;"
						classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
						<PARAM NAME="Alignment" VALUE="1">
						<param name=Format value="YYYY.MM.DD">
						<param name=ReadOnly   value=false>
						<param name=Numeric value=false></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					</td>
					<td width="*">&nbsp;</td>
				</tr>
				<tr height="20px">
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="43px" class=font_green_bold align="center">공종명</td>
					<td width="166px">
						<INPUT style="FONT-SIZE:12px;" id=wbs_name size=25 ></td>
					<td width="60px">	
						<INPUT  type=button  class="img_btnFind"  value=검색 onclick=wbs_code_find() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"></td>
					<td>&nbsp;</td>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="58px" class=font_green_bold align="center">계약구분</td>
					<td colspan="4">
						<comment id="__NSID__"><OBJECT id=ccom_level width=80px 
						classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
						<param name=Data     value="1^외주,2^납품설치,@^전체">
						<param name=DataID     value=ds_1>
						<PARAM NAME="Enable" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					<td align="right">
						<INPUT id=bt_excel_query  type=button  class="img_btn5_1"  value=엑셀내리기 onclick=excel_down() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;</td>
				</tr>        
			</table>
		</td>
	</tr>
	<tr height="*">
		<td>
			<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0">
				<tr height="20px">
					<td>
						<comment id="__NSID__"><OBJECT id=tb_1 
						    style="FONT-SIZE: 12px; Z-INDEX: 200; WIDTH: 100%; HEIGHT: 20px" 
						    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
						  <param name="BackColor"  value="#BBE0F4">
						  <param name="TextColor"  value="BLACK">
						  <PARAM NAME="Format" VALUE="
						    <T>divid=tab_page_1 title=현장별</T>
						    <T>divid=tab_page_2 title=공종별</T>
						    ">
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
				</tr>
				<tr height="*">
					<td>
						<DIV id=tab_page_1 
							style="WIDTH: 100%; POSITION: absolute; HEIGHT: 100%;" >
						<comment id="__NSID__"><OBJECT id=gd_1 
						    style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%; HEIGHT: 100%" 
						    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
							<PARAM NAME="MultiRowSelect" VALUE="-1">
							<PARAM NAME="AutoInsert" VALUE="-1">
						   <PARAM NAME="BorderStyle"  VALUE=1>
							<PARAM NAME="AllShowEdit" VALUE="-1">
							<PARAM NAME="Editable" VALUE="0">
							<param name="ViewSummary"    value=1>
							<PARAM NAME="ColSizing" 	VALUE=true>
							<PARAM NAME="Format" VALUE="
							  <C> Name='현장명' id={IF(level=100,long_name&&' 소  계',long_name)} suppress=1 bgcolor={decode(curlevel,100,'#e4cbdf','#ffffff')}   HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=180
						            SumText='합 계'  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='구분' ID=tag	EditStyle=Combo Align=Center Data='A:건축,C:토목,E:전기,J:자재,L:조경,M:설비,T:공통' BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='공종명' id={IF(level=100,' ',profession_wbs_name)}  BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=130
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='업체명' id={IF(level=100,' ',sbcr_name)}  BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=130
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='최초계약일' id={IF(level=100,' ',min_sbc_dt)}	 BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='최종계약일' id={IF(level=100,' ',max_sbc_dt)}	 BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='실행금액' ID=exe_amt BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText=@sum  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='최초계약금' ID=min_sbc_amt BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText=@sum  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='최종계약금' ID=max_sbc_amt BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText=@sum  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='차수' ID=chg_degree BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=40 
							  			SumText=''  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='실행실적금액' ID={max_amt2-min_amt2} BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText={sum(max_amt2)-sum(min_amt2)}  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='외주실적금액' ID={max_amt-min_amt} BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText={sum(max_amt)-sum(min_amt)}  SumColor=Black SumBgColor=Pink  </C>
							  ">
							<PARAM NAME="DataID" VALUE="ds_1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
						</DIV>
						
						<DIV id=tab_page_2 
							style="WIDTH: 100%; POSITION: absolute; HEIGHT: 100%;" >
						<comment id="__NSID__"><OBJECT id=gd_2 
						    style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%; HEIGHT: 100%" 
						    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
							<PARAM NAME="MultiRowSelect" VALUE="-1">
							<PARAM NAME="AutoInsert" VALUE="-1">
						   <PARAM NAME="BorderStyle"  VALUE=1>
							<PARAM NAME="AllShowEdit" VALUE="-1">
							<PARAM NAME="Editable" VALUE="0">
							<param name="ViewSummary"    value=1>
							<PARAM NAME="ColSizing" VALUE="-1">
							<PARAM NAME="Format" VALUE="
							  <C> Name='현장명' id={IF(level=100,profession_wbs_name&&' 소  계',long_name)} suppress=1 bgcolor={decode(curlevel,100,'#e4cbdf','#ffffff')}   HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=180
						            SumText='합 계'  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='구분' ID=tag	EditStyle=Combo Align=Center Data='A:건축,C:토목,E:전기,J:자재,L:조경,M:설비,T:공통' BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='공종명' id={IF(level=100,' ',profession_wbs_name)}  BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=130
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='업체명' id={IF(level=100,' ',sbcr_name)}  BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=130
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='최초계약일' id={IF(level=100,' ',min_sbc_dt)}	 BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='최종계약일' id={IF(level=100,' ',max_sbc_dt)}	 BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=70
						            SumText=''  SumColor=Black SumBgColor=Pink   </C>
							  <C> Name='실행금액' ID=exe_amt BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText=@sum  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='최초계약금' ID=min_sbc_amt BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText=@sum  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='최종계약금' ID=max_sbc_amt BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText=@sum  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='차수' ID=chg_degree BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=40 
							  			SumText=''  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='실행실적금액' ID={max_amt2-min_amt2} BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText={sum(max_amt2)-sum(min_amt2)}  SumColor=Black SumBgColor=Pink  </C>
							  <C> Name='외주실적금액' ID={max_amt-min_amt} BgColor={decode(curlevel,100,'#e4cbdf',(decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')))}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK   Width=100 
							  			SumText={sum(max_amt)-sum(min_amt)}  SumColor=Black SumBgColor=Pink  </C>
							  ">
							<PARAM NAME="DataID" VALUE="ds_2"></OBJECT></comment> <script> __ws__(__NSID__);</script>
						</DIV>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
</div>
</BODY></HTML>
