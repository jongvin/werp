<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : s_guarantee_accept_1h.html								-->
<!-- 2. 유형(시나리오): 입력 															-->
<!-- 3. 기 능 정 의   : 보증서접수 내역                        	-->
<!-- 4. 변 경 이 력   :  박두현 작성																		-->
<!-- 5. 관련프로그램  :																						-->
<!-- 6. 특 기 사 항   :																							-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
// <LINK rel="stylesheet" type="text/css" href="../../../comm_function/env.css">
var is_sw='N'      //계약내역으로 들어가며는 'Y'로 바꿈. ('Y':계약승인처리화면으로 되돌아가기위해 쿠키를 삭제 안함)
                   //('N':계약승인처리화면으로 되돌아가기위해 쿠키함)
var gs_home = top.frames['security'].gs_home.value
var gs_user_id = top.frames['security'].user_id.value
var gs_empno = top.frames['security'].empno.value
var is_ds_1_addr = 's_chg_cn_title_dur_1q.jsp?arg_dept_code='                    //계약  목록 
var is_ds_2_addr = 's_guarantee_accept_1q.jsp?arg_dept_code=' 
var is_tr_2_addr = gs_home + '/const/s_web/03/s_guarantee_accept_1tr.jsp'
var il_screen = 1                   
var is_sbcr_code = ""
var is_dept_code = ""
var is_dept_name = ""
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	if (il_screen > 1){
	   div_btnquery_onclick()
	   return
	}   
	ds_1.DataID = is_ds_1_addr + is_dept_code
	ds_1.SyncLoad=true
	ds_1.Reset() 
	
   if (ds_1.CountRow < 1)    // 상위가 한건도 없을경우 하위의 기존 데이타를 없앰. 
       ds_2.ClearData()


}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
 
 if (ds_1.CountRow < 1) return

 ds_2.DataID = is_ds_2_addr +  is_dept_code + "&arg_order_number=" + ds_1.NameValue(ds_1.RowPosition,"order_number")
 ds_2.SyncLoad=true
 ds_2.Reset()
}

//------------------------------------------------------------------------
function initial_move()
//------------------------------------------------------------------------
{
  ds_2.NameValue(ds_2.RowPosition,"dept_code") = ds_1.NameValue(ds_1.RowPosition,"dept_code")
  ds_2.NameValue(ds_2.RowPosition,"order_number") = ds_1.NameValue(ds_1.RowPosition,"order_number")
  ds_2.NameValue(ds_2.RowPosition,"guarantee_class") = "1"
  if (ds_2.RowPosition == 1) 
      ds_2.NameValue(ds_2.RowPosition,"seq") = 1
  else
      ds_2.NameValue(ds_2.RowPosition,"seq") = ds_2.NameValue(ds_2.RowPosition - 1,"seq") + 1
  gd_2.Focus()
  gd_2.SetColumn("guarantee_class")
}

//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
 ds_2.AddRow()
 initial_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{

 if (ds_2.RowPosition == 0){     //한건도 없을경우는  0 
   btnadd_onclick()
   initial_move()
   return
 }  
 ds_2.InsertRow(ds_2.RowPosition)
 initial_move()
}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
  if  (gd_2.MultiRowSelect){               // multi row select 일 경우
     for (i=ds_2.CountRow ;i >0 ;i--)
     {
        if (ds_2.RowMark(i) == 1)
               ds_2.DeleteRow(i)
    }   
    ds_2.MarkRows(ds_2.RowPosition,ds_2.RowPosition)  //삭제작업완료후 MARK
   }
  else{
  		if (ds_2.NameValue(ds_2.RowPosition,'invoice_num') != '' ) {
  			alert('전표가 생성된 자료는 삭제하실 수 없습니다...')
  			return
     	}
     	else{
     		ds_2.DeleteRow(ds_2.RowPosition)  
     	}
  }
 }
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{

  if (ds_2.IsUpdated){
	 var ll_dup
	 ll_dup = f_dup_chk("ds_2","seq")
	 if (ll_dup > 0) {
	     alert("순번이 중복되었습니다: 순번를 수정하십시요 ")
	     ds_2.RowPosition = ll_dup
     	  gd_2.SetColumn("seq");
	     return
	 }
  }
 
   
  if (ds_2.IsUpdated){
    if  (confirm("변경되었습니다 저장하시겠습니까?")){
           tr_2.Post()
    }    
 } 
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
  ds_2.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
//	  if (ds_2.IsUpdated) {
//     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
//        {  //저장 routine
//        }   
// 
//   }     

// parent.frames['main_ct'].window.close()     
}

//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
	result = f_dept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	dept_name.value = is_dept_name

  il_screen = 1   //parent를 다시 읽음 
	btnquery_onclick()
}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}

//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_screen = focus
}
//------------------------------------------------------------------------
function btnquery_prt_onclick()                     // 미리보기
//------------------------------------------------------------------------
{
   var arg_temp,ls_temp
   if (ds_2.CountRow < 1) return

	ls_temp = ds_2.NameValue(ds_2.RowPosition,"invoice_num");
	
	if (ls_temp == ''){
		alert('전표가 생성되지않아 출력하실 수 없습니다...')
		return
	}

	arg_temp = "const_rpt/d_web/01r/"       
	arg_temp = arg_temp + "d_slip_report"  
	
	arg_temp = arg_temp + "&RptParams=" + ds_2.NameValue(ds_2.RowPosition,"invoice_num")
	f_crystal_report(arg_temp)   
}
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_2');
	var xArr   = new Array(false);
	var yArr   = new Array(true);

	f_reSize(objArr, xArr, yArr);
}  
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
    top.frames['main_title'].mouse_over()
	ll_cnt = f_select_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '020' order by etc_code") //승인구분
	ll_cnt = f_select1_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '017' order by etc_code") //승인구분

	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
   
   tr_2.Action = is_tr_2_addr

	dept_name.value = is_dept_name
	btnquery_onclick()

}

//---------------------------------------------------------------------
function vat_editable(status)
//---------------------------------------------------------------------
{
	gd_2.ColumnProp('guarantee_vat', 'Edit') = status
}
//---------------------------------------------------------------------
function window_onunload()
//---------------------------------------------------------------------
{
}
//---------------------------------------------------------------------------
function slip_call()                        //전표조회
//---------------------------------------------------------------------------
{
	if (ds_2.RowPosition < 1) return
	var ll_invoice_num,li_sql,ll_cnt
	
	if (ds_2.NameValue(ds_2.RowPosition,'invoice_num') == '') {
		alert('전표가 생성되지 않았습니다...')
		return
	}
	ll_invoice_num = parseInt(ds_2.NameValue(ds_2.RowPosition,"invoice_num"),10)
	li_sql = " SELECT to_char(make_dt,'YYYYMMDD') select_1,make_seq select_2,slip_kind_tag select_3,make_comp_code select_4 " +
	         " FROM t_acc_slip_head where slip_id = " + ll_invoice_num
	ll_cnt = f_select_q(li_sql)
	if (ll_cnt < 1) {
		alert('전표가 생성되지 않았습니다...')
		return
	}

	var lrArgs = new Array();
	var lsURL = gs_home + "/general/t_web/01/t_WSlipR.jsp"
	lrArgs.opener = window;
	lrArgs.SLIP_ID = ll_invoice_num;
	lrArgs.SLIP_IDSEQ = 0;
	lrArgs.MAKE_DT        = ds_select.NameValue(1,'select_1');
	lrArgs.MAKE_SEQ       = parseInt(ds_select.NameValue(1,'select_2'),10);
	lrArgs.SLIP_KIND_TAG  = ds_select.NameValue(1,'select_3');
	lrArgs.MAKE_COMP_CODE = ds_select.NameValue(1,'select_4');
	lrArgs.READONLY_TF = 'T';
	
	window.showModalDialog(lsURL,lrArgs,"center:yes;dialogWidth:1024px;dialogheight:800px;status:no;help:no;scroll:no");
}
//---------------------------------------------------------------------------
function slip_delete()                        //전표삭제
//---------------------------------------------------------------------------
{
	if (ds_2.RowPosition < 1) return
	var ll_invoice_num,li_sql,ll_cnt,ls_tag
	
	if (ds_2.NameValue(ds_2.RowPosition,'invoice_num') == '') {
		alert('전표가 생성되지 않았습니다...')
		return
	}
	if (ds_2.NameValue(ds_2.RowPosition,'slip_st') == 'C') {
		alert('확정된 전표는 삭제하실 수 없습니다...')
		return
	}
	if  (confirm("전표를 삭제하시겠습니까?")){
	}
	else {
		return
	}
	ll_invoice_num = parseInt(ds_2.NameValue(ds_2.RowPosition,"invoice_num"),10)

	ds_spcall.DataID = gs_home + '/const/y_slip_delete_procedure.jsp?arg_seq=' + ll_invoice_num
	ds_spcall.SyncLoad = true
	ds_spcall.reset()
	ds_2.NameValue(ds_2.RowPosition,'invoice_num') = ''
	ds_2.NameValue(ds_2.RowPosition,'invoice_num1') = ''
	tr_2.Post()

	div_btnquery_onclick()
}
//---------------------------------------------------------------------
function slip_rtn()
//---------------------------------------------------------------------
{
	var result,li_unq_num,send_arg,ls_row;
	var array = new Array();
	
	if (ds_2.IsUpdated){
		alert('수정된 자료를 저장부터 하시고 계속하십시오(미처리)...')
		return
	}

	if (ds_2.RowPosition < 1) return
	ls_row = ds_2.RowPosition
	if (ds_2.NameValue(ds_2.RowPosition,'guarantee_class') != '2') {
		alert("선급전표만 처리 가능합니다...")
		return
	}
	if(ds_1.NameValue(ds_1.RowPosition,'approve_class') != '6') {
			alert('계약처리가 안되서 전표를 발행할 수 없습니다...')
			return
		}
	if (ds_2.NameValue(ds_2.RowPosition,"invoice_num") != '') {
		alert('이미 전표가 생성된 자료입니다...')
		return
	}
	if (ds_2.NameValue(ds_2.RowPosition,"pay_dt") == '') {
		alert('지급희망일이 입력안되서 전표를 발행할 수 없습니다...')
		return
	}
	var li_order_number,ls_date,li_seq
	
	li_order_number = ds_2.NameValue(ds_2.RowPosition,'order_number')
	ls_date         = ds_2.NameValue(ds_2.RowPosition,'guarantee_issueday')
	li_seq          = ds_2.NameValue(ds_2.RowPosition,'seq')
	if (ls_date == '' || ls_date == '          ') {
		alert("발급(증빙)일자를 반드시 입력하십시오...")
		return
	}

	if  (confirm("전표를 생성하시면 자료를 수정하실 수 없습니다... 계속하시겠습니까?")){
	}
	else {
		return
	}

	ds_spcall.DataID = 's_sp_slip_prepayment_procedure.jsp?arg_dept_code=' + is_dept_code + 
															'&arg_date=' + ls_date + 
															'&arg_user=' + gs_empno + 
															'&arg_order_number=' + li_order_number + 
															'&arg_seq=' + li_seq
	ds_spcall.SyncLoad = true
	ds_spcall.reset()
	div_btnquery_onclick()
	if (ds_2.NameValue(ls_row,'invoice_num') != '') {
		alert("정상처리되었습니다...")
		slip_call()
	}
	else{
		alert("전표가 생성되지않았습니다...")
	}
}
//---------------------------------------------------------------------
function ctrl_key(e)
//---------------------------------------------------------------------
{
	alert("111")
}
</SCRIPT>

<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnSuccess()>
div_btnquery_onclick()
</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
{
  if  (row < 1) return;
  div_btnquery_onclick()  
}  
</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_2>
	if  (row < 1) return
		if (ds_2.NameValue(row, "guarantee_class") == "2") 
			vat_editable("Numeric")
		else 
			vat_editable("None")
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_2>
{
	if  (row < 1) return;
	if (ds_2.NameValue(row,"invoice_num") != '' ) {
		gd_2.Editable="false"
	}
	else{
		gd_2.Editable="true"
	}
}  
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnCloseUp(row,colid)>
	if (ds_2.NameValue(row,colid)!="2"){
		if (ds_2.NameValue(row,"guarantee_vat")!= 0)
			ds_2.NameValue(row,"guarantee_vat") = 0
		vat_editable("None")
	}
	else
		vat_editable("Numeric")
</script>

<script language=JavaScript for=ds_2 event=OnColumnChanged(row,colid)>
	if (ds_2.NameValue(row, "guarantee_class") == "2"){
		if (colid=="guarantee_amt")
			ds_2.NameValue(row,"guarantee_vat") = ds_2.NameValue(row,"guarantee_amt") * 0.1
	}
</script>

<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 
 <comment id="__NSID__"><Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_tot 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_lab 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:s_guarantee_accept_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>


</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) onunload=window_onunload() oncontextmenu="return false">
<div class=main_div> 
<table border="0" width="100%" height="100%" cellspacing="0">
	<tr height="20px">
		<td class=td_green colspan="2">
			<table border="0" cellspacing="0" cellpadding="0" class=main_table>
				<tr>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="43px" class=font_green_bold align="center">현장명</td>
					<td width="166px">
						<INPUT style="FONT-SIZE:12px;" id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" style=" FONT-SIZE: 12px;" size=25 onkeyDown="keyDown()"></td>
					</td>
					<td>
						<INPUT  type=button  class="img_btnFind"  value=검색 onclick=dept_code_find() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
					</td>
					<td>
						<INPUT  id=button_1  type=button  class="img_btn4_1"  value=전표조회 onclick=slip_call() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  id=button_2  type=button  class="img_btn4_1"  value=전표삭제 onclick=slip_delete() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  id=button_3  type=button  class="img_btn4_1"  value=전표생성 onclick=slip_rtn() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;
					</td>
	         </tr>                 
	      </table>
	   </td>
	</tr>
	<tr height="50%">
		<td width="50%">
			<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
			    style="FONT-SIZE: 12px; Z-INDEX: 105; WIDTH:100%; HEIGHT: 100%;" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AllShowEdit" VALUE="-1">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="DataID" VALUE="ds_1">
				<PARAM NAME="Format" VALUE=" 
				  <C> Name=계약번호 ID=const_no  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=55 </C>
				  <C> Name=차수 ID=chg_degree  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=30 </C> 
				  <C> Name=계약명 ID=sbc_name  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=150 </C> 
				  <C> Name=업체명 ID=sbcr_name  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=100 </C> 
				  <C> Name=승인구분 ID=approve_class   Edit=None EditStyle=Lookup Data='ds_select:select_1:select_2'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
				  <C> Name=공사시작일 ID=start_dt   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=65 </C> 
				  <C> Name=공사종료일 ID=end_dt   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=65 </C> 
				  <C> Name=진행 ID=close_tag  Edit=None EditStyle=Combo Data='Y:완료,N:진행' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
				  <C> Name=계약금액 ID=sbc_amt  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=100 </C>
			      ">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="50%">
		
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4 > 
                 <div align="right">선급지급구분</div></td>
             <td width="30%" colspan=6> 
		            <comment id="__NSID__"><OBJECT id=ccom_previous_pay_tag width=90px
		                    classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
					          <param name=Data     value="Y^예,N^아니오">
				             <param name=DataID     value=ds_1>
				             <param name=CodeColumn value=previous_pay_tag>
			                <param name=Auto      value=false>	
				             <PARAM NAME="Enable" VALUE="0"></OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
                 <div align="right">선급율</div></td>
             <td width="35%" colspan=7> 
					   <comment id="__NSID__"><OBJECT id=em_previous_amt_rt   
                         style="WIDTH: 40px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
                       <param name=Alignment  value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
                       <param name=MaxDecimalPlace   value=2>
                       <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
             </td> 
         </tr> 
         <tr BGCOLOR="white" > 
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4 > 
                 <div align="right">선급금(공급가)</div></td>
             <td width="30%" colspan=6> 
					   <comment id="__NSID__"><OBJECT id=em_previous_amt   
                         style="WIDTH: 100px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
                       <param name=Alignment  value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
                       <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
                   </TD>
             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
                 <div align="right">선급부가세</div></td>
             <td width="35%" colspan=7> 
					   <comment id="__NSID__"><OBJECT id=em_previous_vat   
                         style="WIDTH: 100px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
                       <param name=Alignment  value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
                       <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
             </td> 
         </tr> 
         <tr BGCOLOR="white" > 
             <td width="100%"   BGCOLOR="#53A9FF" style="COLOR: WHITE" colspan=20 > 
                 <div align="center">보증서 계약 조건</div></td>
         </tr> 
         <tr BGCOLOR="white" > 
             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=2> 
                 <div align="right">구분</div></td>
             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"   colspan=2> 
                 <div align="center">보증율</div></td>
             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
                 <div align="center">보증금액</div></td>
             <td width="30%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=6 > 
                 <div align="center">보증종별</div></td>
             <td width="35%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=7 > 
                 <div align="center">보증기간</div></td>
         </tr> 
	       <tr BGCOLOR="white" > 
             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=2> 
	              <div align="right">계약</div></td>
             <td width="10%"   colspan=2> 
					   <comment id="__NSID__"><OBJECT id=em_sbc_guarantee_rt 
	                      style="WIDTH: 50px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
	                    <param name=SelectAll          value="-1">
	                    <param name=Alignment  value=2>
	                    <param name=MaxDecimalPlace   value=2>
	                    <param name=ReadOnly   value=true>
	                    <param name=ReadOnlyForeColor value=gray>
	                    <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
	               </TD>
             <td width="15%"      colspan=3> 
					   <comment id="__NSID__"><OBJECT id=em_sbc_guarantee_amt 
	                      style="WIDTH: 80px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
	                    <param name=SelectAll          value="-1">
	                    <param name=Alignment  value=2>
	                    <param name=ReadOnly   value=true>
	                    <param name=ReadOnlyForeColor value=gray>
	                    <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
	               </TD>
             <td width="30%"    colspan=6 > 
	               <INPUT style="FONT-SIZE:12px;" id=tx_sbc_guarantee_kind size=20 disabled=true readonly></td>
             <td width="35%"    colspan=7 > 
					   <comment id="__NSID__"><OBJECT id=em_sbc_guarantee_start_dt 
	                      style="WIDTH: 70px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
	                    <param name=SelectAll          value="-1">
					        <param name=Format value="YYYY-MM-DD">
	                    <param name=Numeric value=false>
	                    <param name=ReadOnly   value=true>
	                    <param name=ReadOnlyForeColor value=gray>
					        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
					        <LABEL>-</LABEL>
					   <comment id="__NSID__"><OBJECT id=em_sbc_guarantee_end_dt 
	                      style="WIDTH: 70px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
	                    <param name=SelectAll          value="-1">
					        <param name=Format value="YYYY-MM-DD">
	                    <param name=Numeric value=false>
	                    <param name=ReadOnly   value=true>
	                    <param name=ReadOnlyForeColor value=gray>
					        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
					       </td>
	       </tr>
          <tr BGCOLOR="white" > 
             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=2> 
                 <div align="right">하자</div></td>
             <td width="10%"   colspan=2> 
					   <comment id="__NSID__"><OBJECT id=em_warrant_guarantee_rt
                         style="WIDTH: 50px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
                       <param name=Alignment  value=2>
                       <param name=MaxDecimalPlace   value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
                       <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
                  </TD>
             <td width="15%"   colspan=3> 
					   <comment id="__NSID__"><OBJECT id=em_warrant_guarantee_amt
                         style="WIDTH: 80px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
                       <param name=Alignment  value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
                       <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
                  </TD>
             <td width="30%"    colspan=6 > 
                  <INPUT style="FONT-SIZE:12px;" id=tx_warrant_guarantee_kind size=20 disabled=true readonly></td>
             <td width="35%"    colspan=7 > 
 					   <comment id="__NSID__"><OBJECT id=em_warrant_guarantee_start_dt 
                         style="WIDTH: 70px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
					        <param name=Format value="YYYY-MM-DD">
                       <param name=Numeric value=false>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
					        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
					        <LABEL>-</LABEL>
 					   <comment id="__NSID__"><OBJECT id=em_warrant_guarantee_end_dt 
                         style="WIDTH: 70px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
					        <param name=Format value="YYYY-MM-DD">
                       <param name=Numeric value=false>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor value=gray>
					        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
					       </td>
          </tr>
           <tr BGCOLOR="white" > 
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4 > 
                 <div align="right">근재보험금액</div></td>
             <td width="20%" colspan=4> 
					   <comment id="__NSID__"><OBJECT id=em_insurance2_amt1 
                         style="WIDTH: 100px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=SelectAll          value="-1">
                       <param name=ReadOnlyBackColor  value=silver>
                       <param name=Alignment  value=2>
                       <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
                  </TD>
             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
                 <div align="right">근재보험사</div></td>
             <td width="45%" colspan=9> 
                  <INPUT style="FONT-SIZE:12px;" id=tx_insurance2_name  size=30></td>
          </tr>
          <tr BGCOLOR="white" > 
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4> 
                 <div align="center">산업재해</div></td>
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4> 
                 <div align="center">영업배상</div></td>
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4> 
                 <div align="center">동산보험</div></td>
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4> 
                 <div align="center">조립보험</div></td>
             <td width="20%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=4> 
                 <div align="center">인상보험</div></td>
          </tr>
          <tr BGCOLOR="white" > 
             <td width="20%" colspan=4 > 
		            <comment id="__NSID__"><OBJECT id=ccom_guarantee_tag1 WIDTH=70px 
		                    classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F  VIEWASTEXT>
						 <PARAM NAME="Alignment" VALUE="1">
			          <PARAM name=Data     value="Y^제출,N^면제">
                   <param name=Auto       value=false>
                   <param name=dataid       value="ds_1">
		             <PARAM name=CodeColumn value=guarantee_tag1>
                   <param name=Enable     value=true>
			         </OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
             <td width="20%" colspan=4 > 
		            <comment id="__NSID__"><OBJECT id=ccom_guarantee_tag2 WIDTH=70px 
		                    classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F  VIEWASTEXT>
						 <PARAM NAME="Alignment" VALUE="1">
			          <PARAM name=Data     value="Y^제출,N^면제">
                   <param name=Auto       value=false>
                   <param name=dataid       value="ds_1">
		             <PARAM name=CodeColumn value=guarantee_tag2>
                   <param name=Enable     value=true>
			         </OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
             <td width="20%" colspan=4 > 
		            <comment id="__NSID__"><OBJECT id=ccom_guarantee_tag3 WIDTH=70px 
		                    classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F  VIEWASTEXT>
						 <PARAM NAME="Alignment" VALUE="1">
			          <PARAM name=Data     value="Y^제출,N^면제">
                   <param name=Auto       value=false>
                   <param name=dataid       value="ds_1">
		             <PARAM name=CodeColumn value=guarantee_tag3>
                   <param name=Enable     value=true>
			         </OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
             <td width="20%" colspan=4 > 
		            <comment id="__NSID__"><OBJECT id=ccom_guarantee_tag4 WIDTH=70px 
		                    classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F  VIEWASTEXT>
						 <PARAM NAME="Alignment" VALUE="1">
			          <PARAM name=Data     value="Y^제출,N^면제">
                   <param name=Auto       value=false>
                   <param name=dataid       value="ds_1">
		             <PARAM name=CodeColumn value=guarantee_tag4>
                   <param name=Enable     value=true>
			         </OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
             <td width="20%" colspan=4 > 
		            <comment id="__NSID__"><OBJECT id=ccom_guarantee_tag5 WIDTH=70px 
		                    classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F  VIEWASTEXT>
						 <PARAM NAME="Alignment" VALUE="1">
			          <PARAM name=Data     value="Y^제출,N^면제">
                   <param name=Auto       value=false>
                   <param name=dataid       value="ds_1">
		             <PARAM name=CodeColumn value=guarantee_tag5>
                   <param name=Enable     value=true>
			         </OBJECT></comment> <script> __ws__(__NSID__);</script></TD>
         </tr> 
      </table>  
		</td>
	</tr>
	<tr height="*">
		<td colspan="2">
			<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
			style="FONT-SIZE: 12px; Z-INDEX: 105; WIDTH:100%; HEIGHT: 100%" 
			classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="AllShowEdit" VALUE="-1">
				<PARAM NAME="Editable" VALUE="-1">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="DataID" VALUE="ds_2">
				<PARAM NAME="Format" VALUE=" 
					<C> Name='순번'  id=seq  width=30  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='종류'  id=guarantee_class  Align=Center width=80  EditStyle=Lookup Data='ds_select1:select_1:select_2' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='접수일자'  id=accept_dt  Align=Center width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='보증번호'  id=guarantee_number  width=142  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='금액'  id=guarantee_amt  width=75  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='부가세'  id=guarantee_vat  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='발급일자'  id=guarantee_issueday    Align=Center width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='보증시작일'  id=guarantee_start_dt   Align=Center  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='보증종료일'  id=guarantee_end_dt   Align=Center  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='지급희망일'  id=pay_dt   Align=Center  width=70  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='보증종별'  id=guarantee_kind  width=100  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='보증사'  id=guarantee_sbcr  width=120  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
					<C> Name='비    고 '  id=note  width=135  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  <C> Name='전표상태' ID=slip_st  Edit=None Align=Center EditStyle=Combo Data='X: ,A:미생성,C:확정,D:삭제,N:가승인' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=50 </C> 
				  <C> Name='전표번호' ID=invoice_num BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=70 </C> 
				  <C> Name='전표번호1' ID=invoice_num1  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=70 </C> 
				">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
	</tr>
</table>

<comment id="__NSID__"><OBJECT id=Bind_1 
    style="Z-INDEX: 107; LEFT: 241px; POSITION: absolute; TOP: 3px" 
    classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	   <C>Col=previous_amt_rt Ctrl=em_previous_amt_rt Param=text Enable=enable</C>
	   <C>Col=previous_amt Ctrl=em_previous_amt Param=text Enable=enable</C>
	   <C>Col=previous_vat Ctrl=em_previous_vat Param=text Enable=enable</C>
	   <C>Col=sbc_guarantee_rt Ctrl=em_sbc_guarantee_rt Param=text Enable=enable</C>
	   <C>Col=sbc_guarantee_amt Ctrl=em_sbc_guarantee_amt Param=text Enable=enable</C>
	   <C>Col=sbc_guarantee_kind Ctrl=tx_sbc_guarantee_kind Param=value Enable=enable</C>
	   <C>Col=sbc_guarantee_start_dt Ctrl=em_sbc_guarantee_start_dt Param=text Enable=enable</C>
	   <C>Col=sbc_guarantee_end_dt Ctrl=em_sbc_guarantee_end_dt Param=text Enable=enable</C>
	   <C>Col=warrant_guarantee_rt Ctrl=em_warrant_guarantee_rt Param=text Enable=enable</C>
	   <C>Col=warrant_guarantee_amt Ctrl=em_warrant_guarantee_amt Param=text Enable=enable</C>
	   <C>Col=warrant_guarantee_kind Ctrl=tx_warrant_guarantee_kind Param=value Enable=enable</C>
	   <C>Col=warrant_guarantee_start_dt Ctrl=em_warrant_guarantee_start_dt Param=text Enable=enable</C>
	   <C>Col=warrant_guarantee_end_dt Ctrl=em_warrant_guarantee_end_dt Param=text Enable=enable</C>
 	   <C>Col=insurance2_amt1 Ctrl=em_insurance2_amt1 Param=text Enable=enable</C>
	   <C>Col=insurance2_name Ctrl=tx_insurance2_name Param=value Enable=enable</C>
   "></OBJECT></comment> <script> __ws__(__NSID__);</script>
</div>
</BODY></HTML>