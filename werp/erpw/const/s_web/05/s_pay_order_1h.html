<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************	-->
<!-- 1. 프로그램 id   : s_pay_order_1h.html						      -->
<!-- 2. 유형(시나리오): 		      				-->
<!-- 3. 기 능 정 의   : 협력업체별 현장별년 월별 기성조회 		  	  	      					-->
<!-- 4. 변 경 이 력   : 박두현 작성												-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :																-->
<!-- *************************************************************	-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value
var is_work_date 
var is_from_date,is_to_date
var is_ds_1_addr = 's_pay_order_list_1q.jsp?arg_yymm='
var is_ds_2_addr = 's_pay_order_1q.jsp?arg_order_wbs_code='
var is_ds_3_addr = 's_pay_dept_yymm_1q.jsp?arg_dept_code='
var is_dept_code
var is_order_wbs_code
var il_order_number 
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	ds_1.DataID = is_ds_1_addr + is_from_date 
	ds_1.SyncLoad=true
	ds_1.Reset()

}

//------------------------------------------------------------------------
function pay_sbcrretrieve()                     // 부서별 협력업체별 조회  
//------------------------------------------------------------------------
{

	ds_2.DataID = is_ds_2_addr + is_order_wbs_code + '&arg_yymm=' + is_from_date 
	ds_2.SyncLoad=true
	ds_2.Reset()

}
//------------------------------------------------------------------------
function pay_sbcryymm_retrieve()                     // 협력업체별 기성년월별조회 
//------------------------------------------------------------------------
{
	ds_3.DataID = is_ds_3_addr + is_dept_code + '&arg_order_number=' + il_order_number + '&arg_yymmseq=' + is_from_date + '9' 
	ds_3.SyncLoad=true
	ds_3.Reset()

}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             

// top.frames['main_ct'].window.close()     
}
//-------------------------------------------------------------------------------
function select_yymm()                  //년월 선택 
//--------------------------------------------------------------------------------
{
   is_from_date = em_select_from.text.substr(0,4) + "." + em_select_from.text.substr(5,2) + ".01" 
  ds_2.ClearData()
  ds_3.ClearData()
   btnquery_onclick()
} 
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_1','gd_2', 'gd_3');
	var xArr   = new Array(false, true,true);
	var yArr   = new Array(true,false,true);

	f_reSize(objArr, xArr, yArr);
}     
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
	is_to_date = f_sysdate()
	is_from_date = is_to_date.substr(0,7) + ".01" 
	em_select_from.text = is_from_date.substr(0,7)
   btnquery_onclick()
   
}
</SCRIPT>
<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_2 event=onFilter(row)>
      if (ds_2.NameValue(row,"tot_prgs") ==0) return false
      else return true
</SCRIPT>

<script language=JavaScript for=ds_1 event=OnRowPosChanged(row)>
if (row < 1) return
is_order_wbs_code = ds_1.NameValue(row,"profession_wbs_code")
pay_sbcrretrieve()
</SCRIPT>
<script language=JavaScript for=ds_2 event=OnRowPosChanged(row)>
if (row < 1) return
is_dept_code = ds_2.NameValue(row,"dept_code")
il_order_number  = ds_2.NameValue(row,"order_number")
pay_sbcryymm_retrieve()
</SCRIPT>

<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("ds_1 Error Code : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("ds_2 Error Code : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("ds_3 Error Code : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=em_select_from event=onKillFocus()>
	if (em_select_from.Modified){ 
		select_yymm()
	}
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_from event=onKeyDown(kcode,scode)>
	if ((em_select_from.Modified) && kcode == 13 ){ 
		select_yymm()
	}
</SCRIPT>   


<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><OBJECT id=ds_1 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
        <param name=UseFilter       value=true> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 101; LEFT: 300px; POSITION: absolute; parent: 20px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="">
</OBJECT></comment> <script> __ws__(__NSID__);</script>	
</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<div class=main_div>
<table border="0" width="100%" height="100%" cellspacing="0">
	<tr height="20px">
		<td class=td_green colspan="2">
			<table BORDER="0" CELLSPACING="0" cellpadding="0" class=main_table>
				<tr> 
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="55px" class=font_green_bold>조회년월</td>
					<td width="80px">
						<comment id="__NSID__"><OBJECT id=em_select_from 
						       style="Z-INDEX: 101; LEFT: 83px; WIDTH: 80px; background: white;" 
						      classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
							    <PARAM NAME="Alignment" VALUE="1">
							    <PARAM NAME="IsComma" VALUE="0">
							    <PARAM NAME="MaxLength" VALUE="8">
							    <PARAM NAME="Format" VALUE="YYYY-MM">
						       <param name=ClipMode       value=false>
							    <PARAM NAME="Numeric" VALUE="0">
							    <PARAM NAME="SelectAll" VALUE="-1">
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
					<td width="25px">
						<img class="img_btnCalendar_S"  id=img_fr OnClick="var result = gn_Cal_Yymm(); 
							if(!is_null(result)){ em_select_from.text = result.substr(0,8);} ; select_yymm()"></td>
					<td width="*">&nbsp;</td>
					<td width="*">*부가세별도</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr height="*">
		<td width="20%" rowspan="2">
			<comment id="__NSID__"><OBJECT id=gd_1 
			    style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%; HEIGHT: 100%" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AutoInsert" VALUE="0">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="AllShowEdit" VALUE="0">
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="Format" VALUE="
			     <C> Name='발주공종명'  id=profession_wbs_name  width=200  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  ">
				<PARAM NAME="DataID" VALUE="ds_1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="*" height="65%">
			<comment id="__NSID__"><OBJECT id=gd_2 
			    style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%; HEIGHT: 100%" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AutoInsert" VALUE="0">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="AllShowEdit" VALUE="0">
				<param name="ViewSummary"    value=1>
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="Format" VALUE="
			     <C> Name='현장명'  id=long_name  width=120  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
				                         SumText='합     계' SumColor=Black SumBgColor=Pink </C>
			     <C> Name='협력업체명'  id=sbcr_name  width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='계약금액'  id=sbc_amt  width=90  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
				           	                                        SumText=@sum          SumColor=Black SumBgColor=Pink</C>
			     <C> Name='전회기성*'  id=bef_prgs  width=91  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
				           	                                        SumText=@sum          SumColor=Black SumBgColor=Pink</C>
			     <C> Name='금회기성*'  id=cur_prgs  width=90  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
				           	                                        SumText=@sum          SumColor=Black SumBgColor=Pink</C>
			     <C> Name='누계기성*'  id=tot_prgs  width=90  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK 
				           	                                        SumText=@sum          SumColor=Black SumBgColor=Pink</C>
			     <C> Name='계약일자'  id=sbc_dt  width=67  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='대표자명'  id=rep_name1  width=60  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  ">
				<PARAM NAME="DataID" VALUE="ds_2"></OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
	</tr>
	<tr>
		<td height="*">
			<comment id="__NSID__"><OBJECT id=gd_3 
			    style="FONT-SIZE: 12px; Z-INDEX: 102; WIDTH: 100%; HEIGHT: 100%" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AutoInsert" VALUE="0">
			   <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="AllShowEdit" VALUE="0">
				<PARAM NAME="Editable" VALUE="0">
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="Format" VALUE="
			     <C> Name='기성년월'  id=yymm  width=60  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='차수'  id=prgs_degree  width=40  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='전회기성*'  id=c_bef_prgs  width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='금회기성*'  id=c_tm_prgs  width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
			     <C> Name='누계기성*'  id=c_tot_prgs  width=150  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
				  ">
				<PARAM NAME="DataID" VALUE="ds_3"></OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
	</tr>
</table></div>
</BODY></HTML>
