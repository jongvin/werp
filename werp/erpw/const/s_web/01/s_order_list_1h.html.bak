<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"> 
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : s_order_list_1h.html								-->
<!-- 2. 유형(시나리오): 조회및 입력															-->
<!-- 3. 기 능 정 의   : 발주목록 작성                        	-->
<!-- 4. 변 경 이 력   :  박두현 작성																		-->
<!-- 5. 관련프로그램  :																						-->
<!-- 6. 특 기 사 항   :																							-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
// <LINK rel="stylesheet" type="text/css" href="../../../comm_function/env.css">
var is_sw='N'      //발주내역으로 들어가며는 'Y'로 바꿈. ('Y':현설품의승인처리화면으로 되돌아가기위해 쿠키를 삭제 안함)
                   //('N':품의승인처리화면으로 되돌아가기위해 쿠키함)
var gs_home = top.frames['security'].gs_home.value
var gs_user_id = top.frames['security'].user_id.value
var gs_password = top.frames['security'].gs_password.value
var is_emp_dept_code = top.frames['security'].dept_code.value

var is_ds_1_addr = 's_order_list_1q.jsp?arg_dept_code='                        //발주 목록 
var is_ds_2_addr = 's_estimate_list_1q.jsp?arg_dept_code='                     //발주 목록별 견적업체들 
var is_ds_3_addr = 's_order_list_rt_1q.jsp'                     //매입세율 처리
var is_tr_1_addr = gs_home + '/const/s_web/01/s_order_list_1tr.jsp'
var is_tr_2_addr = gs_home + '/const/s_web/01/s_estimate_list_1tr.jsp'
var is_sbcr_code = ""
var is_dept_code = "",is_vattag,il_tax_rt,il_notax_rt
var is_dept_name = ""
var il_order_number = 9999
var il_screen = 1,is_chk=0,is_program_chk='Y'
var is_from_dt,is_to_dt

var ib_update = false
</SCRIPT>

<!-- ======================================================================= -->
<!--                                 Function                                -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript>
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	if (il_screen > 1){
	  div_btnquery_onclick()
	  return
	}   
	ds_1.DataID = is_ds_1_addr + is_dept_code
	ds_1.SyncLoad=true
	ds_1.Reset()
   if  (ds_1.CountRow < 1)     //상위가 한건도 없을경우 하위의 기존 데이타를 없애줌. 
       ds_2.ClearData() 	


     if (il_order_number != 9999)    // 현설품의 계약승인처리 화면에서 넘어왔느냐 체크 (넘어왔으며는 9999가 아닌 발주번호)
         ds_1.RowPosition =  ds_1.NameValueRow('order_number',il_order_number);

   // -------------------------발주내역으로 들어갔다가 다시 돌아왔을경우 해당 발주번호로 가기위해서 다음로직수행
   var result="";
	var array = new Array();
	result = readCookie("@s_order_detail@")
   if (result == "err") {
      return
   }
	else {
	   array = result.split("@");
      ll_order_number = parseInt(array[2])  //발주 번호
      ds_1.RowPosition = ds_1.ValueRow(2,ll_order_number)   // 2는 "order_number" column 임
      makeCookie("@s_order_detail@","")
    }
}
//---------------------------------------------------------------------------
function guljae_rtn()                      // 전자결재
//---------------------------------------------------------------------------
{
	var ls_addr,ll_temp

	ll_temp = ds_1.NameValue(ds_1.RowPosition,'dept_code') + '@' + ds_1.NameValue(ds_1.RowPosition,'order_number')

	ls_addr = 'https://www.worldro.net/loginsso.aspx?ui='
	ls_addr = ls_addr + gs_user_id + ':' + gs_password + '&unq=' + ll_temp + '&type=Y06'

	ll_height = screen.availHeight  -  40
	ll_width  = screen.availWidth
	window.showModalDialog(ls_addr,"","status:no;dialogWidth:777px;dialogHeight:737px;edge sunken;scroll:no");
}
//------------------------------------------------------------------------
function make_rt()                     // 매입세율 생성
//------------------------------------------------------------------------
{
	ds_3.DataID = is_ds_3_addr
	ds_3.SyncLoad=true
	ds_3.Reset()

	if (is_vattag == '2') {
		ds_3.AddRow()
		ds_3.NameValue(ds_3.RowPosition,'key_rt') = 100;
		ds_3.NameValue(ds_3.RowPosition,'data_rt') = 100;
	}
	if (is_vattag == '4') {
		ds_3.AddRow()
		ds_3.NameValue(ds_3.RowPosition,'key_rt') = il_notax_rt;
		ds_3.NameValue(ds_3.RowPosition,'data_rt') = il_notax_rt;
	}
}
//-----------------------------------------------------------------------
function init_move()                       // 초기값 세팅 
//------------------------------------------------------------------------
{
 ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
 ds_1.NameValue(ds_1.RowPosition,'order_class') = '1'
 ds_1.NameValue(ds_1.RowPosition,'chg_start_dt') = is_from_dt
 ds_1.NameValue(ds_1.RowPosition,'chg_end_dt') = is_to_dt
 ds_1.NameValue(ds_1.RowPosition,'ebid_yn') = '2'
 ds_1.NameValue(ds_1.RowPosition,'dept_proj_tag') = '1'
 ds_1.NameValue(ds_1.RowPosition,'open_yn') = 'N'
 ds_1.NameValue(ds_1.RowPosition,'bill_rt') = 100
 ds_1.NameValue(ds_1.RowPosition,'sbc_guarantee_rt') = 10
 ds_1.NameValue(ds_1.RowPosition,'warrant_guarantee_rt') = 3
 ds_1.NameValue(ds_1.RowPosition,'delay_rt2') = 0.3
 ds_1.NameValue(ds_1.RowPosition,'vat_class') = is_vattag
 ds_1.NameValue(ds_1.RowPosition,'dept_proj_tag') = '1'
 if (is_vattag == '2') {
 	ds_1.NameValue(ds_1.RowPosition,'buy_rt') = 100
 }
 else{
 	ds_1.NameValue(ds_1.RowPosition,'buy_rt') = 0
 }
 	
 if  (ds_1.CountRow > 1) {
      ds_1.NameValue(ds_1.RowPosition,"order_number") = ds_1.NameValue(ds_1.RowPosition + 1,"order_number") + 1
      ds_1.NameValue(ds_1.RowPosition,"approve_class") = "1"
      ds_1.NameValue(ds_1.RowPosition,"choice_kind") = "2"
      ds_1.NameValue(ds_1.RowPosition,'bef_order_number') = ds_1.NameValue(ds_1.RowPosition + 1,"order_number") + 1
      ds_1.NameValue(ds_1.RowPosition,'re_est_cnt') = 1
      ds_1.NameValue(ds_1.RowPosition,'cancel_yn') = 'N'
 }   
 else {      
      ds_1.NameValue(ds_1.RowPosition,"order_number") = 1
      ds_1.NameValue(ds_1.RowPosition,"approve_class") = "1"
      ds_1.NameValue(ds_1.RowPosition,"choice_kind") = "2"
      ds_1.NameValue(ds_1.RowPosition,'bef_order_number') = 1
      ds_1.NameValue(ds_1.RowPosition,'re_est_cnt') = 1
      ds_1.NameValue(ds_1.RowPosition,'cancel_yn') = 'N'
 }   
 
	ds_1.NameValue(ds_1.RowPosition,"br_place") = '현장사무실'
	ds_1.NameValue(ds_1.RowPosition,"pr_place") = '본사'
	ds_1.NameValue(ds_1.RowPosition,"bill_pay") = '기업구매자금'
//	ds_1.NameValue(ds_1.RowPosition,"warrant_guarantee_rt") = 3
//	ds_1.NameValue(ds_1.RowPosition,"sbc_guarantee_rt") = 10
//	ds_1.NameValue(ds_1.RowPosition,"delay_rt2") = 0.3
	ds_1.NameValue(ds_1.RowPosition,"pay_mat") = '없음'
	ds_1.NameValue(ds_1.RowPosition,"mat_etc") = '지급자재외 일체(주자재, 소모잡자재, 가설재, 공구, 양중장비등)'
	ds_1.NameValue(ds_1.RowPosition,"elec_remark") = '당사지급(분전반까지 당사부담)'
	ds_1.NameValue(ds_1.RowPosition,"wat_remark") = '당사지급(작업구간까지 용수라인설치 추가비용은 "을"이 부담)'
	ds_1.NameValue(ds_1.RowPosition,"adjust_note") = '실시공 물량정산(필요시 Item 추가할 것, 물량 및 단가누락, 계산착오, 오기등 견적착오는 인정하지 않음)'
	ds_1.NameValue(ds_1.RowPosition,"note") = '-안전관리비, 산재보험 제외\n-근재보험(인당 1억, 건당 2억)포함\n (계약과 동시에 증권제출 하여야 함)'
	ds_1.NameValue(ds_1.RowPosition,"prgs_pay2") = '월 1회 어음 100%(기업구매자금)'
	
} 

//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
 if  (is_dept_code == "") {
     alert("현장을 선택하십시요(검색을 누르십시요)")
      return
 }     
 if ( is_vattag == '') {
 	alert('현장에 대한 과세구분을 등록하시고 작업하십시오...')
 	return
 }

if (il_screen > 1) {
   div_btnadd_onclick()
   return
}   
else {
	if( is_program_chk == 'N') {
		return
	}
}
btninsert_onclick()
set_vat()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
 if  (is_dept_code == "") {
     alert("현장을 선택하십시요(검색을 누르십시요)")
      return
 }     
 if ( is_vattag == '') {
 	alert('현장에 대한 과세구분을 등록하시고 작업하십시오...')
 	return
 }
 if (il_screen > 1) {
   div_btninsert_onclick()
   return
 }
 else {
	if( is_program_chk == 'N') {
		return
	}
}
if  (ds_1.CountRow > 0) { 
     ds_1.RowPosition=1
     ds_1.InsertRow(ds_1.RowPosition)
 }    
 else 
     ds_1.AddRow()
 init_move()
 set_vat()
}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
  if (il_screen > 1) {
  div_btndelete_onclick()
  return
  }
  else {
	if( is_program_chk == 'N') {
		return
	}
}
if  (ds_2.CountRow > 0) {
      alert("업체가 등록되어 있어서 삭제할수 없습니다")
      return
  }
  
  ls_approve_class = ds_1.NameValue(ds_1.RowPosition,"approve_class")
  if (ls_approve_class != "1" ) {
      alert("작성중에서만 삭제 할수 있습니다")
      return
  }    
  
  ll_order_number = ds_1.NameValue(ds_1.RowPosition,"order_number")       
  ds_1.DeleteRow(ds_1.RowPosition) 
  if  (confirm("삭제되었습니다 저장하시겠습니까?")){
	   arg_cmd = "delete from s_order_detail   " +   
	                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
	                 "         order_number = " + ll_order_number + "  "  
	   f_update_sql(arg_cmd)
	   arg_cmd = "delete from s_order_parent   " +   
	                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
	                 "         order_number = " + ll_order_number + "  "  
	   f_update_sql(arg_cmd)
      tr_1.Post()
  }
  else
      btnquery_onclick()
 
 }
 
//---------------------------------------------------------------------------
function btnsave_condition()                       // 저장 조건 체크로직 
//---------------------------------------------------------------------------
{
  
 if (ds_1.NameValue(ds_1.RowPosition,"order_wbs_code") == "") {
     alert("발주공종은 반드시 입력되어야 합니다")
     return false
 }
 return true     
} 
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
 if (il_screen > 1) {
    div_btnsave_onclick()
    return
 } 
   
 if (btnsave_condition()) {}
 else
   return
   
  if (ds_1.IsUpdated){
		 if (f_start_end_chk()) {}                  //종료일자가 시작일자보다 큰지를 check
		 else return 
      
      if  (confirm("변경되었습니다 저장하시겠습니까?"))
          tr_1.Post()
   }
	IFrame_upload.btnsave_onclick()
}
//------------------------------------------------------------------------
function f_start_end_chk()                       //종료일자가 시작일자보다 반드시 크거나 같아야하는 로직 체크
//------------------------------------------------------------------------
{

  var ll_ret_row
     ll_ret_row = gf_gd_start_end_date('ds_1','start_dt','end_dt')
	  if (ll_ret_row > 0)  {
	     alert('당공종 공사기간의 종료일자가 시작일자보다 반드시 커야합니다')
	     ds_1.RowPosition = ll_ret_row	      
	     return false
	  }   
  return true        
}
//------------------------------------------------------------------------
function f_get_parent_key()                     // IFrame_upload에서 호출하는 함수 parent_key 를 return   ....이펑션을 추가하고 job_code, dir_name, title, parent_key 세팅.....
//------------------------------------------------------------------------
{
   IFrame_upload.is_job_code = 'S';							//업무 코드
   IFrame_upload.is_dir_name = '외주관리';		//저장될폴더지정
   IFrame_upload.is_title = '현설';								//화면제목

	var ls_parent_key = ds_1.NameValue(ds_1.RowPosition,"dept_code") + ds_1.NameValue(ds_1.RowPosition, "order_number");

	return ls_parent_key;
}

//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
 if (il_screen > 1) {
    div_btncancel_onclick()
    return
 }   
  ds_1.Undo(ds_1.RowPosition)
}
//----------------------------------------------------------------------
function div_init_move()                         //하위 공통 initial move
//----------------------------------------------------------------------
{
  ds_2.NameValue(ds_2.RowPosition,"dept_code") = is_dept_code
  ds_2.NameValue(ds_2.RowPosition,"order_number") = ds_1.NameValue(ds_1.RowPosition,"order_number")
  ds_2.NameValue(ds_2.RowPosition,"re_est_yn") = '1'
  ds_2.NameValue(ds_2.RowPosition,"est_yn") = 'N'
  ds_2.NameValue(ds_2.RowPosition,"injung_yn") = 'Y'

  if (is_emp_dept_code.substr(2,1) >= '5')
     ds_2.NameValue(ds_2.RowPosition,"recommender_department") = '현장'
  else     
     ds_2.NameValue(ds_2.RowPosition,"recommender_department") = '본사'
  

}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{

 if (ds_1.CountRow < 1) return
 
 ds_2.DataID = is_ds_2_addr +  is_dept_code + "&arg_order_number=" + ds_1.NameValue(ds_1.RowPosition,"order_number")
 ds_2.SyncLoad=true
 ds_2.Reset()
 
    IFrame_upload.btnquery_onclick(f_get_parent_key()) 

}
//-----------------------------------------------------------------------
function div_btnadd_onclick()                    //하위 추가
//-----------------------------------------------------------------------
{
  ls_approve_class = ds_1.NameValue(ds_1.RowPosition,"approve_class")
  if (ls_approve_class == "4" || ls_approve_class == "5") {
      alert("승인 혹은 선정이 되어서 추가 할수 없습니다")
      return
  }    
	if( is_program_chk == 'Y' && ls_approve_class != '1') {
		alert('작성중에서만 처리 가능합니다...')
		return
	}

   sbc_search()
}
//-----------------------------------------------------------------------
function div_btninsert_onclick()                    //하위 삽입.
//-----------------------------------------------------------------------
{
  ls_approve_class = ds_1.NameValue(ds_1.RowPosition,"approve_class")
  if (ls_approve_class == "4" || ls_approve_class == "5") {
      alert("승인 혹은 선정이 되어서 삽입 할수 없습니다")
      return
  }    
	if( is_program_chk == 'Y' && ls_approve_class != '1') {
		alert('작성중에서만 처리 가능합니다...')
		return
	}



   sbc_search()

}

//------------------------------------------------------------------------
function div_btndelete_onclick()                //하위 삭제
//------------------------------------------------------------------------
{
  ls_sbcr_code = ds_2.NameValue(ds_2.RowPosition,"sbcr_code")

  ls_approve_class = ds_1.NameValue(ds_1.RowPosition,"approve_class")
  if (ls_approve_class != "1" && is_program_chk == 'Y' ) {
      alert("작성중에서만 삭제 할 수 있습니다")
      return
  }    
  if (is_program_chk == 'N' && ls_approve_class != '2') {
  		alert('요청중인 자료만 삭제 할 수 있습니다...')
  		return
  	}

  ds_2.DeleteRow(ds_2.RowPosition)  
  
  ll_order_number = ds_1.NameValue(ds_1.RowPosition,"order_number")
  if  (confirm("삭제되었습니다 저장하시겠습니까?")){
	   arg_cmd = "delete from s_estimate_detail   " +   
	                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
	                 "         order_number = " + ll_order_number + " and "   + 
			           "         sbcr_code  = '" + ls_sbcr_code + "'   "   
	   f_update_sql(arg_cmd)
	   arg_cmd = "delete from s_estimate_detail_web   " +   
	                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
	                 "         order_number = " + ll_order_number + " and "   + 
			           "         sbcr_code  = '" + ls_sbcr_code + "'   "   
	   f_update_sql(arg_cmd)
	   arg_cmd = "delete from s_estimate_parent   " +   
	                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
	                 "         order_number = " + ll_order_number + " and "   + 
			           "         sbcr_code  = '" + ls_sbcr_code + "'   "   
	   f_update_sql(arg_cmd)
	   arg_cmd = "delete from s_estimate_parent_web   " +   
	                 "  where  dept_code = '" + is_dept_code + "'  and "   + 
	                 "         order_number = " + ll_order_number + "  and "   + 
			           "         sbcr_code  = '" + ls_sbcr_code + "'   "   
	   f_update_sql(arg_cmd)
      tr_2.Post()
      div_btnquery_onclick()
  }
  else
      div_btnquery_onclick()

 }
//---------------------------------------------------------------------------
function div_btnsave_onclick()                  //하위 저장 
//---------------------------------------------------------------------------
{

 tr_2.Action = is_tr_2_addr
// dup check logic   	
  if (ds_2.IsUpdated){
	 var ll_dup
	 ll_dup = f_dup_chk("ds_2","sbcr_code")
	 if (ll_dup > 0) {
	     alert("업체가 중복되었습니다: 업체를 수정하십시요 ")
	     ds_2.RowPosition = ll_dup
     	  gd_2.SetColumn("sbcr_code");
	     return false
	 }
  }

 if ((ds_2.IsUpdated)  ||  (ds_1.IsUpdated)) {
    if  (confirm("변경되었습니다 저장하시겠습니까?")) {
		  if (btnsave_condition()) {}
		  else 
		      return false
		      
			if (ds_1.IsUpdated) {
				 if (f_start_end_chk()) {}                  //종료일자가 시작일자보다 큰지를 check
					 else return 
				     tr_1.Post()
			}

        for(i=1; i<= ds_2.CountRow; i++) {
            if  (ds_2.NameValue(i,"select_yn") == 'T')
                ds_2.NameValue(i,"select_yn") = 'Y'
            else
                ds_2.NameValue(i,"select_yn") = 'N'
        
            if  (ds_2.NameValue(i,"pr_yn") == 'T')
                ds_2.NameValue(i,"pr_yn") = 'Y'
            else
                ds_2.NameValue(i,"pr_yn") = 'N'
        
            if  (ds_2.NameValue(i,"est_yn") == 'T')
                ds_2.NameValue(i,"est_yn") = 'Y'
            else
                ds_2.NameValue(i,"est_yn") = 'N'
        }
		if (ds_2.IsUpdated) 
          tr_2.Post()
      div_btnquery_onclick()
   }
   else {
   	return false
   }
 } 
 return true
}
//----------------------------------------------------------------------------
function div_btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
  ds_2.Undo(ds_2.RowPosition)
}


//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_1.IsUpdated) {
     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
        {  //저장 routine
        }   
 
   }     
top.frames['main_ct'].location.href(ls_arg)
top.frames['main_title'].div_r.style.visibility="hidden"             
top.frames['main_title'].div_u.style.visibility="hidden"             

// top.frames['main_ct'].window.close()     
}
//---------------------------------------------------------------------------
function dept_code_find()                       //현장 찾기 
//---------------------------------------------------------------------------
{
is_chk = 1
	result = f_dept_code_find(dept_name.value)
	if (result==false)return
	
	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value

	f_select2_q("select vattag select_1,tax_rate select_2,free_rate select_3,chg_const_start_date select_4,chg_const_end_date select_5 from z_code_dept where dept_code = '" + is_dept_code + "'")
	is_vattag   = ds_select2.NameValue(ds_select2.RowPosition,'select_1')
	il_tax_rt   = ds_select2.NameValue(ds_select2.RowPosition,'select_2')
	il_notax_rt = ds_select2.NameValue(ds_select2.RowPosition,'select_3')
	is_from_dt  = ds_select2.NameValue(ds_select2.RowPosition,'select_4')
	is_to_dt    = ds_select2.NameValue(ds_select2.RowPosition,'select_5')
	make_rt()
	dept_name.value = is_dept_name
	il_screen = 1
	btnquery_onclick()
}   
//---------------------------------------------------------------------------
function  sbc_search()
//---------------------------------------------------------------------------
{
	var result,ll_cnt=0,i,j,ll_row,ll_chk=0,ll_find;
	var array = new Array();
	row = ds_2.RowPosition
	ls_data ="@" + ds_1.NameValue(ds_1.RowPosition,"profession_wbs_code")
	result = window.showModalDialog(gs_home + "/const/s_web/00/s_sbcr_search_order_1h.html",ls_data,"dialogWidth:800px;dialogHeight:600px");
	if(result == "") return false
	
	array = result.split("@");
	ll_chk = parseInt(array[0],10);
	
	if (ll_chk > 0) {
		for (i=1;i<=ll_chk;i++){
			j = i * 3 - 2;
			ll_find = ds_2.NameValueRow('sbcr_code', array[j]);
			if (ll_find < 1) {
				ds_2.AddRow()
			   ll_row = ds_2.RowPosition
			   div_init_move()
			   ds_2.NameValue(ll_row,'sbcr_code') = array[j]
			   ds_2.NameValue(ll_row,'profession_wbs_code') = array[j+1]
				ll_cnt = f_select2_q("select sbcr_name select_1,rep_name1 select_2,tel_number1 select_3 from s_sbcr where sbcr_code = '" + array[j] + "'")
				if (ll_cnt > 0 ) {
				  ds_2.NameValue(ll_row,"sbcr_name")   = ds_select2.NameValue(ds_select.RowPosition,'select_1');   // 협력업체 명 
				  ds_2.NameValue(ll_row,"rep_name1")   = ds_select2.NameValue(ds_select.RowPosition,'select_2');   // 대표자명 
				  ds_2.NameValue(ll_row,"tel_number1") = ds_select2.NameValue(ds_select.RowPosition,'select_3');   // 전화번호   
				}
				ll_cnt = f_select2_q("select profession_wbs_name select_1,register_chk select_2 from s_wbs_request where sbcr_code = '" + array[j] + "' and profession_wbs_code = '" + array[j+1] + "'")
				if (ll_cnt > 0 ) {
				  ds_2.NameValue(ll_row,"profession_wbs_name")   = ds_select2.NameValue(ds_select.RowPosition,'select_1');  
				  ds_2.NameValue(ll_row,"register_chk")   = ds_select2.NameValue(ds_select.RowPosition,'select_2'); 
				}
			}
		}
	}	  	

}
//---------------------------------------------------------------------------
function  order_wbs_search()
//---------------------------------------------------------------------------
{
	var result;
	var ls_approve_class
	
	ls_approve_class = ds_1.NameValue(ds_1.RowPosition,'approve_class')
//kdw 	if (ls_approve_class != '1') return
	
   ls_data = ds_1.NameValue(ds_1.RowPosition,"s_order_wbs_name")
	var array = new Array();
	result = window.showModalDialog(gs_home + "/const/s_web/00/s_profession_wbs_search_1h.html", ls_data,"dialogWidth:600px;dialogHeight:500px");
	if(result == "") return;
	array = result.split("@");
   ds_1.NameString(ds_1.RowPosition,"profession_wbs_code") = array[0];   // 발주 전문공종코드  
   ds_1.NameString(ds_1.RowPosition,"s_order_wbs_name") = array[1];   // 발주전문공종명
//   if (tx_order_name.value == '') {
 if (ls_approve_class == '1') 
	     tx_order_name.value = array[1]
//   }
   
}  
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//---------------------------------------------------------------------------
function f_set_resize()
//---------------------------------------------------------------------------
{
	var objArr = new Array('gd_2', 'div_file_upload');
	var xArr   = new Array(false,false);
	var yArr   = new Array(true,true);

	f_reSize(objArr, xArr, yArr);
}  
//------------------------------------------------------------------------
function request_rtn()                       //요청처리
//------------------------------------------------------------------------
{
	var ls_approve_class,ls_pr_dt,ls_estimate_dt,ls_profession_wbs_code,ls_sa_row,ls_br_dt
	var ll_order,ll_chk,ls_vat_class
	if (ds_1.RowPosition < 1 ) return
	
	ls_approve_class = ds_1.NameValue(ds_1.RowPosition,'approve_class')
	ls_br_dt = ds_1.NameValue(ds_1.RowPosition,'br_date')
	ls_pr_dt = ds_1.NameValue(ds_1.RowPosition,'pr_dt')
	ls_estimate_dt = ds_1.NameValue(ds_1.RowPosition,'estimate_dt')
	ls_profession_wbs_code = ds_1.NameValue(ds_1.RowPosition,'profession_wbs_code')
	ls_vat_class = ds_1.NameValue(ds_1.RowPosition,'vat_class')
	
	
	if (ls_profession_wbs_code == ''){
		alert('발주공종을 반드시 선택해야만 요청이 가능합니다...')
		return
	}
	if (ls_approve_class != '1') {
		alert('작성중에서만 요청이 가능합니다...')
		return
	}
//	if (ls_pr_dt == '') {
//		alert('입찰일시는 반드시 입력되어야 요청이 가능합니다...')
//		return
//	}
	if (ls_br_dt == '') {
		alert('현설일시는 반드시 입력되어야 요청이 가능합니다...')
		return
	}
	if (ls_estimate_dt == '') {
		alert('견적제출일시는 반드시 입력되어야 요청이 가능합니다...')
		return
	}
	if (ls_vat_class == '') {
		alert('부가세구분이 등록되어야 요청이 가능합니다...')
		return
	}
	
	ll_order = ds_1.NameValue(ds_1.RowPosition,'order_number')
	f_select2_q("select nvl(count(*),0) select_1 from s_order_parent where dept_code = '" + is_dept_code + "' and order_number =" + ll_order + " and direct_class = '3'")
	if (ds_select2.ErrorCode != 0) {alert("에러발생");return;}
	ll_chk = ds_select2.NameValue(ds_select2.RowPosition,'select_1')
//	if (ll_chk == 0 && ds_1.NameValue(ds_1.RowPosition,'buy_rt') != 0 ){
//		alert('발주내역에 매입세가 존재하지않아 요청 할 수 없습니다...')
//		return
//	}
//

	if  (confirm("승인요청을하면 수정할 수 없습니다 계속하시겠습니까?")){
	}
	else {
		return
	}
	
	if (ds_1.IsUpdated || ds_2.IsUpdated){
	   if  (confirm("변경되었습니다 저장하시겠습니까?")){
			 if (f_start_end_chk()) {}                  //종료일자가 시작일자보다 큰지를 check
			 else {
			 	alert('요청처리가 취소되었습니다...')
			 	return 
			 }
	       tr_1.Post()
	       tr_2.Post()
	   }
	}

	if (ds_2.CountRow == 0) {
	  alert("참가 업체가 한건도 없기때문에 요청할수 없습니다")
	  return 
	}    
	else {
		 var ll_order_number = 0
		 ll_order_number = ds_1.NameValue(ds_1.RowPosition, "order_number")
		 ll_cnt = f_select2_q("select count(dept_code) select_1 from s_order_detail " +
		 							 "where dept_code = '" + is_dept_code + "' and " +
		 							 "order_number = " + ll_order_number )
		 if (ds_select2.ErrorCode != 0) {alert("에러발생");return;}
		 if ( ds_select2.NameValue(1, "select_1") <= 0 ) {
		 	 alert("발주내역을 작성하지 않으면 승인요청을 할수 없습니다.")
		 	 return 
		 }
	}

	ll_cnt = f_select2_q("SELECT F_ORDER_LIST_CHK('" + is_dept_code + "'," + ll_order_number + ") select_1 from dual")
	if (ds_select2.ErrorCode != 0) {alert("에러발생");return;}
	if (ds_select2.NameValue(ds_select2.RowPosition,'select_1') > 0) {
		alert(ds_select2.NameValue(ds_select2.RowPosition,'select_1'))
		alert("발주내역에 잘못된 자료가 존재합니다.");
		return;
	}

	ld_date = f_sysdate()
	ds_1.NameValue(ds_1.RowPosition,"request_dt")  = ld_date
	ds_1.NameValue(ds_1.RowPosition,"approve_class") = '2'
	tr_1.post()
	ls_sa_row = ds_1.RowPosition
	il_screen = 1
	btnquery_onclick()
	ds_1.RowPosition = ls_sa_row
}
//---------------------------------------------------------------------------
function order_detail()                        //발주내역 들어가기 
//---------------------------------------------------------------------------
{
  if (div_btnsave_onclick()) {}
  else
     return
   if (ds_1.CountRow < 1) {
       alert('추가를 하여서 목록을 먼저 작성하십시요')
       return
   }      
   is_sw='Y'   // WINDOW ONUNLOAD(CLOSE EVENT)에서 계약승인처리 쿠키를 삭제 안함. 
  ls_data = ds_1.NameValue(ds_1.RowPosition,"dept_code") + "@" + is_dept_name + "@" +
            ds_1.NameValue(ds_1.RowPosition,"order_number") + "@" + 
            ds_1.NameValue(ds_1.RowPosition,"approve_class") + "@" + 
            ds_1.NameValue(ds_1.RowPosition,"order_name") + "@" + gf_initial_security()
  makeCookie("@s_order_detail@",ls_data)
  if  ((ds_1.NameValue(ds_1.RowPosition,"approve_class") == "2") || (ds_1.NameValue(ds_1.RowPosition,"approve_class") == "3") || 
       (ds_1.NameValue(ds_1.RowPosition,"approve_class") == "4") || (ds_1.NameValue(ds_1.RowPosition,"approve_class") == "5") || 
       (ds_1.NameValue(ds_1.RowPosition,"approve_class") == "6"))
     top.frames['main_ct'].location.href(gs_home + "/const/s_web/01/s_order_detail_1h.html" +"?"+'r')
  else
     top.frames['main_ct'].location.href(gs_home + "/const/s_web/01/s_order_detail_1h.html" +"?"+'u')
}  

//---------------------------------------------------------------------------
function sbc_ret()     //현설품의  승인 처리로 가기  
//---------------------------------------------------------------------------
{
 top.frames['main_ct'].location.href(gs_home + "/const/s_web/01/s_order_approve_process_1h.html" +"?"+'r')
}
//---------------------------------------------------------------------
function window_onunload()
//---------------------------------------------------------------------
{
   if (is_sw == 'N')                      // 계약내역으로 들어가지않았으므로 쿠키 정보를 지움.  
       makeCookie("@s_order_list_ret@","")
}

//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_screen = focus
}
//------------------------------------------------------------------------
function set_vat()    // 매입세 변경시 부가세 변경
//------------------------------------------------------------------------
{
	var ls_buy_rt
	ls_buy_rt = ccom_buy_rt.CodeValue
	em_vat_rt.Text = 100.0 - parseFloat(ls_buy_rt)
}
//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
  
   top.frames['main_title'].mouse_over()
   top.frames['main_title'].title_name.value = " " + "현설계획"  

	 ll_cnt = f_select_q("select etc_code select_1, child_name select_2  from z_code_etc_child where class_tag = '020' order by etc_code") //승인구분
    ll_cnt = f_select1_q("select CORPORATION_SECTION select_1, SECTION_NAME select_2  from S_CODE_CORPORATION   order by CORPORATION_SECTION")   //등록구분
	

	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	
	f_select2_q("select chg_const_start_date select_1,chg_const_end_date select_2 from z_code_dept where dept_code = '" + is_dept_code + "'")
	is_from_dt  = ds_select2.NameValue(ds_select2.RowPosition,'select_1')
	is_to_dt    = ds_select2.NameValue(ds_select2.RowPosition,'select_2')

	dept_name.value = is_dept_name

   result = readCookie("@s_order_list_ret@")   //현설품의  승인 처리 에서 왔는지 체크하는 곳.
   if (result == "err") {
       div_sbc_ret.style.visibility="hidden"
       is_program_chk = 'Y'
   }
   else {
   		is_program_chk = 'N'
        	var array = new Array();
	      array = result.split("@");
         is_dept_code = array[0]     // 승인처리에서 넘어온 부서코드
         is_dept_name = array[1]     // 승인처리에서 넘어온 부서명
         il_order_number = parseInt(array[2])  // 승인처리에서 넘어온 발주번호
         dept_name.value = is_dept_name
         div_sbc_ret.style.visibility="visible"
   }       

	f_select2_q("select vattag select_1,tax_rate select_2,free_rate select_3 from z_code_dept where dept_code = '" + is_dept_code + "'")
	is_vattag   = ds_select2.NameValue(ds_select2.RowPosition,'select_1')
	il_tax_rt   = ds_select2.NameValue(ds_select2.RowPosition,'select_2')
	il_notax_rt = ds_select2.NameValue(ds_select2.RowPosition,'select_3')
	make_rt()
	tr_1.Action = is_tr_1_addr
	tr_2.Action = is_tr_2_addr
	setTimeout('btnquery_onclick()',1)
   tb_1.ActiveIndex=3
   setTimeout('tb_1.ActiveIndex=1',1)
}
</SCRIPT>

<!-- ======================================================================= -->
<!--                                   Event                                 -->
<!-- ======================================================================= -->
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code(tr_1) : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code(tr_2) : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=em_directamt_rt event=onKillFocus()>
	if (em_directamt_rt.Modified){ 
		em_bill_rt.text = 100 - parseInt(em_directamt_rt.text,10);
	}
</SCRIPT>        	

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
{

  if  (row < 1) return;
  var i
  if (ds_1.NameValue(row,"approve_class") != '1' && ds_1.NameValue(row,"approve_class") != '') {
		gf_protect_on('tab_page_1')
		gf_protect_on('tab_page_2')
		gf_protect_on('tab_page_3')
		gd_2.Editable=false
		IFrame_upload.btn_add.style.visibility='hidden'
		IFrame_upload.btn_del.style.visibility='hidden'
		IFrame_upload.gd_1.Editable=false
bt_order_wbs_code.ReadOnly = false
tx_s_order_wbs_name.contentEditable = true
  }		
  else {
		gf_protect_off('tab_page_1')
		gf_protect_off('tab_page_2')
		gf_protect_off('tab_page_3')
		gd_2.Editable=true
		em_chg_start_dt.ReadOnly = true
		em_chg_end_dt.ReadOnly = true
		em_bill_rt.ReadOnly = true
		em_cnt_amt.ReadOnly = true
		em_exe_amt.ReadOnly = true
		em_approve_dt.ReadOnly = true
		em_request_dt.ReadOnly = true
		IFrame_upload.btn_add.style.visibility='visible'
		IFrame_upload.btn_del.style.visibility='visible'
		IFrame_upload.gd_1.Editable=true
		
  }
 
  div_btnquery_onclick()  
}  

</SCRIPT>
<script language=JavaScript for=em_order_number event=onKillFocus()>
	var ll_order,ll_chk
	ll_order = ds_1.OrgNameValue(ds_1.RowPosition,'order_number')
	f_select2_q("select nvl(count(*),0) select_1 from s_order_parent where dept_code = '" + is_dept_code + "' and order_number =" + ll_order )
	ll_chk = ds_select2.NameValue(ds_select2.RowPosition,'select_1')
	if (ll_chk != 0){
		alert('발주내역에 자료가 존재하여 발주번호를 변경 할 수 없습니다...')
		em_order_number.text = ds_1.OrgNameValue(ds_1.RowPosition,'order_number')
		ds_1.NameValue(ds_1.RowPosition,'order_number') = ds_1.OrgNameValue(ds_1.RowPosition,'order_number')
//		return false
	}
	return true
</SCRIPT>

<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>
	var ll_order,ll_chk
	if (colid == 'buy_rt' && is_chk == 0){
		ll_order = ds_1.NameValue(row,'order_number')
		f_select2_q("select nvl(count(*),0) select_1 from s_order_parent where dept_code = '" + is_dept_code + "' and order_number =" + ll_order + " and direct_class = '3'")
		ll_chk = ds_select2.NameValue(ds_select2.RowPosition,'select_1')
		if (ll_chk != 0 && ds_1.NameValue(row,'buy_rt') == 0 ){
			is_chk = 1;
			ds_1.NameValue(row,'buy_rt') = ds_1.OrgNameValue(row,'buy_rt');
			ccom_buy_rt.DataValue = ds_1.OrgNameValue(row,'buy_rt');
			alert('발주내역에 매입세가 존재하여 매입세율을 0%로 할 수 없습니다...')
		}
	}
	if (colid == 'order_number') {
		ds_1.NameValue(ds_1.RowPosition,'bef_order_number') = ds_1.NameValue(ds_1.RowPosition,'order_number')
	}
	is_chk = 0;
</script>


<SCRIPT language=JavaScript event=OnSelChanged(nIndex) for=tb_1>
{ 
 }             
</SCRIPT>
<SCRIPT language=JavaScript event=CanSelChange(nIndex) for=tb_1>
{
} 
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnClick(row,colid)>
  if (ds_1.NameValue(ds_1.RowPosition,"approve_class") == '4' || ds_1.NameValue(ds_1.RowPosition,"approve_class") == '5') 
     return

//if (colid == "pr_yn") {
//   if (ds_2.NameValue(row,colid) == 'T')
//       ds_2.NameValue(row,colid) = 'F'
//   else
//       ds_2.NameValue(row,colid) = 'T'    
//}

</SCRIPT>

<SCRIPT language=JavaScript for=gd_1 event=OnDblClick(row,colid)>
	ds_1.RowPosition=row
	order_detail()
</SCRIPT>

<script language=JavaScript for=ccom_buy_rt event=onSelChange()>
	set_vat()
</script>
<!-- ======================================================================= -->
<!--                                 Component                               -->
<!-- ======================================================================= -->
<comment id="__NSID__"><OBJECT id=ds_update
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_sysdate
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 10px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 10px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 10px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 10px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:s_order_list_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:s_estimate_list_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>

</HEAD>

<!-- ======================================================================= -->
<!--                                   Body                                  -->
<!-- ======================================================================= -->
<BODY style="FONT-SIZE: 12px; margin: 0px;" onload=setTimeout('window_onload()',1) onunload=window_onunload() oncontextmenu="return false">
<div class=main_div>
<table border="0" width="100%" height="100%" cellspacing="0">
	<tr height="20px">
		<td class=td_green colspan="2">
			<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0" class=main_table>
				<tr>
					<td width="15px"><img src="../../../image/bullet3.gif"></td>
					<td width="43px" class=font_green_bold>현장명</td>
					<td width="166px">
						<INPUT style="FONT-SIZE:12px;" id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" style=" FONT-SIZE: 12px;" size="25" onkeyDown="keyDown()">
					</td>
					<td width="60px">
						<INPUT  type=button  class="img_btnFind"  value=검색 onclick=dept_code_find() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
					</td>
					<td width="*">&nbsp;</td>
					<td align="right">
						<INPUT  type=button  class="img_btn4_1"  value=승인요청 onclick=request_rtn() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						<INPUT  type=button  class="img_btn6_1"  value=발주내역작성 onclick=order_detail() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"> &nbsp;&nbsp;
					</td>
					<td width="50px">
						<div id=div_sbc_ret> 
							<INPUT type=button  class="img_btnClose"  value=닫기 onclick=sbc_ret() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
						</div>           
	 				</td>
				</tr>                 
	      </table>
		</td>
	</tr>
	<tr height="70%">
		<td width="34%">
			<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
			    style="FONT-SIZE: 12px; Z-INDEX: 105; width: 100%; height: 100%;" 
			    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
				<PARAM NAME="MultiRowSelect" VALUE="0">
				<PARAM NAME="AllShowEdit" VALUE="-1">
				<PARAM NAME="Editable" VALUE="0">
			    <PARAM NAME="BorderStyle"  VALUE=1>
				<PARAM NAME="ColSizing" VALUE="-1">
				<PARAM NAME="DataID" VALUE="ds_1">
				<PARAM NAME="Format" VALUE=" 
				  <C> Name=발주번호 ID=order_number  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C>
				  <C> Name=승인구분 ID=approve_class  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center EditStyle=Lookup Data='ds_select:select_1:select_2' HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
				  <C> Name=발주명 ID=order_name  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=200 </C> 
			      ">
			</OBJECT></comment> <script> __ws__(__NSID__);</script>
		</td>
		<td width="66%">
			<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0">
				<tr height="20px">
					<td>
						<comment id="__NSID__"><OBJECT id=tb_1 
						    style="FONT-SIZE: 12px; Z-INDEX: 200; WIDTH: 100%; HEIGHT: 100%;" 
						    classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
						  <param name="BackColor"  value="#BBE0F4">
						  <param name="TextColor"  value="BLACK">
						  <PARAM NAME="Format" VALUE="
						    <T>divid=tab_page_1 title=현설품의</T>
						    <T>divid=tab_page_2 title=현설일반</T>
						    <T>divid=tab_page_3 title=현설결과</T>
						   ">
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
				</tr>
				<tr>
					<td>
				  <DIV id=tab_page_1 
				         style="WIDTH: 100%; HEIGHT: 100%; POSITION: absolute;" >
				      <table width="100%"  height="100%"  BORDER="1" CELLSPACING="0" align="center" >
				         <tr BGCOLOR="white" > 
				         	<td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3 > 
				            	<div align="right">*발주번호</div></td>
				            <td width="10%" colspan=2> 
									<comment id="__NSID__"><OBJECT id=em_order_number   
		                        style="WIDTH: 40px"
							         classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
			                        <param name=ReadOnlyBackColor  value=silver>
			                        <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
<!--             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
                 <div align="right">전자입찰여부</div></td>
             <td width="10%" colspan=2 > 
					  <comment id="__NSID__"><OBJECT id=ccom_ebid_yn 
                         style="WIDTH:60px"
					          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
							  <PARAM NAME="Alignment" VALUE="1">
						      <param name=Data     value="1^예,2^아니오">
				            <param name=DataID     value=ds_1>
		                  <param name=Auto       value=false>
                        <param name=Enable     value=true>
						      </OBJECT></comment> <script> __ws__(__NSID__);</script></td> -->
				            <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				            	<div align="right">계약부서</div></td>
				            <td width="10%" colspan=2 > 
									  <comment id="__NSID__"><OBJECT id=ccom_dept_proj_tag 
				                         style="WIDTH:60px"
									          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
										      <param name=Data     value="1^본사,2^현장">
								            <param name=DataID     value=ds_1>
						                  <param name=Auto       value=false>
				                        <param name=Enable     value=true>
										      </OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2  > 
				                 <div align="right">발주구분</div></td>
				             <td width="15%" colspan=3 > 
									  <comment id="__NSID__"><OBJECT id=ccom_order_class 
				                         style="WIDTH:80px"
									          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
										      <param name=Data     value="1^외주,2^납품설치">
								            <param name=DataID     value=ds_1>
						                  <param name=Auto       value=false>
				                        <param name=Enable     value=true>
										      </OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2   > 
				                 <div align="right" >요청일자</div></td>
				             <td width="15%"  colspan=3 > 
									   <comment id="__NSID__"><OBJECT id=em_request_dt tabindex=-1 READONLY
				                         style="WIDTH: 80px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="YYYY-MM-DD">
				                       <param name=ReadOnly   value=true>
				                        <param name=ReadOnlyForeColor        value=black>
				                        <param name=ReadOnlyBackColor       value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">*발주공종</div></td>
				             <td width="60%" colspan=12> 
				                  <INPUT style="FONT-SIZE:12px;" id=tx_order_wbs_code   readOnly  size=5>
									   <INPUT id=bt_order_wbs_code    type=button onclick=order_wbs_search() class=img_btnFind_S>
				                  <INPUT style="FONT-SIZE:12px;" id=tx_s_order_wbs_name  tabIndex=-1 READONLY  size=40 disabled></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=2 > 
				                 <div align="right">승인일자</div></td>
				             <td width="15%" colspan=3 > 
									   <comment id="__NSID__"><OBJECT id=em_approve_dt tabIndex=-1 READONLY  
				                         style="WIDTH: 80px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="YYYY-MM-DD">
				                       <param name=ReadOnly   value=true>
				                        <param name=ReadOnlyForeColor        value=black>
				                        <param name=ReadOnlyBackColor       value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">*발주명</div></td>
				             <td width="85%" colspan=17 >
				                  <INPUT style="FONT-SIZE:12px;" id=tx_order_name    size=74 ></td>
				         </tr>                 
				         <tr BGCOLOR="white" > 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
				                 <div align="right">전체공사기간</div></td>
				             <td width="35%" colspan=7 > 
									   <comment id="__NSID__"><OBJECT id=em_chg_start_dt  tabindex=-1 
				                         style="WIDTH: 90px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="YYYY-MM-DD">
						                 <param name=ReadOnly   value=true>
				                       <param name=ReadOnlyBackColor  value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
				                  <LABEL>&nbsp;-&nbsp;</LABEL>
									   <comment id="__NSID__"><OBJECT id=em_chg_end_dt   tabindex=-1
				                         style="WIDTH: 90px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="YYYY-MM-DD">
						                 <param name=ReadOnly   value=true>
				                       <param name=ReadOnlyBackColor  value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
				                 <div align="right">*당공종공사기간</div></td>
				             <td width="35%" colspan=7 > 
									   <comment id="__NSID__"><OBJECT id=em_start_dt   
				                         style="WIDTH: 90px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="YYYY-MM-DD">
				                       <param name=ReadOnlyBackColor  value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
				                  <LABEL>&nbsp;-&nbsp;</LABEL>
									   <comment id="__NSID__"><OBJECT id=em_end_dt   
				                         style="WIDTH: 90px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="YYYY-MM-DD">
				                       <param name=ReadOnlyBackColor  value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">도급금액</div></td>
				             <td width="20%" colspan=4 > 
				                 <comment id="__NSID__"><OBJECT id=em_cnt_amt  tabindex=-1
				                         style="WIDTH: 105px"
				                         classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                         <param name=Numeric value=true>
				                       <param name=ReadOnlyBackColor  value=silver>
				                         <param name=MaxDecimalPlace   value=0>
				                         </OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
				                 <div align="right">실행금액</div></td>
				             <td width="20%" colspan=4 > 
				                 <comment id="__NSID__"><OBJECT id=em_exe_amt  tabindex=-1
				                         style="WIDTH: 105px"
				                         classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                         <param name=Numeric value=true>
				                       <param name=ReadOnlyBackColor  value=silver>
				                         <param name=MaxDecimalPlace   value=0>
				                         </OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2  > 
				                 <div align="right">선정방법</div></td>
				             <td width="20%" colspan=4 > 
									  <comment id="__NSID__"><OBJECT id=ccom_choice_kind  
				                         style="WIDTH: 105px"
									          classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F VIEWASTEXT>
											     <PARAM NAME="Alignment" VALUE="1">
										      <param name=Data     value="1^수의계약,2^지명경쟁">
								            <param name=DataID     value=ds_1>
						                  <param name=Auto       value=false>
				                        <param name=Enable     value=true>
										      </OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">*현설일시</div></td>
				             <td width="20%" colspan=4 > 
									   <comment id="__NSID__"><OBJECT id=em_br_date   
				                         style="WIDTH: 105px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											     <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="0000-00-00 00:00">
				                       <param name=Numeric value=false>
				                       <param name=ReadOnlyBackColor  value=silver>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">*견적제출일시</div></td>
				             <td width="20%" colspan=4 >
									   <comment id="__NSID__"><OBJECT id=em_estimate_dt   
				                         style="WIDTH: 105px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											     <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="0000-00-00 00:00">
				                       <param name=ReadOnlyBackColor  value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK; visibility:hidden" colspan=2  > 
				                 <div align="right">*입찰일시</div></td>
				             <td width="20%" colspan=4 style="visibility:hidden">
									   <comment id="__NSID__"><OBJECT id=em_pr_dt  
				                         style="WIDTH: 105px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											     <PARAM NAME="Alignment" VALUE="1">
									        <param name=Format value="0000-00-00 00:00">
				                       <param name=ReadOnlyBackColor  value=silver>
				                       <param name=Numeric value=false>
									        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				         </tr>                 
				          <tr BGCOLOR="white"> 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
				                 <div align="right">현설장소</div></td>
				             <td width="45%" colspan=9>
				                  <INPUT style="FONT-SIZE:12px;" id=tx_br_place    size=38></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=2 > 
				                 <div align="right">설명자</div></td>
				             <td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=1 > 
				                 <div align="right">직책</div></td>
				             <td width="10%" colspan=2 > 
				                  <INPUT style="FONT-SIZE:12px;" id=tx_br_jik    size=8 ></td>
				             <td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=1 > 
				                 <div align="right">성명</div></td>
				             <td width="10%" colspan=2 > 
				                  <INPUT style="FONT-SIZE:12px;" id=tx_br_name    size=8></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">입찰장소</div></td>
				             <td width="45%" colspan=9>
				                  <INPUT style="FONT-SIZE:12px;" id=tx_pr_place    size=38></td>
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2  > 
				                 <div align="right">입회인</div></td>
				             <td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=1 > 
				                 <div align="right">직책</div></td>
				             <td width="10%" colspan=2 > 
				                  <INPUT style="FONT-SIZE:12px;" id=tx_opt_jik     size=8></td>
				             <td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=1 > 
				                 <div align="right">성명</div></td>
				             <td width="10%" colspan=2 > 
				                  <INPUT style="FONT-SIZE:12px;" id=tx_opt_name    size=8></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				             <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=2  > 
				                 <div align="right">대금지불</div></td>
				             <td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1  > 
				                 <div align="right">현금</div></td>
				             <td width="10%" colspan=2 > 
									        <comment id="__NSID__"><OBJECT id=em_directamt_rt   
				                         style="WIDTH: 50px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											     <PARAM NAME="Alignment" VALUE="2">
													<PARAM NAME="MaxLength" VALUE="3">
													<PARAM NAME="SelectAll" VALUE="-1">
													<PARAM NAME="MaxDecimalPlace" VALUE="2">
													<param name=ReadOnlyBackColor  value=silver>
									  			  <PARAM NAME="MaxLength" VALUE="3">
				                          <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				             <td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=1  > 
				                 <div align="right">어음</div></td>
				             <td width="10%" colspan=2 > 
									        <comment id="__NSID__"><OBJECT id=em_bill_rt   tabindex=-1
				                         style="WIDTH: 50px"
									          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                       <param name=ReadOnlyBackColor  value=silver>
				                          <param name=Numeric value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
				                 <div align="right">어음지급방법</div></td>
				             <td width="45%" colspan=9 > 
				                  <INPUT style="FONT-SIZE:12px;" id=tx_bill_pay     size=37></td>
				         </tr>                 
				         <tr BGCOLOR="white"> 
				              <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
				                  <div align="right">하자보증율</div></td>
				              <td width="10%" colspan=2 >      
							        <comment id="__NSID__"><OBJECT id=em_warrant_guarantee_rt   
				                   style="WIDTH: 50px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=Numeric value=true>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK" colspan=3  > 
				                 <div align="right">하자보증기간</div></td>
				             <td width="40%" colspan=8 >
				             		전체공사 준공 후
				                  <INPUT style="FONT-SIZE:12px;" id=tx_warrant_term  size=5  >개월</td>
				              <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=2  > 
				                  <div align="right">계약보증율</div></td>
				              <td width="10%" colspan=2 >      
							        <comment id="__NSID__"><OBJECT id=em_sbc_guarantee_rt   
				                   style="WIDTH: 50px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=Numeric value=true>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				         </tr>                 
				         <tr BGCOLOR="white" > 
				              <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"   colspan=3 > 
				                  <div align="right">도급선급금율</div></td>
				              <td width="10%" colspan=2 >
							        <comment id="__NSID__"><OBJECT id=em_previous_pay1   
				                   style="WIDTH: 50px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                    <param name=Numeric value=true>
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				              <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"   colspan=3 > 
				                  <div align="right">하도선급금율</div></td>
				              <td width="10%" colspan=2 >
							        <comment id="__NSID__"><OBJECT id=em_previous_pay2   
				                   style="WIDTH: 50px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                    <param name=Numeric value=true>
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				              <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
				                  <div align="right">연체상금율</div></td>
				              <td width="25%" colspan=5 ><div align="right">연체일수*계약금액의</div>
				              </td>
				              <td width="5%" colspan=1 >
							        <comment id="__NSID__"><OBJECT id=em_delay_rt2   
				                   style="WIDTH: 30px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=Numeric value=true>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				              <td width="5%" colspan=5 >(%)
				              </td>
				         </tr>                 
				         <tr BGCOLOR="white" > 
				             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3 > 
				                 <div align="right">도급선급금</div></td>
				             <td width="15%" colspan=3 > 
				                 <comment id="__NSID__"><OBJECT id=em_cnt_previous_amt
				                         style="WIDTH: 90px"
				                         classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                         <param name=Numeric value=true>
				                       <param name=ReadOnlyBackColor  value=silver>
				                         <param name=MaxDecimalPlace   value=0>
				                         </OBJECT></comment> <script> __ws__(__NSID__);</script></td>
				              <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"   colspan=2 > 
				                  <div align="right">부가세율</div></td>
				              <td width="10%" colspan=2 >
							        <comment id="__NSID__"><OBJECT id=em_vat_rt   
				                   style="WIDTH: 50px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
				                    <param name=Numeric value=true>
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				              <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  colspan=3  > 
				                  <div align="right">매입세 재료비율</div></td>
				              <td width="10%" colspan=2 >      
							        <comment id="__NSID__"><OBJECT id=em_buy_mat_rt   
				                   style="WIDTH: 50px"
							          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
											  <PARAM NAME="Alignment" VALUE="2">
											<PARAM NAME="MaxLength" VALUE="3">
											<PARAM NAME="SelectAll" VALUE="-1">
											<PARAM NAME="MaxDecimalPlace" VALUE="2">
				                    <param name=ReadOnlyBackColor  value=silver>
				                    <param name=Numeric value=true>
				                    <param name=MaxDecimalPlace   value=2></OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				              <td width="10%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"   colspan=2 > 
				                  <div align="right">매입세율</div></td>
				              <td width="15%" colspan=3 >
										<comment id="__NSID__"><object id=ccom_buy_rt
											classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
						                                        height=106 width=70 VIEWASTEXT>
											<PARAM NAME="Alignment" VALUE="1">
											<param name=ComboDataID         value=ds_3>
						               <param name=CodeCColumn        value=key_rt>
						               <param name=DataCColumn         value=data_rt>
						               <param name=ReadOnlyBackColor     value="#F2F2F2">
						               <param name=Auto     value=false>
											<param name=Enable   value=false>
										</OBJECT></comment> <script> __ws__(__NSID__);</script>%</td>
				         </tr>                 
				      </table>
				   </DIV>    
				   
						<DIV id=tab_page_2 
							style="WIDTH: 100%; HEIGHT: 100%; POSITION: absolute;" >
							<table width="100%"  height="100%"  BORDER="1" CELLSPACING="0" style="POSITION: absolute;">
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">공사범위</div></td>
									<td colspan=17 >
										<TEXTAREA  style="FONT-SIZE:12px;" id=tx_const_range  rows=1 cols=75></TEXTAREA></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%"  colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">지급자재</div></td>
									<td colspan=17 >
										<INPUT style="FONT-SIZE:12px;" id=tx_pay_mat     size=76></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%"  colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">지입자재</div></td>
									<td colspan=17 >
										<INPUT style="FONT-SIZE:12px;" id=tx_mat_etc     size=76></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">전력</div></td>
									<td colspan=17 >
										<INPUT style="FONT-SIZE:12px;" id=tx_elec_remark     size=76></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">용수</div></td>
									<td colspan=17 >
										<INPUT style="FONT-SIZE:12px;" id=tx_wat_remark     size=76></td>
								</tr>                                              
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK" > 
										<div align="right">인도조건</div></td>
									<td width="35%" colspan=7 >
										<INPUT style="FONT-SIZE:12px;" id=tx_deliverymethod     size=25></td>
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">결제조건</div></td>
									<td width="35%" colspan=7 >
										<INPUT style="FONT-SIZE:12px;" id=tx_paymentmethod     size=25></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">가설사항</div></td>
									<td colspan=17 >
										<TEXTAREA  style="FONT-SIZE:12px;" id=tx_tmp_note  rows=3 cols=75></TEXTAREA></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">정산방법</div></td>
									<td colspan=17 >
										<TEXTAREA  style="FONT-SIZE:12px;" id=tx_adjust_note  rows=3 cols=75></TEXTAREA></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">기 타</div></td>
									<td colspan=17 >
										<TEXTAREA  style="FONT-SIZE:12px;" id=tx_note  rows=3 cols=75></TEXTAREA></td>
								</tr> 
								<tr BGCOLOR="white" > 
									<td width="15%" colspan=3   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
										<div align="right">기성지불</div></td>
									<td colspan=17 >
										<TEXTAREA  style="FONT-SIZE:12px;" id=tx_prgs_pay2  rows=2 cols=75></TEXTAREA></td>
								</tr> 
							</table>                         
						</DIV>	
						
					   <DIV id=tab_page_3 
					         style="WIDTH: 100%; HEIGHT: 100%; POSITION: absolute;" >
					      <table width="100%" BORDER="1" CELLSPACING="0">
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">공사기간</div></td>
					             <td colspan=3> 
										   <comment id="__NSID__"><OBJECT id=em_2start_dt   
					                         style="WIDTH: 70px"
										          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
										        <param name=Format value="YYYY-MM-DD">
					                       <param name=ReadOnlyBackColor  value=silver>
					                       <param name=Numeric value=false>
										        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script>
					                  <LABEL>&nbsp;-&nbsp;</LABEL>
										   <comment id="__NSID__"><OBJECT id=em_2end_dt   
					                         style="WIDTH: 70px"
										          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
										        <param name=Format value="YYYY-MM-DD">
					                       <param name=ReadOnlyBackColor  value=silver>
					                       <param name=Numeric value=false>
										        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					         </tr>                 
					         <tr BGCOLOR="white"> 
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">현설일시</div></td>
					             <td width="35%"> 
										   <comment id="__NSID__"><OBJECT id=em_2br_date   
					                         style="WIDTH: 105px"
										          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
												  <PARAM NAME="Alignment" VALUE="1">
										        <param name=Format value="0000-00-00 00:00">
					                       <param name=Numeric value=false>
					                       <param name=ReadOnlyBackColor  value=silver>
										        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">견적제출</div></td>
					             <td width="35%">
										   <comment id="__NSID__"><OBJECT id=em_2estimate_dt   
					                         style="WIDTH: 105px"
										          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
												  <PARAM NAME="Alignment" VALUE=1>
												  
										        <param name=Format value="0000-00-00 00:00">
					                       <param name=ReadOnlyBackColor  value=silver>
					                       <param name=Numeric value=false>
										        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
					         </tr>                 
					         <tr BGCOLOR="white"> 
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">현설장소</div></td>
					             <td width="87%" colspan=3>
					                  <INPUT style="FONT-SIZE:12px;" id=tx2_br_place    size=75></td>
					         </tr>                 
					         <tr BGCOLOR="white"> 
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">설명자</div></td>
					             <td width="35%"> 
					                  <INPUT style="FONT-SIZE:12px;" id=tx2_br_jik    size=10 >
					                  <INPUT style="FONT-SIZE:12px;" id=tx2_br_name    size=10></td>
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">입회인</div></td>
					             <td width="35%"> 
					                  <INPUT style="FONT-SIZE:12px;" id=tx2_opt_jik     size=10>
					                  <INPUT style="FONT-SIZE:12px;" id=tx2_opt_name    size=10></td>
					         </tr>                 
					         <tr BGCOLOR="white" > 
					             <td width="15%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
					                 <div align="right">기 타</div></td>
					             <td colspan=3>
					                 <TEXTAREA  style="FONT-SIZE:12px;" id=tx_br_remark rows=4 cols=75></TEXTAREA></td>
					         </tr> 
					       </table>                         
						 </DIV>
					</td>
				</tr>
			</table>
		</td>
	</tr>
	<tr height="40%">
		<td colspan="2">
			<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0">
				<tr>
					<td width="55%">
						<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
					    style="FONT-SIZE: 12px; Z-INDEX: 105; WIDTH:100%; HEIGHT: 100%;" 
					    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
							<PARAM NAME="MultiRowSelect" VALUE="0">
							<PARAM NAME="AllShowEdit" VALUE="-1">
							<PARAM NAME="Editable" VALUE="-1">
						   <PARAM NAME="BorderStyle"  VALUE=1>
							<PARAM NAME="ColSizing" VALUE="-1">
							<PARAM NAME="DataID" VALUE="ds_2">
							<param name=TitleHeight      value=30>
							<PARAM NAME="Format" VALUE=" 
								  <C> Name='현설;참석' ID=pr_yn Edit=None EditStyle=CheckBox   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=40 </C> 
								  <C> Name='업체명' ID=sbcr_name Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=150 </C>
								  <C> Name='추천;부서' ID=recommender_department EditStyle=Combo Align=Center Data='현장:현장,본사:본사' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=50 </C> 
								  <C> Name='등록' ID=register_chk Edit=None EditStyle=Combo Data='1:정규,2:임시,3:가,4:[자재]정규,5:[자재]임시,6:[자재]가,7:탈락' 
						  						BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
								  <C> Name=등록공종 ID=profession_wbs_name  Edit=None   BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=150 </C> 
								  <C> Name='업체동향' ID=recommender_reson Edit=None
						  						BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=150 </C> 
								  <C> Name=대표자 ID=rep_name1 Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
								  <C> Name=전화번호 ID=tel_number1 Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=100 </C> 
						     ">
						</OBJECT></comment> <script> __ws__(__NSID__);</script>
					</td>
					<td width="45%">
						<DIV id=div_file_upload
						     style="Z_INDEX: 100; WIDTH: 100%; HEIGHT: 100%; FONT-SIZE: 12px">
								<IFRAME ID=IFrame_upload FRAMEBORDER=1 SCROLLING=NO SRC="../../../comm_function/file_upload/file_upload.html" 
						     style="WIDTH: 100%;  HEIGHT: 100%"></IFRAME>
						</DIV>
					</td>
				</tr>
			</table>
		</td>
	</tr>
</table>
	 
<comment id="__NSID__"><OBJECT id=Bind_1 
    style="Z-INDEX: 107; LEFT: 241px; POSITION: absolute; TOP: 3px" 
    classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	   <C>Col=choice_kind Ctrl=ccom_choice_kind Param=codevalue Enable=enable</C>
	   <C>Col=order_class Ctrl=ccom_order_class Param=codevalue Enable=enable</C>
	   <C>Col=ebid_yn Ctrl=ccom_ebid_yn Param=codevalue Enable=enable</C>
	   <C>Col=dept_proj_tag Ctrl=ccom_dept_proj_tag Param=codevalue Enable=enable</C>
	   <C>Col=order_number Ctrl=em_order_number Param=text Enable=enable</C>
	   <C>Col=request_dt Ctrl=em_request_dt Param=text Enable=enable</C>
	   <C>Col=approve_dt Ctrl=em_approve_dt Param=text Enable=enable</C>
	   <C>Col=profession_wbs_code Ctrl=tx_order_wbs_code Param=value Enable=enable</C>
	   <C>Col=s_order_wbs_name Ctrl=tx_s_order_wbs_name Param=value Enable=enable</C>
	   <C>Col=order_name Ctrl=tx_order_name Param=value </C>
	   <C>Col=start_dt Ctrl=em_start_dt Param=text Enable=enable</C>
	   <C>Col=end_dt Ctrl=em_end_dt Param=text Enable=enable</C>
	   <C>Col=chg_start_dt Ctrl=em_chg_start_dt Param=text Enable=enable</C>
	   <C>Col=chg_end_dt Ctrl=em_chg_end_dt Param=text Enable=enable</C>
	   <C>Col=cnt_amt Ctrl=em_cnt_amt Param=text Enable=enable</C>
	   <C>Col=exe_amt Ctrl=em_exe_amt Param=text Enable=enable</C>
	   <C>Col=br_date Ctrl=em_br_date Param=text Enable=enable</C>
	   <C>Col=estimate_dt Ctrl=em_estimate_dt Param=text Enable=enable</C>
	   <C>Col=br_place Ctrl=tx_br_place Param=value Enable=enable</C>
	   <C>Col=pr_place Ctrl=tx_pr_place Param=value Enable=enable</C>
	   <C>Col=pr_dt   Ctrl=em_pr_dt Param=text Enable=enable</C>
	   <C>Col=br_jik Ctrl=tx_br_jik Param=value Enable=enable</C>
	   <C>Col=br_name Ctrl=tx_br_name Param=value Enable=enable</C>
	   <C>Col=opt_jik Ctrl=tx_opt_jik Param=value Enable=enable</C>
	   <C>Col=opt_name Ctrl=tx_opt_name Param=value Enable=enable</C>
	   <C>Col=previous_pay1  Ctrl=em_previous_pay1  Param=text Enable=enable</C>
	   <C>Col=previous_pay2  Ctrl=em_previous_pay2  Param=text Enable=enable</C>
	   <C>Col=warrant_guarantee_rt  Ctrl=em_warrant_guarantee_rt  Param=text Enable=enable</C>
	   <C>Col=delay_rt2  Ctrl=em_delay_rt2  Param=text Enable=enable</C>
	   <C>Col=sbc_guarantee_rt  Ctrl=em_sbc_guarantee_rt  Param=text Enable=enable</C>
	   <C>Col=directamt_rt  Ctrl=em_directamt_rt  Param=text Enable=enable</C>
	   <C>Col=bill_rt  Ctrl=em_bill_rt  Param=text Enable=enable</C>
	   <C>Col=vat_rt  Ctrl=em_vat_rt  Param=text Enable=enable</C>
	   <C>Col=cnt_previous_amt  Ctrl=em_cnt_previous_amt  Param=text Enable=enable</C>
	   <C>Col=buy_rt  Ctrl=ccom_buy_rt  Param=codevalue Enable=enable</C>
	   <C>Col=buy_mat_rt  Ctrl=em_buy_mat_rt  Param=text Enable=enable</C>
	   <C>Col=bill_pay  Ctrl=tx_bill_pay  Param=value Enable=enable</C>
	   <C>Col=warrant_start_dt  Ctrl=em_warrant_start_dt  Param=text Enable=enable</C>
	   <C>Col=warrant_end_dt  Ctrl=em_warrant_end_dt  Param=text Enable=enable</C>
	   <C>Col=warrant_term  Ctrl=tx_warrant_term  Param=value Enable=enable</C>
	   <C>Col=const_range Ctrl=tx_const_range Param=value Enable=enable</C>
	   <C>Col=pay_mat Ctrl=tx_pay_mat Param=value Enable=enable</C>
	   <C>Col=mat_etc Ctrl=tx_mat_etc Param=value Enable=enable</C>
	   <C>Col=tmp_note Ctrl=tx_tmp_note Param=value Enable=enable</C>
	   <C>Col=adjust_note Ctrl=tx_adjust_note Param=value Enable=enable</C>
	   <C>Col=note Ctrl=tx_note Param=value Enable=enable</C>
	   <C>Col=prgs_pay2 Ctrl=tx_prgs_pay2  Param=value Enable=enable</C>
	   <C>Col=br_remark Ctrl=tx_br_remark Param=value Enable=enable</C>
	   <C>Col=start_dt Ctrl=em_2start_dt Param=text Enable=enable</C>
	   <C>Col=end_dt Ctrl=em_2end_dt Param=text Enable=enable</C>
	   <C>Col=br_date Ctrl=em_2br_date Param=text Enable=enable</C>
	   <C>Col=estimate_dt Ctrl=em_2estimate_dt Param=text Enable=enable</C>
	   <C>Col=br_place Ctrl=tx2_br_place Param=value Enable=enable</C>
	   <C>Col=br_jik Ctrl=tx2_br_jik Param=value Enable=enable</C>
	   <C>Col=br_name Ctrl=tx2_br_name Param=value Enable=enable</C>
	   <C>Col=opt_jik Ctrl=tx2_opt_jik Param=value Enable=enable</C>
	   <C>Col=opt_name Ctrl=tx2_opt_name Param=value Enable=enable</C>
	   <C>Col=elec_remark Ctrl=tx_elec_remark Param=value Enable=enable</C>
	   <C>Col=wat_remark Ctrl=tx_wat_remark Param=value Enable=enable</C>
	   <C>Col=deliverymethod Ctrl=tx_deliverymethod Param=value Enable=enable</C>
	   <C>Col=paymentmethod  Ctrl=tx_paymentmethod Param=value Enable=enable</C>
          "></OBJECT></comment> <script> __ws__(__NSID__);</script>
</div>
<!--<input type="button_query0" value=" 전산결재" 
style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
background-color:#E9F5F5; border:1 #A1A9A9 solid; LEFT: 700px; POSITION: absolute; WIDTH: 65px; TOP: 7px;  height:17px"   
onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
"  onclick="guljae_rtn()"> -->

</BODY></HTML>
