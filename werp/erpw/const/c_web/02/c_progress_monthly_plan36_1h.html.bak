<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************				-->
<!-- 1. 프로그램 id   :c_progress_monthly_plan_1h.html					-->
<!-- 2. 유형(시나리오): 조회및 수정															-->
<!-- 3. 기 능 정 의   : 시공계획입력 -->
<!-- 4. 변 경 이 력   :  임종빈 작성														-->
<!-- 5. 관련프로그램  :																			-->
<!-- 6. 특 기 사 항   :	-->
<!-- *********************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = parent.frames['security'].gs_home.value
var is_ds_1_addr = gs_home + '/const/c_web/02/c_progress_monthly_plan36_1q.jsp?arg_dept_code='
var is_tr_1_addr = gs_home + '/const/c_web/02/c_progress_monthly_plan_input36_1tr.jsp'
var is_ds_mm_input_addr = gs_home + '/const/c_web/02/c_progress_monthly_plan_input36_1q.jsp?arg_dept_code='

var is_work_date = top.frames['security'].gs_sysdate.value
var is_dept_code 
var is_chg_seq 
var is_chg_no_seq 
var is_const_start_date 
var is_const_end_date 
var is_parent_sec
var is_const_start_date
var is_const_end_date
var is_work_dt
var il_nIndex = 1
var is_max_k = 0
var ib_onload = true
var s_dept_code
var s_chg_seq
var s_cat_text
var s_std_date
var s_from
var ib_app = false

var is_data_header = "cat_text:STRING(1),name:STRING(50),ssize:STRING(40),unit:STRING(10),qty:DECIMAL(13,3).amt:DECIMAL(13,0).year:STRING(10),q1:STRING(10),q2:STRING(10),q3:STRING(10),q4:STRING(10),q5:STRING(10),q6:STRING(10),q7:STRING(10),q8:STRING(10),q9:STRING(10),q10:STRING(10),q11:STRING(10),q12:STRING(10),q13:STRING(10),q14:STRING(10),q15:STRING(10),q16:STRING(10),q17:STRING(10),q18:STRING(10),q19:STRING(10),q20:STRING(10),q21:STRING(10),q22:STRING(10),q23:STRING(10),q24:STRING(10),q25:STRING(10),q26:STRING(10),q27:STRING(10),q28:STRING(10),q29:STRING(10),q30:STRING(10),q31:STRING(10),q32:STRING(10),q33:STRING(10),q34:STRING(10),q35:STRING(10),q36:STRING(10),q37:STRING(10),q38:STRING(10)"

				/*
				"<FC> Name='구분' ID=col_tag color=black  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#b0c4de  HeadColor=BLACK    Width=50  EditStyle=Combo  Lookup  Data='M:재료,L:노무,X:경비,S:외주' align=center sort=true</FC>" +
				"<FC> Name='내역코드' ID=detail_code edit=none color=black  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=73 </FC>" +
				"<FC> Name='집행공종' ID=cat_text color=black  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#b0c4de  HeadColor=BLACK    Width=100 sort=true</FC>" +	
				*/						 
var is_format_1 =
	           "<FC> Name='명  칭' ID=name edit=none color=black  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=170 "  + 
	           "              SumColor=Black SumBgColor=Pink SubSumText='    합  계'  SubBgColor='silver' </FC>" +
	           "<FC> Name='규  격' ID=ssize edit=none color=black BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=100 SubSumText='' SubBgColor='silver'</FC>" +
	           "<FC> Name='단위' ID=unit edit=none color=black BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=40 SubSumText='' SubBgColor='silver'</FC>" +
	           "<FG> Name='  실         행' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK   " +
	           "     <FC> Name=수량 ID=qty edit=none color=black BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=80  SubBgColor='silver'</FC>" +
	           "     <FC> Name=금액 ID=amt edit=none color=black  Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK     Width=85 " +
	           "     	                                        SumText=@sum          SumColor=Black SumBgColor=Pink  SubBgColor='silver'</FC>" +
				  "   </G> " +
				  "<FC>ID=tot_qty name=수량합계 value={q1  +q2  +q3  +q4  +q5  +q6  +q7  +q8  +q9  +q10"+
				  "																+q11+q12+q13+q14+q15+q16+q17+q18+q19+q20"+
				  "																 +q21+q22+q23+q24+q25+q26+q27+q28+q29+q30"+
				  "																 +q31+q32+q33+q34+q35+q36+q37+q38"+
				  "} Dec=3 width=85 HeadBgColor=#BBE0F4 Bgcolor=@color1  SubBgColor='silver'</FC>" +
				  "<FC>ID=tot_amt name=금액합계 value={a1  +a2  +a3  +a4  +a5  +a6  +a7  +a8  +a9  +a10"+
				  "																 +a11+a12+a13+a14+a15+a16+a17+a18+a19+a20"+
				  "																 +a21+a22+a23+a24+a25+a26+a27+a28+a29+a30"+
				  "																 +a31+a32+a33+a34+a35+a36+a37+a38"+
				  "} width=85 HeadBgColor=#BBE0F4 Bgcolor=@color2 SubBgColor='silver' show=false</FC>" +
				  "<C>ID=q1  width=70 show=false  Bgcolor=@q1            HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q2  width=70 show=false   Bgcolor=@q2              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q3  width=70 show=false   Bgcolor=@q3              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q4  width=70 show=false   Bgcolor=@q4              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q5  width=70 show=false   Bgcolor=@q5              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q6  width=70 show=false   Bgcolor=@q6              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q7  width=70 show=false   Bgcolor=@q7              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q8  width=70 show=false   Bgcolor=@q8              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q9  width=70 show=false   Bgcolor=@q9              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q10 width=70 show=false   Bgcolor=@q10             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q11  width=70 show=false  Bgcolor=@q11              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q12  width=70 show=false  Bgcolor=@q12              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q13  width=70 show=false  Bgcolor=@q13              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q14  width=70 show=false  Bgcolor=@q14              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q15  width=70 show=false  Bgcolor=@q15              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q16  width=70 show=false  Bgcolor=@q16             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q17  width=70 show=false  Bgcolor=@q17              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q18  width=70 show=false  Bgcolor=@q18              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q19  width=70 show=false  Bgcolor=@q19             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q20 width=70 show=false   Bgcolor=@q20             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q21  width=70 show=false  Bgcolor=@q21              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q22  width=70 show=false  Bgcolor=@q22              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q23  width=70 show=false  Bgcolor=@q23              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q24  width=70 show=false  Bgcolor=@q24              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q25  width=70 show=false  Bgcolor=@q25              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q26  width=70 show=false  Bgcolor=@q26              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q27  width=70 show=false  Bgcolor=@q27              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q28  width=70 show=false  Bgcolor=@q28              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q29  width=70 show=false  Bgcolor=@q29              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q30 width=70 show=false   Bgcolor=@q30            HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q31  width=70 show=false  Bgcolor=@q31               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q32  width=70 show=false  Bgcolor=@q32               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q33  width=70 show=false  Bgcolor=@q33               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q34  width=70 show=false  Bgcolor=@q34               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q35  width=70 show=false  Bgcolor=@q35               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q36  width=70 show=false  Bgcolor=@q36               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q37  width=70 show=false  Bgcolor=@q37               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=q38  width=70 show=false  Bgcolor=@q38               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"
	          
var is_format_2 =
	           "<FC> Name='명  칭' ID=name edit=none color=black  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=170 " + 
	           "          SumText='합     계' SumColor=Black SumBgColor=Pink SubSumText='    합  계'  SubBgColor='silver'</FC>" +
	           "<FC> Name='규  격' ID=ssize edit=none color=black BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=100 SubBgColor='silver'</FC>" +
	           "<FC> Name='단위' ID=unit edit=none color=black BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=40 SubBgColor='silver'</FC>" +
	           "<FG> Name='  실         행' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK   " +
	           "     <FC> Name=수량 ID=qty edit=none color=black BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK    Width=80 SubBgColor='silver'</FC>" +
	           "     <FC> Name=금액 ID=amt edit=none color=black  Edit=None BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')} HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK     Width=85 " +
	           "     	                                        SumText=@sum          SumColor=Black SumBgColor=Pink SubBgColor='silver'</FC>" +
	           "   </FG> " +
				  "<FC>ID=tot_qty name=수량합계 value={q1  +q2  +q3  +q4  +q5  +q6  +q7  +q8  +q9  +q10"+
				  "																+q11+q12+q13+q14+q15+q16+q17+q18+q19+q20"+
				  "																 +q21+q22+q23+q24+q25+q26+q27+q28+q29+q30"+
				  "																 +q31+q32+q33+q34+q35+q36+q37+q38"+
				  "} Dec=3 width=85 HeadBgColor=#BBE0F4 Bgcolor=@color1  SubBgColor='silver' show=false</FC>" +
				  "<FC>ID=tot_amt name=금액합계 value={a1  +a2  +a3  +a4  +a5  +a6  +a7  +a8  +a9  +a10"+
				  "																 +a11+a12+a13+a14+a15+a16+a17+a18+a19+a20"+
				  "																 +a21+a22+a23+a24+a25+a26+a27+a28+a29+a30"+
				  "																 +a31+a32+a33+a34+a35+a36+a37+a38"+
				  "} width=85 HeadBgColor=#BBE0F4 Bgcolor=@color2 SubBgColor='silver'</FC>" +
				  "<C>ID=a1  width=70 show=false  Bgcolor=@a1            HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a2  width=70 show=false   Bgcolor=@a2              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a3  width=70 show=false   Bgcolor=@a3              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a4  width=70 show=false   Bgcolor=@a4              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a5  width=70 show=false   Bgcolor=@a5              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a6  width=70 show=false   Bgcolor=@a6              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a7  width=70 show=false   Bgcolor=@a7              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a8  width=70 show=false   Bgcolor=@a8              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a9  width=70 show=false   Bgcolor=@a9              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a10 width=70 show=false   Bgcolor=@a10             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a11  width=70 show=false  Bgcolor=@a11              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a12  width=70 show=false  Bgcolor=@a12              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a13  width=70 show=false  Bgcolor=@a13              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a14  width=70 show=false  Bgcolor=@a14              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a15  width=70 show=false  Bgcolor=@a15              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a16  width=70 show=false  Bgcolor=@a16             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a17  width=70 show=false  Bgcolor=@a17              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a18  width=70 show=false  Bgcolor=@a18              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a19  width=70 show=false  Bgcolor=@a19             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a20 width=70 show=false   Bgcolor=@a20             HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a21  width=70 show=false  Bgcolor=@a21              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a22  width=70 show=false  Bgcolor=@a22              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a23  width=70 show=false  Bgcolor=@a23              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a24  width=70 show=false  Bgcolor=@a24              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a25  width=70 show=false  Bgcolor=@a25              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a26  width=70 show=false  Bgcolor=@a26              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a27  width=70 show=false  Bgcolor=@a27              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a28  width=70 show=false  Bgcolor=@a28              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a29  width=70 show=false  Bgcolor=@a29              HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a30 width=70 show=false   Bgcolor=@a30            HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a31  width=70 show=false  Bgcolor=@a31               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a32  width=70 show=false  Bgcolor=@a32               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a33  width=70 show=false  Bgcolor=@a33               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a34  width=70 show=false  Bgcolor=@a34               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a35  width=70 show=false  Bgcolor=@a35               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a36  width=70 show=false  Bgcolor=@a36               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a37  width=70 show=false  Bgcolor=@a37               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"+
              "<C>ID=a38  width=70 show=false  Bgcolor=@a38               HeadBgColor=#BBE0F4  HeadColor=BLACK SubBgColor='silver' </C>"
              
</script>

<!-- ======================================================================= -->
<!--                      Function                          -->
<!-- ======================================================================= -->
<script language="JavaScript">                                
                                

//---------------------------------------------------------------
function btnquery_onclick()               //조회 
//---------------------------------------------------------------
{ //ds_1.SetDataHeader(is_data_header);

	ds_1.Cleardata();
	gd_1.dataid = ''
	
	var ls_cat_text = ds_select.namevalue(ds_select.rowposition, 'cat_text')

	

	ds_1.DataID = is_ds_1_addr + is_dept_code + 
					  "&arg_chg_seq="  +  is_chg_seq + 
					  "&arg_cat_text="  +   ls_cat_text
				  
	ds_1.SyncLoad=true

	ds_1.reset()
	//alert('ds_1')
	ds_2.DataID = is_ds_mm_input_addr + is_dept_code + 
					  "&arg_chg_seq="  +  is_chg_seq+
					  "&arg_year="  +  em_date.text+'.01.01'+
					  "&arg_cat_text="  +  ls_cat_text
	ds_2.SyncLoad=true
	
	ds_2.reset()
	//alert('ds_2')
	//alert(ds_1.countrow)
	//alert(ds_2.countrow)

	ib_onload = true
	make_cross()
	ib_onload = false
	ds_1.ResetStatus()
	
	gd_1.dataid = 'ds_1'

	

}
//-----------------------------------------------------------------
function make_cross(show)               // 크로스탭 작성
//------------------------------------------------------------------
{ var i , ii
	var j=1
	var k
	var ls_year, ls_mm_qty, ls_mm_amt, ls_year_name
	var ds_2_countrow = ds_2.countrow
	var col_str
	
	if (il_nIndex ==1){
		col_str='q'
	}
	else{
		if (il_nIndex ==2){
			col_str='a'
		}
	}

	for(ii=1; ii <= is_max_k ;ii++){
		gd_1.ColumnProp(col_str+ii, 'show')=false
	}
	
	for (i=1;i<=ds_1.CountRow;i++) {
		ls_spec_unq_num = ds_1.namevalue(i, 'spec_unq_num')
		
		sun_cur = ds_2.namevalue(j, 'spec_unq_num')
		
		k = 1
		while (ls_spec_unq_num == sun_cur){
		
			ls_year			 = ds_2.namevalue(j, 'year')
			ls_year_name		= ds_2.namevalue(j, 'year_name')
			ls_mm_qty  = ds_2.namevalue(j, 'plan_mm_qty')
			ls_mm_amt = ds_2.namevalue(j, 'plan_mm_amt')
			
			if (i ==1){
				gd_1.ColumnProp(col_str+k, 'NAME')=ls_year_name
				gd_1.ColumnProp(col_str+k, 'show')=true
				if ( ls_year < is_work_dt.substr(0, 7)||ls_year_name=='전년누계'||ls_year_name=='잔여누계' ) {  //변경일자 이전월은 실적집계금액 이므로 수정불가
					gd_1.ColumnProp(col_str+k, 'edit') = 'none'
				}
				else{
					gd_1.ColumnProp(col_str+k, 'edit') = ''
				}

				is_max_k = k;

			}

			if (!show) {
			ds_1.namevalue(i, 'q'+k) = ls_mm_qty;
			ds_1.namevalue(i, 'a'+k) = ls_mm_amt;
			}
/*
			if (il_nIndex ==1){
				ds_1.namevalue(i, col_str+k) = ls_mm_qty;
			}
			else{
				if (il_nIndex ==2){
					ds_1.namevalue(i, col_str+k) = ls_mm_amt;
				}
			}
*/			  

			j++;

			if (j > ds_2_countrow) {
				break;
			}

			k++

			sun_cur = ds_2.namevalue(j, 'spec_unq_num')

		}
		
		if (j > ds_2.countrow) {
			break;
		}

	}
	//ds_1.rowmark(ds_1.rowposition) = 0
	
	for (i=1; i <=ds_1.countrow; i++){
		ds_1.rowmark(i) = 0
	}
	
}
//-----------------------------------------------------------------
function btnsave_onclick()               // 저장
//------------------------------------------------------------------
{

  if (ds_1.IsUpdated){
    if  (confirm("변경되었습니다 저장하시겠습니까?")){
        //tr_1.Post()
			tr_1.Action = is_tr_1_addr
			save_rtn()
			btnquery_onclick()
    }    
  }      
}
//-----------------------------------------------------------------
function save_rtn()               // 저장
//------------------------------------------------------------------
{ var i 
   var ls_spec_unq_num
	var ll_row = 0
	var ll_mm_qty, ll_mm_amt
	var ls_year
	var col_str
	
	

	if (il_nIndex ==1){
		col_str='q'
	}
	else{
		if (il_nIndex ==2){
			col_str='a'
		}
	}

	for (i=1; i<=ds_1.CountRow; i++) {
		if (ds_1.SysStatus(i) == 3) {
			ls_spec_unq_num = ds_1.namevalue(i, 'spec_unq_num')
			ll_row = ds_2.namevaluerow('spec_unq_num', ls_spec_unq_num)

			if (ll_row > 0){
				
					for(j=1; j<= is_max_k; j++){
						/*if (il_nIndex ==1){
							ll_mm_qty = ds_1.namevalue(i, 'q'+j)
						}
						else{
							if (il_nIndex ==2){
								ll_mm_amt = ds_1.namevalue(i, 'a'+j)
							}
						}*/
						ll_mm_qty = ds_1.namevalue(i, 'q'+j)
						ll_mm_amt = ds_1.namevalue(i, 'a'+j)
						sun_cur = ds_2.namevalue( ll_row, 'spec_unq_num')
						ls_year = ds_2.namevalue( ll_row, 'year')
						year_cur = gd_1.ColumnProp(col_str+j, 'NAME')
						
						if ((ls_spec_unq_num == sun_cur) && (ls_year == year_cur) ){
							//if (ll_mm_qty > 0){alert(ll_mm_qty)}
							/*if (il_nIndex ==1){
								ds_2.namevalue(ll_row, 'plan_mm_qty') = ll_mm_qty
							}
							else{
								if (il_nIndex ==2){
									ds_2.namevalue(ll_row, 'plan_mm_amt') = ll_mm_amt
								}
							}*/
							ds_2.namevalue(ll_row, 'plan_mm_qty') = ll_mm_qty
							ds_2.namevalue(ll_row, 'plan_mm_amt') = ll_mm_amt
							
							//alert(ds_2.namevalue(ll_row, 'plan_mm_qty'))
							
						}
						ll_row++
					}
			}
      }
   }
	tr_1.Post()
	sp_call()
}


//-----------------------------------------------------------------
function sp_call()               //sp call  
//------------------------------------------------------------------
{
   
	var ls_cat_text = ds_select.namevalue(ds_select.rowposition, 'cat_text')
   ds_spcall.DataID = 'y_c_progress_detail_makeeven_procedure.jsp?arg_dept_code=' + is_dept_code + 
					  "&arg_chg_seq="  +  is_chg_seq + 
					  "&arg_cat_text="  +   ls_cat_text
   ds_spcall.SyncLoad = true
   ds_spcall.reset()

}
//-------------------------------------------------------------------------------
function make_edit()
//-------------------------------------------------------------------------------
{ 
	row = ds_1.rowposition

	ls_unit = ds_1.namevalue(row, 'unit')
	if(tb_1.activeindex==1){
		if (ls_unit =='식'){
			gd_1.editable =false;
		}
		else{
			gd_1.editable = true;
		}
	}
	else{
		if (ls_unit =='식'){
			gd_1.editable =true;
		}
		else{
			gd_1.editable = false;
		}
	}
}
//-------------------------------------------------------------------------------
function tab_changed(idx)                  // tab changed 
//-------------------------------------------------------------------------------
{  
	switch (idx)
   {
    case 1: 
	         gd_1.dataid = ''
            gd_1.format = is_format_1
            break;   
    case 2: 
				gd_1.dataid = ''
				gd_1.format = is_format_2
            break;

   }
	//gd_1.dataid = 'ds_1'
	make_cross(true)
	gd_1.dataid = 'ds_1'

	 make_edit()


	//btnquery_onclick() 
}
//---------------------------------------------------------------------------
function close_rtn()                      // 닫기 
//---------------------------------------------------------------------------
{   //alert(gs_home + "/const/c_web/02/c_chg_progress_1h.html" +"?"+is_parent_sec)
     top.frames['main_ct'].location.href(gs_home + "/const/c_web/02/c_chg_progress_1h.html" +"?"+is_parent_sec)

}
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		dept_code_find();
	} 
}
//---------------------------------------------------------------------------
function excel_down()                      // 
//---------------------------------------------------------------------------
{ var room, filename
   filename = '시공계획';
	filename = filename +'_'+ds_select.namevalue(ds_select.rowposition, 'cat_text');
   
  var sheet_name = filename+'('+is_dept_name+')';
  var file_name = sheet_name+".xls";
  gd_1.GridToExcel(sheet_name, file_name, 1)
}
//---------------------------------------------------------------------------
function app_per()
//---------------------------------------------------------------------------
{ ib_app = true

   var isQty = false
	var colidx
	var col_str
	
	if (tb_1.activeindex =='1') {
		isQty = true;
		col_str='q'
	}
	else{
		isQty = false;
		col_str='a'
	}

	ls_em_per = em_per.text
	
	gd_1.redraw = false
	
	
	var j_from	= cc_from.index+1
	var j_to			= cc_to.index+j_from
	var ls_year_name
	alert(j_from+'/'+j_to	)
	//if (j_from > j_to ) {alert('기간이 잘못됬습니다');return;}
	
		for (i=1; i<=ds_1.CountRow; i++) {
			ls_unit = ds_1.namevalue(i, 'unit')
			if  ( ((ds_1.RowMark(i) == 1) && (tb_1.activeindex==1) && (ls_unit!='식')) || ((ds_1.RowMark(i) == 1) && (tb_1.activeindex==2) && (ls_unit=='식')) ){
				
				for(j=j_from; j<=j_to; j++){
					colidx = j+15				

					ls_year_name = gd_1.ColumnProp(col_str+j, 'NAME')
					//alert(ls_year_name)
					if ( ls_year_name !='전년누계'&&ls_year_name !='잔여누계'){
						if (isQty){
							ls_qty = ds_1.namevalue(i, 'qty');
							c_qty = ls_qty * ls_em_per/100
							ds_1.ColumnValue(i, colidx ) = parseInt(c_qty*1000)/1000;
							//alert(j+'/'+i)
						}
						else{
							ls_amt = ds_1.namevalue(i, 'amt');
							c_amt = ls_amt * ls_em_per/100
							ds_1.ColumnValue(i, colidx +60) = parseInt(c_amt);
						}
					}
					else{
						j_to = j_to+1;
					}
				}
			}
		}
	
	gd_1.redraw = true

	ib_app = false
}
//---------------------------------------------------------------------------
function ret_from()
//---------------------------------------------------------------------------
{
	var ls_seq, std_date

	 ls_dept_code	= is_dept_code
	 ls_chg_seq		=is_chg_seq
	 ls_cat_text		= ds_select.namevalue(ds_select.rowposition, 'cat_text')
	 ls_std_date = em_date.text+'.01.01'
	 
	ls_seq = "select distinct to_char(cd.year,'yyyy.mm') select_1 "+
														"		from c_progress_detail cd, "+
														"			  y_chg_budget_detail bd  "+
														"		where cd.dept_code = '"+ls_dept_code+"'"+
														"		  and cd.chg_seq   = '"+ls_chg_seq+"'"+
														"			 and cd.dept_code = bd.dept_code "+
														"			 and cd.chg_no_seq = bd.chg_no_seq "+
														"			 and cd.spec_unq_num = bd.spec_unq_num "+
														"			 and cd.spec_no_seq  = bd.spec_no_seq "+
														"			 and nvl(bd.cat_text,'....')  like decode('"+ls_cat_text+"', 'ALL', '%', '"+ls_cat_text+"') "+
														"      and cd.year between '"+ls_std_date+"' and add_months(to_date('"+ls_std_date+"'), 35)"   +
														"      and cd.year >='"+is_work_dt.substr(0, 7)+".01'"+
														"	  order by to_char(cd.year,'yyyy.mm') "

	
	if ((ls_dept_code != s_dept_code)||(ls_chg_seq != s_chg_seq)||(ls_cat_text != s_cat_text)||(ls_std_date != s_std_date)){
		
		ll_cnt = f_ds_select_q("ds_from",ls_seq)
		s_dept_code = ls_dept_code 
		s_chg_seq		= ls_chg_seq		
		s_cat_text		= ls_cat_text		
		s_std_date   =ls_std_date
		
	}
	ret_to()
 }
 //---------------------------------------------------------------------------
function ret_to()
//---------------------------------------------------------------------------
{
	var ls_seq

	 ls_dept_code	= is_dept_code
	 ls_chg_seq		=is_chg_seq
	 ls_cat_text		= ds_select.namevalue(ds_select.rowposition, 'cat_text')
	 ls_from           = ds_from.namevalue(ds_from.rowposition, 'select_1')
	 ls_std_date = em_date.text+'.01.01'
	 
	ls_seq = "select distinct to_char(cd.year,'yyyy.mm') select_1 "+
														"		from c_progress_detail cd, "+
														"			  y_chg_budget_detail bd  "+
														"		where cd.dept_code = '"+ls_dept_code+"'"+
														"		  and cd.chg_seq   = '"+ls_chg_seq+"'"+
														"			 and cd.dept_code = bd.dept_code "+
														"			 and cd.chg_no_seq = bd.chg_no_seq "+
														"			 and cd.spec_unq_num = bd.spec_unq_num "+
														"			 and cd.spec_no_seq  = bd.spec_no_seq "+
														"			 and nvl(bd.cat_text,'....')  like decode('"+ls_cat_text+"', 'ALL', '%', '"+ls_cat_text+"') "+
														"      and cd.year between '"+ls_std_date+"' and add_months(to_date('"+ls_std_date+"'), 35)"   +
														"         and to_char(cd.year,'yyyy.mm') >= '"+ls_from+"'"+
														"	  order by to_char(cd.year,'yyyy.mm') "

	ll_cnt = f_ds_select_q("ds_to",ls_seq)
	/*
	if ((ls_dept_code != s_dept_code)||(ls_chg_seq != s_chg_seq)||(ls_cat_text != s_cat_text)||(ls_from != s_from)){
		ll_cnt = f_ds_select_q("ds_to",ls_seq)
		cc_to.index = 0
		s_dept_code = ls_dept_code 
		s_chg_seq		= ls_chg_seq		
		s_cat_text		= ls_cat_text		
		s_from				= ls_from
	}
	*/
 }
//----------------------------------------------------------------
function window_onload()                  // window open event 
//-----------------------------------------------------------------
{  
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
	 gd_1.format = is_format_1

	var result=	 top.frames['security'].gs_param.value

	em_date.text = is_work_date.substr(0,4)
   
	array = result.split("@");
   is_dept_code = array[0]
   is_chg_seq = array[1]
	is_chg_no_seq = array[2]
	is_const_start_date = array[3]
	is_const_end_date = array[4]
   is_parent_sec= array[5]
	is_work_dt = array[6]

	const_fromto.value = is_const_start_date+' ~ '+ is_const_end_date

   is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	dept_name.value = is_dept_name

	 ds_select.dataid = gs_home+ "/const/c_web/02/c_progress_monthly_plan_cat_1q.jsp?arg_dept_code="+is_dept_code+
																																															"&arg_chg_no_seq="  +  is_chg_no_seq 
	 ds_select.syncload=true
	 ds_select.reset()

	 

	//tab_changed(1)
	//btnquery_onclick()
    
}
</SCRIPT>

<!-- ======================================================================= -->
<!--                     Event                          -->
<!-- ======================================================================= -->
<script language=JavaScript for=ccombo1 event=OnSelChange()>
	btnsave_onclick()
	btnquery_onclick()
	//setTimeout('btnquery_onclick()',1)
</script>

<!-- 
<script language=JavaScript for=ccombo1 event=OnCloseUp()>
	btnsave_onclick()
	setTimeout('btnquery_onclick()',1)
</script>
 -->

 <SCRIPT language=JavaScript event=OnSelChanged(nIndex) for=tb_1>
{	
	il_nIndex = nIndex
  tab_changed(nIndex)
  
 }
</SCRIPT>
<script language=JavaScript for=ds_1 event=OnRowPosChanged(row)>
	 make_edit()

</script>

<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>
	//alert(parseInt(ds_1.NameValue(row,'amt')))
	//alert(parseInt(gd_1.VirtualString(row,'tot_amt')))
	if (ib_onload) {return}
	var tag = colid.substr(0,1)
	
	if (ib_app){ /* 일괄적용할때는 적용율에 의한 계산 하고 그냥입력할때는 단가로 계산한다*/
		
		var ls_em_per = em_per.text
		if(tb_1.activeindex == 1&&tag =='q'){
			var ll_qty = ds_1.namevalue(row,'qty')
			var ll_tot_qty = gd_1.VirtualString(row,'tot_qty')
			ll_tot_qty = parseFloat(ll_tot_qty.replace(/,/g,''))

			if (ll_qty == ll_tot_qty){
				var ll_amt = ds_1.namevalue(row,'amt')
				var ll_tot_amt = gd_1.VirtualString(row,'tot_amt')
				ll_tot_amt = ll_tot_amt.replace(/,/g,'')
				ll_tot_amt = parseInt(ll_tot_amt)
				ds_1.namevalue(row, 'a'+colid.substr(1,2) ) = ll_amt - ll_tot_amt + ds_1.namevalue(row, 'a'+colid.substr(1,2));
			}
			else{
				var ls_amt = ds_1.namevalue(row,'amt');
				var c_amt = ls_amt * ls_em_per/100
				ds_1.namevalue(row, 'a'+colid.substr(1,2) ) = parseInt(c_amt);
			}
			
		}
		if(tb_1.activeindex == 2&&tag =='a'){
			var ll_amt = ds_1.namevalue(row,'amt')
			var ll_tot_amt = gd_1.VirtualString(row,'tot_amt')
			ll_tot_amt = parseInt(ll_tot_amt.replace(/,/g,''))

			if (ll_amt == ll_tot_amt){
				var ll_qty = ds_1.namevalue(row,'qty')
				var ll_tot_qty = gd_1.VirtualString(row,'tot_qty')
				ll_tot_qty = ll_tot_qty.replace(/,/g,'')
				ll_tot_qty = parseFloat(ll_tot_qty)
				ds_1.namevalue(row, 'q'+colid.substr(1,2) ) = ll_qty - ll_tot_qty + ds_1.namevalue(row, 'q'+colid.substr(1,2));
			}
			else{
				var ls_qty = ds_1.namevalue(row,'qty');
				var c_qty = ls_qty * ls_em_per/100
				ds_1.namevalue(row, 'q'+colid.substr(1,2) ) = parseInt(c_qty*1000)/1000;
			}
		}

	}
	else{
		if(tb_1.activeindex == 1){
			if (tag =='q'){
				var ll_qty = ds_1.namevalue(row,'qty')
				var ll_tot_qty = gd_1.VirtualString(row,'tot_qty')
				ll_tot_qty = parseFloat(ll_tot_qty.replace(/,/g,''))
				
				if (ll_qty == ll_tot_qty){
					var ll_amt = ds_1.namevalue(row,'amt')
					var ll_tot_amt = gd_1.VirtualString(row,'tot_amt')
					ll_tot_amt = ll_tot_amt.replace(/,/g,'')
					ll_tot_amt = parseInt(ll_tot_amt)
					ds_1.namevalue(row, 'a'+colid.substr(1,2) ) = ll_amt - ll_tot_amt + ds_1.namevalue(row, 'a'+colid.substr(1,2));
					
				}
				else{
					var amt = ds_1.namevalue(row, colid) * ds_1.namevalue(row, 'price')
					ds_1.namevalue(row, 'a'+colid.substr(1,2) ) = parseInt(amt);
				}
			}
		}
		
		if(tb_1.activeindex == 2){
			if (tag =='a'){
				var ll_amt = ds_1.namevalue(row,'amt')
				var ll_tot_amt = gd_1.VirtualString(row,'tot_amt')
				ll_tot_amt = parseInt(ll_tot_amt.replace(/,/g,''))

				if (ll_amt == ll_tot_amt){
					
					var ll_qty = ds_1.namevalue(row,'qty')
					var ll_tot_qty = gd_1.VirtualString(row,'tot_qty')
					ll_tot_qty = ll_tot_qty.replace(/,/g,'')
					ll_tot_qty = parseFloat(ll_tot_qty)
					ds_1.namevalue(row, 'q'+colid.substr(1,2) ) = ll_qty - ll_tot_qty + ds_1.namevalue(row, 'q'+colid.substr(1,2));
				}
				else{
					var amt = ds_1.namevalue(row, colid) / ds_1.namevalue(row, 'price')
					ds_1.namevalue(row, 'q'+colid.substr(1,2) ) = parseInt(amt*1000)/1000;
				}
			}
		}
	}
	

	//alert(tag)
	//ds_1.namevalue(row
</script>


<SCRIPT language=JavaScript for=ds_select event=OnLoadError()>
  alert("Error Code(ds_select) : " + ds_select.ErrorCode + "\n" + "Error Message : " + ds_select.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code(ds_spcall) : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code (tr_1): " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<script language=JavaScript for=gd_1 event=OnUserColor(row,eventid)>
	if (eventid == 'color1') {
	   var qty       = ds_1.NameValue(row,'qty')
		var tot_qty = gd_1.VirtualString(row,'tot_qty')
		
		qty = qty.toString()
		tot_qty = tot_qty.toString()

		qty			= qty.replace(/,/g,'')
		tot_qty = tot_qty.replace(/,/g,'')

		qty			= parseFloat(qty)
		tot_qty = parseFloat(tot_qty)

		if (qty < tot_qty ) {
        return 'red'
		}
		else if( qty == tot_qty){
			return "skyblue"
		}
		else {
			if ((row % 2) == 0){
				return "#F4F2D8"
			}
			else{
				return "ffffff"
			}
		}
	}
  if (eventid == 'color2') {
		var amt       = ds_1.NameValue(row,'amt')
		var tot_amt = gd_1.VirtualString(row,'tot_amt')
		
		amt = amt.toString()
		tot_amt = tot_amt.toString()

		amt			= amt.replace(/,/g,'')
		tot_amt = tot_amt.replace(/,/g,'')

		amt			= parseFloat(amt)
		tot_amt = parseFloat(tot_amt)
		 
		if (amt < tot_amt ) {
			
			return 'red'
		}
		else if( amt == tot_amt){
			return "skyblue"
		}
		else {
			if ((row % 2) == 0){
				return "#F4F2D8"
			}
			else{
				return "ffffff"
			}
		}
	}
  
  
  
  var ls_temp
  ls_id = eventid
  ls_temp = ls_id.substr(1,1)
	
  
  if (ds_1.NameValue(row, ls_id) == 0) {
     if ((row % 2) == 0)
         return "#F4F2D8"
     else
         return "ffffff"
   }
  else
     return "#99FFFF"   
	
</SCRIPT>

<script language=JavaScript for=cc_from event=OnDropDown()>
	cc_to.enable =true
	ret_from()
</script>

<!-- ======================================================================= -->
<!--                      Component                          -->
<!-- ======================================================================= -->

	
 <comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_from
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_to
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
      
 <comment id="__NSID__"><Object id=ds_select1
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_select2
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
    style="Z-INDEX: 101; LEFT: 156px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 >
	 <param name=SubSumExpr          value="total ">
       </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 101; LEFT: 156px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 >
       </OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_update 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_spcall
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
    

<comment id="__NSID__"><OBJECT id=tr_1 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:c_progress_monthly_plan_input36_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>

</HEAD>
<!-- ======================================================================= -->
<!--                     Body                         -->
<!-- ======================================================================= -->

<BODY style="FONT-SIZE: 12px;margin=0" onload=setTimeout('window_onload()',1)  >
<div class=main_div>
	<table width="100%"  height="100%"  BORDER="0"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px; ">
		<TR height="20px">
			<TD class=td_green>
					<table border= "0" cellpadding="0" cellspacing="0" class=main_table>
						<tr>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td width="45px" class=font_green_bold>현장명</td>
							<td width="166">
								<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"   style="ime-mode:active"   style=" FONT-SIZE: 12px" style="ime-mode:active " size=25 onkeyDown="keyDown()"  readonly >
							</td>
							<td width="15px"><img src="../../../image/bullet3.gif"></td>
							<td width="58px" class=font_green_bold>집행공종</td>
								<td width=250px>
										<comment id="__NSID__"><object id=ccombo1 classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F height=200px width=100%  style=" FONT-SIZE: 12px; font-weight:bold">
											<param name=ComboDataID  value=ds_select>
											<param name=CodeCColumn        value=cat_text>
											<param name=DataCColumn         value=cat_text>
										</object></comment> <script> __ws__(__NSID__);</script>
								</td>
								<td width="15px"><img src="../../../image/bullet3.gif"></td>
								<td width="58px" class=font_green_bold>공사기간</td>
								<td width=140px >
										<input id=const_fromto type=text  readonly style="width: 100%; ; " align=center class=td_green >

								</td>
								<td width="15px"><img src="../../../image/bullet3.gif"></td>
								<td width="45px" class=font_green_bold>기준년</td>
								<td width="60px	">
									<comment id="__NSID__"><OBJECT id=em_date 
												 style="WIDTH: 50px; HEIGHT: 20px; background: white;" 
												classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
												 <PARAM NAME="Alignment" VALUE="1">
												 <PARAM NAME="IsComma" VALUE="0">
												 <PARAM NAME="MaxLength" VALUE="6">
												 <PARAM NAME="Format" VALUE="YYYY">
												 <PARAM NAME="Numeric" VALUE="0">
												 <PARAM NAME="SelectAll" VALUE="-1">
										</OBJECT></comment> <script> __ws__(__NSID__);</script>
								</td>
								<td width="*">&nbsp;</td>
								<td width=160px>
										<input id=bt_excel_down type="button" value="엑셀변환"  class="img_btn4_1"
									onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;"  onclick=excel_down()>
										
										<input type="button" value="닫기" 
													 class="img_btnClose"
													onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;" onclick="close_rtn()">
								</td>
						</tr>
					</table>
			</TD>
		</TR>
		</TR>
		<TR height="20px">
			<TD class=td_green>
				<table border= "0" cellpadding="0" cellspacing="0" class=main_table>
					<tr>
						<td width=100px>
							<comment id="__NSID__"><OBJECT id=tb_1 
									 style=" WIDTH: 100%; HEIGHT: 20px" 
									 classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
								  <param name="BackColor"  value="#BBE0F4">
								  <param name="TextColor"  value="BLACK">
								  <PARAM NAME="Format" VALUE="
									 <T>divid=tab_page_1 title='수량'</T>
									 <T>divid=tab_page_2 title='금액'</T>">
							</OBJECT></comment> <script> __ws__(__NSID__);</script>
						</td>
						<td width="*">&nbsp;</td>
						<td width="15px"><img src="../../../image/bullet3.gif"></td>
						<td width="80px" class=font_green_bold>요율일괄적용</td>
						<td width=50px>
							<comment id="__NSID__"><OBJECT id=em_per 
									 style=" WIDTH: 100%; background-color:white " 
									classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
									 <PARAM NAME="Alignment" VALUE="2">
									 <PARAM NAME="MaxLength" VALUE="3">
									 <PARAM NAME="Format" VALUE="000.00">
									  <param name= "InputFormat"   value="000.00">
									  <param name=MaxDecimalPlace   value=2>
									 <PARAM NAME="Numeric" VALUE=true>
									 <param name="ShowLiteral"   value="true">
									 <PARAM NAME="SelectAll" VALUE="true">
									 <param name=VisibleMaxDecimal   value="false">
									 <param name=PromptChar   value="-">
							</OBJECT></comment> <script> __ws__(__NSID__);</script>
						</td>
						<td width="11px" class=font_green_bold>%</td>
						<td width="15px"><img src="../../../image/bullet3.gif"></td>
						<td width="30px" class=font_green_bold>기간</td>
						<td width=80px>
								<comment id="__NSID__"><object id=cc_from classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F height=200px width=100%  style=" FONT-SIZE: 12px; ">
									<param name=ComboDataID  value=ds_from>
									<param name=CodeCColumn        value=select_1>
									<param name=DataCColumn         value=select_1>
								</object></comment> <script> __ws__(__NSID__);</script>
						</td>
						<td width=80px>
								<comment id="__NSID__"><object id=cc_to classid=clsid:FD4C6571-DD20-11D2-973D-00104B15E56F height=200px width=100%  style=" FONT-SIZE: 12px; ">
									<param name=ComboDataID  value=ds_to>
									<param name=CodeCColumn        value=select_1>
									<param name=DataCColumn         value=select_1>
									<param name=Enable  value="false">
								</object></comment> <script> __ws__(__NSID__);</script>
						</td>
						<td width=100px>
						<input type=button value="일괄적용" class="img_btn4_1" 
						onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;" onclick=app_per()>
						</td>
						
					</tr>
				</table>
			</TD>
		</tr>
		<TR >
			<TD>
					<comment id="__NSID__"><OBJECT id=gd_1 
					 style=" WIDTH: 100%; HEIGHT: 100%" 
					 classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
					<PARAM NAME="BorderStyle"  VALUE=1>
					<PARAM NAME="Editable" VALUE="1">
					<PARAM NAME="ColSizing" VALUE="1">
					<!-- <PARAM NAME="SortView"  VALUE="Left"> -->
					<param name=ReDraw  value="false">
					<param name=AllShowEdit  value="true">
					<param name=ColSelect  value=false>
					<param name=MultiRowSelect  value="true">
					<PARAM NAME="DataID" VALUE=""></OBJECT></comment> <script> __ws__(__NSID__);</script>
			</TD>
		</TR>
	</table>
</div>
</BODY></HTML>
