<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : c_progress_parent_mul_1h.html 	-->
<!-- 2. 유형(시나리오): 조회및 입력											-->
<!-- 3. 기 능 정 의   : 보할공정 입력   	-->
<!-- 4. 변 경 이 력   :  박두현 작성												-->
<!-- 5. 관련프로그램  :																-->
<!-- 6. 특 기 사 항   :															-->
<!-- *************************************************************		-->
<HTML>
<LINK rel="stylesheet" type="text/css" href="/werp/erpw.css">
<HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>

var gs_home = top.frames['security'].gs_home.value


var is_ds_0_addr = gs_home + '/const/c_web/02/c_progress_parent_detail_1q.jsp?arg_dept_code='         
var is_ds_1_addr = gs_home + '/const/c_web/02/c_progress_parent_1q.jsp?arg_dept_code='         
var is_tr_1_addr = gs_home + '/const/c_web/02/c_progress_parent_1tr.jsp'         
var is_ds_2_addr = 'c_progress_detail_mul_1q.jsp?arg_dept_code='         
var is_tr_2_addr = gs_home + '/const/c_web/02/c_progress_detail_1tr.jsp'
var is_ds_cross_addr = 'c_progress_cross_input_csv.csv'
var is_dept_code = ""
var is_dept_name = ""
var is_start_date = ""
var is_end_date = ""
var il_chg_no_seq=1
var il_screen=2
var is_update
var ret_update
var il_row_set=0
var is_colid=''
var arr_title = new Array(); 
var ds_1_success,ds_2_success='Y'    // update가 성공적이다.
var il_tot_sum=0         //실행 총합계금액
var il_tot_per=0         //실행 총율 
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
 document.all.LowerFrame.style.visibility="visible"; 
// alert('aa')
 //setTimeout('retrieve()',1);
 retrieve() 
}

//------------------------------------------------------------------------
function retrieve()                     // 조회  
//------------------------------------------------------------------------
{  // parent  detail 을 조회(cross tab전단계을위해 전체를 조회)
   ds_0.DataID = is_ds_0_addr + is_dept_code + '&arg_chg_no_seq=' + il_chg_no_seq 
   ds_0.SyncLoad=true
   ds_0.Reset()
   if (ds_0.CountRow == 0) {
     plan_cal()
   }  
   
   ds_1.DataID = is_ds_1_addr + is_dept_code + '&arg_chg_no_seq=' + il_chg_no_seq 
   ds_1.SyncLoad=true
   ds_1.Reset()
   if (ds_1.CountRow == 0) {
      alert('자료집계가 잘못되었습니다')
      return
   }

   ds_2.DataID = is_ds_2_addr + is_dept_code + '&arg_chg_no_seq=' +  il_chg_no_seq
   ds_2.SyncLoad=true
   ds_2.Reset()

   // cross - tab 용 
   
   ds_cross.DataID = is_ds_cross_addr 
   ds_cross.SyncLoad=true
   ds_cross.Reset()
   ds_cross.ClearData()
   
   ds_cross_create()
   
}

//----------------------------------------------------------------------------
function ds_cross_create()                     // cross -tab 강제로 만들기(유저컬러때문에 만듬)
//---------------------------------------------------------------------------- 
{
  gd_1.ReDraw=false
  var i,j=0,ll_row,ll_search_row
  var k=-1;   // year data(실행)
  il_seq = 0
  var ls_data
  var ll_com 
  il_tot_sum=il_tot_per=0
  for (i=1;i<=ds_0.CountRow;i++) {
      ll_com = ds_0.NameValue(i,'seq') 
      if (ll_com != il_seq) {
         il_seq = ds_0.NameValue(i,'seq')
         ds_cross.Addrow()
         ll_row = ds_cross.RowPosition
         ds_cross.NameValue(ll_row,'seq') = ds_0.NameValue(i,'seq')
         ds_cross.NameValue(ll_row,'name') = ds_0.NameValue(i,'name')
         ds_cross.NameValue(ll_row,'wbs_code') = ds_0.NameValue(i,'wbs_code')
         ds_cross.NameValue(ll_row,'plan_amt') = ds_0.NameValue(i,'plan_amt')
         ds_cross.NameValue(ll_row,'plan_per') = ds_0.NameValue(i,'plan_per')
         ds_cross.NameValue(ll_row,'plan_amt_y') = ds_0.NameValue(i,'plan_amt_y')
         ds_cross.NameValue(ll_row,'plan_per_y') = ds_0.NameValue(i,'plan_per_y')
         ds_cross.NameValue(ll_row,'year') = ds_0.NameValue(i,'year')
         ds_cross.NameValue(ll_row,'invest_class') = ds_0.NameValue(i,'invest_class')
         ds_cross.NameValue(ll_row,'sum_plan_mm_per') = ds_0.NameValue(i,'sum_plan_mm_per')
         ds_cross.NameValue(ll_row,'sum_plan_mm_amt') = ds_0.NameValue(i,'sum_plan_mm_amt')
         il_tot_sum = il_tot_sum + ds_0.NameValue(i,'plan_amt_y')    //실행금액( 'A' 공종 빼고)
         il_tot_per = il_tot_sum + ds_0.NameValue(i,'plan_pert_y')
         if (j > 0) il_totcnt = j         //옆으로의 건수 
         j=0
        
      }
      j = j + 1
      
      ds_cross.NameValue(ll_row,'p' + j) = ds_0.NameValue(i,'plan_mm_per')
      ds_cross.NameValue(ll_row,'amt' + j) = ds_0.NameValue(i,'plan_mm_amt')
 //   ds_cross.NameValue(ll_row,'m' + j) = ds_0.NameValue(i,'plan_mm_amt')
      if (ll_row == 1)    //타이틀 보관 
         arr_title[j] = ds_0.NameValue(i,'yyyy_mm')
  }    
   gd_1_format()
   ds_cross.ResetStatus()
   ds_cross.RowPosition = 1
   gd_1.ReDraw=true
}
//----------------------------------------------------------------
function gd_1_title_color()         // gd_1  타이틀 변결
//----------------------------------------------------------------
{
  var ls_year,ls_year_aft,i,j,ls_sum_year
  j=0
  ls_year = ''

  for (i=1;i<=200;i++) {
      eval("ls_year_aft = rds_" + tb_1.ActiveIndex + ".NameValue(1,'xkeyname_" +  i + "') ")
      if (ls_year_aft == null) break
      ls_sum_year = ls_year_aft                       //gd_3 에서 년월을 보여주지 않기위해서 
      ls_year_aft = ls_year_aft.substr(0,4)
      if (tb_1.ActiveIndex == 3 || tb_1.ActiveIndex == 6) {
            if (ls_sum_year.substr(4,1) == '.')   {                 //소계만 display 
               eval("gd_" + tb_1.ActiveIndex + ".ColumnProp('real_amt_" +  i + "', 'Show') = false")
            }   
      }   
      if (ls_year != ls_year_aft) {
         j=j+1
         ls_year = ls_year_aft
      }
      if (tb_1.ActiveIndex == 3 || tb_1.ActiveIndex == 6) {}
      else {
        if ((j % 2) == 1) 
           eval("gd_" + tb_1.ActiveIndex + ".ColumnProp('real_amt_"  + i + "', 'HeadBgColor') = '#FFFF99'")
        else
           eval("gd_" + tb_1.ActiveIndex + ".ColumnProp('real_amt_"  + i + "', 'HeadBgColor') = '#FFCCFF'")
     }      
         
  }    
}

//----------------------------------------------------------------------------
function gd_1_format()                     // 공정표 그리기 
//---------------------------------------------------------------------------- 
{
  var i

  for (i=1;i<=il_totcnt;i++) {
     gd_1.ColumnProp('p'+i, 'Show')=true
  }
  for (i=il_totcnt + 1;i<=60;i++) {
     gd_1.ColumnProp('p'+i, 'Show')=false
  }
  var ls_year,ls_year_aft,j
  j=0
  ls_year = ''
  for (i=1;i<=il_totcnt;i++) {
      gd_1.ColumnProp('p'+i, 'NAME')=arr_title[i]
      ls_year_aft = arr_title[i]                       
      ls_year_aft = ls_year_aft.substr(0,4)
      if (ls_year != ls_year_aft) {
         j=j+1
         ls_year = ls_year_aft
      }
      if ((j % 2) == 1) 
         gd_1.ColumnProp('p'  + i , 'HeadBgColor') = '#FFFF99'
      else
         gd_1.ColumnProp('p'  + i , 'HeadBgColor') =  '#FFCCFF'
  }
}

//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{

}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{

}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{

 }
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{

   if (ds_cross.IsUpdated) 
          if  (confirm("변경되었습니다 저장하시겠습니까?")) {}
          else return

   var i
   
   for (i=1; i<=ds_cross.CountRow; i++) {
      if (ds_cross.SysStatus(i) == 3) {
         ds_2_update_rtn(i)
      }
   }

    ds_2_success = 'Y'
    
    if (ds_2.IsUpdated) {
       ds_2_success = 'N'
       tr_2.Post()
    }   


    ds_1_success = 'Y'
    if (ds_1.IsUpdated) {
       ds_1_success = 'Y'
       tr_1.Post()
    }   
    recal_cal()   
    if (ds_1_success == 'Y' && ds_2_success == 'Y') 
       ds_cross.ResetStatus()

}
//----------------------------------------------------------------------------
function ds_2_update_rtn(row)                     // ds_2 가로를 세로로 변경 
//---------------------------------------------------------------------------- 
{
  var ii
  var ls_wbs_code
  ls_wbs_code = ds_cross.NameValue(row,'wbs_code')
  ll_row = ds_2.NameValueRow('wbs_code',ls_wbs_code)
  for (ii=1;ii<=il_totcnt;ii++) {
      ds_2.NameValue(ll_row,'plan_mm_per') = ds_cross.NameValue(row,'p'+ii)
      ds_2.NameValue(ll_row,'plan_mm_amt') =ds_cross.NameValue(row,'amt'+ii)
      ll_row++
  }    
  ll_row = ds_1.NameValueRow('wbs_code',ls_wbs_code)
  ds_1.NameValue(row,'plan_per') = ds_cross.NameValue(row,'plan_per')
}

//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
  ds_2.Undo(ds_2.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	  if (ds_2.IsUpdated) {
     if  (confirm("변경되었습니다 저장하시겠습니까?")) 
        {  //저장 routine
        }   
 
   }     

// parent.frames['main_ct'].window.close()     
}

//---------------------------------------------------------------------------
function recal_cal()
//---------------------------------------------------------------------------
{
        ds_update.DataID = 'y_c_progress_parent_cmp_procedure.jsp?arg_dept_code=' + is_dept_code + 
                           '&arg_chg_no_seq=' + il_chg_no_seq 
        ds_update.SyncLoad = true
        ds_update.reset()

}

//---------------------------------------------------------------------------
function plan_cal()
//---------------------------------------------------------------------------
{
      
       if  (confirm("자료를 재집계하시겠습니까?")) {}
          else return
        ls_date = em_start_date.text
        ls_date = ls_date.substr(0,8) + '01'
        ds_update.DataID = 'y_c_progress_parent_procedure.jsp?arg_dept_code=' + is_dept_code + 
                           '&arg_chg_no_seq=' + il_chg_no_seq +
                           '&arg_start_date=' +ls_date + 
                           '&arg_last_date=' + em_end_date.text 
        ds_update.SyncLoad = true
        ds_update.reset()
        btnquery_onclick()

}
//---------------------------------------------------------------------------
function real_amt_rtn()                     //실적 집계 
//---------------------------------------------------------------------------
{
   var ls_yymm=''
   ls_yymm =prompt("집계할 시작년월-종료년월 입력하십시요(yyyy.mm) :예제: 2003.01-2003.04",ls_yymm)

   if (ls_yymm == null)	//취소
      return
   var ls_form,ls_to,ll_len
   ll_len = ls_yymm.length
   if (ll_len < 7) {
      alert('날짜를 잘못입력하셨습니다')
      return
   }   
   if (ll_len == 7) {
       ls_from = ls_yymm + '.01'
       ls_to = ls_from
   }    
   else {
      if (ll_len != 15) {
         alert('날짜를 잘못입력하셨습니다 \n예제처럼 다시 입력하십시요')
         return
      }   
      else {
         ls_from = ls_yymm.substr(0,7) + '.01'
         ls_to   = ls_yymm.substr(8,7) + '.01'
      }
   }      

   if (ls_to >= ls_from) {}
   else {
      alert('종료년월이 시작년월보다 큽니다 \n예제처럼 다시 입력하십시요')
      return
   }            
   ls_yymm = ls_yymm + '.01' 
   var ret
   ret =  f_check_date(ls_from) 
   if (ret) {}
   else {
      alert('시작년월이 잘못입력되었습니다')
      return
   }
   ret =  f_check_date(ls_to) 
   if (ret) {}
   else {
      alert('종료년월이  잘못입력되었습니다')
      return
   }
   var ls_temp_1,ls_temp_2
   ls_temp_1 = em_start_date.text
   ls_temp_1 = ls_temp_1.substr(0,8) + '01'
   ls_temp_2 = em_end_date.text
   ls_temp_2 = ls_temp_2.substr(0,8) + '31'

   if (ls_from >=ls_temp_1 &&  ls_to <=ls_temp_2) {}
   else {
      alert('입력한 날짜가 시작일과 종료일사이에 있지않습니다')
      return
   }   
   
   ds_update.DataID = 'y_c_progress_real_procedure.jsp?arg_dept_code=' + is_dept_code + 
                      '&arg_chg_no_seq=' + il_chg_no_seq +
                      '&arg_start_date=' + ls_from + 
                      '&arg_last_date=' + ls_to
   ds_update.SyncLoad = true
   ds_update.reset()
        
   recal_cal()    // 전체 재계산 
   btnquery_onclick() 

}


//---------------------------------------------------------------------------
function plan_amt_cal()
//---------------------------------------------------------------------------
{

  ls_temp = gd_1.GetColumn();

  if (ls_temp.substr(0,1) != 'p') {
     alert('컬럼이 년월이 아닙니다')
     return
  }
  
 var ll_amt
 var ls_colid
 ls_colid = 'amt' + ls_temp.substr(1,3)
 ll_amt = ds_cross.NameValue(ds_cross.RowPosition,'plan_amt') - ds_cross.NameValue(ds_cross.RowPosition,'sum_plan_mm_amt')
 ds_cross.NameValue(ds_cross.RowPosition,ls_colid) =   ds_cross.NameValue(ds_cross.RowPosition,ls_colid) + ll_amt
 ds_cross.NameValue(ds_cross.RowPosition,'sum_plan_mm_amt') =  ds_cross.NameValue(ds_cross.RowPosition,'plan_amt')
 
// ds_cross_onexit_rtn(il_row_set,is_colid,ds_cross.OrgNameValue(il_row_set,is_colid))
  
}
//---------------------------------------------------------------------------
function plan_per_cal()
//---------------------------------------------------------------------------
{
  var ls_colid
  ls_colid = gd_1.GetColumn()
  if (ls_colid.substr(0,1) != 'p') {
     alert('컬럼이 년월이 아닙니다')
     return
  }
  
 var ll_per,ll_temp
 ll_per = (ds_cross.NameValue(ds_cross.RowPosition,'plan_per') * 100) 
 ll_per = gf_point(ll_per,0,'r')
 ll_temp =  (ds_cross.NameValue(ds_cross.RowPosition,'sum_plan_mm_per') * 100)
 ll_temp = gf_point(ll_temp,0,'r')
 ll_per = ll_per - ll_temp    //차이율 계산 
 ll_per = ll_per / 100
 ll_per = gf_point(ll_per,2,'c')
 ds_cross.NameValue(ds_cross.RowPosition,ls_colid) =   ds_cross.NameValue(ds_cross.RowPosition,ls_colid) + ll_per
 ds_cross_onexit_rtn(ds_cross.RowPosition,ls_colid,'','2')
  
  
}
//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_screen = focus
}
//---------------------------------------------------------------------------
function cross_rtn()                      // 보할공정보기  
//---------------------------------------------------------------------------
{
   var ls_parm
   ls_parm = is_dept_code + '@' + is_dept_name + '@' + il_chg_no_seq  
	is_returnvalue = window.showModalDialog("c_progress_cross_1h.html" ,ls_parm,"dialogWidth:"+1200+"px; dialogHeight:"+800+"px");

}
 

//---------------------------------------------------------------------------
function close_rtn()                      // 닫기 
//---------------------------------------------------------------------------
{
     top.frames['main_ct'].location.href(gs_home + "/const/c_web/02/c_chg_progress_1h.html" +"?"+ret_update)

}
//---------------------------------------------------------------------------
function ds_cross_onexit_rtn(row,colid,olddata,arg_gubun)            // arg_gubun  '1' -> on exit event /  '2'-> 복사 
//---------------------------------------------------------------------------
{
  if (arg_gubun == 1)
     if (ds_cross.NameValue(row,colid) == olddata) return
  if (colid == 'plan_per') {
     ds_cross.NameValue(row,'plan_per_y') = ds_cross.NameValue(row,'plan_per')
     return
  }   
  var ll_per1,ll_per2,ls_temp
  if (colid.length <= 3) { // p1 <> p60  percent를 입력하였다.
     ll_per1 = ds_cross.NameValue(row,'plan_per')
     ll_per2 = ds_cross_sum_rtn(row,'plan_mm_per')   // 율 합계구하기 
     if (ll_per2 > ll_per1) { 
         alert(ll_per1 + '%가 넘었습니다')
         ds_cross.NameValue(row,colid) = 0
         ds_cross.NameValue(row,'amt' + colid.substr(1,10)) = (il_tot_sum * ds_cross.NameValue(row,colid)) / 100
         ds_cross.NameValue(row,'sum_plan_mm_amt') =  ds_cross_sum_rtn(row,'plan_mm_amt')
         return
     }
     ds_cross.NameValue(row,'sum_plan_mm_per') = ll_per2
     
     ds_cross.NameValue(row,'amt' + colid.substr(1,10)) = (il_tot_sum * ds_cross.NameValue(row,colid)) / 100
     ds_cross.NameValue(row,'sum_plan_mm_amt') =  ds_cross_sum_rtn(row,'plan_mm_amt')
  }
}  
//---------------------------------------------------------------------------
function ds_cross_sum_rtn(row,arg_colid)                      // 율 합계 
//---------------------------------------------------------------------------
{
  var ll_temp ,ll_tot
  ll_temp = 0
  ll_tot = 0
  var i
  if (arg_colid == 'plan_mm_per') {
     for (i=1;i<=il_totcnt;i++) {
         ll_temp =  (ds_cross.NameValue(row,'p' + i) * 100)
         ll_temp = gf_point(ll_temp,0,'r')            // * 100을 했을때 .9999 란값으로 계산될경우가 있으므로 round
         ll_tot = ll_tot + parseInt(ll_temp,10) 
     }
     ll_tot = ll_tot / 100
     return gf_point(ll_tot,2,'c')
  }       
  ll_temp = 0
  if (arg_colid == 'plan_mm_amt') {
     for (i=1;i<=il_totcnt;i++) {
         ll_temp = ll_temp + ds_cross.NameValue(row,'amt' + i)
     }
     return ll_temp
  }       
  
}
//---------------------------------------------------------------------
function gd_1_bt_excel()                     //엑셀붙히기
//---------------------------------------------------------------------
{
  var ls_col_type = new Array()    
  ls_col_type = ['p1','N','p2','N','p3','N','p4','N','p5','N','p6','N','p7','N','p8','N','p9','N','p10','N','p11','N','p12','N',
                 'p13','N','p14','N','p15','N','p16','N','p17','N','p18','N','p19','N','p20','N','p21','N','p22','N','p24','N','p_24','N',
                 'p25','N','p26','N','p27','N','p28','N','p29','N','p30','N','p31','N','p32','N','p33','N','p34','N','p35','N','p_36','N',
                 'p37','N','p38','N','p39','N','p40','N','p41','N','p42','N','p43','N','p44','N','p45','N','p46','N','p47','N','p_48','N',
                 'p49','N','p50','N','p51','N','p52','N','p53','N','p54','N','p55','N','p56','N','p57','N','p58','N','p59','N','p_60','N']


  var arg_auto_insert = 'N'   //자동 삽입 
   // 엑셀자료를 복사한후 GRID에 붙여넣기 하였을경우에 엑셀의 자료를 GRID에 복사및 추가 한다
   // arg_ds      : dataset명칭            예) 'ds_1'
   // arg_gd      : 그리드 명칭            예) 'gd_1'
   // arg_row     : current row            예)  ds_1.RowPosition
   // arg_tot_row : 총 건수                예)  ds_1.CountRow
   // arg_col_type: 컬럼 id와 정보(배열명) 예)  'name','S','cnt_qty','N'      type: S는 스트링   N: NUMERIC 필드 
   // arg_auto_insert: 복사할 row가 많으면 자동 addrow         예) 'Y': 자동 ADDROW   'N': ADDROW하지않음  

  ll_a = gf_excel_copy_row_col('ds_cross','gd_1',ds_cross.RowPosition,ds_cross.CountRow,ls_col_type,arg_auto_insert)     
  if (ll_a == 'err') { 
     alert('화면의 시작 셀을 정확히 클릭하십시요')
     return
  }
  var i  
  var j
  for (i=1;i<=ds_cross.CountRow;i++) {
     if (ds_cross.SysStatus(i) !=3)
         continue
     for (j=1;j<=il_totcnt;j++) {
         if (ds_cross.OrgNameValue(i,'p' + j) !=  ds_cross.NameValue(i,'p' + j) )  
             ds_cross_onexit_rtn(i,'p' + j,999)
     }        
  }       
  
  
}

//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()

	is_dept_code = top.frames['security'].gs_dept_code.value
	is_dept_name = top.frames['security'].gs_dept_name.value
	dept_name.value = is_dept_name
   var result=	 top.frames['security'].gs_param.value
	var array = new Array();

	array = result.split("@");
   il_chg_no_seq = array[0]

   em_start_date.text = array[1]
   em_end_date.text = array[2]
   ret_update= array[3]

   tr_2.Action = is_tr_2_addr
   tr_1.Action = is_tr_1_addr
   
   is_update = gf_initial_security()
   if (is_update == 'r') {
      gd_1.Editable = false
      bt_but.style.visibility="hidden"
   }
   btnquery_onclick()
}
</SCRIPT>

<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_0 event=OnLoadError()>
  alert("Error Code(ds_0) : " + ds_0.ErrorCode + "\n" + "Error Message : " + ds_0.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_cross event=OnLoadError()>
  alert("Error Code(ds_cross) : " + ds_cross.ErrorCode + "\n" + "Error Message : " + ds_cross.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>


<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code (tr_2): " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code (tr_1): " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_2 event=OnSuccess()>
  ds_2_success = 'Y'
</SCRIPT>
<SCRIPT language=JavaScript for=tr_1 event=OnSuccess()>
  ds_1_success = 'Y'
</SCRIPT>


<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_cross>
 if (row < 1) return 
 if (ds_cross.NameValue(row,'invest_class') == 'Y' && is_update != 'r') 
 {
    gd_1.Editable = true
 }   
 else {    
    gd_1.Editable = false
 }
 
</SCRIPT>
<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_cross.RowPosition == ds_1.CountRow)  {
       return
    }    
    else{    
        ds_cross.RowPosition++
    }    
}
</SCRIPT>


<script language=JavaScript for=ds_1 event=OnColumnChanged(row,colid)>

     

</SCRIPT>
<script language=JavaScript for=ds_2 event=OnColumnChanged(row,colid)>

</SCRIPT>
<script language=JavaScript for=gd_1 event=OnExit(row,colid,olddata)>
  ds_cross_onexit_rtn(row,colid,olddata,'1')
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnClick(row,colid)>
  il_row_set = row
  is_colid = colid
</SCRIPT>


<script language=JavaScript for=gd_1 event=OnRButtonDown(row,colid,xpos,ypos)>

  if (il_row_set != row) {
     alert('클릭으로 초기컬럼을 누르지 않았습니다')
     return
  }
  var ls_temp
  ls_temp = is_colid
  if (ls_temp.substr(0,1) != 'p') {
     alert('컬럼이 년월이 아닙니다')
     return
  }
  
  var ll_from_no
  var ll_to_no
  if (ls_temp.substr(1,1) >= '1' && ls_temp.substr(1,1) <=9) {}
  else {
     alert('컬럼이 년월이 아닙니다')
     return
  }
  ll_from_no = ls_temp.substr(1,ls_temp.length -1)
  if (colid.substr(1,1) >= '1' && colid.substr(1,1) <=9) {}
  else {
     alert('컬럼이 년월이 아닙니다')
     return
  }
  ll_to_no =  colid.substr(1,colid.length -1)
  ll_from_no = parseInt(ll_from_no,10) 
  ll_to_no = parseInt(ll_to_no,10)
 
  if  (confirm("복사하시겠습니까?")) {}
  else return
  
  var i
  if (ll_to_no > ll_from_no) {
     for (i=ll_from_no + 1;i<=ll_to_no;i++) {
         ds_cross.NameValue(row,'p' + i) = ds_cross.NameValue(row,'p' + ll_from_no)
         ds_cross_onexit_rtn(row,'p' + i,'','2')
     }
  }    
  else {
     for (i=ll_to_no ;i<=ll_from_no - 1;i++) {
         ds_cross.NameValue(row,'p' + i) =  ds_cross.NameValue(row,'p' + ll_from_no)    
         ds_cross_onexit_rtn(row,'p' + i,'','2')
     }
  } 
     
        
</SCRIPT>

<script language=JavaScript for=gd_1 event=OnUserColor(row,eventid)>
  if (eventid == 'color1') {
     if (ds_cross.NameValue(row,'plan_per') != ds_cross.NameValue(row,'sum_plan_mm_per')) 
         return '#FFCCFF'
     else 
        if ((row % 2) == 0)
            return "#F4F2D8"
        else
            return "ffffff"
  }
  if (eventid == 'color2') {
     if (ds_cross.NameValue(row,'plan_amt') != ds_cross.NameValue(row,'sum_plan_mm_amt')) 
         return '#FFCCFF'
     else 
        if ((row % 2) == 0)
            return "#F4F2D8"
        else
            return "ffffff"
  }
  
  
  var ls_temp
  ls_temp = eventid
  ls_temp = ls_temp.substr(1,10)

  if (ds_cross.NameValue(row,'p' + ls_temp) == 0) {
     if ((row % 2) == 0)
         return "#F4F2D8"
     else
         return "ffffff"
   }
  else
     return "#99FFFF"   
</SCRIPT>
</HEAD>
 <comment id="__NSID__"><Object id=ds_update
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>
 <comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49> </OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_0 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_cross 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49>
</OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:c_progress_detail_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:c_progress_parent_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 4px; WIDTH: 200px; POSITION: absolute; TOP: 2px; HEIGHT: 24px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td   BGCOLOR="#BBE0F4" style="COLOR: BLACK"> 
                 <div align="right">현장명</div></td>
             <td >
						<INPUT id=dept_name disabled  >
         </tr>                 
      </table>
</DIV>      
  <DIV id=div_1 
         style="Z-INDEX: 111; LEFT: 240px; WIDTH: 300px; POSITION: absolute; TOP: 1px; HEIGHT: 50px;FONT-SIZE: 12px" >
      <table width="100%"   BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
             <td    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
                 <div align="right">공사시작일</div></td>
             <td > 
					   <comment id="__NSID__"><OBJECT id=em_start_date tabIndex=-1 READONLY
                         style="WIDTH: 70px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=Numeric value=false>
                       <param name=Alignment  value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor        value=black>
                       <param name=ReadOnlyBackColor       value=silver>
					        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
             <td    BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
                 <div align="right">공사종료일</div></td>
             <td > 
					   <comment id="__NSID__"><OBJECT id=em_end_date tabIndex=-1 READONLY
                         style="WIDTH: 70px"
					          classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
                       <param name=Numeric value=false>
                       <param name=Alignment  value=2>
                       <param name=ReadOnly   value=true>
                       <param name=ReadOnlyForeColor        value=black>
                       <param name=ReadOnlyBackColor       value=silver>
					        <param name=PromptChar   value="_"></OBJECT></comment> <script> __ws__(__NSID__);</script></td>
         </tr> 
     </table>
</div>   
<DIV   id=bt_but style="Z-INDEX: 105; LEFT: 550px; WIDTH: 350px; POSITION: absolute; TOP: 7px; HEIGHT: 20px">
<input id=bt_plan_per type="button" value="실행금액집계" 
          style="color:#2E4A4A; font-size:13px;WIDTH=80px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=plan_cal()>
<input id=bt_plan_per type="button" value="투입금액집계" 
          style="color:#2E4A4A; font-size:13px;WIDTH=80px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=real_amt_rtn()>
<input id=bt_plan_amt type="button" value="보할보정" 
          style="color:#2E4A4A; font-size:13px;WIDTH=60px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=plan_per_cal()>
<input id=bt_plan_amt type="button" value="금액보정" 
          style="color:#2E4A4A; font-size:13px;WIDTH=60px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=plan_amt_cal()>
</div>
<input id=bt_close type="button" value="엑붙" 
          style="color:#2E4A4A; font-size:13px;WIDTH:30px; CURSOR: hand; LEFT:850px; Top:7px;height:17px;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   POSITION: absolute;"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=gd_1_bt_excel()>
<input id=bt_cross type="button" value="보할공정보기" 
          style="color:#2E4A4A; font-size:13px;WIDTH:80px; CURSOR: hand; LEFT:883px; Top:7px;height:17px;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   POSITION: absolute;"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=cross_rtn()>
<input id=bt_close type="button" value="닫기" 
          style="color:#2E4A4A; font-size:13px;WIDTH:30px; CURSOR: hand; LEFT:965px; Top:7px;height:17px;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   POSITION: absolute;"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=close_rtn()>

<comment id="__NSID__"><OBJECT id=gd_1 
    style="FONT-SIZE: 12px;  LEFT: 1px; WIDTH: 1009px; POSITION: absolute; TOP: 30px;
    HEIGHT: 100%" classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49>
	<PARAM NAME="MultiRowSelect" VALUE="0">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
	<param name="ViewSummary"    value=1>
	<PARAM NAME="Format" VALUE="
              <FC> Name='공종' ID=name  Edit=None Width=120   HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK     </FC>  
	           <FC> Name='보할(%)' ID=plan_per Width=50  Align=Right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK 
	                        SumText={sum(plan_per_y)}          SumColor=Black SumBgColor=Pink</FC>
	           <FC> Name='금액' ID=plan_amt Edit=None Width=100 Align=Right BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK 
	                        SumText={sum(plan_amt_y)}          SumColor=Black SumBgColor=Pink</FC>
	           <FC> Name='입력(%)' ID=sum_plan_mm_per Width=50 Bgcolor=@color1 Edit=None Align=Right   HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK 
	                         </FC>
	           <FC> Name='입력금액' ID=sum_plan_mm_amt Edit=None Bgcolor=@color2 Width=100 Align=Right  HeadAlign=Center  HeadBgColor=#BBE0F4  HeadColor=BLACK </FC>
              <C>ID=p1  width=50   Bgcolor=@p1            HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
              <C>ID=p2  width=50   Bgcolor=@p2              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p3  width=50   Bgcolor=@p3              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p4  width=50   Bgcolor=@p4              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p5  width=50   Bgcolor=@p5              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p6  width=50   Bgcolor=@p6              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p7  width=50   Bgcolor=@p7              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p8  width=50   Bgcolor=@p8              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p9  width=50   Bgcolor=@p9              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p10 width=50   Bgcolor=@p10             HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p11  width=50  Bgcolor=@p11              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p12  width=50  Bgcolor=@p12              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p13  width=50  Bgcolor=@p13              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p14  width=50  Bgcolor=@p14              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p15  width=50  Bgcolor=@p15              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p16  width=50  Bgcolor=@p16             HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p17  width=50  Bgcolor=@p17              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p18  width=50  Bgcolor=@p18              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p19  width=50  Bgcolor=@p19             HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p20 width=50   Bgcolor=@p20             HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
              <C>ID=p21  width=50  Bgcolor=@p21              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p22  width=50  Bgcolor=@p22              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p23  width=50  Bgcolor=@p23              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p24  width=50  Bgcolor=@p24              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p25  width=50  Bgcolor=@p25              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p26  width=50  Bgcolor=@p26              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p27  width=50  Bgcolor=@p27              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p28  width=50  Bgcolor=@p28              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p29  width=50  Bgcolor=@p29              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p30 width=50   Bgcolor=@p30            HeadBgColor=#BBE0F4  HeadColor=BLACK </C>
              <C>ID=p31  width=50  Bgcolor=@p31               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p32  width=50  Bgcolor=@p32               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p33  width=50  Bgcolor=@p33               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p34  width=50  Bgcolor=@p34               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p35  width=50  Bgcolor=@p35               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p36  width=50  Bgcolor=@p36               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p37  width=50  Bgcolor=@p37               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p38  width=50  Bgcolor=@p38               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p39  width=50  Bgcolor=@p39               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p40 width=50   Bgcolor=@p40              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p41  width=50  Bgcolor=@p41              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p42  width=50  Bgcolor=@p42              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p43  width=50  Bgcolor=@p43               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p44  width=50  Bgcolor=@p44               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p45  width=50  Bgcolor=@p45               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p46  width=50  Bgcolor=@p46               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p47  width=50  Bgcolor=@p47               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p48  width=50  Bgcolor=@p48               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p49  width=50  Bgcolor=@p49               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p50 width=50   Bgcolor=@p50              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p51  width=50  Bgcolor=@p51               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p52  width=50  Bgcolor=@p52               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p53  width=50  Bgcolor=@p53               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p54  width=50  Bgcolor=@p54               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p55  width=50  Bgcolor=@p55               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p56  width=50  Bgcolor=@p56               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p57  width=50  Bgcolor=@p57               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p58  width=50  Bgcolor=@p58               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p59  width=50  Bgcolor=@p59               HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
              <C>ID=p60 width=50   Bgcolor=@p60              HeadBgColor=#BBE0F4  HeadColor=BLACK</C>
           ">
	      <PARAM NAME="DataID" VALUE="ds_cross">
	      </OBJECT></comment> <script> __ws__(__NSID__);</script>
	<script language="javascript"  for=ds_2 event=OnLoadCompleted(rowcount)>
		document.all.LowerFrame.style.visibility="hidden";
	</script>
   
	<iframe id="LowerFrame" name="work" style=" position:absolute; left:350px; top:150px" FrameBorder="0" src="../../../comm_function/wait.html">
	</iframe> 

</BODY></HTML>
