<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : m_estimation_list_selyn_1h.html					-->
<!-- 2. 유형(시나리오): 조회및 입력						-->
<!-- 3. 기 능 정 의   : 자재견적 개봉화면  		                      	-->
<!-- 4. 변 경 이 력   : 박두현 작성						-->
<!-- 5. 관련프로그램  :								-->
<!-- 6. 특 기 사 항   :								-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_secu.js"></SCRIPT> 



<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
// <LINK rel="stylesheet" type="text/css" href="../../../comm_function/env.css">
var gs_home = top.frames['security'].gs_home.value
var gs_user_id = top.frames['security'].user_id.value

var is_fr_date      = top.frames['security'].gs_sysdate.value
var is_to_date      = top.frames['security'].gs_sysdate.value
var is_work_date = top.frames['security'].gs_sysdate.value
var il_screen = 1,is_name = ''
var is_filter
var is_yymm
var ii_seq
var is_title
var is_ds_1_addr = 'm_estimation_list_1q.jsp?arg_date='                        //견적 목록 
var is_ds_2_addr = 'm_vender_est_list_1q.jsp?arg_date='                        //견적 목록 
var is_ds_3_addr = 'm_vender_open_1q.jsp?arg_date='                     //견적내역

var is_tr_1_addr = gs_home + '/const/m_web/02/m_estimation_list_1tr.jsp'
var is_tr_2_addr = gs_home + '/const/m_web/02/m_vender_est_list_1tr.jsp'
var is_ds_seq_addr = gs_home + '/const/m_web/00/m_spec_unq_no_1q.jsp'                 // seq_no구하기 
var is_tr_3_addr = gs_home + '/const/m_web/02/m_vender_open_1tr.jsp'
var is_sort      = " "
var is_tr_3_success='Y'
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{

	if (il_screen > 1){
		div_btnquery_onclick()
		return
	}   
	ds_1.DataID = is_ds_1_addr + is_fr_date + '&arg_to_date=' + is_to_date + '&arg_name=' + is_name
	ds_1.SyncLoad=true
	ds_1.Reset()
	div_btnquery_onclick()

}

//------------------------------------------------------------------------
function btnquery_prt_onclick()                     // 미리보기
//------------------------------------------------------------------------
{
   var arg_temp, ls_date

   ls_date = ds_1.NameValue(ds_1.RowPosition,"estimateyymm")

   if (report_kind[0].checked) {
   	est_compare()                                        // 보고서 명   ---- 견적대비표
   }
   else {
//   	arg_temp ="const_rpt/m_web/02r/m_estimate_request"   // 보고서 명   ---- 견적의뢰서
//	   arg_temp = arg_temp + "&RptParams=" + is_dept_code + 
//                "&RptParams=" + ls_date +
//					 "&RptParams=" + ds_1.NameString(ds_1.RowPosition,"estimateseq")
//
//	   f_crystal_report(arg_temp)   //보고서 호출
	}   	

}

//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
//	tab_page_1.Focus();
//	tab_page_1.SetColumn("tx_esttitle");
}

//-----------------------------------------------------------------------
function init_move()                       // 초기값 세팅 
//------------------------------------------------------------------------
{
//	ds_1.NameValue(ds_1.RowPosition,"dept_code") = is_dept_code
	var ll_cnt,ll_max
	
	ds_1.NameValue(ds_1.RowPosition,"estimateyymm") = is_work_date
	ds_1.NameValue(ds_1.RowPosition,"requestseq") = 0
	ds_1.NameValue(ds_1.RowPosition,"order_class") = '1'
	ds_1.NameValue(ds_1.RowPosition,"ebid_yn") = '2'
	ds_1.NameValue(ds_1.RowPosition,"bid_class") = '2'
	ds_1.NameValue(ds_1.RowPosition,"open_class") = '2'
	ds_1.NameValue(ds_1.RowPosition,'choicetag')= 'N'
	
	ll_cnt = f_select_q("select nvl(max(estimateseq),0) select_1 from m_estimation " +
							 "where to_char(estimateyymm,'YYYY.MM') = to_char(to_date('" + is_work_date + "'),'YYYY.MM') " )
	if (ll_cnt > 0){
		ll_max = parseInt(ds_select.NameValue(ds_select.RowPosition,'select_1'),10) + 1;
	}
	else {
		ll_max = 1;
	}

	ds_1.NameValue(ds_1.RowPosition,"estimateseq") = ll_max

	tr_1.Post()
	Fn_SetColumn()
} 

//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	if (il_screen > 1) {
		div_btnsave_onclick()
		return
	}   
	if (ds_1.IsUpdated){
		if  (confirm("변경되었습니다 저장하시겠습니까?"))
		tr_1.Post()
	}
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	if (il_screen > 1) {
		div_btncancel_onclick()
		return
	}   
	ds_1.Undo(ds_1.RowPosition)
}
//-----------------------------------------------------------------------
function div_Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	gd_2.Focus();
	gd_2.SetColumn("estimatedetailseq");
}

//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
	if (ds_1.CountRow < 1){
		ds_2.ClearData()	
		return
	}
	
	ds_2.DataID = is_ds_2_addr  + ds_1.NameValue(ds_1.RowPosition,"estimateyymm") +
			"&arg_seq=" + ds_1.NameValue(ds_1.RowPosition,"estimateseq")
	ds_2.SyncLoad=true
	ds_2.Reset()
}
//---------------------------------------------------------------------
function fc_request_copy()               //견적내역 복사
//---------------------------------------------------------------------
{
var parm;
	if (ds_1.CountRow < 1) { 
		alert("선택한 내역이 없기때문에 들어갈수 없습니다")
		return
	}   
	if (ds_1.IsUpdated){
		if  (confirm("변경되었습니다 저장하시겠습니까?")){
			tr_1.Post()
		}
		else {
			return
		}
	}

	parm = gs_home + '@' + ds_1.NameValue(ds_1.RowPosition,"estimateyymm") +
	      '@' + ds_1.NameValue(ds_1.RowPosition,"estimateseq")

	window.showModalDialog("../00/m_request_find_1h.html" ,parm,"dialogWidth:"+1000+"px; dialogHeight:"+700+"px");
	
	div_btnquery_onclick()
}

//---------------------------------------------------------------------------
function div_btnsave_onclick()                  //하위 저장 
//---------------------------------------------------------------------------
{
	var ls_chk=0
	
	
	if (ds_2.IsUpdated || ds_1.IsUpdated ){
		if  (confirm("변경되었습니다 저장하시겠습니까?")){
			if (ds_1.IsUpdated) {
				tr_1.Action = is_tr_1_addr
				tr_1.Post()
			}
			if (ds_2.IsUpdated) {
			   	for (i=1; i<= ds_2.CountRow; i++){
				   	if (ds_2.NameValue(i,"mtrcode") == ''){
			   			ls_chk++
		   			}
		   		}
		   		if (ls_chk == 0) {
					tr_2.Action = is_tr_2_addr
			       		tr_2.Post()
			       		sp_call()
		       		}
	       			else {
			   		alert("자재코드를 반드시 입력하십시오 \n        저장되지않았습니다.")
			       	}
			}
	       	}
	}
}
//-------------------------------------------------------------------------------
function sp_call()                  // Stored Procedure Call 
//--------------------------------------------------------------------------------
{
 	var ls_date,li_seq
        ls_date = ds_1.NameValue(ds_1.RowPosition,"estimateyymm")
        li_seq  = ds_1.NameValue(ds_1.RowPosition,"estimateseq")
       	ds_spcall.DataID = 'y_m_vender_est_cmpt_procedure.jsp?arg_dept_code=' + is_dept_code + '&arg_date=' + ls_date + '&arg_seq=' + li_seq
        ds_spcall.SyncLoad = true
        ds_spcall.reset()
}
//----------------------------------------------------------------------------
function div_btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_2.Undo(ds_2.RowPosition)
}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	if (ds_1.IsUpdated) {
		if  (confirm("변경되었습니다 저장하시겠습니까?")) 
		{  //저장 routine
		}   
	
	}     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             
	
	// top.frames['main_ct'].window.close()     
}
//---------------------------------------------------------------------------
function vender_est_call()                        //업체별견적 들어가기 
//---------------------------------------------------------------------------
{
	var ls_chk,ls_ebid_yn
	if (ds_2.CountRow < 1) { 
		alert("선택한 업체가 없기때문에 들어갈수 없습니다")
		return
	}   
	if (ds_1.IsUpdated){
		tr_1.Post()
	}                       
		
	ls_chk = ds_1.NameValue(ds_1.RowPosition,'choicetag')
	ls_ebid_yn = ds_1.NameValue(ds_1.RowPosition,'ebid_yn')
	is_dept_name = ds_1.NameValue(ds_1.RowPosition,"long_name")

	ls_data = gs_home +  "@" + 
                                   ds_2.NameValue(ds_2.RowPosition,"estimateyymm")+"@" +
                                   ds_2.NameValue(ds_2.RowPosition,"estimateseq")+"@" +
                                   ds_2.NameValue(ds_2.RowPosition,"sbcr_code")+"@" +
                                   ds_2.NameValue(ds_2.RowPosition,"sbcr_name")+"@" +
                                   ds_1.NameValue(ds_1.RowPosition,"esttitle") + "@"
                                      
   if (ls_chk == 'N') 
       ls_data = ls_data + 'u'
   else       
       ls_data = ls_data + 'r'
	window.showModalDialog("m_vender_est_1h.html" ,ls_data,"dialogWidth:"+1100+"px; dialogHeight:"+700+"px");
}
//----------------------------------------------------------------
function  est_compare()
//----------------------------------------------------------------
{
	if (ds_1.CountRow < 1) { 
		alert("선택한 견적이 없기때문에 들어갈수 없습니다")
		return
	}   

	ls_yymm 	= ds_1.NameValue(ds_1.RowPosition,"estimateyymm")
	ls_seq	= ds_1.NameValue(ds_1.RowPosition,"estimateseq")
  	ls_title = ds_1.NameValue(ds_1.RowPosition,"esttitle") + "[" + ls_yymm + " - " + ls_seq + "]"
  	arg_temp ="const_rpt/m_web/02r/m_esti_com"     // 보고서 명
   arg_temp = arg_temp + "&RptParams=" + ls_title +
								 "&RptParams=" + ls_yymm + 
                			 "&RptParams=" + ls_seq  
//alert(arg_temp) 
   f_crystal_report(arg_temp)   //보고서 호출

}
//-------------------------------------------------------------------------------
function select_yymm()                  //년월 선택 
//--------------------------------------------------------------------------------
{
   is_fr_date = em_select_yymm.text
   is_to_date = em_select_to_yymm.text
   il_screen = 1
   btnquery_onclick()
 
}   
//------------------------------------------------------------------------
function keyDown()                       //검색어 입력후 enter를 쳤을경우
//------------------------------------------------------------------------
{
	if (window.event.keyCode == 13) { 
		sbcr_search();
	} 
}
//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_screen = focus
}
//--------------------------------------------------------------------------
function   sbcr_search()
//----------------------------------------------------------------
{
	if (tx_sbcr_search_name.value == '') {
		is_name = ''
	}
	else {
		is_name = tx_sbcr_search_name.value
	}
	btnquery_onclick()
}
//----------------------------------------------------------------------------
function sbcr_cancel()                     //선정 취소
//---------------------------------------------------------------------------- 
{
	var i,ls_sbcr_code,arg_cmd,ll_cnt,ls_chk

	is_chk = ds_1.NameValue(ds_1.RowPosition,'choicetag')

	if (is_chk == 'N') return

	ll_cnt = f_select_q("select count(*) select_1 from m_approval " +
							 "where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ds_select.ErrorCode != 0) {alert("에러발생");return;}
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
		if (ls_chk > 0) {
			alert('이미 품의자료가 존재함으로 선정취소를 하실 수 없습니다...')
			return
		}
	}

	if  (!confirm("선정된 업체 모두를 취소 하시겠습니까?")) {
		return;
	}   

	if (is_ebid_yn == '1') {
		arg_cmd = "  UPDATE m_estimation " +
					"     set buytag = '3' " +
					"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					"     AND estimateseq = " + ii_seq 
					f_update_sql(arg_cmd)
		ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'N'
	}

	for (i=1;i<=ds_2.CountRow;i++) {
		ds_2.NameValue(i,'choicetag') = 'N'
		ls_sbcr_code = ds_2.NameValue(i,'sbcr_code')
		arg_cmd = "  UPDATE m_vender_est_web " +
				 "     set choicetag = 'N' " +
				 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
				 "     AND estimateseq = " + ii_seq +
				 "     AND sbcr_code = '" + ls_sbcr_code + "'"
		f_update_sql(arg_cmd)
	}
	tr_2.Post()
	select_yymm()
}
//----------------------------------------------------------------------------
function open_rtn()                 // 견적개봉
//-----------------------------------------------------------------------------
{
	var j,ls_text,arg_cmd,ll_cnt,ls_chk,ls_sbcr_code,ll_amt,ls_est_yn
	ll_cnt = f_select_q("select buytag select_1 from m_estimation " +
							 " where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
	}
	else{
		return
	}
	
  	
	is_enddatetime = ds_1.NameValue(ds_1.RowPosition,'enddatetime') + ' 12'

	is_sysdate = f_sysdatetime()	
	is_sysdate = is_sysdate.substr(0,13)

   if (is_sysdate <	is_enddatetime) {
       alert('견적제출시한이 도래하지않았습니다')
       return
   }
	
	if (ds_1.CountRow < 1) {
	   alert("bb")
 	   return
	}
	if (ls_chk != '1' && ls_chk != '2') {
		alert('견적의뢰상태가 아니어서 견적개봉을 하실 수 없습니다... ')
		return
	}
	if (ls_chk == '1') {
	   if (gs_user_id ==  "kilee" || gs_user_id == "1" || gs_user_id == 'parkjh' || gs_user_id == 'chosh') {}
	   else {
	       alert('권한이 없습니다')
	       return
	   }    
		if  (confirm("전자입찰 견적개봉를 하시겠습니까?")){  
		}
		else {
			return
		}
	}
	else {
	   if (gs_user_id ==  "kilee" || gs_user_id == "1" || gs_user_id == 'parkjh' || gs_user_id == 'chosh') {}
	   else {
	       alert('권한이 없습니다')
	       return
	   }    
		if  (confirm("전자입찰 재견적개봉를 하시겠습니까?")){  
		}
		else {
			return
		}
	}
	tr_3.Action = is_tr_3_addr

   ls_text = is_yymm + ii_seq;
	is_key = gf_key_make(ls_text)
//	alert(is_key)
	for (i=1;i<=ds_2.CountRow;i++){
		ls_sbcr_code = ds_2.NameValue(i,'sbcr_code')

		ds_3.DataID = is_ds_3_addr +  is_yymm + "&arg_seq=" + ii_seq + "&arg_sbcr=" + ls_sbcr_code
		ds_3.SyncLoad=true
		ds_3.Reset()
		
		ll_amt = 0;
		
		if (ds_3.CountRow > 0){
			for (j=1 ;j <=ds_3.CountRow ;j++){
				Cipher.Decrypt(ls_text,ds_3.NameValue(j,"b_chgprice"),is_key)
				ls_text = Cipher.returnArg(1);
				if (ls_chk == '1') {
					ds_3.NameValue(j,"unitprice") = ls_text
				}
				ds_3.NameValue(j,"chgprice") = ls_text
				ll_amt = ll_amt + parseInt(ds_3.NameValue(j,"b_qty") * parseInt(ls_text,10),10);
			}
			is_tr_3_success='Y'
			tr_3.Post()
			if (is_tr_3_success != 'Y') {
			   alert('견적단가 개봉시 에러발생:(전산실문의요망)')
			   return
			}
			if (ll_amt > 0) {
				if (ls_chk == '1') {
					arg_cmd = "  UPDATE m_vender_est " +
								 "     set amt = " + ll_amt + "," +
								 "         chg_amt = " + ll_amt + "," +   
//   							 "     	  estimatedate = sysdate ," +  박두현 수정(견적제출일로 사용하기위해서)
								 "         est_yn = 'Y'" +
								 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
								 "     AND estimateseq = " + ii_seq +
								 "     AND sbcr_code = '" + ls_sbcr_code + "'"
				}
				else {
					arg_cmd = "  UPDATE m_vender_est " +
								 "     set chg_amt = " + ll_amt + "," +
//								 "     	  estimatedate = sysdate ," +  박두현 수정(견적제출일로 사용하기위해서)
								 "         est_yn = 'Y'" +
								 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
								 "     AND estimateseq = " + ii_seq +
								 "     AND sbcr_code = '" + ls_sbcr_code + "'"
				}				
			   f_update_sql(arg_cmd)
			}
		}
	}
var gis_name = top.frames['security'].gs_name.value
	
	arg_cmd = "  UPDATE m_estimation " +
				 "     set buytag = '3'," +
				 "         open_yn = 'Y', " +
				 "         open_per = '" + gis_name + "'," +
				 "         open_dt = sysdate " +
				 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
				 "     AND estimateseq = " + ii_seq 
	
   f_update_sql(arg_cmd)
   alert('정상처리 되었습니다...')
   btnquery_onclick()

}
//----------------------------------------------------------------------------
function req_rtn()                     // 견적의뢰
//---------------------------------------------------------------------------- 
{
	var arg_cmd,i,ls_estimateyymm,ls_estimateseq,ls_sbcr_code,ls_chk,ll_cnt
	if ( ds_2.CountRow < 1) {
		alert('견적받을 업체를 추가하시고 다시작업하시기 바랍니다...')
		return
	}
	ll_cnt = f_select_q("select buytag select_1 from m_estimation " +
							 "where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
	}
	if (ls_chk != '') {
		alert('이미 견적의뢰되어있습니다... ')
		return
	}
	if  (confirm("전자입찰 견적의뢰를 하시겠습니까?")) 
	{  
		for (i=1;i<=ds_2.CountRow;i++) {
			ls_estimateyymm = ds_2.NameValue(i,"estimateyymm")
			ls_estimateseq  = ds_2.NameValue(i,"estimateseq")
			ls_sbcr_code    = ds_2.NameValue(i,"sbcr_code")

			arg_cmd = "  INSERT INTO M_VENDER_EST_WEB   " +
						 "    SELECT ESTIMATEYYMM,ESTIMATESEQ,SBCR_CODE,CHOICETAG,EST_YN,DELIVERYMETHOD,DELIVERYLIMITDATE, " +
						 "				 PAYMENTMETHOD,QUALITY,RECOMMEND,AMT,CHG_AMT,REMARK  " +
						 "      FROM M_VENDER_EST  " +
						 "     WHERE ESTIMATEYYMM = '" + ls_estimateyymm + "'" +
						 "       AND estimateseq = " + ls_estimateseq +
						 "       AND sbcr_code = '" + ls_sbcr_code + "'" +
						 " @ INSERT INTO M_VENDER_EST_DETAIL_WEB  " +
						 "     SELECT ESTIMATEYYMM,ESTIMATESEQ,'" + ls_sbcr_code + "',EST_UNQ_NUM,NAME,SSIZE,UNITCODE,   " +
						 "				QTY,ESTIMATEDETAILSEQ,0,''  " +
						 "       FROM M_EST_DETAIL  " +
						 "     WHERE ESTIMATEYYMM = '" + ls_estimateyymm + "'" +
						 "       AND estimateseq = " + ls_estimateseq +
   					 " @ UPDATE m_estimation " +
   					 "      set buytag = '1'," +
   					 "          estimatedate = sysdate " +
						 "     WHERE ESTIMATEYYMM = '" + ls_estimateyymm + "'" +
						 "       AND estimateseq = " + ls_estimateseq 
		   f_update_sql_multy(arg_cmd)

			//메세지 보내기시작
			var ls_name,ls_dept_name,ls_tel,ls_date
			ll_cnt = f_select_q("SELECT nvl(rtrim(A.INOUT_TEL),'') select_1 FROM S_WBS_REQUEST A WHERE " +
						"A.SBCR_CODE = '" + ls_sbcr_code + "' " +
						"AND A.PROFESSION_WBS_CODE = '" + ds_2.NameValue(i,"profession_wbs_code") + "'")
			if (ll_cnt > 0){
				ls_tel = ds_select.NameValue(ds_select.RowPosition,'select_1');
			}
			if (ls_tel != null || ls_tel != '') {
				ll_cnt = f_select_q("select DISTINCT B.LONG_NAME select_1,to_char(C.ENDDATETIME,'YYYY.MM.DD') select_2,b.DEPT_CODE select_3 From " +
								" M_EST_DETAIL A, Z_CODE_DEPT B, M_ESTIMATION C WHERE " +
								"  a.DEPT_CODE = b.DEPT_CODE " +
								"AND a.ESTIMATEYYMM = C.ESTIMATEYYMM AND a.ESTIMATESEQ = c.ESTIMATESEQ " +
								"AND a.ESTIMATEYYMM = '" + ls_estimateyymm + "' " + 
								"AND a.ESTIMATESEQ = " + ls_estimateseq)
				if (ll_cnt > 0){
					ls_dept_name = ds_select.NameValue(ds_select.RowPosition,'select_1');
					ls_date = ds_select.NameValue(ds_select.RowPosition,'select_2');
					if (ds_select.NameValue(ds_select.RowPosition,'select_3').substr(0,2) == 'A0') {
						ls_name = '*월드건설*'
					} else {
						ls_name = '*월드건설산업*'
					}
				}
				gf_mail_to(ls_name,' 통합구매팀','',ls_tel,ls_name + ' ' + ls_dept_name + '현장 ' + ls_date + '(12:00)입찰입니다')
			}
			//메세지 보내기종료
		}
	}   
	else {
		return
	}

}
//----------------------------------------------------------------------------
function rereq_rtn()                     // 재견적의뢰
//---------------------------------------------------------------------------- 
{
	var arg_cmd,i,ls_estimateyymm,ls_estimateseq,ls_sbcr_code,ls_chk,ll_cnt
	var ls_name,ls_dept_name,ls_tel,ls_date
	if ( ds_2.CountRow < 1) {
		return
	}
	ll_cnt = f_select_q("select buytag select_1 from m_estimation " +
							 "where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
	}
	if (ls_chk != '3') {
		alert('접수상태에서만 재견적의뢰를 하실수있습니다... ')
		return
	}
	
	is_enddatetime = ds_1.NameValue(ds_1.RowPosition,'enddatetime') + ' 12'

	is_sysdate = f_sysdatetime()	
	is_sysdate = is_sysdate.substr(0,13)
	
   if (is_sysdate < 	is_enddatetime) {
       alert('견적제출시한이 도래하지않았습니다')
       return
   }
	
	if  (confirm("전자입찰 재견적의뢰를 하시겠습니까?")) 
	{  
		arg_cmd = "  UPDATE M_VENDER_EST_WEB   " +
					 "     set EST_YN = 'N' " +
					 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					 "       AND estimateseq = " + ii_seq +
					 " @ UPDATE m_estimation " +
					 "      set buytag = '2' , open_yn = 'N' " +
					 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					 "       AND estimateseq = " + ii_seq  + " " + 
		          " @  UPDATE M_VENDER_EST   " +
					 "     set EST_YN = 'N' " +
					 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					 "       AND estimateseq = " + ii_seq 
		
	   f_update_sql_multy(arg_cmd)
	   il_screen = 1
	   btnquery_onclick()
	}   
	else {
		return
	}

}

//----------------------------------------------------------------
function  est_compare_scr()
//----------------------------------------------------------------
{
	if (ds_2.CountRow < 1) { 
		alert("선택한 견적업체가 없기때문에 들어갈수 없습니다")
		return
	}   
	makeCookie("@m_vender_est_compare_detail@",is_yymm+"@" +
                                   ii_seq +"@" +
                                   is_title + "@" + 
                                   gs_home + '/const/m_web/02/m_estimation_list_selyn_1h.html')
	top.frames['main_ct'].location.href(gs_home + "/const/m_web/02r/m_vender_est_compare_detail_1h.html" +"?"+'p')
}
//---------------------------------------------------------------------------
function est_result_scr()                        //변경대비
//---------------------------------------------------------------------------
{
	var ls_chk,ls_chk_dt,ls_curr_dt
   if  (ds_2.CountRow < 1) {
        alert("견적업체가 한건도 존재하지 않습니다")
        return
   }     
	if ( ds_1.NameValue(ds_1.RowPosition,"ebid_yn") == '1' ) {
    	if ( ds_1.NameValue(ds_1.RowPosition,"open_yn") != 'Y' ) {
  	   	alert("알림! 견적개봉전 까지는 견적내역에 들어가실 수 없습니다...")
 		   return
	   }
   }
  
   ls_data = ds_1.NameValue(ds_1.RowPosition,"estimateyymm")+ "@" + ds_1.NameValue(ds_1.RowPosition,"estimateseq") 
   
   window.showModalDialog("m_est_result_1h.html",ls_data,"dialogWidth:1012px;dialogHeight:700px");
}

//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
	tr_1.Action = is_tr_1_addr
	tr_2.Action = is_tr_2_addr
	tr_3.Action = is_tr_3_addr
	
  	ds_seq.DataID = is_ds_seq_addr                       // SEQ NO 의 DATAID
	top.frames['main_title'].title_name.value = " " + "견적 개봉"             
   ll_cnt = f_ds_select_q("ds_date","select to_char(trunc(sysdate,'mm'),'yyyy.mm.dd') select_1 from dual")
   em_select_yymm.text = ds_date.NameValue(1,'select_1') 
   ll_cnt = f_ds_select_q("ds_date","select to_char(add_months(trunc(sysdate,'mm') ,1) - 1 ,'yyyy.mm.dd') select_1 from dual")
   em_select_to_yymm.text = ds_date.NameValue(1,'select_1') 
   select_yymm()

   ds_1.SortExpr = "+ebid_yn"
  	is_sort = ds_1.SortExpr;
   ds_1.Sort()
}
</SCRIPT>
<script language=JavaScript for=gd_1 event=onClick(row,colid)>
  if (row == 0) {
  		if (is_sort == "+" + colid)
   	  ds_1.SortExpr = "-" + colid;
  	   else
   	  ds_1.SortExpr = "+" + colid;
   	  
  	  is_sort = ds_1.SortExpr;
  	  ds_1.Sort();
  }   
</script>

<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_1.RowPosition == ds_1.CountRow)  
        btnadd_onclick()
    else     
        ds_1.RowPosition++
}
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_2.RowPosition == ds_2.CountRow)  
        div_btnadd_onclick()
    else     
        ds_2.RowPosition++
}
</SCRIPT>

<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
{
	if  (row < 1) return;
	is_chk = ds_1.NameValue(row,'choicetag')
	is_ebid_yn = ds_1.NameValue(row,'ebid_yn')
	is_yymm = ds_1.NameValue(ds_1.RowPosition,"estimateyymm")
	ii_seq = ds_1.NameValue(ds_1.RowPosition,"estimateseq")
	is_title = ds_1.NameValue(ds_1.RowPosition,"esttitle")
	if (is_chk == 'Y' || is_ebid_yn == '1') {
		gd_2.Editable = false
		if (is_ebid_yn == '1' && is_chk == 'N'){
			gd_2.ColumnProp('choicetag', 'Edit') =""
		}
	}
	else {
		gd_2.Editable = true
		gd_2.ColumnProp('buytag', 'Edit') ="None"
	}

	div_btnquery_onclick()  
}  
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnExit(row,colid,olddata)>
  if (row < 1) return
  if (colid != 'choicetag') return

	var ls_codevalue,ls_sbcr_code,arg_cmd
	var ls_name,ls_dept_name,ls_tel,ls_date
	ls_codevalue = ds_2.NameValue(row,'choicetag') 
	is_ebid_yn = ds_1.NameValue(ds_1.RowPosition,'ebid_yn')
	if (ls_codevalue == 'Y') {
		if (ds_2.NameValue(ds_2.RowPosition,"est_yn") == 'N') {
			alert("견적이 제출되지않고는 선정할 수 없습니다")
			ds_2.NameValue(row,'choicetag') = 'N'
			return;
		}
		if (is_ebid_yn == '1') {
			ls_sbcr_code = ds_2.NameValue(row,'sbcr_code')
			arg_cmd = "  UPDATE m_vender_est_web " +
						"     set choicetag = 'Y' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq +
						"     AND sbcr_code = '" + ls_sbcr_code + "'"
			f_update_sql(arg_cmd)
			arg_cmd = "  UPDATE m_estimation " +
						"     set buytag = '4' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq 
			f_update_sql(arg_cmd)
			ds_2.NameValue(ds_2.RowPosition,"choicetag") = 'Y'
			tr_2.Post()

			//메세지 보내기시작
			var ls_name,ls_dept_name,ls_tel,ls_date
			for (i=1;i<=ds_2.CountRow;i++) {
				ll_cnt = f_select_q("SELECT nvl(rtrim(A.INOUT_TEL),'') select_1 FROM S_WBS_REQUEST A WHERE " +
							"A.SBCR_CODE = '" + ds_2.NameValue(i,"sbcr_code") + "' " +
							"AND A.PROFESSION_WBS_CODE = '" + ds_2.NameValue(i,"profession_wbs_code") + "'")
				if (ll_cnt > 0){
					ls_tel = ds_select.NameValue(ds_select.RowPosition,'select_1');
				}
				if (ls_tel != null || ls_tel != '') {
					ll_cnt = f_select_q("select DISTINCT B.LONG_NAME select_1,to_char(C.ENDDATETIME,'YYYY.MM.DD') select_2,b.DEPT_CODE select_3 From " +
									" M_EST_DETAIL A, Z_CODE_DEPT B, M_ESTIMATION C WHERE " +
									"  a.DEPT_CODE = b.DEPT_CODE " +
									"AND a.ESTIMATEYYMM = C.ESTIMATEYYMM AND a.ESTIMATESEQ = c.ESTIMATESEQ " +
									"AND a.ESTIMATEYYMM = '" + ds_2.NameValue(i,"estimateyymm") + "' " + 
									"AND a.ESTIMATESEQ = " + ds_2.NameValue(i,"estimateseq"))
					if (ll_cnt > 0){
						ls_dept_name = ds_select.NameValue(ds_select.RowPosition,'select_1');
						ls_date = ds_select.NameValue(ds_select.RowPosition,'select_2');
						if (ds_select.NameValue(ds_select.RowPosition,'select_3').substr(0,2) == 'A0') {
							ls_name = '*월드건설*'
						} else {
							ls_name = '*월드건설산업*'
						}
					}
//					alert(ls_tel)
					if (ds_2.NameValue(i,"sbcr_code") == ls_sbcr_code) {
						gf_mail_to(ls_name,' 통합구매팀','',ls_tel,ls_name + ' ' + ls_dept_name + '현장 ' + ls_date + '개봉결과 선정입니다')
					} else {
						gf_mail_to(ls_name,' 통합구매팀','',ls_tel,ls_name + ' ' + ls_dept_name + '현장 ' + ls_date + '개봉결과 탈락입니다')
					}
				}
			}
			//메세지 보내기종료
		}

	} else {
		if (is_ebid_yn == '1') {
			ls_sbcr_code = ds_2.NameValue(ds_2.RowPosition,'sbcr_code')
			arg_cmd = "  UPDATE m_vender_est_web " +
						"     set choicetag = 'N' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq +
						"     AND sbcr_code = '" + ls_sbcr_code + "'"
			f_update_sql(arg_cmd)
			arg_cmd = "  UPDATE m_estimation " +
						"     set buytag = '3' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq 
			f_update_sql(arg_cmd)
			ds_2.NameValue(ds_2.RowPosition,"choicetag") = 'N'
			tr_2.Post()
		}
	}
</script>

</HEAD>
<SCRIPT language=JavaScript for=em_select_yymm event=onKillFocus()>
        if (em_select_yymm.Modified){ 
	   select_yymm()
	   }
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_yymm event=onKeyDown(kcode,scode)>
        if ((em_select_yymm.Modified) && kcode == 13 ){ 
	   select_yymm()
	   }
</SCRIPT>   
<SCRIPT language=JavaScript for=em_select_to_yymm event=onKillFocus()>
        if (em_select_to_yymm.Modified){ 
	   select_yymm()
	   }
</SCRIPT>        	
<SCRIPT language=JavaScript for=em_select_to_yymm event=onKeyDown(kcode,scode)>
        if ((em_select_to_yymm.Modified) && kcode == 13 ){ 
	   select_yymm()
	   }
</SCRIPT>   
<SCRIPT language=JavaScript for=gd_1 event=OnDblClick(row,colid)>
ds_1.RowPosition=row
</SCRIPT>
     	
<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code(tr_1) : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code(tr_2) : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_spcall event=OnLoadError()>
  alert("Error Code(ds_spcall) : " + ds_spcall.ErrorCode + "\n" + "Error Message : " + ds_spcall.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
  alert("Error Code(tr_3) : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_3.ErrorMsg + "\n");
  is_tr_3_success='N'
</SCRIPT>
<comment id="__NSID__"><OBJECT id=ds_sysdate 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
    <param name=UseFilter       value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_seq 
    style="Z-INDEX: 102; LEFT: 244px; POSITION: absolute; TOP: 1px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_spcall 
    style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_update
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_date
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_estimation_list_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
	
<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_vender_est_list_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tr_3 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_vender_open_1tr=ds_3)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
	
 <OBJECT id=Cipher classid=clsid:BD64BD76-594A-47A6-A0EE-5CD6DF66BC8B
  width=0 height=0 VIEWASTEXT></OBJECT>
	
<DIV id=gd_1_button 
style="Z-INDEX: 107; LEFT: 10px; WIDTH: 1010px; POSITION: absolute; TOP: 0px; HEIGHT: 20px">
<DIV id=hdept_page_1 
         style="Z-INDEX: 111; LEFT: 2px; WIDTH: 550px; POSITION: absolute; TOP: 2px; HEIGHT: 20px;FONT-SIZE: 12px" >
      <table width="100%" height="100%"  BORDER="1"  align="center"   CELLSPACING="0" style="FONT-SIZE: 12px">
         <tr BGCOLOR="white" > 
  				<td width="15%"   BGCOLOR="#53A9FF" style="COLOR: WHITE " colspan=3 > 
					<div align="right">제목검색</div></td>
				<td width="35%" colspan=7> 
				  	<INPUT id=tx_sbcr_search_name   size=16 onkeyDown="keyDown()" >
				  	<INPUT id=bt_sbcr_name  type=button   value=검색 onclick=sbcr_search()>
				</td>
  				<td width="10%"   BGCOLOR="#53A9FF" style="COLOR: WHITE " colspan=2 > 
                 <div align="right">조회기간</div></td>
  				<td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK " colspan=1 > 
                 <div align="right">From</div></td>
				<td width="15%" colspan=3> 
					<comment id="__NSID__"><OBJECT id=em_select_yymm 
					       style="Z-INDEX: 101; WIDTH: 80px " 
					      classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
						    <PARAM NAME="Alignment" VALUE="1">
						    <PARAM NAME="IsComma"   VALUE="0">
						    <PARAM NAME="MaxLength" VALUE="6">
						    <PARAM NAME="Format"    VALUE="YYYY-MM-DD">
					       <param name=ClipMode    value=false>
						    <PARAM NAME="Numeric"   VALUE="0">
						    <PARAM NAME="SelectAll" VALUE="-1">
					</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
  				<td width="5%"   BGCOLOR="#BBE0F4" style="COLOR: BLACK " colspan=1 > 
                 <div align="right">To</div></td>
				<td width="15%" colspan=3> 
					<comment id="__NSID__"><OBJECT id=em_select_to_yymm 
					       style="Z-INDEX: 101; WIDTH: 80px " 
					      classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
						    <PARAM NAME="Alignment" VALUE="1">
						    <PARAM NAME="IsComma"   VALUE="0">
						    <PARAM NAME="MaxLength" VALUE="6">
						    <PARAM NAME="Format"    VALUE="YYYY-MM-DD">
			             <param name=ClipMode    value=false>
						    <PARAM NAME="Numeric"   VALUE="0">
						    <PARAM NAME="SelectAll" VALUE="-1">
					</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
       </tr>                 
      </table>
</DIV>      
	
<!--	
<input type="button" value="견적대비표"  
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 670px;POSITION: absolute;TOP:7px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=est_compare()>
-->


<input type="button" value="견적개봉" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 708px;POSITION: absolute;TOP:9px;width:60px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=open_rtn()>

<input type="button" value="재견적의뢰" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 770px;POSITION: absolute;TOP:9px;width:80px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=rereq_rtn()>

	<input type=radio name=report_kind value="견적대비표" Checked=true 
	           style="font-size:13px; CURSOR: hand; 
	           LEFT: 860px; POSITION: absolute; TOP: 2px;  height:17px" >
	<LABEL id=Label_4  
	    	style="WIDTH: 100px; LEFT: 880px;POSITION: absolute; HEIGHT: 25px; TOP:5px">견적대비표
	</LABEL>
	<input type=radio name=report_kind value="견적의뢰서"
	           style="font-size:13px; CURSOR: hand;
	           LEFT: 860px; POSITION: absolute; TOP: 17px;  height:17px" >
	<LABEL id=Label_5  
	    	style="WIDTH: 100px; LEFT: 880px;POSITION: absolute; HEIGHT: 25px; TOP:19px">견적의뢰서
	</LABEL>
<!-- 미리보기 버튼	-->	           
	<img type=btnquery_prt 
	          style="color:#2E4A4A; font-size:13px; CURSOR: hand;
	           background-color:#E9F5F5; border:1 #A1A9A9 solid; LEFT: 945px; POSITION: absolute; 
	           TOP: 6px; "   
	            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	           "  onclick=btnquery_prt_onclick() src="../../../image/icon/preview.gif" >
	
</DIV>
<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
    style="FONT-SIZE: 12px; Z-INDEX: 105; LEFT: 2px; WIDTH:1008px; POSITION: absolute; TOP: 35px; HEIGHT: 350px" 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="AutoInsert" VALUE="-1">
	<PARAM NAME="Editable" VALUE="0">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="Format" VALUE=" 
	   <FC> Name='번호' ID=estimateseq Edit=None Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=30 </FC> 
	  <FC> Name='제목' ID=esttitle Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=220 </FC>
	  <FC> Name='선정여부' ID=choicetag Align=Center EditStyle=Combo Data='Y:선정,N:미선정' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=50 </FC> 
	  <C> Name='작성일자' ID=estimateyymm Edit=None Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=65 </C> 
	  <C> Name='전자입찰' ID=ebid_yn Edit=None Align=Center EditStyle=Combo Data='1:예,2:아니오'  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=65 </C> 
	  <C> Name='제출시한' ID=enddatetime Edit=None Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=104 </C> 
	  <C> Name='개봉일시' ID=open_dt Edit=None Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=105 </C> 
	  <C> Name='개봉자' ID=open_per Edit=None Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK Width=65 </C> 
	  <C> Name='개봉여부' ID=open_yn Align=Center EditStyle=Combo Data='Y:개봉,N:미개봉' BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
	  <C> Name='특 기 사 항' ID=remark Align=left  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Left HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=600 </C> 
      ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<input type="button" value="견적내역" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 100px;POSITION: absolute;TOP:390px;width:60px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=vender_est_call()>
<input type="button" value=" 업체선정 취소 "
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 170px;POSITION: absolute;TOP:390px;width:100px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=sbcr_cancel()>

<input type="button" value="견적의뢰" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 350px;POSITION: absolute;TOP:390px;width:60px; height:17px; display:none;"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=req_rtn()>

<input type="button" value="업체별 견적대비표 " 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 280px;POSITION: absolute;TOP:390px;width:120px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=est_compare_scr()>
<input type="button" value="결과조회" 
	style="color:#2E4A4A; font-size:13px; CURSOR: hand; 
	background-color:#E9F5F5; border:1 #A1A9A9 solid;  LEFT: 660px;POSITION: absolute;TOP:390px;width:60px; height:17px"   
	onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
	onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
	"  onclick=est_result_scr()>

<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
    style="FONT-SIZE: 12px; Z-INDEX: 105; LEFT: 2px; WIDTH:1010px; POSITION: absolute; TOP: 410px; HEIGHT: 35%" 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="Editable" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="DataID" VALUE="ds_2">
   <param name="ViewSummary"    value=1>
	<PARAM NAME="Format" VALUE=" 
	  <C> Name='선정' ID=choicetag  Align=Center HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=50
		EditStyle=Combo Data='Y:선정,N:'  </C> 
	  <C> Name='견적' ID=est_yn Edit=None Align=Center HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=50 
		EditStyle=Combo Data='Y:제출,N:미제출'  </C> 
	  <C> Name='업체명' ID=sbcr_name Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=200 </C>
	  <C> Name=담당자 ID=chrg_name1 Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
	  <C> Name=담당자연락처  ID=chrg_tel_number2 Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=110 </C> 
	  <C> Name=대표자 ID=rep_name1 Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=60 </C> 
	  <C> Name=전화번호 ID=tel_number1 Edit=None  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=100 </C> 
	  <C> Name=견적제출일시 ID=est_dt Align=Center  BgColor={decode(currow-tointeger(currow/2)*2,0,'#F4F2D8',1,'ffffff')}  HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=110 </C>
      ">
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</DIV>
</BODY></HTML>