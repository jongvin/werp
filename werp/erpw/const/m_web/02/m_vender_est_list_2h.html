<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- **************************************************************		-->
<!-- 1. 프로그램 id   : m_estimation_list_1h.html					-->
<!-- 2. 유형(시나리오): 조회및 입력						-->
<!-- 3. 기 능 정 의   : 자재견적내역입력  		                      	-->
<!-- 4. 변 경 이 력   : 김동우 작성						-->
<!-- 5. 관련프로그램  :								-->
<!-- 6. 특 기 사 항   :								-->
<!-- *************************************************************		-->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=ks_c_5601-1987">
<META content="MSHTML 6.00.2716.2200" name=GENERATOR>
<LINK rel="stylesheet" type="text/css" href="../../../erpw.css">
<SCRIPT SRC="../../../comm_function/comm_function.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_calendar.js"></SCRIPT> 
<SCRIPT SRC="../../../comm_function/comm_secu.js"></SCRIPT> 


<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>

<SCRIPT SRC="../../../comm_function/comm_wid.js"></SCRIPT>
<SCRIPT language=JavaScript>
// <LINK rel="stylesheet" type="text/css" href="../../../comm_function/env.css">
var gs_home = top.frames['security'].gs_home.value
var is_name = top.frames['security'].gs_name.value
var gs_user_id = top.frames['security'].user_id.value
var is_dept_code = ''
var is_dept_name = ''
var is_yymm      = top.frames['security'].gs_sysdate.value
var il_screen = 1
var is_filter,is_chk
var ii_seq,is_ebid_yn
var is_title,is_key
var is_html=""                    //되돌아갈 html주소 

var is_ds_1_addr = 'm_vender_est_list_1q.jsp?arg_date='                        //견적 목록 
var is_ds_2_addr = 'm_vender_est_detail_12q.jsp?arg_date='                     //견적내역(세부)
var is_ds_5_addr = 'm_vender_est_detail_11q.jsp?arg_date='                     //견적내역(집계)
var is_ds_3_addr = 'm_vender_open_1q.jsp?arg_date='                     //견적내역
var is_ds_4_addr = 'm_vender_est_list_2q.jsp?arg_date='                     //견적내역
var is_tr_1_addr = gs_home + '/const/m_web/02/m_vender_est_list_1tr.jsp'
var is_tr_2_addr = gs_home + '/const/m_web/02/m_vender_est_detail_1tr.jsp'
var is_tr_3_addr = gs_home + '/const/m_web/02/m_vender_open_1tr.jsp'
var is_tr_4_addr = gs_home + '/const/m_web/02/m_vender_est_list_2tr.jsp'
//------------------------------------------------------------------------
function btnquery_onclick()                     // 조회  
//------------------------------------------------------------------------
{
	if (il_screen > 1){
		div_btnquery_onclick()
		return
	}   
	ds_1.DataID = is_ds_1_addr + is_yymm + '&arg_seq=' + ii_seq 
	ds_1.SyncLoad=true
	ds_1.Reset()
	div_btnquery_onclick()

}
//-----------------------------------------------------------------------
function Fn_SetColumn()   // 커서위치 세팅
//-----------------------------------------------------------------------
{
	//tab_page_1.Focus();
	//tab_page_1.SetColumn("tx_esttitle");
}

//-----------------------------------------------------------------------
function init_move()                       // 초기값 세팅 
//------------------------------------------------------------------------
{
	var ls_sbcr_code
	bt_vender_find()
	ls_sbcr_code = ds_1.NameValue(ds_1.RowPosition,"sbcr_code")
	if (ls_sbcr_code == '' ) {
	  	ds_1.DeleteRow(ds_1.RowPosition)
	  	return
	}	
	ds_1.NameValue(ds_1.RowPosition,"estimateyymm") = is_yymm
	ds_1.NameValue(ds_1.RowPosition,"estimateseq") = ii_seq
	ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'N'
	ds_1.NameValue(ds_1.RowPosition,"est_yn") = 'N'
//	ds_1.NameValue(ds_1.RowPosition,"injung_yn") = 'Y'

	btnsave_onclick()

  	arg_cmd = " INSERT INTO M_VENDER_EST_DETAIL " +
     		  " SELECT ESTIMATEYYMM,ESTIMATESEQ," + "'" + ls_sbcr_code + "'" +
     		  "        ,EST_UNQ_NUM,0,0  " +
       		  "   FROM M_EST_DETAIL  " +
      		  "  WHERE ESTIMATEYYMM = " + "'" + is_yymm + "'" +
      		  "    AND ESTIMATESEQ = " + ii_seq

	f_update_sql(arg_cmd)
	
//  	arg_cmd = " INSERT INTO M_VENDER_EST_DETAIL_WEB " +
//     		  " SELECT ESTIMATEYYMM,ESTIMATESEQ," + "'" + ls_sbcr_code + "'" +
//     		  "        ,EST_UNQ_NUM,0,0  " +
//       		  "   FROM M_EST_DETAIL  " +
//      		  "  WHERE ESTIMATEYYMM = " + "'" + is_yymm + "'" +
//      		  "    AND ESTIMATESEQ = " + ii_seq

//	f_update_sql(arg_cmd)
	
	div_btnquery_onclick()
	
	Fn_SetColumn()
} 

//-----------------------------------------------------------------------
function btnadd_onclick()                       // 추가 
//------------------------------------------------------------------------
{
	if  (is_dept_code == "") {
		alert("현장을 선택하십시요(검색을 누르십시요)")
		return
	 }     

	ds_1.AddRow()     
	init_move()
}
//-----------------------------------------------------------------------
function btninsert_onclick()                    // 삽입
//-----------------------------------------------------------------------
{
	if  (is_dept_code == "") {
		alert("현장을 선택하십시요(검색을 누르십시요)")
		return
	}     
	if  (ds_1.CountRow > 0) { 
		ds_1.InsertRow(ds_1.RowPosition)
	}    
	else {
		ds_1.AddRow()     
	}
	init_move()
}
//------------------------------------------------------------------------
function btndelete_onclick()                    // 삭제 
//------------------------------------------------------------------------
{
	var ls_sbcr_code,ll_cnt,ll_count
	
	
//	ll_cnt = f_select_q("select nvl(count(*),0) select_1 from m_vender_est " +
//							 "where estimateyymm = '" + is_yymm + "'" +
//							 "  and estimateseq = " + ii_seq  +
//							 "  and est_yn = 'Y'))
//	if (ll_cnt > 0){
//		ll_count = parseInt(ds_select.NameValue(ds_select.RowPosition,'select_1'),10);
//		
//		if (ll_count > 0){
//			alert('이미선택된 업체가 존재함으로
//		}
//	}
	
	
	if (ds_2.CountRow > 0) {
		if  (confirm("하위에 자료도 모두 삭제하시겠습니까?")) {
			ds_2.DeleteAll()
			ls_sbcr_code = ds_1.NameValue(ds_1.RowPosition,"sbcr_code")
		  	arg_cmd = " delete from M_VENDER_EST_DETAIL_WEB " +
		      		  "  WHERE ESTIMATEYYMM = " + "'" + is_yymm + "'" +
		      		  "    AND ESTIMATESEQ = " + ii_seq +
		      		  "    AND sbcr_code = " + "'" + ls_sbcr_code + "'"
		
			f_update_sql(arg_cmd)
		  	arg_cmd = " delete from M_VENDER_EST_WEB " +
		      		  "  WHERE ESTIMATEYYMM = " + "'" + is_yymm + "'" +
		      		  "    AND ESTIMATESEQ = " + ii_seq +
		      		  "    AND sbcr_code = " + "'" + ls_sbcr_code + "'"
		
			f_update_sql(arg_cmd)
		  	arg_cmd = "  UPDATE m_estimation " +
   					 "      set buytag = ''," +
   					 "          estimatedate = '' " +
						 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						 "       AND estimateseq = " + ii_seq 
		
			f_update_sql(arg_cmd)
			div_btnsave_onclick()
		}
		else {
			alert("하위에 자료가있어 삭제할 수 없습니다")
			return 
		}
  	}
  	ds_1.DeleteRow(ds_1.RowPosition)
  	tr_1.Post()
 }
//---------------------------------------------------------------------------
function btnsave_onclick()                       // 저장
//---------------------------------------------------------------------------
{
	if (ds_1.IsUpdated){
		if  (confirm("변경되었습니다 저장하시겠습니까?"))
		tr_1.Post()
		div_btnsave_onclick()
	}
}
//----------------------------------------------------------------------------
function btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	if (il_screen > 1) {
		div_btncancel_onclick()
		return
	}   
	ds_1.Undo(ds_1.RowPosition)
}
//------------------------------------------------------------------------
function div_btnquery_onclick()                     // 하위 조회  
//------------------------------------------------------------------------
{
	if (ds_1.CountRow < 1) {
		ds_5.ClearData()	
		return
	}
	
	ds_5.DataID = is_ds_5_addr  + ds_1.NameValue(ds_1.RowPosition,"estimateyymm") +
			"&arg_seq=" + ds_1.NameValue(ds_1.RowPosition,"estimateseq") +
			"&arg_vender=" + ds_1.NameValue(ds_1.RowPosition,"sbcr_code")
	ds_5.SyncLoad=true
	ds_5.Reset()

	ds_2.DataID = is_ds_2_addr  + ds_1.NameValue(ds_1.RowPosition,"estimateyymm") +
			"&arg_seq=" + ds_1.NameValue(ds_1.RowPosition,"estimateseq") +
			"&arg_vender=" + ds_1.NameValue(ds_1.RowPosition,"sbcr_code") 
	ds_2.SyncLoad=true
	ds_2.Reset()
}	
//--------------------------------------------------------------------------
function   filter_function()
//----------------------------------------------------------------
{
	gd_2.ReDraw = false
	ds_2.Filter()
	gd_2.ReDraw = true
}  

//---------------------------------------------------------------------
function bt_vender_find()               //견적업체 찾기
//---------------------------------------------------------------------
{
	var result;
	var array = new Array();
	var varray = new Array();
	var i,j
	
	if (ds_1.CountRow > 0 ) {
	   	for (i=1; i< ds_1.CountRow; i++){
			varray = varray + ds_1.NameValue(i,"sbcr_code") + "@"
		}
	}

	result = window.showModalDialog(gs_home + "/const/m_web/00/m_vender_find_2h.html", varray,"dialogWidth:700px;dialogHeight:510px");
	if(result == "") return;

	array = result.split("@");
	tx_sbcr_code.value = array[0]
	tx_sbcr_name.value = array[1]
//	ds_1.NameValue(ds_1.RowPosition,'profession_wbs_code') = array[3]
}
//---------------------------------------------------------------------------
function div_btnsave_onclick()                  //하위 저장 
//---------------------------------------------------------------------------
{
	
	tr_2.Action = is_tr_2_addr
	
	if (ds_2.IsUpdated){
     		tr_2.Post()
	}
}
//----------------------------------------------------------------------------
function ok_rtn()                     //선정 
//---------------------------------------------------------------------------- 
{
	var i,ls_sbcr_code,arg_cmd,ll_cnt,ls_chk,ls_name
	if (is_chk == 'Y') return
	if (ds_1.RowPosition < 1) return
	if (ds_1.NameValue(ds_1.RowPosition,"est_yn") == 'N') {
		alert("견적이 제출되지않고는 선정할 수 없습니다")
		return;
	}
	if (ds_2.CountRow < 1) {
		alert("견적내역이 없어서 선정할 수 없습니다")
		return;
	}
	
	ls_name = ds_1.NameValue(ds_1.RowPosition,'sbcr_name')
	
	if  (confirm(ls_name + " 업체를 선정 하시겠습니까?")) 
	{  //저장 routine
	}   
	else {
		return
	}
	
	if (is_ebid_yn == '1') {
		ls_sbcr_code = ds_1.NameValue(ds_1.RowPosition,'sbcr_code')
		arg_cmd = "  UPDATE m_vender_est_web " +
					"     set choicetag = 'Y' " +
					"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					"     AND estimateseq = " + ii_seq +
					"     AND sbcr_code = '" + ls_sbcr_code + "'"
		f_update_sql(arg_cmd)
	}
	arg_cmd = "  UPDATE m_estimation " +
				"     set buytag = '4' " +
				"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
				"     AND estimateseq = " + ii_seq 
	f_update_sql(arg_cmd)
	ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'Y'
	tr_1.Post()
	for(i=1;i<=ds_4.CountRow;i++){
		ds_4.NameValue(i,'approve_class') = '6'
	}
	tr_4.Post()
   is_chk = 'Y'   //업체 선정

	alert('정상으로 선정되었습니다...')
	gf_protect_on('tab_page_1')
	top.frames['main_title'].div_r.style.visibility="visible"
	top.frames['main_title'].div_u.style.visibility="hidden"
}
//----------------------------------------------------------------------------
function sbcr_cancel()                     //선정 취소
//---------------------------------------------------------------------------- 
{
	var i,ls_sbcr_code,arg_cmd,ll_cnt,ls_chk
	if (is_chk == 'N') return
	ll_cnt = f_select_q("select count(*) select_1 from m_approval " +
							 "where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
							 
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
		if (ls_chk > 0) {
			alert('이미 품의자료가 존재함으로 선정취소를 하실 수 없습니다...')
			return
		}
	}
	
	
	if  (confirm("선정된 업체 모두를 취소 하시겠습니까?")) 
	{  //저장 routine
	}   
	else {
		return
	}
	
		if (is_ebid_yn == '1') {
			arg_cmd = "  UPDATE m_estimation " +
						"     set buytag = '3' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq 
						f_update_sql(arg_cmd)
			ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'N'
		}
	
	for (i=1;i<=ds_1.CountRow;i++) {
		ds_1.NameValue(i,'choicetag') = 'N'
		ls_sbcr_code = ds_1.NameValue(i,'sbcr_code')
		arg_cmd = "  UPDATE m_vender_est_web " +
				 "     set choicetag = 'N' " +
				 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
				 "     AND estimateseq = " + ii_seq +
				 "     AND sbcr_code = '" + ls_sbcr_code + "'"
		f_update_sql(arg_cmd)
	}
	tr_1.Post()
	for(i=1;i<=ds_4.CountRow;i++){
		ds_4.NameValue(i,'approve_class') = '5'
	}
	tr_4.Post()
   is_chk = 'N' 
	alert('정상으로 취소되었습니다...')
	gf_protect_off('tab_page_1')
	ccom_choicetag.Enable=false
	top.frames['main_title'].div_r.style.visibility="hidden"
	top.frames['main_title'].div_u.style.visibility="visible"
}
//----------------------------------------------------------------------------
function div_btncancel_onclick()                     // 취소
//---------------------------------------------------------------------------- 
{
	ds_2.Undo(ds_2.RowPosition)
}
//----------------------------------------------------------------------------
function req_rtn()                     // 견적의뢰
//---------------------------------------------------------------------------- 
{
	var arg_cmd,i,ls_estimateyymm,ls_estimateseq,ls_sbcr_code,ls_chk,ll_cnt
	var sms_chk = "";
	if ( ds_1.CountRow < 1) {
		alert('견적받을 업체를 추가하시고 다시작업하시기 바랍니다...')
		return
	}
	ll_cnt = f_select_q("select buytag select_1 from m_estimation " +
							 "where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
	}
	if (ls_chk != '') {
		alert('이미 견적의뢰되어있습니다... ')
		return
	}
	if  (confirm("전자입찰 견적의뢰를 하시겠습니까?")) 
	{
		for (i=1;i<=ds_1.CountRow;i++) {
			ls_estimateyymm = ds_1.NameValue(i,"estimateyymm")
			ls_estimateseq  = ds_1.NameValue(i,"estimateseq")
			ls_sbcr_code    = ds_1.NameValue(i,"sbcr_code")

			arg_cmd = "  INSERT INTO M_VENDER_EST_WEB   " +
						 "    SELECT ESTIMATEYYMM,ESTIMATESEQ,SBCR_CODE,CHOICETAG,EST_YN,DELIVERYMETHOD,DELIVERYLIMITDATE, " +
						 "				 PAYMENTMETHOD,QUALITY,RECOMMEND,AMT,CHG_AMT,REMARK  " +
						 "      FROM M_VENDER_EST  " +
						 "     WHERE ESTIMATEYYMM = '" + ls_estimateyymm + "'" +
						 "       AND estimateseq = " + ls_estimateseq +
						 "       AND sbcr_code = '" + ls_sbcr_code + "'" +
						 " @ INSERT INTO M_VENDER_EST_DETAIL_WEB  " +
						 "     SELECT ESTIMATEYYMM,ESTIMATESEQ,'" + ls_sbcr_code + "',EST_UNQ_NUM,NAME,SSIZE,UNITCODE,   " +
						 "				QTY,ESTIMATEDETAILSEQ,0,''  " +
						 "       FROM M_EST_DETAIL  " +
						 "     WHERE ESTIMATEYYMM = '" + ls_estimateyymm + "'" +
						 "       AND estimateseq = " + ls_estimateseq +
   					 " @ UPDATE m_estimation " +
   					 "      set buytag = '1'," +
   					 "          estimatedate = sysdate " +
						 "     WHERE ESTIMATEYYMM = '" + ls_estimateyymm + "'" +
						 "       AND estimateseq = " + ls_estimateseq 
		   f_update_sql_multy(arg_cmd)

			//메세지 보내기시작
			var ls_name,ls_dept_name,ls_tel,ls_date
			ll_cnt = f_select_q("SELECT nvl(rtrim(A.INOUT_TEL),'') select_1 FROM S_WBS_REQUEST A WHERE " +
						"A.SBCR_CODE = '" + ls_sbcr_code + "' " +
						"AND A.PROFESSION_WBS_CODE = '" + ds_1.NameValue(i,"profession_wbs_code") + "'")
			if (ll_cnt > 0){
				ls_tel = ds_select.NameValue(ds_select.RowPosition,'select_1');
			}
			if (ls_tel != null || ls_tel != '') {
				ll_cnt = f_select_q("select DISTINCT B.LONG_NAME select_1,to_char(C.ENDDATETIME,'YYYY.MM.DD') select_2,b.DEPT_CODE select_3 From " +
								" M_EST_DETAIL A, Z_CODE_DEPT B, M_ESTIMATION C WHERE " +
								"  a.DEPT_CODE = b.DEPT_CODE " +
								"AND a.ESTIMATEYYMM = C.ESTIMATEYYMM AND a.ESTIMATESEQ = c.ESTIMATESEQ " +
								"AND a.ESTIMATEYYMM = '" + ls_estimateyymm + "' " + 
								"AND a.ESTIMATESEQ = " + ls_estimateseq)
				if (ll_cnt > 0){
					ls_dept_name = ds_select.NameValue(ds_select.RowPosition,'select_1');
					ls_date = ds_select.NameValue(ds_select.RowPosition,'select_2');
					if (ds_select.NameValue(ds_select.RowPosition,'select_3').substr(0,2) == 'A0') {
						ls_name = '*월드건설*'
					} else {
						ls_name = '*월드건설산업*'
					}
				}
				if (sms_chk == "") {
					if (confirm("견적의뢰 SMS를 발송하시겠습니까?"))
						sms_chk = "1";
					else
						sms_chk = "2";
				}
				if (sms_chk == "1")
					gf_mail_to(ls_name,' 통합구매팀','',ls_tel,ls_name + ' ' + ls_dept_name + '현장 ' + ls_date + '(12:00)입찰입니다');
			}
			//메세지 보내기종료
		}
	}   
	else {
		return
	}

}
//----------------------------------------------------------------------------
function rereq_rtn()                     // 재견적의뢰
//---------------------------------------------------------------------------- 
{
	var arg_cmd,i,ls_estimateyymm,ls_estimateseq,ls_sbcr_code,ls_chk,ll_cnt
	var ls_name,ls_dept_name,ls_tel,ls_date
	if ( ds_1.CountRow < 1) {
		return
	}
	ll_cnt = f_select_q("select buytag select_1 from m_estimation " +
							 "where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
	}
	if (ls_chk != '3') {
		alert('접수상태에서만 재견적의뢰를 하실수있습니다... ')
		return
	}
	
	is_enddatetime = ds_1.NameValue(ds_1.RowPosition,'enddatetime') + ' 12'

	is_sysdate = f_sysdatetime()	
	is_sysdate = is_sysdate.substr(0,13)
	
   if (is_sysdate < 	is_enddatetime) {
       alert('견적제출시한이 도래하지않았습니다')
       return
   }

	if  (confirm("전자입찰 재견적의뢰를 하시겠습니까?")) 
	{  
		arg_cmd = "  UPDATE M_VENDER_EST_WEB   " +
					 "     set EST_YN = 'N' " +
					 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					 "       AND estimateseq = " + ii_seq +
					 " @ UPDATE m_estimation " +
					 "      set buytag = '2' , open_yn = 'N' " +
					 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					 "       AND estimateseq = " + ii_seq  + " " + 
		          " @  UPDATE M_VENDER_EST   " +
					 "     set EST_YN = 'N' " +
					 "     WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
					 "       AND estimateseq = " + ii_seq 
		
	   f_update_sql_multy(arg_cmd)
	   il_screen = 1
	   btnquery_onclick()
	}   
	else {
		return
	}

}
//----------------------------------------------------------------------------
function open_rtn()                 // 견적개봉
//-----------------------------------------------------------------------------
{
	var j,ls_text,arg_cmd,ll_cnt,ls_chk,ls_sbcr_code,ll_amt,ls_est_yn
	ll_cnt = f_select_q("select buytag select_1 from m_estimation " +
							 " where estimateyymm = '" + is_yymm + "'" +
							 "  and estimateseq = " + ii_seq  )
	if (ll_cnt > 0){
		ls_chk = ds_select.NameValue(ds_select.RowPosition,'select_1');
	}
	else{
		return
	}
	
  	
	is_enddatetime = ds_1.NameValue(ds_1.RowPosition,'enddatetime') + ' 12'

	is_sysdate = f_sysdatetime()	
	is_sysdate = is_sysdate.substr(0,13)
//	alert(is_sysdate)
//	alert(is_enddatetime)
   if (is_sysdate <	is_enddatetime) {
       alert('견적제출시한이 도래하지않았습니다')
       return
   }
	
	if (ds_1.CountRow < 1) {
	   alert("bb")
 	   return
	}
	if (ls_chk != '1' && ls_chk != '2') {
		alert('견적의뢰상태가 아니어서 견적개봉을 하실 수 없습니다... ')
		return
	}
	if (ls_chk == '1') {
	   if (gs_user_id ==  "kilee" || gs_user_id == "1" || gs_user_id == 'parkjh' || gs_user_id == 'chosh') {}
	   else {
	       alert('권한이 없습니다')
	       return
	   }    
		if  (confirm("전자입찰 견적개봉를 하시겠습니까?")){  
		}
		else {
			return
		}
	}
	else {
	   if (gs_user_id ==  "kilee" || gs_user_id == "1" || gs_user_id == 'parkjh' || gs_user_id == 'chosh') {}
	   else {
	       alert('권한이 없습니다')
	       return
	   }    
		if  (confirm("전자입찰 재견적개봉를 하시겠습니까?")){  
		}
		else {
			return
		}
	}
	tr_3.Action = is_tr_3_addr

   ls_text = is_yymm + ii_seq;
	is_key = gf_key_make(ls_text)
//	alert(is_key)
	for (i=1;i<=ds_1.CountRow;i++){
		ls_sbcr_code = ds_1.NameValue(i,'sbcr_code')

		ds_3.DataID = is_ds_3_addr +  is_yymm + "&arg_seq=" + ii_seq + "&arg_sbcr=" + ls_sbcr_code
		ds_3.SyncLoad=true
		ds_3.Reset()
		
		ll_amt = 0;
		
		if (ds_3.CountRow > 0){
			for (j=1 ;j <=ds_3.CountRow ;j++){
				Cipher.Decrypt(ls_text,ds_3.NameValue(j,"b_chgprice"),is_key)
				ls_text = Cipher.returnArg(1);
				if (ls_chk == '1') {
					ds_3.NameValue(j,"unitprice") = ls_text
				}
				ds_3.NameValue(j,"chgprice") = ls_text
				ll_amt = ll_amt + parseInt(ds_3.NameValue(j,"b_qty") * parseInt(ls_text,10),10);
			}
			tr_3.Post()
			if (ll_amt > 0) {
				if (ls_chk == '1') {
					arg_cmd = "  UPDATE m_vender_est " +
								 "     set amt = " + ll_amt + "," +
								 "         chg_amt = " + ll_amt + "," +
//								 "     	  estimatedate = sysdate ," +    박두현 수정(견적제출일로 사용하기위해서)
								 "         est_yn = 'Y'" +
								 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
								 "     AND estimateseq = " + ii_seq +
								 "     AND sbcr_code = '" + ls_sbcr_code + "'"
				}
				else {
					arg_cmd = "  UPDATE m_vender_est " +
								 "     set chg_amt = " + ll_amt + "," +
//								 "     	  estimatedate = sysdate ," +    박두현 수정(견적제출일로 사용하기위해서)
								 "         est_yn = 'Y'" +
								 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
								 "     AND estimateseq = " + ii_seq +
								 "     AND sbcr_code = '" + ls_sbcr_code + "'"
				}				
			   f_update_sql(arg_cmd)
			}
		}
	}
	arg_cmd = "  UPDATE m_estimation " +
				 "     set buytag = '3'," +
				 "         open_yn = 'Y', " +
				 "         open_per = '" + is_name + "'," +
				 "         open_dt = sysdate " +
				 "   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
				 "     AND estimateseq = " + ii_seq 
	
   f_update_sql(arg_cmd)
   alert('정상처리 되었습니다...')
   btnquery_onclick()

}
//----------------------------------------------------------------------------
function btnexit_onclick(ls_arg)                 // 종료 
//-----------------------------------------------------------------------------
{
	if (ds_1.IsUpdated) {
		if  (confirm("변경되었습니다 저장하시겠습니까?")) 
		{  //저장 routine
		}   
	
	}     
	top.frames['main_ct'].location.href(ls_arg)
	top.frames['main_title'].div_r.style.visibility="hidden"             
	top.frames['main_title'].div_u.style.visibility="hidden"             
	
	// top.frames['main_ct'].window.close()     
}
//----------------------------------------------------------------
function close_rtn()                      //화면 닫기 
//----------------------------------------------------------------
{
	top.frames['main_ct'].location.href(is_html +"?"+'u')
}
//----------------------------------------------------------------
function  est_compare()
//----------------------------------------------------------------
{
	if (ds_1.CountRow < 1) { 
		alert("선택한 견적업체가 없기때문에 들어갈수 없습니다")
		return
	}   
	makeCookie("@m_vender_est_compare_detail@",is_yymm+"@" +
                                   ii_seq +"@" +
                                   is_title + "@" + 
                                   gs_home + '/const/m_web/02/m_vender_est_list_1h.html')
	top.frames['main_ct'].location.href(gs_home + "/const/m_web/02r/m_vender_est_compare_detail_1h.html" +"?"+'p')

}

//------------------------------------------------------------------------
function get_focus(focus) // gd가 포커스를 받을때 동작.
//------------------------------------------------------------------------
{
	il_screen = focus
}

//---------------------------------------------------------------------------
function window_onload()                      // window open event
//---------------------------------------------------------------------------
{
  if (f_reject_window()) return 
   top.frames['main_title'].mouse_over()
	tr_1.Action = is_tr_1_addr
	tr_2.Action = is_tr_2_addr
	tr_4.Action = is_tr_4_addr
   
	var result="";
	var array = new Array();
   	result = readCookie("@m_vender_est_list@")
	
	array = result.split("@");
        
	is_dept_code = array[0]
	is_dept_name = array[1]
	is_yymm      = array[2]
	ii_seq       = array[3]
	is_title     = array[4]
	is_html      = array[5]	
	is_chk       = array[7]
	is_ebid_yn   = array[8]
	if (is_chk == 'Y' || is_ebid_yn == '1') {
		gf_protect_on('tab_page_1')
		if (is_ebid_yn == '1' && is_chk == 'N'){
			ccom_choicetag.Enable=false
		}
	}
	else {
		gf_protect_off('tab_page_1')
			ccom_choicetag.Enable=false
			em_amt.ReadOnly=true
			em_chg_amt.ReadOnly=true
//		ccom_buytag.Enable=0
	}
//	tx_remark.contentEditable=true
	top.frames['main_title'].title_name.value =  " 업체별견적내역 "         
	dept_name.value = " " + is_title + "[" + is_yymm + " - " + ii_seq + "]"

	ds_4.DataID = is_ds_4_addr + is_yymm + '&arg_seq=' + ii_seq 
	ds_4.SyncLoad=true
	ds_4.Reset()
	
	btnquery_onclick()
}
</SCRIPT>
<script language=JavaScript for=ccom_choicetag event=onCloseUp()>
	var ls_codevalue,ls_sbcr_code,arg_cmd
	var ls_name,ls_dept_name,ls_tel,ls_date
	ls_codevalue = ccom_choicetag.CodeValue
	if (ls_codevalue == 'Y') {
		if (ds_1.NameValue(ds_1.RowPosition,"est_yn") == 'N') {
			alert("견적이 제출되지않고는 선정할 수 없습니다")
			ccom_choicetag.CodeValue = 'N'
			ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'N'
			return;
		}
		if (is_ebid_yn == '1') {
			ls_sbcr_code = ds_1.NameValue(ds_1.RowPosition,'sbcr_code')
			arg_cmd = "  UPDATE m_vender_est_web " +
						"     set choicetag = 'Y' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq +
						"     AND sbcr_code = '" + ls_sbcr_code + "'"
			f_update_sql(arg_cmd)
			arg_cmd = "  UPDATE m_estimation " +
						"     set buytag = '4' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq 
			f_update_sql(arg_cmd)
			ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'Y'
			tr_1.Post()
         is_chk = 'Y'   //업체 선정
			//메세지 보내기시작
<!--			var ls_name,ls_dept_name,ls_tel,ls_date
			for (i=1;i<=ds_1.CountRow;i++) {
				ll_cnt = f_select_q("SELECT nvl(rtrim(A.INOUT_TEL),'') select_1 FROM S_WBS_REQUEST A WHERE " +
							"A.SBCR_CODE = '" + ds_1.NameValue(i,"sbcr_code") + "' " +
							"AND A.PROFESSION_WBS_CODE = '" + ds_1.NameValue(i,"profession_wbs_code") + "'")
				if (ll_cnt > 0){
					ls_tel = ds_select.NameValue(ds_select.RowPosition,'select_1');
				}
				if (ls_tel != null || ls_tel != '') {
					ll_cnt = f_select_q("select DISTINCT B.LONG_NAME select_1,to_char(C.ENDDATETIME,'YYYY.MM.DD') select_2,b.DEPT_CODE select_3 From " +
									" M_EST_DETAIL A, Z_CODE_DEPT B, M_ESTIMATION C WHERE " +
									"  a.DEPT_CODE = b.DEPT_CODE " +
									"AND a.ESTIMATEYYMM = C.ESTIMATEYYMM AND a.ESTIMATESEQ = c.ESTIMATESEQ " +
									"AND a.ESTIMATEYYMM = '" + ds_1.NameValue(i,"estimateyymm") + "' " + 
									"AND a.ESTIMATESEQ = " + ds_1.NameValue(i,"estimateseq"))
					if (ll_cnt > 0){
						ls_dept_name = ds_select.NameValue(ds_select.RowPosition,'select_1');
						ls_date = ds_select.NameValue(ds_select.RowPosition,'select_2');
						if (ds_select.NameValue(ds_select.RowPosition,'select_3').substr(0,2) == 'A0') {
							ls_name = '*월드건설*'
						} else {
							ls_name = '*월드건설산업*'
						}
					}
					if (confirm(ds_1.NameValue(i,"sbcr_name") + " 선정 및 탈락 SMS메세지를 보내시겠습니까?")) {
						if (ds_1.NameValue(i,"sbcr_code") == ls_sbcr_code) {
							gf_mail_to(ls_name,' 통합구매팀','',ls_tel,ls_name + ' ' + ls_dept_name + '현장 ' + ls_date + '개봉결과 선정입니다')
						} else {
							gf_mail_to(ls_name,' 통합구매팀','',ls_tel,ls_name + ' ' + ls_dept_name + '현장 ' + ls_date + '개봉결과 탈락입니다')
						}
					}
				}
			} 
			//메세지 보내기종료-->
		}

	} else {
		if (is_ebid_yn == '1') {
			ls_sbcr_code = ds_1.NameValue(ds_1.RowPosition,'sbcr_code')
			arg_cmd = "  UPDATE m_vender_est_web " +
						"     set choicetag = 'N' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq +
						"     AND sbcr_code = '" + ls_sbcr_code + "'"
			f_update_sql(arg_cmd)
			arg_cmd = "  UPDATE m_estimation " +
						"     set buytag = '3' " +
						"   WHERE ESTIMATEYYMM = '" + is_yymm + "'" +
						"     AND estimateseq = " + ii_seq 
						f_update_sql(arg_cmd)
			ds_1.NameValue(ds_1.RowPosition,"choicetag") = 'N'
			is_chk = 'N'   //업체선정 취소
			tr_1.Post()
		}
	}
</script>
<script language=JavaScript for=ccom_est_yn event=onCloseUp()>
	var ls_codevalue
	ls_codevalue = ccom_est_yn.CodeValue
	if (ls_codevalue == 'N') {
		if (ds_1.NameValue(ds_1.RowPosition,"choicetag") == 'Y') {
			alert("선정된 업체는 견적 취소를 할 수 없습니다")
			ccom_est_yn.CodeValue = 'Y'
			ds_1.NameValue(ds_1.RowPosition,"est_yn") = 'Y'
		}
	}
</script>
<script language=JavaScript for=gd_1 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_1.RowPosition == ds_1.CountRow)  
        btnadd_onclick()
    else     
        ds_1.RowPosition++
}
</SCRIPT>
<script language=JavaScript for=gd_2 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_2.RowPosition != ds_2.CountRow)  
        ds_2.RowPosition++
}
</SCRIPT>
<script language=JavaScript for=gd_3 event=OnKeyPress(kcode)>
if (kcode == 13) {
    if (ds_5.RowPosition != ds_5.CountRow)  
        ds_5.RowPosition++
}
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_5>
{
	if  (row < 1) return;
	filter_function()
}
</SCRIPT>
<SCRIPT language=JavaScript event=OnRowPosChanged(row) for=ds_1>
{
	if  (row < 1) return;
	
	if (ds_2.IsUpdated){
 		btnsave_onclick()
 	}
	if (ds_1.NameValue(row,"choicetag") == 'Y' || is_ebid_yn == '1' || is_chk == 'Y') {
		gd_2.Editable=0
		gd_3.Editable=0
	}
	else{
		gd_2.Editable=-1
		gd_3.Editable=-1
	}
	
	div_btnquery_onclick()  
}  
</SCRIPT>
<SCRIPT language=JavaScript event=OnSelChanged(nIndex) for=tb_1>
{ 
	if ( tb_1.ActiveIndex == 1 ){
	  gd_3.style.width='100%' 
	}
	else {
	  gd_3.style.width='600px' 
	}
 }             
</SCRIPT>

<SCRIPT language=JavaScript for=ds_2 event=onFilter(row)>
	var ll_row,ls_name,ls_ssize,ls_unit
	ll_row = ds_5.RowPosition
	ls_name  = ds_5.NameValue(ll_row,'name')
	ls_ssize = ds_5.NameValue(ll_row,'ssize')
	ls_unit  = ds_5.NameValue(ll_row,'unitcode')

	if (ds_2.NameValue(row,"name") == ls_name && ds_2.NameValue(row,'ssize') == ls_ssize && ds_2.NameValue(row,'unitcode') == ls_unit ) return true
	else return false;
</SCRIPT>

</HEAD>
<BODY style="FONT-SIZE: 12px" onload=setTimeout('window_onload()',1) oncontextmenu="return false" >
<SCRIPT language=JavaScript for=ds_1 event=OnLoadError()>
  alert("Error Code(ds_1) : " + ds_1.ErrorCode + "\n" + "Error Message : " + ds_1.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_1 event=OnFail()>
  alert("Error Code(tr_1) : " + tr_1.ErrorCode + "\n" + "Error Message : " + tr_1.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_2 event=OnLoadError()>
  alert("Error Code(ds_2) : " + ds_2.ErrorCode + "\n" + "Error Message : " + ds_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_3 event=OnLoadError()>
  alert("Error Code(ds_3) : " + ds_3.ErrorCode + "\n" + "Error Message : " + ds_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_4 event=OnLoadError()>
  alert("Error Code(ds_4) : " + ds_4.ErrorCode + "\n" + "Error Message : " + ds_4.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=ds_5 event=OnLoadError()>
  alert("Error Code(ds_5) : " + ds_5.ErrorCode + "\n" + "Error Message : " + ds_5.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=ds_update event=OnLoadError()>
  alert("Error Code(ds_update) : " + ds_update.ErrorCode + "\n" + "Error Message : " + ds_update.ErrorMsg + "\n");
</SCRIPT>

<SCRIPT language=JavaScript for=tr_2 event=OnFail()>
  alert("Error Code(tr_2) : " + tr_2.ErrorCode + "\n" + "Error Message : " + tr_2.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_3 event=OnFail()>
  alert("Error Code(tr_3) : " + tr_3.ErrorCode + "\n" + "Error Message : " + tr_3.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript for=tr_4 event=OnFail()>
  alert("Error Code(tr_4) : " + tr_4.ErrorCode + "\n" + "Error Message : " + tr_4.ErrorMsg + "\n");
</SCRIPT>
<SCRIPT language=JavaScript  event=OnColumnChanged(row,colid) for=ds_5>
	var ld_amt,i
	if (colid == "unitprice" ) {
		for(i=1;i<=ds_2.CountRow;i++){
			ds_2.NameValue(i,'unitprice') = ds_5.NameValue(row,'unitprice')
			ds_2.NameValue(i,'chgprice')  = ds_5.NameValue(row,'unitprice')
			ld_amt = ds_2.NameValue(i,"unitprice") * ds_2.NameValue(i,"qty")
			ld_amt = parseInt(ld_amt)
			ds_2.NameValue(i,"comp_amt") = ld_amt
			ld_amt = ds_2.NameValue(i,"chgprice") * ds_2.NameValue(i,"qty")
			ld_amt = parseInt(ld_amt)
			ds_2.NameValue(i,"comp_chgamt") = ld_amt
		}
		ds_5.NameValue(row,"comp_amt") = ds_2.NameSum('comp_amt',0,0)
		ds_5.NameValue(row,"chgprice") = ds_5.NameValue(row,"unitprice")
		ds_1.NameValue(ds_1.RowPosition,"amt") = ds_5.NameSum('comp_amt',0,0)
	}
	if (colid == "chgprice" ) {
		for(i=1;i<=ds_2.CountRow;i++){
			ds_2.NameValue(i,'chgprice')  = ds_5.NameValue(row,'chgprice')
			ld_amt = ds_2.NameValue(i,"chgprice") * ds_2.NameValue(i,"qty")
			ld_amt = parseInt(ld_amt)
			ds_2.NameValue(i,"comp_chgamt") = ld_amt
		}
		ds_5.NameValue(row,"comp_chgamt") = ds_2.NameSum('comp_chgamt',0,0)
		ds_1.NameValue(ds_1.RowPosition,"chg_amt") = ds_5.NameSum('comp_chgamt',0,0)
	}
</SCRIPT>

 <comment id="__NSID__"><OBJECT id=ds_update
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_1
    style="Z-INDEX: 103; LEFT: 169px; POSITION: absolute; TOP: 3px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
    <param name=UseFilter       value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=ds_2 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
    <param name=UseFilter       value=true></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_3 
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_4
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=ds_5
    style="Z-INDEX: 108; LEFT: 319px; POSITION: absolute; TOP: 7px" 
    classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT></OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_select
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><Object id=ds_sysdate
      style="Z-INDEX: 100; LEFT: 339px; POSITION: absolute; TOP: 13px" 
      classid=clsid:3267EA0D-B5D8-11D2-A4F9-00608CEBEE49 VIEWASTEXT> </OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tr_1 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_vender_est_list_1tr=ds_1)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
	
<comment id="__NSID__"><OBJECT id=tr_2 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_vender_est_detail_1tr=ds_2)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tr_3 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_vender_open_1tr=ds_3)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=tr_4 
    style="Z-INDEX: 103; LEFT: 477px; POSITION: absolute; TOP: 2px" 
    classid=clsid:0A2233AD-E771-11D2-973D-00104B15E56F VIEWASTEXT>
	<PARAM NAME="Action" VALUE="">
	<PARAM NAME="KeyName" VALUE="toinb_dataid4">
	<PARAM NAME="KeyValue" VALUE="JSP(I:m_vender_est_list_2tr=ds_4)">
	<PARAM NAME="Protocol" VALUE="1"></OBJECT></comment> <script> __ws__(__NSID__);</script>
	
 <OBJECT id=Cipher classid=clsid:BD64BD76-594A-47A6-A0EE-5CD6DF66BC8B
  width=0 height=0 VIEWASTEXT></OBJECT>
<!--	
<DIV id=tab_page_2 
         style="LEFT: 325px; WIDTH: 180px; POSITION: absolute; TOP: 0px; HEIGHT: 25px; BACKGROUND-COLOR: #FFFFFF">
	<table width="100%"  BORDER="2"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
		<tr BGCOLOR="white"> 
			<td width="40%"   BGCOLOR="#CA7944" style="COLOR: WHITE"  > 
				<div align="right">의뢰구분</div></td>
			<td width="60%"> 
				<comment id="__NSID__"><object id=ccom_buytag
					classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
                                        height=80 width=100 VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<param name=Data     value="^,1^견적의뢰,2^재견적의뢰,3^접수,4^선정">
               <param name=ReadOnlyBackColor     value="#F2F2F2">
               <param name=Auto     value=false>
					<param name=Enable   value=false>
					<param name=DataID     value=ds_1>
					<param name=CodeColumn value=buytag>
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td> 
         	</tr>                 
	</table>    
</DIV> -->
<DIV id=gd_1_button 
style="Z-INDEX: 107; LEFT: 2px; WIDTH: 1010px; POSITION: absolute; TOP: 0px; HEIGHT: 20px">
	<INPUT id=dept_name  ondblclick="dept_name.select()" onfocus="dept_name.select()"  style="ime-mode:active" readonly
	    style="Z-INDEX: 100; FONT-SIZE: 12px; LEFT: 10px; WIDTH: 308px; POSITION: absolute; TOP: 5px"
	    >
</div>	    
<DIV id=gd_1_button 
style="Z-INDEX: 107; LEFT: 650px; WIDTH: 400px; POSITION: absolute; TOP: 7px; HEIGHT: 20px">
	<INPUT  type=button  class="img_btn4_1"  value=업체선정 onclick=ok_rtn() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
	<INPUT  type=button  class="img_btn4_1"  value=선정취소 onclick=sbcr_cancel() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
	<INPUT  type=button  class="img_btn5_1"  value=견적대비표 onclick=est_compare() onmouseover="this.style.color=MOUSE_OVER;" onmouseout="this.style.color=MOUSE_OUT;">
	<INPUT type=button  class="img_btnClose"  value=닫기 onclick=close_rtn() >
<!--<input type="button2" value=" 견적개봉 " 
          style="Z_INDEX: 108; LEFT: 735px; top:5px;POSITION: absolute;  WIDTH:60px; color:#2E4A4A; font-size:13px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=open_rtn()>
<input type="button2" value=" 견적의뢰 " 
          style="Z_INDEX: 108; LEFT: 800px; top:5px;POSITION: absolute;  WIDTH:60px; color:#2E4A4A; font-size:13px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=req_rtn()>
<input type="button2" value=" 재견적의뢰 " 
          style="Z_INDEX: 108; LEFT: 865px; top:5px;POSITION: absolute;  WIDTH:75px; color:#2E4A4A; font-size:13px; CURSOR: hand;
           background-color:#E9F5F5; border:1 #A1A9A9 solid;   height:17px"   
            onmouseover="this.style.backgroundColor='#C0E8DB'; this.style.color='#EF315E'" 
            onmouseout="this.style.backgroundColor='#E9F5F5'; this.style.color='#0E4433'
           "  onclick=rereq_rtn()>-->
</DIV>

<comment id="__NSID__"><OBJECT id=gd_1 onfocus="get_focus(1)"
    style="FONT-SIZE: 12px; Z-INDEX: 105; LEFT: 2px; WIDTH:500px; POSITION: absolute; TOP: 30px; HEIGHT: 207px" 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
	<PARAM NAME="AutoInsert" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="Editable" VALUE="0">
	<PARAM NAME="ColSizing" VALUE="-1">
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="Format" VALUE=' 
	  <C> Name="견적업체" ID=sbcr_name Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=200 </C>
	  <C> Name="구분" ID=choicetag Edit=None Align=Center HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=50
		EditStyle=Combo Data="Y:선정,N:"  </C> 
	  <C> Name="견적서" ID=est_yn Edit=None Align=Center HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=50 
		EditStyle=Combo Data="Y:제출,N:미제출"  </C> 
	  <C> Name="견적금액" ID=amt Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=80 </C>
	  <C> Name="조정금액" ID=chg_amt Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=80 </C>
      '>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<DIV id=tab_page_1 
         style="LEFT: 505px; WIDTH: 500px; POSITION: absolute; TOP: 30px; HEIGHT: 550px; BACKGROUND-COLOR: #FFFFFF">
	<table width="100%"  BORDER="4"    CELLSPACING="0"  align="center"   style="FONT-SIZE: 12px">
		<tr BGCOLOR="white"> 
			<td width="15%"  colspan=3 BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">견적업체</div></td>
			<td width="85%" colspan=17> 
                  		<INPUT id=tx_sbcr_code  MAXLENGTH=10 tabIndex=1 size=10 readonly >
                  		<INPUT id=tx_sbcr_name  MAXLENGTH=30 tabIndex=0 size=44 readonly ></td>
         	</tr>                 
		<tr BGCOLOR="white"> 
			<td width="15%"  colspan=3 BGCOLOR="#CA7944" style="COLOR: BLACK"  > 
				<div align="right">선정여부</div></td>
			<td width="15%" colspan=3> 
				<comment id="__NSID__"><object id=ccom_choicetag
					classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
                                        height=80 width=70 VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<param name=Data     value="Y^선정,N^미선정">
               <param name=ReadOnlyBackColor     value="#F2F2F2">
               <param name=Auto     value=false>
					<param name=Enable   value=false>
					<param name=DataID     value=ds_1>
					<param name=CodeColumn value=choicetag>
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td> 
			<td width="15%" colspan=3  BGCOLOR="#CA7944" style="COLOR: BLACK"  > 
				<div align="right">견적여부</div></td>
			<td width="15%" colspan=3> 
				<comment id="__NSID__"><object id=ccom_est_yn
					classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
                                        height=80 width=70 VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<param name=Data     value="Y^제출,N^미제출">
               <param name=ReadOnlyBackColor     value="#F2F2F2">
               <param name=Auto     value=false>
					<param name=Enable   value=false>
					<param name=DataID     value=ds_1>
					<param name=CodeColumn value=est_yn>
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td> 
			<td width="15%" colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">견적제출일</div></td>
			<td width="25%" colspan=5> 
				<comment id="__NSID__"><OBJECT id=em_estimatedate tabIndex=4 
					style="WIDTH: 110px;" 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<PARAM NAME="Format" value="0000-00-00 00:00">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
<!--			<td width="15%" colspan=3  BGCOLOR="#CA7944" style="COLOR: BLACK"  > 
				<div align="right">인증서</div></td>
			<td width="15%" colspan=3> 
				<comment id="__NSID__"><object id=ccom_injung_yn
					classid=CLSID:FD4C6571-DD20-11D2-973D-00104B15E56F
                                        height=80 width=70 VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<param name=Data     value="Y^예,N^아니요">
               <param name=ReadOnlyBackColor     value="#F2F2F2">
               <param name=Auto     value=false>
					<param name=Enable   value=false>
					<param name=DataID     value=ds_1>
					<param name=CodeColumn value=injung_yn>
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td>  -->
     	</tr>                 
		<tr BGCOLOR="white"> 
			<td width="15%"  colspan=3 BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">견적개봉일</div></td>
			<td width="35%" colspan=7> 
				<comment id="__NSID__"><OBJECT id=em_open_dt tabIndex=4 
					style="WIDTH: 166px;" 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="1">
					<PARAM NAME="Format" VALUE="0000-00-00 00:00">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
			<td width="15%" colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">공급담당자</div></td>
			<td width="35%" colspan=7> 
                  		<INPUT id=tx_recommend  MAXLENGTH=20 tabIndex=9 size=22></td>
         	</tr>                 
		<tr BGCOLOR="white"> 
			<td width="15%" colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">견적금액</div></td>
			<td width="35%" colspan=7 > 
                  		<comment id="__NSID__"><OBJECT id=em_amt tabIndex=0
					style="WIDTH: 166px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="0">
					<PARAM NAME="PromptChar" VALUE="">
					<PARAM NAME=ReadOnlyForeColor VALUE="#CC3333">
					<PARAM NAME="ReadOnly" VALUE="-1">
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
			<td width="15%" colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
				<div align="right">조정금액</div></td>
			<td width="35%" colspan=7 > 
                  		<comment id="__NSID__"><OBJECT id=em_chg_amt tabIndex=0
					style="WIDTH: 166px; " 
					classid=clsid:E6876E99-7C28-43AD-9088-315DC302C05F VIEWASTEXT>
					<PARAM NAME="Alignment" VALUE="2">
					<PARAM NAME="MaxLength" VALUE="13">
					<PARAM NAME="SelectAll" VALUE="-1">
					<PARAM NAME="PromptChar" VALUE="">
					<PARAM NAME=ReadOnlyForeColor VALUE="#CC3333">
					<PARAM NAME="ReadOnly" VALUE="-1">
				</OBJECT></comment> <script> __ws__(__NSID__);</script></td>
         	</tr>                 
		<tr BGCOLOR="white"> 
             		<td width="15%" colspan=3  BGCOLOR="#BBE0F4" style="COLOR: BLACK"  > 
                 		<div align="right">비고</div></td>
             		<td width="85%" colspan=17> 
	                 	<TEXTAREA id=tx_remark  rows=6 tabIndex=10 cols=55 style="font-size:12px"></TEXTAREA></td>
         	</tr>                 
	</table>    
</DIV>

<comment id="__NSID__"><OBJECT id=bd_data 
    	style="Z-INDEX: 108; LEFT: 124px; WIDTH: 22px; POSITION: absolute; TOP: -37px; HEIGHT: 18px" 
    	classid=clsid:9C9AB433-EA85-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="DataID" VALUE="ds_1">
	<PARAM NAME="BindInfo" VALUE="
	    	<C>Col=sbcr_code       Ctrl=tx_sbcr_code Param=value Enable=enable</C>
		<C>Col=sbcr_name         Ctrl=tx_sbcr_name Param=value Enable=enable</C>
		<C>Col=estimatedate      Ctrl=em_estimatedate Param=text Enable=enable</C>
		<C>Col=deliverylimitdate Ctrl=em_deliverylimitdate Param=text Enable=enable</C>
		<C>Col=open_dt 			 Ctrl=em_open_dt Param=text Enable=enable</C>
		<C>Col=deliverymethod    Ctrl=tx_deliverymethod Param=value Enable=enable</C>
		<C>Col=paymentmethod     Ctrl=tx_paymentmethod Param=value Enable=enable</C>
		<C>Col=quality           Ctrl=tx_quality Param=value Enable=enable</C>
		<C>Col=recommend         Ctrl=tx_recommend Param=value Enable=enable</C>
		<C>Col=amt               Ctrl=em_amt Param=text Enable=enable</C>
		<C>Col=chg_amt           Ctrl=em_chg_amt Param=text Enable=enable</C>
		<C>Col=remark            Ctrl=tx_remark Param=value Enable=enable</C>
	" >
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<comment id="__NSID__"><OBJECT id=tb_1 
	style="FONT-SIZE: 12px; Z-INDEX: 200; LEFT: 2px; WIDTH:150px; POSITION: absolute; TOP: 240px; HEIGHT: 20px" 
	classid=clsid:ED382953-E907-11D3-B694-006097AD7252 VIEWASTEXT>
		<param name="BackColor"  value="#BBE0F4">
		<param name="TextColor"  value="BLACK">
		<PARAM NAME="Format" VALUE="
			<T>divid=tab_page_2 title=견적내역</T>
			<T>divid=tab_page_3 title=세부내역</T>
		">
</OBJECT></comment> <script> __ws__(__NSID__);</script>

<comment id="__NSID__"><OBJECT id=gd_3 onfocus="get_focus(3)"
    style="FONT-SIZE: 12px; Z-INDEX: 105; LEFT: 2px; WIDTH:1006px; POSITION: absolute; TOP: 260px; HEIGHT: 60%" 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
	<PARAM NAME="DataID" VALUE="ds_5">
	<PARAM NAME="Format" VALUE=' 
		  <C> Name="현장명" ID=long_name Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=170 SumText=@Count  SumColor=Black SumBgColor=Pink</C>
		  <C> Name="명칭" ID=name Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK BgColor=#F2F2F2 Width=190 
		  			SumText="합 계"  SumColor=Black SumBgColor=Pink  </C> 
		  <C> Name="규격" ID=ssize Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=150 </C> 
		  <C> Name="단위" ID=unitcode Edit=None Align=Center HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=45 </C> 
		  <C> Name="수량" ID=qty Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=60 
		  		SumText=@sum   SumColor=Black SumBgColor=Pink  </C> 
		  <G> Name="견적" HeadBgColor=#BBE0F4  HeadColor=BLACK   >
		  <C> Name="단가" ID=unitprice HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=75 </C> 
		  <C> Name="금액" ID=comp_amt Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=85 
		  		SumText=@sum   SumColor=Black SumBgColor=Pink </C></G>
		  <G> Name="조정" HeadBgColor=#BBE0F4  HeadColor=BLACK   >
		  <C> Name="단가" ID=chgprice HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=75 </C> 
		  <C> Name="금액" ID=comp_chgamt Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=85 
		  		SumText=@sum  SumColor=Black SumBgColor=Pink </C></G>
      '>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
<DIV id=tab_page_3 
	style="FONT-SIZE: 12px; Z-INDEX: 200; LEFT: 602px; WIDTH:406px; POSITION: absolute; TOP: 260px; HEIGHT: 60%" >
<comment id="__NSID__"><OBJECT id=gd_2 onfocus="get_focus(2)"
    style="FONT-SIZE: 12px; Z-INDEX: 105; LEFT: 0px; WIDTH:100%; POSITION: absolute; TOP:0px; HEIGHT: 95%" 
    classid=clsid:1F57AEAD-DB12-11D2-A4F9-00608CEBEE49 VIEWASTEXT>
	<PARAM NAME="MultiRowSelect" VALUE="-1">
	<PARAM NAME="AllShowEdit" VALUE="-1">
   <PARAM NAME="BorderStyle"  VALUE=4>
	<PARAM NAME="Editable" VALUE="-1">
	<PARAM NAME="ColSizing" VALUE="-1">
        <param name="ViewSummary"    value=1>
	<PARAM NAME="DataID" VALUE="ds_2">
	<PARAM NAME="Format" VALUE=' 
		  <C> Name="수량" ID=qty Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=60 
		  		SumText=@sum   SumColor=Black SumBgColor=Pink  </C> 
		  <G> Name="견적" HeadBgColor=#BBE0F4  HeadColor=BLACK   >
		  <C> Name="단가" ID=unitprice HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=75 </C> 
		  <C> Name="금액" ID=comp_amt Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=85 
		  		SumText=@sum   SumColor=Black SumBgColor=Pink </C></G>
		  <G> Name="조정" HeadBgColor=#BBE0F4  HeadColor=BLACK   >
		  <C> Name="단가" ID=chgprice HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  Width=75 </C> 
		  <C> Name="금액" ID=comp_chgamt Edit=None HeadAlign=Center HeadBgColor=#BBE0F4  HeadColor=BLACK  BgColor=#F2F2F2 Width=85 
		  		SumText=@sum  SumColor=Black SumBgColor=Pink </C></G>
      '>
</OBJECT></comment> <script> __ws__(__NSID__);</script>
</DIV>
</DIV>
</BODY></HTML>
