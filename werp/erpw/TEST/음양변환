//		 0 : 변환성공
//		-1 : 년범위를 벗어난 경우 (1881 ~ 2043)
//		-2 : 월범위를 벗어난 경우 (   1 ~   12)
//		-3 : 일범위를 벗어난 경우
//		-4 : 윤달이 아닌데 윤달체크가 된 경우

integer yearpos
integer i, j
integer lunmap[163, 13], tmp[]
long totday
integer ai_year, ai_month, ai_day

setnull(as_soldate)

if len(as_lundate) = 10 then
	ai_month = integer(mid(as_lundate, 6, 2))
elseif len(as_lundate) = 8 then
	ai_month = integer(mid(as_lundate, 5, 2))
else
	return -1
end if

ai_year = integer(left(as_lundate, 4))
ai_day = integer(right(as_lundate, 2))

if ai_year < 1881 or ai_year > 2043 then return -1
if ai_month < 1 or ai_month > 12 then return -2
if ai_day < 1 then return -3

for yearpos = 1 to 16
	choose case yearpos
		case 1
		// --------------------> 1881 ~ 1890 <------ //
			tmp[] =												 &
			  { 1, 2, 1, 2, 1, 2, 2, 3, 2, 2, 1, 2, 1, &
				 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 2, 1, 1, 2, 1, 3, 2, 1, 2, 2, 1, 2, 2, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 3, 2, 1, 1, 2, 1, 2, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2  }
		case 2
		// --------------------> 1891 ~ 1900 <------ //
			tmp[] =												 &
			  { 1, 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 3, 2, 2, 1, 2, 2, 2, &
				 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 3, 1, 2, 1, 2, 1, 2, 1, &
				 2, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 3, 2, 2, 1, 2, 1, 2, 1, 2, 1, &
				 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 2, 3, 2, 2, 1, 2  }
		case 3
		// --------------------> 1901 ~ 1910 <------ //
			tmp[] =												 &
			  { 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 3, 2, 1, 1, 2, 2, 1, 2, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 0, &
				 2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 4, 1, 2, 1, 2, 1, 2, 1, 2, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 0, &
				 1, 2, 3, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0  }
		case 4
		// --------------------> 1911 ~ 1920 <------ //
			tmp[] =												 &
			  { 2, 1, 2, 1, 1, 2, 3, 1, 2, 2, 1, 2, 2, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 2, 3, 1, 2, 1, 2, 1, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 3, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 3, 2, 2, 1, 2, 2, &
				 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 0  }
		case 5
		// --------------------> 1921 ~ 1930 <------ //
			tmp[] =												 &
			  { 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 2, 1, 3, 2, 1, 1, 2, 1, 2, 2, &
				 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 0, &
				 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 0, &
				 2, 1, 2, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 2, 3, 1, 2, 1, 1, 2, 2, 1, 2, 2, 2, &
				 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 2, 1, 1, 2, 3, 1, 2, 1, 2, 2, 1  }
		case 6
		// --------------------> 1931 ~ 1940 <------ //
			tmp[] =												 &
				 { 2, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 4, 1, 2, 1, 2, 1, 1, 2, &
				 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 0, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 4, 1, 2, 1, 2, 1, 2, 2, 2, 1, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 2, 1, 1, 2, 1, 1, 4, 1, 2, 2, 1, 2, &
				 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0  }
		case 7
		// --------------------> 1941 ~ 1950 <------ //
			tmp[] =												 &
				 { 2, 2, 1, 2, 2, 1, 4, 1, 1, 2, 1, 2, 1, &
				 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 1, 2, 0, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
				 1, 1, 2, 1, 4, 1, 2, 1, 2, 2, 1, 2, 2, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 0, &
				 2, 2, 3, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 3, 2, 1, 2, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0  }
		case 8
		// --------------------> 1951 ~ 1960 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 2, 1, 4, 2, 1, 2, 1, 2, 1, 2, &
				 1, 2, 1, 1, 2, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 2, 1, 1, 4, 1, 1, 2, 1, 2, 1, 2, 2, 2, &
				 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 1, 1, 2, 3, 2, 1, 2, 2, &
				 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 1, 2, 2, 3, 2, 1, 2, 1, 2, 1  }
		case 9
		// --------------------> 1961 ~ 1970 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 2, 1, 3, 2, 1, 2, 1, 2, 2, 2, 1, &
				 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 0, &
				 2, 2, 2, 3, 2, 1, 1, 2, 1, 1, 2, 2, 1, &
				 2, 2, 1, 2, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 1, 2, 3, 2, 1, 2, 1, 2, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 0  }
		case 10
		// --------------------> 1971 ~ 1980 <------ //
			tmp[] =												 &
				 { 1, 2, 1, 1, 2, 3, 2, 1, 2, 2, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2, 1, 0, &
				 2, 2, 1, 2, 3, 1, 2, 1, 1, 2, 2, 1, 2, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 2, 3, 2, 1, 1, 2, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 0, &
				 2, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 1, 2, 1, 2, 4, 1, 2, 2, 1, 2, 1, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0  }
		case 11
		// --------------------> 1981 ~ 1990 <------ //
			tmp[] =												 &
				 { 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 3, 2, 1, 1, 2, 2, 1, 2, 2, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 3, 2, 2, &
				 1, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 1, 0, &
				 2, 1, 2, 2, 1, 2, 3, 2, 2, 1, 2, 1, 2, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 1, 2, 1, 1, 2, 3, 1, 2, 1, 2, 2, 2, 2  }
		case 12
		// --------------------> 1991 ~ 2000 <------ //
			tmp[] =												 &
				 { 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 0, &
				 1, 2, 2, 3, 2, 1, 2, 1, 1, 2, 1, 2, 1, &
				 2, 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 2, 1, 2, 2, 1, 2, 3, 2, 1, 1, 2, &
				 1, 2, 1, 2, 2, 1, 2, 1, 2, 2, 1, 2, 0, &
				 1, 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 1, 2, 1, 3, 2, 2, 1, 2, 2, 2, 1, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 0  }
		case 13
		// --------------------> 2001 ~ 2010 <------ //
			tmp[] =												 &
				 { 2, 2, 2, 1, 3, 2, 1, 1, 2, 1, 2, 1, 2, &
				 2, 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 0, &
				 1, 2, 3, 2, 2, 1, 2, 1, 2, 2, 1, 1, 2, &
				 1, 2, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
				 1, 1, 2, 1, 2, 1, 2, 3, 2, 2, 1, 2, 2, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 0, &
				 2, 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 0, &
				 2, 2, 1, 1, 2, 3, 1, 2, 1, 2, 1, 2, 2, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0  }
		case 14
		// --------------------> 2011 ~ 2020 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 2, 1, 2, 1, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 4, 2, 1, 2, 1, 1, 2, 1, 2, 1, &
				 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 1, 2, 1, 2, 1, 2, 2, 3, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 2, 2, 1, 2, 2, 0, &
				 1, 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 0, &
				 2, 1, 1, 2, 1, 3, 2, 1, 2, 1, 2, 2, 2, &
				 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 0, &
				 2, 1, 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 0, &
				 2, 1, 2, 2, 3, 2, 1, 1, 2, 1, 2, 1, 2  }
		case 15
		// --------------------> 2021 ~ 2030 <------ //
			tmp[] =												 &
				 { 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 2, 1, 0, &
				 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 0, &
				 1, 2, 3, 2, 1, 2, 1, 2, 2, 1, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 3, 2, 1, 2, 2, 2, 1, &
				 2, 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 0, &
				 1, 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 2, 0, &
				 1, 2, 2, 1, 2, 3, 1, 2, 1, 1, 2, 2, 1, &
				 2, 2, 1, 2, 2, 1, 1, 2, 1, 1, 2, 2, 0, &
				 1, 2, 1, 2, 2, 1, 2, 1, 2, 1, 2, 1, 0  }
		case 16
		// --------------------> 2031 ~ 2040 <------ //
			tmp[] =												 &
				 { 2, 1, 2, 3, 2, 1, 2, 2, 1, 2, 1, 2, 1, &
				 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
				 1, 2, 1, 1, 2, 1, 2, 3, 2, 2, 2, 1, 2, &
				 1, 2, 1, 1, 2, 1, 2, 1, 2, 2, 2, 1, 0, &
				 2, 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 1, 4, 1, 1, 2, 1, 2, 2, &
				 2, 2, 1, 2, 1, 1, 2, 1, 1, 2, 1, 2, 0, &
				 2, 2, 1, 2, 1, 2, 1, 2, 1, 1, 2, 1, 0, &
				 2, 2, 1, 2, 2, 3, 2, 1, 2, 1, 2, 1, 1, &
				 2, 1, 2, 2, 1, 2, 2, 1, 2, 1, 2, 1, 0  }
	end choose
	for i = 1 to 10
		for j = 1 to 13
			lunmap[(yearpos - 1) * 10 + i, j] = tmp[(i - 1) * 13 + j]
		next
	next
next

// --------------------> 2041 ~ 2043 <------ //
tmp[] = { 2, 1, 1, 2, 1, 2, 2, 1, 2, 2, 1, 2, 0, &
			 1, 2, 3, 1, 2, 1, 2, 1, 2, 2, 2, 1, 2, &
			 1, 2, 1, 1, 2, 1, 1, 2, 2, 1, 2, 2, 0  }
for i = 1 to 3
	for j = 1 to 13
		lunmap[i + 160, j] = tmp[(i - 1) * 13 + j]
	next
next

if ab_yun then
	ai_month ++
	if lunmap[ai_year - 1880, 13] = 0 then return -4
	if lunmap[ai_year - 1880, ai_month] < 3 then return -4
	if ai_day > lunmap[ai_year - 1880, ai_month] + 26 then return -3
else
	for i = 1 to 12
		if lunmap[ai_year - 1880, i] > 2 then ai_month ++
		if i >= ai_month then exit
	next
	if ai_day > lunmap[ai_year - 1880, ai_month] + 28 then return -3
end if

yearpos = 0
totday = 0
i = 1
if ai_year > 1881 then
	yearpos = ai_year - 1881
	do while i <= yearpos
		for j = 1 to 13
			totday += lunmap[i, j]
		next
		if lunmap[i, 13] = 0 then
			totday += 336
		else
			totday += 362
		end if
		i ++
	loop
end if

yearpos ++
i = 1
do while i < ai_month
	if lunmap[yearpos, i] > 2 then
		totday += lunmap[yearpos, i] + 26
	else
		totday += lunmap[yearpos, i] + 28
	end if
	i ++
loop

totday += ai_day + 686685
as_soldate = f_juliantodate(totday, as_seperate)
return 0
